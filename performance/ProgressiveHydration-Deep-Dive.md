# Progressive Hydration â€” Deep Dive: Tá»± Viáº¿t Tay Tá»« Sá»‘ 0

> **TÃ i liá»‡u há»c táº­p chuyÃªn sÃ¢u â€” HoÃ n toÃ n báº±ng Tiáº¿ng Viá»‡t**
> Tá»± viáº¿t tay má»i thá»©, khÃ´ng phá»¥ thuá»™c thÆ° viá»‡n â€” Giáº£i thÃ­ch cá»±c ká»³ chi tiáº¿t kÃ¨m sÆ¡ Ä‘á»“

---

## Má»¥c Lá»¥c

```
Â§1.  Server-Side Rendering (SSR) â€” Ná»n táº£ng trÆ°á»›c khi hiá»ƒu Hydration
Â§2.  Hydration lÃ  gÃ¬? â€” QuÃ¡ trÃ¬nh "thá»•i há»“n" vÃ o HTML tÄ©nh
Â§3.  Uncanny Valley â€” Thung lÅ©ng ká»³ láº¡ cá»§a SSR
Â§4.  Progressive Hydration lÃ  gÃ¬? â€” Tá»•ng quan & Ã tÆ°á»Ÿng cá»‘t lÃµi
Â§5.  So sÃ¡nh: Full Hydration vs Progressive Hydration
Â§6.  CÃ¡ch Progressive Hydration hoáº¡t Ä‘á»™ng â€” SÆ¡ Ä‘á»“ chi tiáº¿t
Â§7.  Tá»± viáº¿t tay Hydrator Component â€” KhÃ´ng dÃ¹ng thÆ° viá»‡n
Â§8.  Intersection Observer â€” Hydrate khi component vÃ o viewport
Â§9.  Idle Callback â€” Hydrate khi trÃ¬nh duyá»‡t ráº£nh
Â§10. Event-Triggered â€” Hydrate khi user tÆ°Æ¡ng tÃ¡c
Â§11. Tá»± viáº¿t tay Code-Splitting + Lazy Hydration
Â§12. React 18+ Selective Hydration & Suspense
Â§13. Server Components + Streaming â€” TÆ°Æ¡ng lai cá»§a Hydration
Â§14. Æ¯u nhÆ°á»£c Ä‘iá»ƒm & Khi nÃ o nÃªn dÃ¹ng
Â§15. Best Practices & Phá»ng váº¥n Q&A
```

---

## Â§1. Server-Side Rendering (SSR) â€” Ná»n Táº£ng TrÆ°á»›c Khi Hiá»ƒu Hydration

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  SSR = SERVER RENDER HTML, Gá»¬I XUá»NG CLIENT!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  Äá»ŠNH NGHÄ¨A:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  SSR = Server-Side Rendering                           â”‚
  â”‚                                                        â”‚
  â”‚  Server RENDER á»©ng dá»¥ng React thÃ nh HTML hoÃ n chá»‰nh  â”‚
  â”‚  â†’ Gá»­i HTML Ä‘Ã³ xuá»‘ng trÃ¬nh duyá»‡t (client)            â”‚
  â”‚  â†’ Client HIá»‚N THá»Š ngay láº­p tá»©c!                     â”‚
  â”‚  â†’ KhÃ´ng cáº§n Ä‘á»£i JavaScript táº£i xong!                â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ Giá»‘ng: NhÃ  hÃ ng Náº¤U Sáº´N â†’ báº¡n nháº­n mÃ³n Äƒn      â”‚
  â”‚     NGAY, khÃ´ng cáº§n Ä‘á»£i náº¥u!                         â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ SSR â€” TOÃ€N Bá»˜ QUÃ TRÃŒNH:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
  â”‚  â”‚  CLIENT  â”‚ â”€â”€â‘ â”€â”€â–¶ â”‚     SERVER       â”‚            â”‚
  â”‚  â”‚ (Browser)â”‚ Request â”‚                  â”‚            â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â‘¡ React render  â”‚            â”‚
  â”‚       â–²                â”‚    ra HTML!      â”‚            â”‚
  â”‚       â”‚                â”‚                  â”‚            â”‚
  â”‚       â”‚                â”‚ â‘¢ Gá»­i HTML +    â”‚            â”‚
  â”‚       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   CSS + JSON     â”‚            â”‚
  â”‚       â”‚    Response    â”‚                  â”‚            â”‚
  â”‚       â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚       â”‚                                                â”‚
  â”‚       â–¼                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
  â”‚  â”‚  â‘£ Browser PARSE HTML   â”‚                         â”‚
  â”‚  â”‚  â†’ Hiá»ƒn thá»‹ UI ngay!    â”‚ â† FCP ráº¥t nhanh!       â”‚
  â”‚  â”‚  â†’ NHÆ¯NG chÆ°a click     â”‚                         â”‚
  â”‚  â”‚    Ä‘Æ°á»£c! (chÆ°a cÃ³ JS!)  â”‚                         â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
  â”‚       â”‚                                                â”‚
  â”‚       â–¼                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
  â”‚  â”‚  â‘¤ Táº£i JavaScript       â”‚                         â”‚
  â”‚  â”‚  â†’ Parse + Execute JS   â”‚                         â”‚
  â”‚  â”‚  â†’ Gáº®N event handlers   â”‚ â† Hydration!           â”‚
  â”‚  â”‚  â†’ UI TÆ¯Æ NG TÃC ÄÆ¯á»¢C!  â”‚                         â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  TIMELINE:                                              â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
  â”‚  â”‚Request â”‚ Server â”‚ HTML  â”‚ Parse â”‚ Load â”‚ Hydrateâ”‚  â”‚
  â”‚  â”‚        â”‚ render â”‚ sent  â”‚ HTML  â”‚  JS  â”‚  DOM   â”‚  â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
  â”‚           â”‚        â”‚       â”‚       â”‚      â”‚        â”‚   â”‚
  â”‚           â–¼        â–¼       â–¼       â–¼      â–¼        â–¼   â”‚
  â”‚        TTFB      HTML    FCP    JS      TTI            â”‚
  â”‚                  ready   âš¡    loaded  (tÆ°Æ¡ng tÃ¡c!)   â”‚
  â”‚                  (nhanh!)       (cháº­m!)                â”‚
  â”‚                                                        â”‚
  â”‚  FCP = First Contentful Paint (hiá»ƒn thá»‹ ná»™i dung)    â”‚
  â”‚  TTI = Time To Interactive (tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c)           â”‚
  â”‚                                                        â”‚
  â”‚  âš¡ FCP nhanh! NHÆ¯NG TTI cháº­m hÆ¡n!                   â”‚
  â”‚  â†’ Khoáº£ng cÃ¡ch FCP â†” TTI = Váº¤N Äá»€ Lá»šN!            â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SO SÃNH SSR vs CSR:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â•â•â• CSR (Client-Side Rendering) â•â•â•                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚ Request â†’ Nháº­n HTML trá»‘ng (<div id="root">) â”‚      â”‚
  â”‚  â”‚        â†’ Táº£i JS (bundle lá»›n!)              â”‚      â”‚
  â”‚  â”‚        â†’ JS render UI tá»« Ä‘áº§u!              â”‚      â”‚
  â”‚  â”‚        â†’ UI hiá»‡n ra = FCP = TTI             â”‚      â”‚
  â”‚  â”‚ â†’ FCP CHáº¬M! (pháº£i Ä‘á»£i JS)                  â”‚      â”‚
  â”‚  â”‚ â†’ NHÆ¯NG TTI = FCP (tÆ°Æ¡ng tÃ¡c ngay!)        â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  â•â•â• SSR (Server-Side Rendering) â•â•â•                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚ Request â†’ Nháº­n HTML Äáº¦Y Äá»¦ (cÃ³ ná»™i dung!) â”‚      â”‚
  â”‚  â”‚        â†’ Browser hiá»ƒn thá»‹ ngay = FCP        â”‚      â”‚
  â”‚  â”‚        â†’ Táº£i JS (bundle lá»›n!)              â”‚      â”‚
  â”‚  â”‚        â†’ Hydrate = gáº¯n events = TTI         â”‚      â”‚
  â”‚  â”‚ â†’ FCP NHANH! (cÃ³ HTML sáºµn!)                â”‚      â”‚
  â”‚  â”‚ â†’ NHÆ¯NG TTI CHáº¬M HÆ N (pháº£i hydrate!)       â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚  â”‚             â”‚ CSR            â”‚ SSR            â”‚     â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
  â”‚  â”‚ FCP         â”‚ âŒ Cháº­m       â”‚ âš¡ Nhanh!      â”‚     â”‚
  â”‚  â”‚ TTI         â”‚ âš¡ = FCP      â”‚ âŒ Cháº­m hÆ¡n   â”‚     â”‚
  â”‚  â”‚ SEO         â”‚ âŒ KÃ©m       â”‚ âš¡ Tá»‘t!        â”‚     â”‚
  â”‚  â”‚ Server load â”‚ âš¡ Nháº¹       â”‚ âŒ Náº·ng hÆ¡n   â”‚     â”‚
  â”‚  â”‚ JS bundle   â”‚ Táº¢I 1 Láº¦N    â”‚ Táº¢I 1 Láº¦N      â”‚     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE SSR CÆ  Báº¢N â€” Tá»° VIáº¾T TAY:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // server.js â€” Server render React thÃ nh HTML!        â”‚
  â”‚  import express from 'express';                        â”‚
  â”‚  import React from 'react';                            â”‚
  â”‚  import { renderToString } from 'react-dom/server';    â”‚
  â”‚  import App from './App';                              â”‚
  â”‚                                                        â”‚
  â”‚  const app = express();                                â”‚
  â”‚                                                        â”‚
  â”‚  app.get('/', (req, res) => {                          â”‚
  â”‚    // â‘  React render App thÃ nh HTML STRING!            â”‚
  â”‚    const html = renderToString(<App />);               â”‚
  â”‚                                                        â”‚
  â”‚    // â‘¡ Gá»­i HTML hoÃ n chá»‰nh xuá»‘ng client!            â”‚
  â”‚    res.send(`                                          â”‚
  â”‚      <!DOCTYPE html>                                   â”‚
  â”‚      <html>                                            â”‚
  â”‚        <head><title>SSR App</title></head>             â”‚
  â”‚        <body>                                          â”‚
  â”‚          <div id="root">${html}</div>                   â”‚
  â”‚          <script src="/bundle.js"></script>             â”‚
  â”‚        </body>                                         â”‚
  â”‚      </html>                                           â”‚
  â”‚    `);                                                 â”‚
  â”‚  });                                                   â”‚
  â”‚                                                        â”‚
  â”‚  // client.js â€” Client "hydrate" HTML Ä‘Ã£ cÃ³!          â”‚
  â”‚  import React from 'react';                            â”‚
  â”‚  import { hydrate } from 'react-dom';                  â”‚
  â”‚  import App from './App';                              â”‚
  â”‚                                                        â”‚
  â”‚  // hydrate() KHÃ”NG táº¡o DOM má»›i!                      â”‚
  â”‚  // â†’ Chá»‰ Gáº®N event handlers lÃªn DOM cÃ³ sáºµn!        â”‚
  â”‚  hydrate(<App />, document.getElementById('root'));     â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ renderToString() = Server â†’ HTML string!           â”‚
  â”‚  ğŸ’¡ hydrate()        = Client â†’ gáº¯n events!           â”‚
  â”‚  ğŸ’¡ KHÃC render()    = Client â†’ táº¡o DOM Má»šI!         â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§2. Hydration LÃ  GÃ¬? â€” QuÃ¡ TrÃ¬nh "Thá»•i Há»“n" VÃ o HTML TÄ©nh

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  HYDRATION = Gáº®N JAVASCRIPT VÃ€O HTML TÄ¨NH Tá»ª SERVER!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  Äá»ŠNH NGHÄ¨A CHI TIáº¾T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Hydration (nghÄ©a Ä‘en: "cáº¥p nÆ°á»›c", "tÆ°á»›i nÆ°á»›c")     â”‚
  â”‚                                                        â”‚
  â”‚  Trong React:                                          â”‚
  â”‚  â†’ HTML tá»« server = "cÃ¢y khÃ´" (tÄ©nh, khÃ´ng tÆ°Æ¡ng    â”‚
  â”‚    tÃ¡c Ä‘Æ°á»£c!)                                         â”‚
  â”‚  â†’ JavaScript = "nÆ°á»›c" (logic, events, state)         â”‚
  â”‚  â†’ Hydrate = "tÆ°á»›i nÆ°á»›c" cho cÃ¢y khÃ´ â†’ CÃ‚Y Sá»NG!   â”‚
  â”‚                                                        â”‚
  â”‚  Ká»¸ THUáº¬T:                                             â”‚
  â”‚  React kiá»ƒm tra DOM nodes hiá»‡n táº¡i (tá»« server)       â”‚
  â”‚  â†’ So sÃ¡nh vá»›i Virtual DOM (tá»« JavaScript)            â”‚
  â”‚  â†’ Gáº®N event listeners (onClick, onChange...)         â”‚
  â”‚  â†’ Khá»Ÿi táº¡o state vÃ  effects                         â”‚
  â”‚  â†’ Component TRá» NÃŠN TÆ¯Æ NG TÃC!                     â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ QUAN TRá»ŒNG: Hydrate KHÃ”NG táº¡o DOM má»›i!           â”‚
  â”‚  â†’ NÃ³ TÃI Sá»¬ Dá»¤NG DOM cÃ³ sáºµn tá»« server!            â”‚
  â”‚  â†’ Chá»‰ "gáº¯n" JavaScript logic vÃ o!                   â”‚
  â”‚  â†’ Náº¿u DOM khÃ´ng khá»›p â†’ React Cáº¢NH BÃO + sá»­a!      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ HYDRATION â€” Tá»ªNG BÆ¯á»šC:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  BÆ¯á»šC 1: HTML tá»« server (TÄ¨NH!)                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚  <div id="root">                             â”‚      â”‚
  â”‚  â”‚    <header>                                   â”‚      â”‚
  â”‚  â”‚      <h1>My App</h1>                          â”‚      â”‚
  â”‚  â”‚      <button>Menu â˜°</button>  â† KHÃ”NG click  â”‚      â”‚
  â”‚  â”‚    </header>                     Ä‘Æ°á»£c!        â”‚      â”‚
  â”‚  â”‚    <main>                                     â”‚      â”‚
  â”‚  â”‚      <p>Welcome!</p>                          â”‚      â”‚
  â”‚  â”‚      <button>Like ğŸ‘</button> â† KHÃ”NG click  â”‚      â”‚
  â”‚  â”‚    </main>                       Ä‘Æ°á»£c!        â”‚      â”‚
  â”‚  â”‚    <footer>Â© 2024</footer>                    â”‚      â”‚
  â”‚  â”‚  </div>                                       â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚  â†’ User THáº¤Y UI nhÆ°ng KHÃ”NG tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c!          â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  BÆ¯á»šC 2: JavaScript bundle Táº¢I Vá»€                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚  bundle.js (cÃ³ thá»ƒ ráº¥t Lá»šN!)                â”‚      â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚      â”‚
  â”‚  â”‚  â”‚ React runtime       â”‚ 40KB         â”‚       â”‚      â”‚
  â”‚  â”‚  â”‚ React DOM           â”‚ 120KB        â”‚       â”‚      â”‚
  â”‚  â”‚  â”‚ App components      â”‚ 200KB        â”‚       â”‚      â”‚
  â”‚  â”‚  â”‚ Third-party libs    â”‚ 150KB        â”‚       â”‚      â”‚
  â”‚  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚       â”‚      â”‚
  â”‚  â”‚  â”‚ Tá»”NG               â”‚ ~510KB!       â”‚       â”‚      â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚      â”‚
  â”‚  â”‚  â†’ Pháº£i DOWNLOAD + PARSE + EXECUTE!           â”‚      â”‚
  â”‚  â”‚  â†’ TrÃªn 3G: cÃ³ thá»ƒ máº¥t 3-5 giÃ¢y!            â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  BÆ¯á»šC 3: HYDRATION xáº£y ra!                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  React duyá»‡t TOÃ€N Bá»˜ cÃ¢y DOM:               â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  <div id="root">                              â”‚      â”‚
  â”‚  â”‚    â”‚                                          â”‚      â”‚
  â”‚  â”‚    â”œâ”€ <header>                                â”‚      â”‚
  â”‚  â”‚    â”‚    â”œâ”€ <h1> âœ… khá»›p! Gáº¯n ref            â”‚      â”‚
  â”‚  â”‚    â”‚    â””â”€ <button> âœ… khá»›p! Gáº®N onClick!  â”‚      â”‚
  â”‚  â”‚    â”‚           â”‚                              â”‚      â”‚
  â”‚  â”‚    â”‚           â””â†’ onClick = toggleMenu()      â”‚      â”‚
  â”‚  â”‚    â”‚              â†’ BÃ‚Y GIá»œ CLICK ÄÆ¯á»¢C!      â”‚      â”‚
  â”‚  â”‚    â”‚                                          â”‚      â”‚
  â”‚  â”‚    â”œâ”€ <main>                                  â”‚      â”‚
  â”‚  â”‚    â”‚    â”œâ”€ <p> âœ… khá»›p!                      â”‚      â”‚
  â”‚  â”‚    â”‚    â””â”€ <button> âœ… khá»›p! Gáº®N onClick!  â”‚      â”‚
  â”‚  â”‚    â”‚           â”‚                              â”‚      â”‚
  â”‚  â”‚    â”‚           â””â†’ onClick = handleLike()       â”‚      â”‚
  â”‚  â”‚    â”‚              useState(0) khá»Ÿi táº¡o!       â”‚      â”‚
  â”‚  â”‚    â”‚                                          â”‚      â”‚
  â”‚  â”‚    â””â”€ <footer> âœ… khá»›p! (tÄ©nh, ko event)    â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  â†’ TOÃ€N Bá»˜ cÃ¢y Ä‘Æ°á»£c hydrate CÃ™NG LÃšC!       â”‚      â”‚
  â”‚  â”‚  â†’ DÃ¹ footer KHÃ”NG Cáº¦N hydrate!              â”‚      â”‚
  â”‚  â”‚  â†’ ÄÃ‚Y LÃ€ Váº¤N Äá»€!                          â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  hydrate() vs render() â€” Sá»° KHÃC BIá»†T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚              â”‚ render()         â”‚ hydrate()      â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ DOM hiá»‡n táº¡iâ”‚ XÃ“A + táº¡o má»›i   â”‚ GIá»® nguyÃªn!   â”‚  â”‚
  â”‚  â”‚ Events      â”‚ Gáº¯n tá»« Ä‘áº§u     â”‚ Gáº¯n lÃªn DOM   â”‚  â”‚
  â”‚  â”‚             â”‚                  â”‚ cÃ³ sáºµn!       â”‚  â”‚
  â”‚  â”‚ Khi nÃ o    â”‚ CSR (thuáº§n       â”‚ SSR (sau khi  â”‚  â”‚
  â”‚  â”‚ dÃ¹ng?      â”‚ client)          â”‚ server render) â”‚  â”‚
  â”‚  â”‚ Tá»‘c Ä‘á»™    â”‚ Pháº£i táº¡o DOM   â”‚ Nhanh hÆ¡n!     â”‚  â”‚
  â”‚  â”‚             â”‚ tá»« Ä‘áº§u!        â”‚ (DOM cÃ³ sáºµn)  â”‚  â”‚
  â”‚  â”‚ Mismatch   â”‚ KhÃ´ng xáº£y ra   â”‚ Console warn!  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  // React 18 thay hydrate() báº±ng hydrateRoot():       â”‚
  â”‚  // CÅ© (React 17):                                    â”‚
  â”‚  hydrate(<App />, document.getElementById('root'));     â”‚
  â”‚                                                        â”‚
  â”‚  // Má»›i (React 18+):                                   â”‚
  â”‚  import { hydrateRoot } from 'react-dom/client';       â”‚
  â”‚  hydrateRoot(document.getElementById('root'), <App />);â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§3. Uncanny Valley â€” Thung LÅ©ng Ká»³ Láº¡ Cá»§a SSR

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  UNCANNY VALLEY = GIAO DIá»†N TRÃ”NG "Sá»NG" NHÆ¯NG "CHáº¾T"!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  GIáº¢I THÃCH:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  "Uncanny Valley" (Thung lÅ©ng ká»³ láº¡):                â”‚
  â”‚                                                        â”‚
  â”‚  Thuáº­t ngá»¯ gá»‘c tá»« robotics â€” robot trÃ´ng Gáº¦N GIá»NG  â”‚
  â”‚  ngÆ°á»i nhÆ°ng KHÃ”NG PHáº¢I ngÆ°á»i â†’ cáº£m giÃ¡c Ká»² Láº !     â”‚
  â”‚                                                        â”‚
  â”‚  Trong SSR:                                            â”‚
  â”‚  â†’ UI trÃ´ng HOÃ€N CHá»ˆNH, Ä‘áº¹p, cÃ³ nÃºt báº¥m!           â”‚
  â”‚  â†’ User nghÄ©: "Trang Ä‘Ã£ load xong!"                  â”‚
  â”‚  â†’ User click nÃºt â†’ KHÃ”NG CÃ“ GÃŒ Xáº¢Y RA!            â”‚
  â”‚  â†’ User bá»‘i rá»‘i: "Trang bá»‹ ÄÆ NG?"                   â”‚
  â”‚  â†’ Thá»±c táº¿: JavaScript CHÆ¯A táº£i xong!                â”‚
  â”‚  â†’ Event handlers CHÆ¯A Ä‘Æ°á»£c gáº¯n!                      â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ UI trÃ´ng "sá»‘ng" nhÆ°ng thá»±c ra "cháº¿t"              â”‚
  â”‚  = UNCANNY VALLEY!                                     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ TIMELINE â€” UNCANNY VALLEY:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Thá»i gian â†’                                           â”‚
  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
  â”‚                                                        â”‚
  â”‚  0s     1s     2s     3s     4s     5s     6s         â”‚
  â”‚  â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”‚          â”‚
  â”‚                                                        â”‚
  â”‚  â”‚ Tráº¯ngâ”‚ HTML hiá»ƒn thá»‹!   â”‚ JS táº£iâ”‚Hydrateâ”‚          â”‚
  â”‚  â”‚      â”‚                   â”‚       â”‚ xong! â”‚          â”‚
  â”‚  â”‚      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–¶â”‚       â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚                   â”‚       â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚  UNCANNY VALLEY!  â”‚       â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚  ==================       â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚  UI Ä‘áº¹p nhÆ°ng            â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚  KHÃ”NG click Ä‘Æ°á»£c!       â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚  User Bá»I Rá»I!           â”‚       â”‚          â”‚
  â”‚  â”‚      â”‚                           â”‚       â”‚          â”‚
  â”‚  â”‚      â–¼                           â–¼       â–¼          â”‚
  â”‚       FCP                        JS      TTI           â”‚
  â”‚    (nhÃ¬n tháº¥y!)               loaded  (click Ä‘Æ°á»£c!)   â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  NGÆ¯á»œI DÃ™NG TRáº¢I NGHIá»†M:                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚  0-1s: MÃ n hÃ¬nh tráº¯ng (bÃ¬nh thÆ°á»ng)         â”‚      â”‚
  â”‚  â”‚  1s:   "á»’ trang load NHANH quÃ¡!"            â”‚      â”‚
  â”‚  â”‚  1.5s: Click nÃºt "Mua hÃ ng" â†’ KHÃ”NG pháº£n   â”‚      â”‚
  â”‚  â”‚        há»“i!                                   â”‚      â”‚
  â”‚  â”‚  2s:   Click láº¡i â†’ váº«n KHÃ”NG!               â”‚      â”‚
  â”‚  â”‚  2.5s: "Trang bá»‹ lá»—i rá»“i!" â†’ GIáº¬N!        â”‚      â”‚
  â”‚  â”‚  3s:   Äang Ä‘á»‹nh RELOAD thÃ¬...               â”‚      â”‚
  â”‚  â”‚  3.5s: JS táº£i xong â†’ nÃºt Báº¤T NGá»œ hoáº¡t     â”‚      â”‚
  â”‚  â”‚        Ä‘á»™ng! â†’ 2 click trÆ°á»›c TRIGGER!        â”‚      â”‚
  â”‚  â”‚  4s:   Mua hÃ ng 2 Láº¦N! â†’ BUG!              â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  â†’ ÄÃ¢y lÃ  LÃ DO Progressive Hydration ra Ä‘á»i!        â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  Táº I SAO FULL HYDRATION GÃ‚Y RA Váº¤N Äá»€:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Trang web thá»±c táº¿ cÃ³ HÃ€NG TRÄ‚M components:           â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚ <App>                                    â”‚          â”‚
  â”‚  â”‚   <Header />         â† Cáº¦N interactive  â”‚          â”‚
  â”‚  â”‚   <HeroBanner />     â† TÄ©nh!           â”‚          â”‚
  â”‚  â”‚   <SearchBar />      â† Cáº¦N interactive  â”‚          â”‚
  â”‚  â”‚   <ProductList />    â† Cáº¦N interactive  â”‚          â”‚
  â”‚  â”‚   <Sidebar />        â† Ãt quan trá»ng    â”‚          â”‚
  â”‚  â”‚   <Recommendations />â† á» DÆ¯á»šI viewport! â”‚          â”‚
  â”‚  â”‚   <Reviews />        â† á» DÆ¯á»šI viewport! â”‚          â”‚
  â”‚  â”‚   <RelatedItems />   â† á» DÆ¯á»šI viewport! â”‚          â”‚
  â”‚  â”‚   <Footer />         â† TÄ©nh!           â”‚          â”‚
  â”‚  â”‚   <ChatWidget />     â† Ãt dÃ¹ng          â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚                                                        â”‚
  â”‚  FULL HYDRATION:                                       â”‚
  â”‚  â†’ Hydrate Táº¤T Cáº¢ cÃ¹ng lÃºc!                          â”‚
  â”‚  â†’ Pháº£i táº£i JS cho Má»ŒI component!                    â”‚
  â”‚  â†’ Ká»ƒ cáº£ Footer (tÄ©nh, KHÃ”NG Cáº¦N!)                  â”‚
  â”‚  â†’ Ká»ƒ cáº£ Reviews (á»Ÿ dÆ°á»›i, user CHÆ¯A THáº¤Y!)          â”‚
  â”‚  â†’ LÃƒNG PHÃ tÃ i nguyÃªn!                               â”‚
  â”‚                                                        â”‚
  â”‚  PROGRESSIVE HYDRATION:                                â”‚
  â”‚  â†’ Hydrate Header, SearchBar TRÆ¯á»šC! (quan trá»ng!)     â”‚
  â”‚  â†’ Footer â†’ KHÃ”NG hydrate (tÄ©nh!)                    â”‚
  â”‚  â†’ Reviews â†’ Hydrate KHI user cuá»™n xuá»‘ng!            â”‚
  â”‚  â†’ ChatWidget â†’ Hydrate KHI user click!               â”‚
  â”‚  â†’ TIáº¾T KIá»†M tÃ i nguyÃªn!                              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§4. Progressive Hydration LÃ  GÃ¬? â€” Tá»•ng Quan & Ã TÆ°á»Ÿng Cá»‘t LÃµi

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PROGRESSIVE HYDRATION = HYDRATE Tá»ªNG PHáº¦N, THEO THá»¨ Tá»°!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  Äá»ŠNH NGHÄ¨A:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Progressive Hydration = "Hydration tiáº¿n tiáº¿n"        â”‚
  â”‚                                                        â”‚
  â”‚  Thay vÃ¬ hydrate TOÃ€N Bá»˜ á»©ng dá»¥ng CÃ™NG LÃšC,        â”‚
  â”‚  ta hydrate Tá»ªNG PHáº¦N má»™t, theo THá»¨ Tá»° Æ¯U TIÃŠN!     â”‚
  â”‚                                                        â”‚
  â”‚  "Progressive" = "Dáº§n dáº§n", "Tiáº¿n triá»ƒn"              â”‚
  â”‚  â†’ Hydrate Dáº¦N Dáº¦N, khÃ´ng á»“ áº¡t!                     â”‚
  â”‚                                                        â”‚
  â”‚  CÃC CHIáº¾N LÆ¯á»¢C HYDRATE:                              â”‚
  â”‚  â‘  Theo VIEWPORT: Hydrate khi component HIá»†N trÃªn    â”‚
  â”‚     mÃ n hÃ¬nh (IntersectionObserver)                    â”‚
  â”‚  â‘¡ Theo IDLE: Hydrate khi trÃ¬nh duyá»‡t Ráº¢NH           â”‚
  â”‚     (requestIdleCallback)                              â”‚
  â”‚  â‘¢ Theo INTERACTION: Hydrate khi user TÆ¯Æ NG TÃC      â”‚
  â”‚     (click, hover, focus...)                           â”‚
  â”‚  â‘£ Theo PRIORITY: Hydrate component QUAN TRá»ŒNG trÆ°á»›c â”‚
  â”‚  â‘¤ Theo MEDIA: Hydrate theo kÃ­ch thÆ°á»›c mÃ n hÃ¬nh     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ Ã TÆ¯á»NG Cá»T LÃ•I:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â•â•â• FULL HYDRATION (truyá»n thá»‘ng) â•â•â•                â”‚
  â”‚                                                        â”‚
  â”‚  JS Bundle (TOÃ€N Bá»˜) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Hydrate     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   ALL!       â”‚
  â”‚  â”‚ Header â”‚ Search â”‚ Products â”‚ Footer â”‚              â”‚
  â”‚  â”‚ Reviewsâ”‚ Chat   â”‚ Related  â”‚ Sidebarâ”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚  â†’ Táº¢I Háº¾T rá»“i má»›i hydrate Háº¾T!                    â”‚
  â”‚  â†’ Cháº­m! Náº·ng! LÃ£ng phÃ­!                             â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  â•â•â• PROGRESSIVE HYDRATION â•â•â•                         â”‚
  â”‚                                                        â”‚
  â”‚  Chunk 1 (nhá»!) â”€â”€â–¶ Hydrate Header + Search âœ…       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
  â”‚  â”‚Header â”‚ Search â”‚ â†’ TTI cho pháº§n QUAN TRá»ŒNG!       â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
  â”‚                                                        â”‚
  â”‚  Chunk 2 (khi ráº£nh) â”€â”€â–¶ Hydrate Products âœ…           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
  â”‚  â”‚ Products â”‚ â†’ Táº£i khi browser idle!                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
  â”‚                                                        â”‚
  â”‚  Chunk 3 (khi cuá»™n) â”€â”€â–¶ Hydrate Reviews âœ…           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
  â”‚  â”‚ Reviews  â”‚ â†’ Táº£i khi user scroll xuá»‘ng!            â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
  â”‚                                                        â”‚
  â”‚  Footer â†’ KHÃ”NG HYDRATE! (tÄ©nh, khÃ´ng cáº§n JS!)       â”‚
  â”‚                                                        â”‚
  â”‚  Chat â†’ Hydrate KHI CLICK vÃ o icon chat!               â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  YÃŠU Cáº¦U Cá»¦A Má»˜T GIáº¢I PHÃP PROGRESSIVE HYDRATION:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â‘  Cho phÃ©p SSR cho Táº¤T Cáº¢ components                â”‚
  â”‚     â†’ Server váº«n render HTML Ä‘áº§y Ä‘á»§!                 â”‚
  â”‚     â†’ SEO + FCP khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng!                  â”‚
  â”‚                                                        â”‚
  â”‚  â‘¡ Há»— trá»£ CODE-SPLITTING theo component              â”‚
  â”‚     â†’ Má»—i component = 1 chunk JS riÃªng!              â”‚
  â”‚     â†’ Chá»‰ táº£i chunk Cáº¦N THIáº¾T!                       â”‚
  â”‚                                                        â”‚
  â”‚  â‘¢ Hydrate theo THá»¨ Tá»° do developer QUYáº¾T Äá»ŠNH      â”‚
  â”‚     â†’ Dev chá»n component nÃ o hydrate TRÆ¯á»šC!           â”‚
  â”‚     â†’ Component nÃ o hydrate SAU!                       â”‚
  â”‚                                                        â”‚
  â”‚  â‘£ KHÃ”NG BLOCK user input trÃªn pháº§n Ä‘Ã£ hydrate!      â”‚
  â”‚     â†’ Pháº§n Ä‘Ã£ hydrate PHáº¢I hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng!   â”‚
  â”‚     â†’ KhÃ´ng bá»‹ "Ä‘Æ¡" khi pháº§n khÃ¡c Ä‘ang hydrate!     â”‚
  â”‚                                                        â”‚
  â”‚  â‘¤ Cho phÃ©p LOADING INDICATOR cho pháº§n chÆ°a hydrate  â”‚
  â”‚     â†’ User biáº¿t pháº§n Ä‘Ã³ Ä‘ang loading!                 â”‚
  â”‚     â†’ KhÃ´ng bá»‘i rá»‘i!                                   â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§5. So SÃ¡nh: Full Hydration vs Progressive Hydration

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  FULL vs PROGRESSIVE â€” NHÃŒN LÃ€ HIá»‚U!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  SÆ  Äá»’ SO SÃNH TRá»°C QUAN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â•â•â• FULL HYDRATION â•â•â•                                â”‚
  â”‚                                                        â”‚
  â”‚  Server HTML â”€â”€â–¶ [  Táº£i toÃ n bá»™ JS bundle  ] â”€â”€â–¶ âš¡  â”‚
  â”‚                   â”‚â—€â”€â”€â”€ Thá»i gian dÃ i! â”€â”€â”€â”€â–¶â”‚          â”‚
  â”‚                                                        â”‚
  â”‚  Timeline:                                             â”‚
  â”‚  0s â”€â”€â”€â”€â”€ 1s â”€â”€â”€â”€â”€ 2s â”€â”€â”€â”€â”€ 3s â”€â”€â”€â”€â”€ 4s â”€â”€â”€â”€â”€ 5s     â”‚
  â”‚  â”‚        â”‚        â”‚        â”‚        â”‚        â”‚        â”‚
  â”‚  â”‚  HTML  â”‚   Táº£i JS bundle (Lá»šN!)  â”‚Hydrate â”‚ TTI   â”‚
  â”‚  â”‚ hiá»‡n!  â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â”‚Táº¤T Cáº¢ â”‚  âš¡   â”‚
  â”‚  â”‚  FCP   â”‚                          â”‚ 1 láº§n! â”‚       â”‚
  â”‚  â”‚        â”‚â—€â”€â”€ Uncanny Valley! â”€â”€â”€â”€â–¶â”‚        â”‚       â”‚
  â”‚  â”‚        â”‚  User KHÃ”NG click Ä‘Æ°á»£c! â”‚        â”‚       â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  â•â•â• PROGRESSIVE HYDRATION â•â•â•                         â”‚
  â”‚                                                        â”‚
  â”‚  Timeline:                                             â”‚
  â”‚  0s â”€â”€ 1s â”€â”€ 2s â”€â”€ 3s â”€â”€ 4s â”€â”€ 5s â”€â”€ 6s â”€â”€ 7s       â”‚
  â”‚  â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚  â”‚HTML â”‚Chunkâ”‚Chunkâ”‚     â”‚Chunkâ”‚     â”‚Chunkâ”‚          â”‚
  â”‚  â”‚hiá»‡n!â”‚  1  â”‚  2  â”‚     â”‚  3  â”‚     â”‚  4  â”‚          â”‚
  â”‚  â”‚ FCP â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚  â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚  â”‚     â”‚ âš¡  â”‚ âš¡  â”‚     â”‚ âš¡  â”‚     â”‚ âš¡  â”‚          â”‚
  â”‚  â”‚     â”‚Nav  â”‚Hero â”‚     â”‚List â”‚     â”‚Chat â”‚          â”‚
  â”‚  â”‚     â”‚hoáº¡tâ”‚hoáº¡t â”‚     â”‚hoáº¡tâ”‚     â”‚hoáº¡tâ”‚          â”‚
  â”‚  â”‚     â”‚Ä‘á»™ngâ”‚Ä‘á»™ng â”‚     â”‚Ä‘á»™ngâ”‚     â”‚Ä‘á»™ngâ”‚          â”‚
  â”‚  â”‚     â”‚    â”‚      â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚  â”‚     â”‚â—€â”€â”€â–¶â”‚      â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚  â”‚     â”‚ TTIâ”‚      â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚  â”‚     â”‚nhá»!â”‚      â”‚     â”‚     â”‚     â”‚     â”‚          â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ TTI cho pháº§n QUAN TRá»ŒNG ráº¥t NHANH!                â”‚
  â”‚  â†’ User tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c Nav tá»« giÃ¢y 1!                â”‚
  â”‚  â†’ Pháº§n Ã­t quan trá»ng táº£i SAU!                        â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  Báº¢NG SO SÃNH CHI TIáº¾T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                  â”‚ Full         â”‚ Progressive    â”‚  â”‚
  â”‚  â”‚                  â”‚ Hydration    â”‚ Hydration      â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ JS táº£i vá»       â”‚ Táº¤T Cáº¢     â”‚ Tá»ªNG PHáº¦N     â”‚  â”‚
  â”‚  â”‚                  â”‚ cÃ¹ng lÃºc!   â”‚ cáº§n thiáº¿t!    â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Hydrate khi     â”‚ NGAY khi JS â”‚ Khi cáº§n:      â”‚  â”‚
  â”‚  â”‚ nÃ o?            â”‚ táº£i xong    â”‚ viewport,idle, â”‚  â”‚
  â”‚  â”‚                  â”‚              â”‚ click...       â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ TTI             â”‚ CHáº¬M        â”‚ NHANH cho     â”‚  â”‚
  â”‚  â”‚                  â”‚ (Ä‘á»£i háº¿t!) â”‚ pháº§n then chá»‘tâ”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Bundle size      â”‚ 1 bundle    â”‚ Nhiá»u chunks  â”‚  â”‚
  â”‚  â”‚ ban Ä‘áº§u        â”‚ Lá»šN!        â”‚ NHá»!          â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Main thread     â”‚ Bá»Š BLOCK    â”‚ KhÃ´ng block!  â”‚  â”‚
  â”‚  â”‚ blocking        â”‚ lÃ¢u!        â”‚ Chia nhá»!     â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ FCP             â”‚ Nhanh (SSR) â”‚ Nhanh (SSR)   â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Uncanny Valley  â”‚ DÃ€I!        â”‚ NGáº®N!         â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Code splitting  â”‚ KhÃ´ng báº¯t   â”‚ Báº®T BUá»˜C!     â”‚  â”‚
  â”‚  â”‚                  â”‚ buá»™c        â”‚ (lÃ  ná»n táº£ng) â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Äá»™ phá»©c táº¡p    â”‚ ÄÆ¡n giáº£n!  â”‚ Phá»©c táº¡p hÆ¡n â”‚  â”‚
  â”‚  â”‚ implementation  â”‚              â”‚ (cáº§n chiáº¿n    â”‚  â”‚
  â”‚  â”‚                  â”‚              â”‚ lÆ°á»£c!)        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§6. CÃ¡ch Progressive Hydration Hoáº¡t Äá»™ng â€” SÆ¡ Äá»“ Chi Tiáº¿t

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  KIáº¾N TRÃšC PROGRESSIVE HYDRATION â€” NHÃŒN TOÃ€N Cáº¢NH!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  SÆ  Äá»’ KIáº¾N TRÃšC Tá»”NG THá»‚:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
  â”‚           â”‚      SERVER         â”‚                      â”‚
  â”‚           â”‚                     â”‚                      â”‚
  â”‚           â”‚  renderToString()   â”‚                      â”‚
  â”‚           â”‚  â†’ HTML Ä‘áº§y Ä‘á»§!   â”‚                      â”‚
  â”‚           â”‚                     â”‚                      â”‚
  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
  â”‚                      â”‚ HTML + CSS                      â”‚
  â”‚                      â–¼                                 â”‚
  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
  â”‚           â”‚      CLIENT         â”‚                      â”‚
  â”‚           â”‚                     â”‚                      â”‚
  â”‚           â”‚  DOM Tree (tÄ©nh)   â”‚                      â”‚
  â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                      â”‚
  â”‚           â”‚  â”‚   <App>       â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”‚ Header  â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€ Hydrate NGAY!     â”‚
  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”‚  Hero   â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€ Hydrate khi IDLE  â”‚
  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”‚Products â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€ Hydrate khi       â”‚
  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   VIEWPORT!          â”‚
  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”‚ Reviews â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€ Hydrate khi       â”‚
  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   VIEWPORT!          â”‚
  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”‚ Footer  â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€ KHÃ”NG hydrate!    â”‚
  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   (tÄ©nh!)           â”‚
  â”‚           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚                      â”‚
  â”‚           â”‚  â”‚  â”‚  Chat   â”‚â—€â”€â”¼â”€â”€â”¼â”€â”€ Hydrate khi       â”‚
  â”‚           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚   CLICK!             â”‚
  â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                      â”‚
  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  HYDRATOR COMPONENT â€” Ã TÆ¯á»NG TRUNG TÃ‚M:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Hydrator = Component Bá»ŒC (wrapper) quanh component   â”‚
  â”‚  cáº§n hydrate cÃ³ Ä‘iá»u kiá»‡n!                            â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚  <Hydrator>                                   â”‚      â”‚
  â”‚  â”‚    â”‚                                          â”‚      â”‚
  â”‚  â”‚    â”œâ”€ BAN Äáº¦U: Render HTML tÄ©nh tá»« server  â”‚      â”‚
  â”‚  â”‚    â”‚  (dÃ¹ng dangerouslySetInnerHTML hoáº·c     â”‚      â”‚
  â”‚  â”‚    â”‚   giá»¯ nguyÃªn server HTML)               â”‚      â”‚
  â”‚  â”‚    â”‚                                          â”‚      â”‚
  â”‚  â”‚    â”œâ”€ THEO DÃ•I Ä‘iá»u kiá»‡n:                    â”‚      â”‚
  â”‚  â”‚    â”‚  â†’ Component vÃ o viewport?              â”‚      â”‚
  â”‚  â”‚    â”‚  â†’ Browser ráº£nh?                         â”‚      â”‚
  â”‚  â”‚    â”‚  â†’ User tÆ°Æ¡ng tÃ¡c?                      â”‚      â”‚
  â”‚  â”‚    â”‚                                          â”‚      â”‚
  â”‚  â”‚    â””â”€ KHI Ä‘iá»u kiá»‡n THá»A:                    â”‚      â”‚
  â”‚  â”‚       â†’ Táº£i JS chunk cho component           â”‚      â”‚
  â”‚  â”‚       â†’ Hydrate component Ä‘Ã³!                â”‚      â”‚
  â”‚  â”‚       â†’ Component TRá» NÃŠN TÆ¯Æ NG TÃC!       â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  </Hydrator>                                  â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  Sá»¬ Dá»¤NG:                                              â”‚
  â”‚  <Hydrator                                             â”‚
  â”‚    whenVisible    // hydrate khi vÃ o viewport          â”‚
  â”‚    whenIdle       // hydrate khi browser ráº£nh          â”‚
  â”‚    on="click"     // hydrate khi click                 â”‚
  â”‚  >                                                     â”‚
  â”‚    <MyComponent />                                     â”‚
  â”‚  </Hydrator>                                           â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  LUá»’NG HOáº T Äá»˜NG CHI TIáº¾T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â‘  Server render:                                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚  renderToString(                              â”‚      â”‚
  â”‚  â”‚    <App>                                      â”‚      â”‚
  â”‚  â”‚      <Hydrator whenVisible>                   â”‚      â”‚
  â”‚  â”‚        <Comments data={data} />               â”‚      â”‚
  â”‚  â”‚      </Hydrator>                              â”‚      â”‚
  â”‚  â”‚    </App>                                     â”‚      â”‚
  â”‚  â”‚  )                                            â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  â†’ Káº¿t quáº£ HTML:                             â”‚      â”‚
  â”‚  â”‚  <div data-hydrate="whenVisible">             â”‚      â”‚
  â”‚  â”‚    <div class="comments">                     â”‚      â”‚
  â”‚  â”‚      <div class="comment">BÃ¬nh luáº­n 1</div>  â”‚      â”‚
  â”‚  â”‚      <div class="comment">BÃ¬nh luáº­n 2</div>  â”‚      â”‚
  â”‚  â”‚    </div>                                     â”‚      â”‚
  â”‚  â”‚  </div>                                       â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  â‘¡ Client nháº­n HTML:                                   â”‚
  â”‚  â†’ Comments HIá»†N trÃªn mÃ n hÃ¬nh (HTML tÄ©nh!)          â”‚
  â”‚  â†’ NHÆ¯NG chÆ°a click, reply, like Ä‘Æ°á»£c!                â”‚
  â”‚                                                        â”‚
  â”‚  â‘¢ User cuá»™n xuá»‘ng â†’ Comments VÃ€O viewport:          â”‚
  â”‚  â†’ IntersectionObserver Báº®T ÄÆ¯á»¢C!                     â”‚
  â”‚  â†’ Táº£i JS chunk cho Comments                           â”‚
  â”‚  â†’ Hydrate Comments component                          â”‚
  â”‚  â†’ BÃ‚Y GIá»œ click, reply, like ÄÆ¯á»¢C!                  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§7. Tá»± Viáº¿t Tay Hydrator Component â€” KhÃ´ng DÃ¹ng ThÆ° Viá»‡n

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Tá»° VIáº¾T HYDRATOR Tá»ª Sá» 0 â€” GIáº¢I THÃCH Tá»ªNG DÃ’NG!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  Ã TÆ¯á»NG Cá»T LÃ•I Cá»¦A HYDRATOR:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Hydrator cáº§n lÃ m 3 viá»‡c:                              â”‚
  â”‚                                                        â”‚
  â”‚  â‘  GIá»® HTML tÄ©nh tá»« server (khÃ´ng máº¥t ná»™i dung!)    â”‚
  â”‚  â‘¡ THEO DÃ•I Ä‘iá»u kiá»‡n (viewport, idle, event...)      â”‚
  â”‚  â‘¢ KHI thá»a Ä‘iá»u kiá»‡n â†’ HYDRATE (render React!)     â”‚
  â”‚                                                        â”‚
  â”‚  THÃCH THá»¨C:                                           â”‚
  â”‚  â†’ Khi React render láº§n Ä‘áº§u trÃªn client, nÃ³ muá»‘n    â”‚
  â”‚    KIá»‚M SOÃT DOM bÃªn trong component!                 â”‚
  â”‚  â†’ NhÆ°ng server Ä‘Ã£ render HTML rá»“i!                  â”‚
  â”‚  â†’ Ta cáº§n "giá»¯" HTML server cho Ä‘áº¿n khi hydrate!    â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I PHÃP:                                            â”‚
  â”‚  â†’ DÃ¹ng ref Ä‘á»ƒ trá» Ä‘áº¿n DOM node                      â”‚
  â”‚  â†’ DÃ¹ng dangerouslySetInnerHTML hoáº·c                  â”‚
  â”‚    suppressHydrationWarning Ä‘á»ƒ giá»¯ HTML server        â”‚
  â”‚  â†’ Khi cáº§n hydrate: render React component tháº­t!     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE HYDRATOR â€” PHIÃŠN Báº¢N CÆ  Báº¢N NHáº¤T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // Hydrator.jsx â€” Tá»± viáº¿t tay, KHÃ”NG thÆ° viá»‡n!       â”‚
  â”‚  import { useState, useRef, useEffect } from 'react';  â”‚
  â”‚                                                        â”‚
  â”‚  function Hydrator({ children }) {                     â”‚
  â”‚    // â‘  State: Ä‘Ã£ hydrate chÆ°a?                       â”‚
  â”‚    const [hydrated, setHydrated] = useState(false);    â”‚
  â”‚    // â‘¡ Ref: trá» Ä‘áº¿n DOM node chá»©a HTML server!     â”‚
  â”‚    const rootRef = useRef(null);                       â”‚
  â”‚                                                        â”‚
  â”‚    // â‘¢ Náº¿u CHÆ¯A hydrate â†’ giá»¯ HTML tÄ©nh!           â”‚
  â”‚    if (!hydrated) {                                    â”‚
  â”‚      return (                                          â”‚
  â”‚        <div                                            â”‚
  â”‚          ref={rootRef}                                 â”‚
  â”‚          // suppressHydrationWarning = báº£o React      â”‚
  â”‚          // Äá»ªNG cáº£nh bÃ¡o khi HTML khÃ´ng khá»›p!       â”‚
  â”‚          suppressHydrationWarning                      â”‚
  â”‚          // dangerouslySetInnerHTML = GIá»® HTML server â”‚
  â”‚          // React sáº½ KHÃ”NG Äá»¤NG VÃ€O ná»™i dung!       â”‚
  â”‚          dangerouslySetInnerHTML={{                     â”‚
  â”‚            __html: ''                                  â”‚
  â”‚          }}                                            â”‚
  â”‚        />                                              â”‚
  â”‚      );                                                â”‚
  â”‚    }                                                   â”‚
  â”‚                                                        â”‚
  â”‚    // â‘£ ÄÃ£ hydrate â†’ render React component THáº¬T!    â”‚
  â”‚    return <div ref={rootRef}>{children}</div>;         â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I THÃCH Tá»ªNG DÃ’NG:                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚ useState(false)                               â”‚      â”‚
  â”‚  â”‚ â†’ Ban Ä‘áº§u hydrated = false                   â”‚      â”‚
  â”‚  â”‚ â†’ Component á»Ÿ cháº¿ Ä‘á»™ "tÄ©nh"!               â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚ useRef(null)                                   â”‚      â”‚
  â”‚  â”‚ â†’ Táº¡o tham chiáº¿u Ä‘áº¿n DOM element tháº­t      â”‚      â”‚
  â”‚  â”‚ â†’ DÃ¹ng Ä‘á»ƒ Ä‘o lÆ°á»ng (viewport check)         â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚ suppressHydrationWarning                      â”‚      â”‚
  â”‚  â”‚ â†’ React prop Ä‘áº·c biá»‡t                        â”‚      â”‚
  â”‚  â”‚ â†’ Báº£o React: "Äá»«ng cáº£nh bÃ¡o náº¿u HTML      â”‚      â”‚
  â”‚  â”‚   server khÃ¡c vá»›i client!"                   â”‚      â”‚
  â”‚  â”‚ â†’ VÃ¬ ta Cá» Ã giá»¯ HTML server!              â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚ dangerouslySetInnerHTML={{ __html: '' }}       â”‚      â”‚
  â”‚  â”‚ â†’ Báº£o React: "Äá»ªNG quáº£n lÃ½ ná»™i dung bÃªn   â”‚      â”‚
  â”‚  â”‚   trong div nÃ y!"                             â”‚      â”‚
  â”‚  â”‚ â†’ Server Ä‘Ã£ render HTML â†’ giá»¯ nguyÃªn!       â”‚      â”‚
  â”‚  â”‚ â†’ __html: '' trÃªn client, nhÆ°ng server HTML  â”‚      â”‚
  â”‚  â”‚   VáºªN CÃ’N ÄÃ“ trong DOM!                    â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚ KHI setHydrated(true):                        â”‚      â”‚
  â”‚  â”‚ â†’ Re-render â†’ vÃ o nhÃ¡nh ELSE!               â”‚      â”‚
  â”‚  â”‚ â†’ {children} = React component tháº­t!         â”‚      â”‚
  â”‚  â”‚ â†’ React tiáº¿p quáº£n DOM!                       â”‚      â”‚
  â”‚  â”‚ â†’ Events Ä‘Æ°á»£c Gáº®N!                           â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ LUá»’NG HOáº T Äá»˜NG HYDRATOR:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Server render:                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
  â”‚  â”‚  <div>                        â”‚                     â”‚
  â”‚  â”‚    <h3>BÃ¬nh luáº­n</h3>        â”‚  HTML tá»« server    â”‚
  â”‚  â”‚    <p>Comment 1...</p>        â”‚  (cÃ³ ná»™i dung!)    â”‚
  â”‚  â”‚    <p>Comment 2...</p>        â”‚                     â”‚
  â”‚  â”‚  </div>                       â”‚                     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
  â”‚              â”‚                                         â”‚
  â”‚              â–¼                                         â”‚
  â”‚  Client mount (hydrated = FALSE):                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
  â”‚  â”‚  <div                         â”‚                     â”‚
  â”‚  â”‚    suppressHydrationWarning   â”‚  React KHÃ”NG       â”‚
  â”‚  â”‚    dangerouslySetInnerHTML    â”‚  Ä‘á»¥ng vÃ o!         â”‚
  â”‚  â”‚  >                            â”‚                     â”‚
  â”‚  â”‚    <!-- HTML server váº«n      â”‚  â† User váº«n       â”‚
  â”‚  â”‚     hiá»‡n! VÃ¬ React khÃ´ng     â”‚    THáº¤Y ná»™i dung!  â”‚
  â”‚  â”‚     xÃ³a nÃ³! -->              â”‚                     â”‚
  â”‚  â”‚  </div>                       â”‚                     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
  â”‚              â”‚                                         â”‚
  â”‚              â”‚ Äiá»u kiá»‡n thá»a! (viewport/idle/click)  â”‚
  â”‚              â–¼                                         â”‚
  â”‚  setHydrated(TRUE) â†’ re-render:                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
  â”‚  â”‚  <div>                        â”‚                     â”‚
  â”‚  â”‚    {children}                 â”‚  React component   â”‚
  â”‚  â”‚    â†’ <Comments data={...} /> â”‚  THáº¬T vá»›i events!  â”‚
  â”‚  â”‚    â†’ onClick, onChange...     â”‚  â† TÆ¯Æ NG TÃC      â”‚
  â”‚  â”‚  </div>                       â”‚     ÄÆ¯á»¢C!           â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ User KHÃ”NG nháº­n ra sá»± thay Ä‘á»•i!                  â”‚
  â”‚  â†’ HTML trÆ°á»›c vÃ  sau GIá»NG NHAU!                      â”‚
  â”‚  â†’ Chá»‰ thÃªm JavaScript "bÃªn dÆ°á»›i"!                   â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§8. Intersection Observer â€” Hydrate Khi Component VÃ o Viewport

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  INTERSECTION OBSERVER = HYDRATE KHI USER CUá»˜N Äáº¾N!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  INTERSECTION OBSERVER LÃ€ GÃŒ?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  IntersectionObserver = Web API theo dÃµi khi 1        â”‚
  â”‚  element GIAO NHAU vá»›i viewport (hoáº·c element cha)!   â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ VÃ­ dá»¥ thá»±c táº¿:                                    â”‚
  â”‚  â†’ Lazy load áº£nh khi cuá»™n Ä‘áº¿n                       â”‚
  â”‚  â†’ Infinite scroll (táº£i thÃªm khi cuá»™n háº¿t)          â”‚
  â”‚  â†’ Progressive Hydration (hydrate khi nhÃ¬n tháº¥y!)    â”‚
  â”‚                                                        â”‚
  â”‚  CÃCH HOáº T Äá»˜NG:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
  â”‚  â”‚         VIEWPORT (mÃ n hÃ¬nh)       â”‚                â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚
  â”‚  â”‚  â”‚                              â”‚  â”‚                â”‚
  â”‚  â”‚  â”‚   Header âœ… (Ä‘Ã£ tháº¥y!)     â”‚  â”‚                â”‚
  â”‚  â”‚  â”‚                              â”‚  â”‚                â”‚
  â”‚  â”‚  â”‚   Products âœ… (Ä‘Ã£ tháº¥y!)   â”‚  â”‚                â”‚
  â”‚  â”‚  â”‚                              â”‚  â”‚                â”‚
  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                â”‚
  â”‚  â”‚  â”‚ â† Ranh giá»›i viewport â”€â”€â”€â”€â”€â–¶â”‚  â”‚                â”‚
  â”‚  â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”˜                â”‚
  â”‚     â”‚                              â”‚                    â”‚
  â”‚     â”‚   Reviews âŒ (chÆ°a tháº¥y!)   â”‚ â† Äang á»Ÿ dÆ°á»›i  â”‚
  â”‚     â”‚                              â”‚    viewport!      â”‚
  â”‚     â”‚   Footer âŒ (chÆ°a tháº¥y!)    â”‚                    â”‚
  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
  â”‚                                                        â”‚
  â”‚  User CUá»˜N XUá»NG:                                     â”‚
  â”‚  â†’ Reviews VÃ€O viewport!                              â”‚
  â”‚  â†’ IntersectionObserver PHÃT HIá»†N!                    â”‚
  â”‚  â†’ Callback Ä‘Æ°á»£c gá»i!                                 â”‚
  â”‚  â†’ Ta hydrate Reviews!                                 â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE Tá»° VIáº¾T TAY â€” HYDRATOR Vá»šI VIEWPORT:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // HydrateOnViewport.jsx                              â”‚
  â”‚  import { useState, useRef, useEffect } from 'react';  â”‚
  â”‚                                                        â”‚
  â”‚  function HydrateOnViewport({                          â”‚
  â”‚    children,                                           â”‚
  â”‚    fallback = null, // Loading indicator tÃ¹y chá»n     â”‚
  â”‚    rootMargin = '200px', // Hydrate TRÆ¯á»šC 200px!      â”‚
  â”‚  }) {                                                  â”‚
  â”‚    const [hydrated, setHydrated] = useState(false);    â”‚
  â”‚    const rootRef = useRef(null);                       â”‚
  â”‚                                                        â”‚
  â”‚    useEffect(() => {                                   â”‚
  â”‚      // â‘  Kiá»ƒm tra browser há»— trá»£ khÃ´ng?            â”‚
  â”‚      if (!('IntersectionObserver' in window)) {        â”‚
  â”‚        // KhÃ´ng há»— trá»£ â†’ hydrate NGAY!               â”‚
  â”‚        setHydrated(true);                              â”‚
  â”‚        return;                                         â”‚
  â”‚      }                                                 â”‚
  â”‚                                                        â”‚
  â”‚      // â‘¡ Táº¡o observer!                               â”‚
  â”‚      const observer = new IntersectionObserver(        â”‚
  â”‚        // Callback: gá»i khi element giao viewport!    â”‚
  â”‚        (entries) => {                                  â”‚
  â”‚          entries.forEach((entry) => {                  â”‚
  â”‚            if (entry.isIntersecting) {                 â”‚
  â”‚              // â‘¢ Element VÃ€O viewport â†’ HYDRATE!    â”‚
  â”‚              setHydrated(true);                        â”‚
  â”‚              // â‘£ Ngá»«ng theo dÃµi (chá»‰ hydrate 1 láº§n)â”‚
  â”‚              observer.unobserve(entry.target);         â”‚
  â”‚            }                                           â”‚
  â”‚          });                                           â”‚
  â”‚        },                                              â”‚
  â”‚        {                                               â”‚
  â”‚          // rootMargin: má»Ÿ rá»™ng "vÃ¹ng nhÃ¬n tháº¥y"    â”‚
  â”‚          // '200px' = hydrate TRÆ¯á»šC khi user cuá»™n    â”‚
  â”‚          // Ä‘áº¿n 200px!                                â”‚
  â”‚          rootMargin,                                   â”‚
  â”‚          // threshold: 0 = chá»‰ cáº§n 1px vÃ o viewport â”‚
  â”‚          threshold: 0,                                 â”‚
  â”‚        }                                               â”‚
  â”‚      );                                                â”‚
  â”‚                                                        â”‚
  â”‚      // â‘¤ Báº¯t Ä‘áº§u theo dÃµi element!                 â”‚
  â”‚      if (rootRef.current) {                            â”‚
  â”‚        observer.observe(rootRef.current);              â”‚
  â”‚      }                                                 â”‚
  â”‚                                                        â”‚
  â”‚      // â‘¥ Cleanup: ngá»«ng theo dÃµi khi unmount!       â”‚
  â”‚      return () => observer.disconnect();               â”‚
  â”‚    }, [rootMargin]);                                   â”‚
  â”‚                                                        â”‚
  â”‚    // â‘¦ ChÆ°a hydrate â†’ giá»¯ HTML server!              â”‚
  â”‚    if (!hydrated) {                                    â”‚
  â”‚      return (                                          â”‚
  â”‚        <div                                            â”‚
  â”‚          ref={rootRef}                                 â”‚
  â”‚          suppressHydrationWarning                      â”‚
  â”‚          dangerouslySetInnerHTML={{ __html: '' }}       â”‚
  â”‚        />                                              â”‚
  â”‚      );                                                â”‚
  â”‚    }                                                   â”‚
  â”‚                                                        â”‚
  â”‚    // â‘§ ÄÃ£ hydrate â†’ render React component!         â”‚
  â”‚    return <div ref={rootRef}>{children}</div>;         â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  Sá»¬ Dá»¤NG:                                              â”‚
  â”‚  function App() {                                      â”‚
  â”‚    return (                                            â”‚
  â”‚      <div>                                             â”‚
  â”‚        <Header />   {/* Hydrate bÃ¬nh thÆ°á»ng! */}       â”‚
  â”‚        <Hero />                                        â”‚
  â”‚                                                        â”‚
  â”‚        {/* Comments chá»‰ hydrate khi cuá»™n Ä‘áº¿n! */}    â”‚
  â”‚        <HydrateOnViewport>                             â”‚
  â”‚          <Comments data={commentsData} />              â”‚
  â”‚        </HydrateOnViewport>                            â”‚
  â”‚                                                        â”‚
  â”‚        {/* RelatedItems hydrate khi gáº§n Ä‘áº¿n! */}      â”‚
  â”‚        <HydrateOnViewport rootMargin="400px">          â”‚
  â”‚          <RelatedItems items={items} />                â”‚
  â”‚        </HydrateOnViewport>                            â”‚
  â”‚      </div>                                            â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ IntersectionObserver:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  rootMargin = '200px' nghÄ©a lÃ :                       â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
  â”‚  â”‚        200px margin trÃªn        â”‚ â† "VÃ¹ng má»Ÿ     â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    rá»™ng"        â”‚
  â”‚  â”‚  â”‚                          â”‚    â”‚                  â”‚
  â”‚  â”‚  â”‚      VIEWPORT            â”‚    â”‚                  â”‚
  â”‚  â”‚  â”‚      (mÃ n hÃ¬nh tháº­t)    â”‚    â”‚                  â”‚
  â”‚  â”‚  â”‚                          â”‚    â”‚                  â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                  â”‚
  â”‚  â”‚        200px margin dÆ°á»›i        â”‚                  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
  â”‚                                                        â”‚
  â”‚  â†’ Element chá»‰ cáº§n vÃ o VÃ™NG Má» Rá»˜NG lÃ  Ä‘Ã£          â”‚
  â”‚    Ä‘Æ°á»£c coi lÃ  "intersecting"!                         â”‚
  â”‚  â†’ Hydrate TRÆ¯á»šC khi user tháº­t sá»± nhÃ¬n tháº¥y!        â”‚
  â”‚  â†’ User cuá»™n Ä‘áº¿n â†’ component ÄÃƒ Sáº´N SÃ€NG!         â”‚
  â”‚  â†’ KhÃ´ng bá»‹ "giáº­t" hay "chá» loading"!                â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§9. Idle Callback â€” Hydrate Khi TrÃ¬nh Duyá»‡t Ráº£nh

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REQUESTIDLECALLBACK = HYDRATE KHI BROWSER Ráº¢NH!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  requestIdleCallback LÃ€ GÃŒ?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Browser cÃ³ 1 "main thread" (luá»“ng chÃ­nh):            â”‚
  â”‚  â†’ Xá»­ lÃ½ rendering, events, JavaScript...             â”‚
  â”‚  â†’ Khi Báº¬N: xá»­ lÃ½ animation, user input...           â”‚
  â”‚  â†’ Khi Ráº¢NH: khÃ´ng cÃ³ gÃ¬ Æ°u tiÃªn hÆ¡n!               â”‚
  â”‚                                                        â”‚
  â”‚  requestIdleCallback(callback) nÃ³i:                    â”‚
  â”‚  "Cháº¡y callback nÃ y KHI NÃ€O browser Ráº¢NH!"           â”‚
  â”‚                                                        â”‚
  â”‚  TIMELINE:                                             â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
  â”‚  â”‚ Frame â”‚ Frame â”‚ IDLE â”‚ Frame â”‚ IDLE  â”‚ Frameâ”‚       â”‚
  â”‚  â”‚ 16ms  â”‚ 16ms  â”‚ !!!! â”‚ 16ms  â”‚ !!!!! â”‚ 16msâ”‚       â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚
  â”‚                    â”‚              â”‚                     â”‚
  â”‚                    â–¼              â–¼                     â”‚
  â”‚              Cháº¡y callback! Cháº¡y callback!            â”‚
  â”‚              (hydrate 1     (hydrate 1                â”‚
  â”‚               component!)    component!)               â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ KHÃ”NG áº£nh hÆ°á»Ÿng animation/user input!             â”‚
  â”‚  â†’ Hydrate chá»‰ khi browser CÃ“ THá»œI GIAN!            â”‚
  â”‚  â†’ UI luÃ´n MÆ¯á»¢T MÃ€!                                  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE Tá»° VIáº¾T TAY â€” HYDRATE ON IDLE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // HydrateOnIdle.jsx                                  â”‚
  â”‚  import { useState, useRef, useEffect } from 'react';  â”‚
  â”‚                                                        â”‚
  â”‚  function HydrateOnIdle({                              â”‚
  â”‚    children,                                           â”‚
  â”‚    timeout = 2000, // Timeout tá»‘i Ä‘a: 2 giÃ¢y!        â”‚
  â”‚  }) {                                                  â”‚
  â”‚    const [hydrated, setHydrated] = useState(false);    â”‚
  â”‚    const rootRef = useRef(null);                       â”‚
  â”‚                                                        â”‚
  â”‚    useEffect(() => {                                   â”‚
  â”‚      // â‘  Kiá»ƒm tra browser há»— trá»£ khÃ´ng?            â”‚
  â”‚      if ('requestIdleCallback' in window) {            â”‚
  â”‚        // â‘¡ ÄÄƒng kÃ½: hydrate khi ráº£nh!               â”‚
  â”‚        const id = requestIdleCallback(                 â”‚
  â”‚          () => setHydrated(true),                      â”‚
  â”‚          { timeout } // Tá»‘i Ä‘a Ä‘á»£i 2s rá»“i Ã‰P cháº¡y! â”‚
  â”‚        );                                              â”‚
  â”‚                                                        â”‚
  â”‚        // â‘¢ Cleanup!                                  â”‚
  â”‚        return () => cancelIdleCallback(id);            â”‚
  â”‚      } else {                                          â”‚
  â”‚        // â‘£ Safari khÃ´ng há»— trá»£ â†’ dÃ¹ng setTimeout!  â”‚
  â”‚        const id = setTimeout(                          â”‚
  â”‚          () => setHydrated(true),                      â”‚
  â”‚          timeout                                       â”‚
  â”‚        );                                              â”‚
  â”‚        return () => clearTimeout(id);                  â”‚
  â”‚      }                                                 â”‚
  â”‚    }, [timeout]);                                      â”‚
  â”‚                                                        â”‚
  â”‚    if (!hydrated) {                                    â”‚
  â”‚      return (                                          â”‚
  â”‚        <div                                            â”‚
  â”‚          ref={rootRef}                                 â”‚
  â”‚          suppressHydrationWarning                      â”‚
  â”‚          dangerouslySetInnerHTML={{ __html: '' }}       â”‚
  â”‚        />                                              â”‚
  â”‚      );                                                â”‚
  â”‚    }                                                   â”‚
  â”‚                                                        â”‚
  â”‚    return <div ref={rootRef}>{children}</div>;         â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I THÃCH TIMEOUT:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  requestIdleCallback(callback, { timeout })    â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  timeout = 2000 nghÄ©a lÃ :                    â”‚      â”‚
  â”‚  â”‚  â†’ Browser Ráº¢NH trÆ°á»›c 2s â†’ cháº¡y ngay!       â”‚      â”‚
  â”‚  â”‚  â†’ Browser Báº¬N hÆ¡n 2s â†’ Ã‰P cháº¡y dÃ¹ chÆ°a   â”‚      â”‚
  â”‚  â”‚    ráº£nh!                                      â”‚      â”‚
  â”‚  â”‚  â†’ Äáº£m báº£o component KHÃ”NG Äá»¢I mÃ£i!       â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  ğŸ’¡ Safari KHÃ”NG há»— trá»£ requestIdleCallback! â”‚      â”‚
  â”‚  â”‚  â†’ DÃ¹ng setTimeout lÃ m fallback!              â”‚      â”‚
  â”‚  â”‚  â†’ KhÃ´ng hoÃ n háº£o nhÆ°ng HOáº T Äá»˜NG!          â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  Sá»¬ Dá»¤NG:                                              â”‚
  â”‚  function App() {                                      â”‚
  â”‚    return (                                            â”‚
  â”‚      <div>                                             â”‚
  â”‚        <Header />                                      â”‚
  â”‚                                                        â”‚
  â”‚        {/* Sidebar hydrate khi browser ráº£nh! */}      â”‚
  â”‚        <HydrateOnIdle timeout={1000}>                  â”‚
  â”‚          <Sidebar />                                   â”‚
  â”‚        </HydrateOnIdle>                                â”‚
  â”‚                                                        â”‚
  â”‚        <Main />                                        â”‚
  â”‚                                                        â”‚
  â”‚        {/* Chat widget hydrate sau 3 giÃ¢y ráº£nh! */}   â”‚
  â”‚        <HydrateOnIdle timeout={3000}>                  â”‚
  â”‚          <ChatWidget />                                â”‚
  â”‚        </HydrateOnIdle>                                â”‚
  â”‚      </div>                                            â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§10. Event-Triggered â€” Hydrate Khi User TÆ°Æ¡ng TÃ¡c

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  EVENT-TRIGGERED = HYDRATE KHI USER CLICK/HOVER/FOCUS!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  Ã TÆ¯á»NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Má»™t sá»‘ component CHá»ˆ Cáº¦N interactive khi user        â”‚
  â”‚  THá»°C Sá»° muá»‘n dÃ¹ng!                                  â”‚
  â”‚                                                        â”‚
  â”‚  VÃ Dá»¤:                                                â”‚
  â”‚  â†’ Chat widget: chá»‰ cáº§n khi user CLICK icon chat!    â”‚
  â”‚  â†’ Search: chá»‰ cáº§n khi user FOCUS vÃ o Ã´ tÃ¬m kiáº¿m!  â”‚
  â”‚  â†’ Dropdown: chá»‰ cáº§n khi user HOVER hoáº·c CLICK!     â”‚
  â”‚  â†’ Carousel: chá»‰ cáº§n khi user SWIPE hoáº·c CLICK!     â”‚
  â”‚                                                        â”‚
  â”‚  â†’ KHÃ”NG Cáº¦N hydrate ngay tá»« Ä‘áº§u!                   â”‚
  â”‚  â†’ TIáº¾T KIá»†M JavaScript!                              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE Tá»° VIáº¾T TAY â€” HYDRATE ON EVENT:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // HydrateOnInteraction.jsx                           â”‚
  â”‚  import { useState, useRef, useEffect } from 'react';  â”‚
  â”‚                                                        â”‚
  â”‚  function HydrateOnInteraction({                       â”‚
  â”‚    children,                                           â”‚
  â”‚    // Máº£ng events sáº½ trigger hydration!               â”‚
  â”‚    events = ['click', 'focus', 'mouseenter'],          â”‚
  â”‚  }) {                                                  â”‚
  â”‚    const [hydrated, setHydrated] = useState(false);    â”‚
  â”‚    const rootRef = useRef(null);                       â”‚
  â”‚                                                        â”‚
  â”‚    useEffect(() => {                                   â”‚
  â”‚      const el = rootRef.current;                       â”‚
  â”‚      if (!el) return;                                  â”‚
  â”‚                                                        â”‚
  â”‚      // â‘  Handler: khi user tÆ°Æ¡ng tÃ¡c â†’ hydrate!     â”‚
  â”‚      const handler = () => setHydrated(true);          â”‚
  â”‚                                                        â”‚
  â”‚      // â‘¡ Gáº¯n listener cho Táº¤T Cáº¢ events!           â”‚
  â”‚      events.forEach((event) => {                       â”‚
  â”‚        el.addEventListener(event, handler, {           â”‚
  â”‚          once: true,    // Chá»‰ gá»i 1 Láº¦N rá»“i tá»±    â”‚
  â”‚                          // Gá» !                       â”‚
  â”‚          passive: true, // KhÃ´ng block scrolling!      â”‚
  â”‚          capture: true, // Báº¯t á»Ÿ phase CAPTURE!      â”‚
  â”‚                          // â†’ Äáº£m báº£o báº¯t Ä‘Æ°á»£c      â”‚
  â”‚                          // event TRÆ¯á»šC khi children! â”‚
  â”‚        });                                             â”‚
  â”‚      });                                               â”‚
  â”‚                                                        â”‚
  â”‚      // â‘¢ Cleanup: gá»¡ táº¥t cáº£ listeners!             â”‚
  â”‚      return () => {                                    â”‚
  â”‚        events.forEach((event) => {                     â”‚
  â”‚          el.removeEventListener(event, handler, {      â”‚
  â”‚            capture: true,                              â”‚
  â”‚          });                                           â”‚
  â”‚        });                                             â”‚
  â”‚      };                                                â”‚
  â”‚    }, [events]);                                       â”‚
  â”‚                                                        â”‚
  â”‚    if (!hydrated) {                                    â”‚
  â”‚      return (                                          â”‚
  â”‚        <div                                            â”‚
  â”‚          ref={rootRef}                                 â”‚
  â”‚          suppressHydrationWarning                      â”‚
  â”‚          dangerouslySetInnerHTML={{ __html: '' }}       â”‚
  â”‚          style={{ cursor: 'pointer' }}                 â”‚
  â”‚        />                                              â”‚
  â”‚      );                                                â”‚
  â”‚    }                                                   â”‚
  â”‚                                                        â”‚
  â”‚    return <div ref={rootRef}>{children}</div>;         â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I THÃCH CÃC OPTIONS:                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  once: true                                   â”‚      â”‚
  â”‚  â”‚  â†’ Listener tá»± Gá»  sau khi gá»i 1 láº§n!        â”‚      â”‚
  â”‚  â”‚  â†’ Hydrate chá»‰ xáº£y ra 1 láº§n!                â”‚      â”‚
  â”‚  â”‚  â†’ TrÃ¡nh gá»i setHydrated nhiá»u láº§n!          â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  passive: true                                â”‚      â”‚
  â”‚  â”‚  â†’ NÃ³i browser: "callback KHÃ”NG gá»i           â”‚      â”‚
  â”‚  â”‚    preventDefault()!"                         â”‚      â”‚
  â”‚  â”‚  â†’ Browser KHÃ”NG cáº§n Ä‘á»£i callback!           â”‚      â”‚
  â”‚  â”‚  â†’ Scrolling MÆ¯á»¢T hÆ¡n!                        â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  capture: true                                â”‚      â”‚
  â”‚  â”‚  â†’ Báº¯t event á»Ÿ CAPTURE phase (tá»« trÃªn       â”‚      â”‚
  â”‚  â”‚    xuá»‘ng), khÃ´ng pháº£i BUBBLE (tá»« dÆ°á»›i lÃªn)  â”‚      â”‚
  â”‚  â”‚  â†’ Äáº£m báº£o ta báº¯t event TRÆ¯á»šC children!    â”‚      â”‚
  â”‚  â”‚  â†’ Quan trá»ng! VÃ¬ children chÆ°a cÃ³ listener! â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  Sá»¬ Dá»¤NG:                                              â”‚
  â”‚  <HydrateOnInteraction events={['click']}>             â”‚
  â”‚    <ChatWidget />                                      â”‚
  â”‚  </HydrateOnInteraction>                               â”‚
  â”‚                                                        â”‚
  â”‚  <HydrateOnInteraction events={['focus', 'click']}>    â”‚
  â”‚    <SearchBar />                                       â”‚
  â”‚  </HydrateOnInteraction>                               â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ EVENT-TRIGGERED HYDRATION:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  BAN Äáº¦U (chÆ°a tÆ°Æ¡ng tÃ¡c):                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚  [ğŸ’¬ Chat]  â† HTML tÄ©nh, KHÃ”NG JS!     â”‚          â”‚
  â”‚  â”‚               TrÃ´ng bÃ¬nh thÆ°á»ng nhÆ°ng    â”‚          â”‚
  â”‚  â”‚               KHÃ”NG cÃ³ event handlers!    â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚              â”‚                                         â”‚
  â”‚              â”‚ User CLICK vÃ o icon chat!               â”‚
  â”‚              â–¼                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚  â‘  Capture listener Báº®T ÄÆ¯á»¢C click!    â”‚          â”‚
  â”‚  â”‚  â‘¡ setHydrated(true)                     â”‚          â”‚
  â”‚  â”‚  â‘¢ React render ChatWidget THáº¬T!         â”‚          â”‚
  â”‚  â”‚  â‘£ Events Ä‘Æ°á»£c gáº¯n (onClick, onChange...)â”‚          â”‚
  â”‚  â”‚  â‘¤ Chat widget Má» RA vÃ  HOáº T Äá»˜NG!     â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚              â”‚                                         â”‚
  â”‚              â–¼                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚  [ğŸ’¬ Chat (ÄANG Má»)]                    â”‚          â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚          â”‚
  â”‚  â”‚  â”‚  Xin chÃ o! TÃ´i cÃ³ thá»ƒ giÃºp  â”‚       â”‚          â”‚
  â”‚  â”‚  â”‚  gÃ¬ cho báº¡n?                   â”‚       â”‚          â”‚
  â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚          â”‚
  â”‚  â”‚  â”‚  [Nháº­p tin nháº¯n...    ] [Gá»­i] â”‚       â”‚          â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ Náº¿u user KHÃ”NG BAO GIá»œ click chat                â”‚
  â”‚  â†’ JS cho chat KHÃ”NG BAO GIá»œ Ä‘Æ°á»£c táº£i!              â”‚
  â”‚  â†’ TIáº¾T KIá»†M tÃ i nguyÃªn!                              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§11. Tá»± Viáº¿t Tay Code-Splitting + Lazy Hydration

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  CODE-SPLITTING = TÃCH JS THÃ€NH NHIá»€U FILE NHá»!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  CODE-SPLITTING LÃ€ GÃŒ?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  KHÃ”NG CODE-SPLITTING:                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚  bundle.js (500KB!)                       â”‚          â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚
  â”‚  â”‚  â”‚ Header + Search + Products + Reviews â”‚ â”‚          â”‚
  â”‚  â”‚  â”‚ + Chat + Footer + Utils + Libraries  â”‚ â”‚          â”‚
  â”‚  â”‚  â”‚ Táº¤T Cáº¢ trong 1 FILE!                â”‚ â”‚          â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚  â†’ Pháº£i táº£i 500KB trÆ°á»›c khi hydrate Báº¤T Cá»¨ GÃŒ!     â”‚
  â”‚                                                        â”‚
  â”‚  CÃ“ CODE-SPLITTING:                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
  â”‚  â”‚ header.js â”‚ â”‚ search.js â”‚ â”‚products.jsâ”‚            â”‚
  â”‚  â”‚  (20KB)   â”‚ â”‚  (15KB)   â”‚ â”‚  (50KB)   â”‚            â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
  â”‚  â”‚reviews.js â”‚ â”‚  chat.js  â”‚ â”‚ footer.js â”‚            â”‚
  â”‚  â”‚  (30KB)   â”‚ â”‚  (40KB)   â”‚ â”‚  (10KB)   â”‚            â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚  â†’ Chá»‰ táº£i 20KB cho Header = hydrate NGAY!           â”‚
  â”‚  â†’ Reviews 30KB táº£i SAU khi cuá»™n Ä‘áº¿n!               â”‚
  â”‚  â†’ Chat 40KB KHÃ”NG Táº¢I náº¿u user khÃ´ng click!         â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  DYNAMIC IMPORT â€” CÆ  Sá» Cá»¦A CODE-SPLITTING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // Static import (truyá»n thá»‘ng):                      â”‚
  â”‚  import Comments from './Comments';                    â”‚
  â”‚  // â†’ Comments LUÃ”N náº±m trong bundle!                 â”‚
  â”‚  // â†’ DÃ¹ user cÃ³ xem comments hay khÃ´ng!              â”‚
  â”‚                                                        â”‚
  â”‚  // Dynamic import (ES2020):                           â”‚
  â”‚  const Comments = await import('./Comments');          â”‚
  â”‚  // â†’ Comments TÃCH thÃ nh file RIÃŠNG!                 â”‚
  â”‚  // â†’ Chá»‰ táº£i KHI Gá»ŒI import()!                     â”‚
  â”‚  // â†’ Webpack/Vite tá»± tÃ¡ch thÃ nh chunk!               â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ import() tráº£ vá» PROMISE!                          â”‚
  â”‚  â†’ CÃ³ thá»ƒ await!                                      â”‚
  â”‚  â†’ CÃ³ thá»ƒ .then()!                                    â”‚
  â”‚  â†’ Webpack tá»± tÃ¡ch thÃ nh file riÃªng!                  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE Tá»° VIáº¾T TAY â€” LAZY HYDRATION Vá»šI CODE-SPLITTING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // LazyHydrate.jsx â€” Káº¿t há»£p táº¥t cáº£!                â”‚
  â”‚  import { useState, useRef, useEffect, useCallback }   â”‚
  â”‚    from 'react';                                       â”‚
  â”‚                                                        â”‚
  â”‚  function LazyHydrate({                                â”‚
  â”‚    // HÃ m import() component (code-splitting!)        â”‚
  â”‚    importComponent,                                    â”‚
  â”‚    // Äiá»u kiá»‡n hydrate                               â”‚
  â”‚    whenVisible = false,                                â”‚
  â”‚    whenIdle = false,                                   â”‚
  â”‚    onInteraction = null, // ['click', 'hover']         â”‚
  â”‚    // Props cho component                              â”‚
  â”‚    componentProps = {},                                 â”‚
  â”‚    // Loading fallback                                 â”‚
  â”‚    fallback = null,                                    â”‚
  â”‚  }) {                                                  â”‚
  â”‚    const [Component, setComponent] = useState(null);   â”‚
  â”‚    const [hydrated, setHydrated] = useState(false);    â”‚
  â”‚    const rootRef = useRef(null);                       â”‚
  â”‚                                                        â”‚
  â”‚    // HÃ m hydrate: táº£i component + Ä‘Ã¡nh dáº¥u!         â”‚
  â”‚    const hydrate = useCallback(async () => {           â”‚
  â”‚      if (hydrated) return; // ÄÃ£ hydrate rá»“i!        â”‚
  â”‚                                                        â”‚
  â”‚      // â‘  Dynamic import component!                   â”‚
  â”‚      const module = await importComponent();           â”‚
  â”‚      const Comp = module.default || module;            â”‚
  â”‚                                                        â”‚
  â”‚      // â‘¡ LÆ°u component + Ä‘Ã¡nh dáº¥u Ä‘Ã£ hydrate!     â”‚
  â”‚      setComponent(() => Comp);                         â”‚
  â”‚      setHydrated(true);                                â”‚
  â”‚    }, [hydrated, importComponent]);                    â”‚
  â”‚                                                        â”‚
  â”‚    // â•â•â• VIEWPORT TRIGGER â•â•â•                         â”‚
  â”‚    useEffect(() => {                                   â”‚
  â”‚      if (!whenVisible || hydrated) return;             â”‚
  â”‚                                                        â”‚
  â”‚      const observer = new IntersectionObserver(        â”‚
  â”‚        (entries) => {                                  â”‚
  â”‚          if (entries[0].isIntersecting) {              â”‚
  â”‚            hydrate();                                  â”‚
  â”‚            observer.disconnect();                      â”‚
  â”‚          }                                             â”‚
  â”‚        },                                              â”‚
  â”‚        { rootMargin: '200px' }                         â”‚
  â”‚      );                                                â”‚
  â”‚                                                        â”‚
  â”‚      if (rootRef.current) {                            â”‚
  â”‚        observer.observe(rootRef.current);              â”‚
  â”‚      }                                                 â”‚
  â”‚      return () => observer.disconnect();               â”‚
  â”‚    }, [whenVisible, hydrated, hydrate]);               â”‚
  â”‚                                                        â”‚
  â”‚    // â•â•â• IDLE TRIGGER â•â•â•                             â”‚
  â”‚    useEffect(() => {                                   â”‚
  â”‚      if (!whenIdle || hydrated) return;                â”‚
  â”‚                                                        â”‚
  â”‚      if ('requestIdleCallback' in window) {            â”‚
  â”‚        const id = requestIdleCallback(                 â”‚
  â”‚          () => hydrate(),                              â”‚
  â”‚          { timeout: 2000 }                             â”‚
  â”‚        );                                              â”‚
  â”‚        return () => cancelIdleCallback(id);            â”‚
  â”‚      } else {                                          â”‚
  â”‚        const id = setTimeout(() => hydrate(), 2000);   â”‚
  â”‚        return () => clearTimeout(id);                  â”‚
  â”‚      }                                                 â”‚
  â”‚    }, [whenIdle, hydrated, hydrate]);                  â”‚
  â”‚                                                        â”‚
  â”‚    // â•â•â• INTERACTION TRIGGER â•â•â•                      â”‚
  â”‚    useEffect(() => {                                   â”‚
  â”‚      if (!onInteraction || hydrated) return;           â”‚
  â”‚      const el = rootRef.current;                       â”‚
  â”‚      if (!el) return;                                  â”‚
  â”‚                                                        â”‚
  â”‚      const events = Array.isArray(onInteraction)       â”‚
  â”‚        ? onInteraction                                 â”‚
  â”‚        : [onInteraction];                              â”‚
  â”‚                                                        â”‚
  â”‚      events.forEach((event) => {                       â”‚
  â”‚        el.addEventListener(event, hydrate, {           â”‚
  â”‚          once: true, passive: true, capture: true,     â”‚
  â”‚        });                                             â”‚
  â”‚      });                                               â”‚
  â”‚                                                        â”‚
  â”‚      return () => {                                    â”‚
  â”‚        events.forEach((event) => {                     â”‚
  â”‚          el.removeEventListener(event, hydrate, {      â”‚
  â”‚            capture: true,                              â”‚
  â”‚          });                                           â”‚
  â”‚        });                                             â”‚
  â”‚      };                                                â”‚
  â”‚    }, [onInteraction, hydrated, hydrate]);             â”‚
  â”‚                                                        â”‚
  â”‚    // â•â•â• RENDER â•â•â•                                   â”‚
  â”‚    if (!hydrated || !Component) {                      â”‚
  â”‚      return (                                          â”‚
  â”‚        <div                                            â”‚
  â”‚          ref={rootRef}                                 â”‚
  â”‚          suppressHydrationWarning                      â”‚
  â”‚          dangerouslySetInnerHTML={{ __html: '' }}       â”‚
  â”‚        />                                              â”‚
  â”‚      );                                                â”‚
  â”‚    }                                                   â”‚
  â”‚                                                        â”‚
  â”‚    return (                                            â”‚
  â”‚      <div ref={rootRef}>                               â”‚
  â”‚        <Component {...componentProps} />                â”‚
  â”‚      </div>                                            â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  Sá»¬ Dá»¤NG:                                              â”‚
  â”‚  function App() {                                      â”‚
  â”‚    return (                                            â”‚
  â”‚      <div>                                             â”‚
  â”‚        <Header />                                      â”‚
  â”‚                                                        â”‚
  â”‚        {/* Hydrate khi cuá»™n Ä‘áº¿n + code-split! */}    â”‚
  â”‚        <LazyHydrate                                    â”‚
  â”‚          importComponent={() => import('./Comments')}  â”‚
  â”‚          whenVisible                                   â”‚
  â”‚          componentProps={{ postId: 123 }}               â”‚
  â”‚        />                                              â”‚
  â”‚                                                        â”‚
  â”‚        {/* Hydrate khi click + code-split! */}         â”‚
  â”‚        <LazyHydrate                                    â”‚
  â”‚          importComponent={() => import('./Chat')}      â”‚
  â”‚          onInteraction={['click']}                     â”‚
  â”‚        />                                              â”‚
  â”‚                                                        â”‚
  â”‚        {/* Hydrate khi browser ráº£nh! */}              â”‚
  â”‚        <LazyHydrate                                    â”‚
  â”‚          importComponent={() => import('./Sidebar')}   â”‚
  â”‚          whenIdle                                      â”‚
  â”‚        />                                              â”‚
  â”‚      </div>                                            â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§12. React 18+ Selective Hydration & Suspense

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REACT 18 = PROGRESSIVE HYDRATION ÄÃƒ CÃ“ Sáº´N!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  CONCURRENT MODE & SELECTIVE HYDRATION:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  React 18 giá»›i thiá»‡u CONCURRENT FEATURES:             â”‚
  â”‚                                                        â”‚
  â”‚  â‘  Selective Hydration:                               â”‚
  â”‚     â†’ React cÃ³ thá»ƒ PAUSE hydration giá»¯a chá»«ng!      â”‚
  â”‚     â†’ Náº¿u user click â†’ NGá»ªNG hydrate pháº§n khÃ¡c      â”‚
  â”‚     â†’ Æ¯U TIÃŠN hydrate pháº§n user Ä‘ang tÆ°Æ¡ng tÃ¡c!     â”‚
  â”‚     â†’ TÃCH Há»¢P Sáº´N! KhÃ´ng cáº§n code thÃªm!            â”‚
  â”‚                                                        â”‚
  â”‚  â‘¡ Streaming SSR (renderToPipeableStream):            â”‚
  â”‚     â†’ Server Gá»¬I HTML theo luá»“ng (stream)!           â”‚
  â”‚     â†’ KhÃ´ng cáº§n Ä‘á»£i render XONG Háº¾T!                â”‚
  â”‚     â†’ Client nháº­n vÃ  hiá»ƒn thá»‹ Dáº¦N Dáº¦N!              â”‚
  â”‚                                                        â”‚
  â”‚  â‘¢ Suspense cho SSR:                                   â”‚
  â”‚     â†’ Bá»c component trong <Suspense>!                â”‚
  â”‚     â†’ Server render placeholder!                       â”‚
  â”‚     â†’ Client hydrate KHÃ”NG Cáº¦N Ä‘á»£i component!        â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ React 18 giáº£i quyáº¿t Háº¦U Háº¾T váº¥n Ä‘á»             â”‚
  â”‚     mÃ  Progressive Hydration cá»‘ giáº£i quyáº¿t!           â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ SELECTIVE HYDRATION:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  React 18 Selective Hydration:                         â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚  <App>                                    â”‚          â”‚
  â”‚  â”‚    <Header />         âœ… Hydrated!       â”‚          â”‚
  â”‚  â”‚    <Suspense>                             â”‚          â”‚
  â”‚  â”‚      <Sidebar />      â³ Äang hydrate... â”‚          â”‚
  â”‚  â”‚    </Suspense>                            â”‚          â”‚
  â”‚  â”‚    <Main>                                 â”‚          â”‚
  â”‚  â”‚      <Content />      âœ… Hydrated!       â”‚          â”‚
  â”‚  â”‚    </Main>                                â”‚          â”‚
  â”‚  â”‚    <Suspense>                             â”‚          â”‚
  â”‚  â”‚      <Comments />     â¸ Chá» hydrate...  â”‚          â”‚
  â”‚  â”‚    </Suspense>                            â”‚          â”‚
  â”‚  â”‚  </App>                                   â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚              â”‚                                         â”‚
  â”‚              â”‚ User CLICK vÃ o Comments!                â”‚
  â”‚              â–¼                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚  React PHÃT HIá»†N user muá»‘n Comments!     â”‚          â”‚
  â”‚  â”‚                                           â”‚          â”‚
  â”‚  â”‚  â†’ NGá»ªNG hydrate Sidebar!                â”‚          â”‚
  â”‚  â”‚  â†’ Æ¯U TIÃŠN hydrate Comments!             â”‚          â”‚
  â”‚  â”‚  â†’ Comments âœ… Hydrated TRÆ¯á»šC!           â”‚          â”‚
  â”‚  â”‚  â†’ Quay láº¡i hydrate Sidebar!              â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ React 18 Tá»° Äá»˜NG Æ°u tiÃªn!                        â”‚
  â”‚  â†’ Developer KHÃ”NG cáº§n viáº¿t logic Æ°u tiÃªn!           â”‚
  â”‚  â†’ Chá»‰ cáº§n bá»c <Suspense>!                           â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE REACT 18 â€” PROGRESSIVE HYDRATION Vá»šI SUSPENSE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // CÃCH 1: React.lazy() + Suspense                    â”‚
  â”‚  // â†’ Code-split + Progressive Hydration!              â”‚
  â”‚                                                        â”‚
  â”‚  import React, { Suspense } from 'react';              â”‚
  â”‚                                                        â”‚
  â”‚  // â‘  Lazy load component (code-splitting Tá»° Äá»˜NG!)  â”‚
  â”‚  const Comments = React.lazy(                          â”‚
  â”‚    () => import('./Comments')                          â”‚
  â”‚  );                                                    â”‚
  â”‚  const Chat = React.lazy(                              â”‚
  â”‚    () => import('./Chat')                              â”‚
  â”‚  );                                                    â”‚
  â”‚  const RelatedItems = React.lazy(                      â”‚
  â”‚    () => import('./RelatedItems')                      â”‚
  â”‚  );                                                    â”‚
  â”‚                                                        â”‚
  â”‚  function App() {                                      â”‚
  â”‚    return (                                            â”‚
  â”‚      <div>                                             â”‚
  â”‚        {/* Header hydrate NGAY! (khÃ´ng lazy) */}       â”‚
  â”‚        <Header />                                      â”‚
  â”‚        <SearchBar />                                   â”‚
  â”‚                                                        â”‚
  â”‚        {/* Comments: lazy + Suspense! */}              â”‚
  â”‚        <Suspense fallback={<CommentsSkeleton />}>      â”‚
  â”‚          <Comments postId={123} />                     â”‚
  â”‚        </Suspense>                                     â”‚
  â”‚                                                        â”‚
  â”‚        {/* Chat: lazy + Suspense! */}                  â”‚
  â”‚        <Suspense fallback={null}>                      â”‚
  â”‚          <Chat />                                      â”‚
  â”‚        </Suspense>                                     â”‚
  â”‚                                                        â”‚
  â”‚        {/* Related Items: lazy! */}                    â”‚
  â”‚        <Suspense fallback={<div>Äang táº£i...</div>}>   â”‚
  â”‚          <RelatedItems />                              â”‚
  â”‚        </Suspense>                                     â”‚
  â”‚                                                        â”‚
  â”‚        <Footer />                                      â”‚
  â”‚      </div>                                            â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I THÃCH:                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  React.lazy(() => import('./Comments'))        â”‚      â”‚
  â”‚  â”‚  â†’ Webpack tÃ¡ch Comments thÃ nh FILE RIÃŠNG!    â”‚      â”‚
  â”‚  â”‚  â†’ Chá»‰ táº£i KHI component cáº§n render!         â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  <Suspense fallback={<Skeleton />}>            â”‚      â”‚
  â”‚  â”‚  â†’ Trong khi Comments chÆ°a táº£i xong:          â”‚      â”‚
  â”‚  â”‚    â†’ Hiá»‡n Skeleton (loading placeholder)!     â”‚      â”‚
  â”‚  â”‚  â†’ Khi táº£i xong:                              â”‚      â”‚
  â”‚  â”‚    â†’ Thay Skeleton báº±ng Comments tháº­t!        â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  fallback={null}                               â”‚      â”‚
  â”‚  â”‚  â†’ KhÃ´ng hiá»‡n gÃ¬ trong khi táº£i!              â”‚      â”‚
  â”‚  â”‚  â†’ Vá»›i SSR: server HTML VáºªN hiá»‡n!             â”‚      â”‚
  â”‚  â”‚  â†’ User khÃ´ng tháº¥y "nháº¥p nhÃ¡y"!             â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  SERVER-SIDE vá»›i React 18:                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  // server.js â€” Streaming SSR!                â”‚      â”‚
  â”‚  â”‚  import { renderToPipeableStream }             â”‚      â”‚
  â”‚  â”‚    from 'react-dom/server';                   â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  app.get('/', (req, res) => {                 â”‚      â”‚
  â”‚  â”‚    const { pipe } = renderToPipeableStream(    â”‚      â”‚
  â”‚  â”‚      <App />,                                 â”‚      â”‚
  â”‚  â”‚      {                                        â”‚      â”‚
  â”‚  â”‚        bootstrapScripts: ['/bundle.js'],      â”‚      â”‚
  â”‚  â”‚        onShellReady() {                       â”‚      â”‚
  â”‚  â”‚          // Shell (Header, Layout) sáºµn sÃ ng!â”‚      â”‚
  â”‚  â”‚          res.statusCode = 200;                â”‚      â”‚
  â”‚  â”‚          res.setHeader('Content-Type',         â”‚      â”‚
  â”‚  â”‚            'text/html');                      â”‚      â”‚
  â”‚  â”‚          pipe(res);                           â”‚      â”‚
  â”‚  â”‚          // â†’ Báº¯t Ä‘áº§u STREAM HTML!          â”‚      â”‚
  â”‚  â”‚          // â†’ Suspense boundaries sáº½        â”‚      â”‚
  â”‚  â”‚          //   Ä‘Æ°á»£c gá»­i khi sáºµn sÃ ng!       â”‚      â”‚
  â”‚  â”‚        },                                     â”‚      â”‚
  â”‚  â”‚      }                                        â”‚      â”‚
  â”‚  â”‚    );                                         â”‚      â”‚
  â”‚  â”‚  });                                          â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  ğŸ’¡ renderToPipeableStream vs renderToString:  â”‚      â”‚
  â”‚  â”‚  â†’ renderToString: Ä‘á»£i render XONG Háº¾T má»›i â”‚      â”‚
  â”‚  â”‚    gá»­i! (blocking!)                          â”‚      â”‚
  â”‚  â”‚  â†’ renderToPipeableStream: gá»­i Dáº¦N Dáº¦N!    â”‚      â”‚
  â”‚  â”‚    Suspense nÃ o xong â†’ gá»­i ngay!             â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§13. Server Components + Streaming â€” TÆ°Æ¡ng Lai Cá»§a Hydration

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REACT SERVER COMPONENTS = KHÃ”NG Cáº¦N HYDRATE!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  SERVER COMPONENTS LÃ€ GÃŒ?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  React Server Components (RSC) = Components cháº¡y     â”‚
  â”‚  CHá»ˆ trÃªn SERVER! KhÃ´ng gá»­i JS xuá»‘ng client!          â”‚
  â”‚                                                        â”‚
  â”‚  KHÃC BIá»†T CÄ‚N Báº¢N:                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  SSR truyá»n thá»‘ng:                            â”‚      â”‚
  â”‚  â”‚  Server render HTML â”€â”€â–¶ Client hydrate vá»›i JS â”‚      â”‚
  â”‚  â”‚  â†’ VáºªN cáº§n gá»­i JS cho Má»ŒI component!        â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  Server Components:                           â”‚      â”‚
  â”‚  â”‚  Server render HTML â”€â”€â–¶ Client KHÃ”NG Cáº¦N JS! â”‚      â”‚
  â”‚  â”‚  â†’ Component CHá»ˆ cháº¡y trÃªn server!            â”‚      â”‚
  â”‚  â”‚  â†’ ZERO JavaScript gá»­i xuá»‘ng client!          â”‚      â”‚
  â”‚  â”‚  â†’ KHÃ”NG Cáº¦N HYDRATE!                        â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚  Server Component     â”‚  Client Component       â”‚   â”‚
  â”‚  â”‚  (máº·c Ä‘á»‹nh Next.js)  â”‚  ('use client')         â”‚   â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
  â”‚  â”‚ Cháº¡y trÃªn server     â”‚ Cháº¡y trÃªn client       â”‚   â”‚
  â”‚  â”‚ KHÃ”NG gá»­i JS         â”‚ Gá»¬I JS (cáº§n hydrate!)  â”‚   â”‚
  â”‚  â”‚ Truy cáº­p DB trá»±c    â”‚ KHÃ”NG truy cáº­p DB      â”‚   â”‚
  â”‚  â”‚ tiáº¿p!                â”‚                          â”‚   â”‚
  â”‚  â”‚ KHÃ”NG cÃ³ state       â”‚ CÃ“ state (useState)     â”‚   â”‚
  â”‚  â”‚ KHÃ”NG cÃ³ effects     â”‚ CÃ“ effects (useEffect)  â”‚   â”‚
  â”‚  â”‚ KHÃ”NG cÃ³ events      â”‚ CÃ“ events (onClick)     â”‚   â”‚
  â”‚  â”‚ â†’ DÃ¹ng cho ná»™i dung â”‚ â†’ DÃ¹ng cho pháº§n        â”‚   â”‚
  â”‚  â”‚   TÄ¨NH, data fetch! â”‚   TÆ¯Æ NG TÃC!            â”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ Káº¾T Há»¢P SERVER + CLIENT COMPONENTS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
  â”‚  â”‚ <App>                    (Server Comp.)  â”‚          â”‚
  â”‚  â”‚ â†’ KHÃ”NG gá»­i JS!                         â”‚          â”‚
  â”‚  â”‚                                          â”‚          â”‚
  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚          â”‚
  â”‚  â”‚   â”‚ <Header />        (Server Comp.) â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ Render HTML, KHÃ”NG JS!         â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ KHÃ”NG cáº§n hydrate!             â”‚  â”‚          â”‚
  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚
  â”‚  â”‚                                          â”‚          â”‚
  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚          â”‚
  â”‚  â”‚   â”‚ <SearchBar />    (Client Comp.)  â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ 'use client'                      â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ Gá»¬I JS! Cáº¦N hydrate!          â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ useState, onChange...           â”‚  â”‚          â”‚
  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚
  â”‚  â”‚                                          â”‚          â”‚
  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚          â”‚
  â”‚  â”‚   â”‚ <ProductList />  (Server Comp.)  â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ Fetch DB trá»±c tiáº¿p!           â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ Render HTML, KHÃ”NG JS!         â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚                                   â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚   â”‚ <AddToCart /> (Client)   â”‚    â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚   â”‚ 'use client'             â”‚    â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚   â”‚ â†’ NÃºt báº¥m, Cáº¦N JS!     â”‚    â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚          â”‚
  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚
  â”‚  â”‚                                          â”‚          â”‚
  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚          â”‚
  â”‚  â”‚   â”‚ <Footer />       (Server Comp.) â”‚  â”‚          â”‚
  â”‚  â”‚   â”‚ â†’ KHÃ”NG gá»­i JS!                 â”‚  â”‚          â”‚
  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
  â”‚                                                        â”‚
  â”‚  JS gá»­i xuá»‘ng client:                                  â”‚
  â”‚  â†’ CHá»ˆ SearchBar + AddToCart!                          â”‚
  â”‚  â†’ KHÃ”NG gá»­i Header, ProductList, Footer!             â”‚
  â”‚  â†’ Bundle size GIáº¢M ÄÃNG Ká»‚!                         â”‚
  â”‚  â†’ Hydration CHá»ˆ cho 2 components!                    â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  CODE NEXT.JS 13+ â€” SERVER + CLIENT COMPONENTS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  // app/page.jsx â€” SERVER Component (máº·c Ä‘á»‹nh!)       â”‚
  â”‚  // KHÃ”NG cÃ³ 'use client' â†’ cháº¡y trÃªn SERVER!        â”‚
  â”‚                                                        â”‚
  â”‚  import { SearchBar } from './SearchBar';              â”‚
  â”‚  import { AddToCart } from './AddToCart';               â”‚
  â”‚                                                        â”‚
  â”‚  // HÃ m async! Fetch data TRá»°C TIáº¾P trÃªn server!     â”‚
  â”‚  export default async function ProductPage() {         â”‚
  â”‚    // â‘  Fetch DB trÃªn server (KHÃ”NG gá»­i request      â”‚
  â”‚    //   tá»« client!)                                    â”‚
  â”‚    const products = await db.products.findMany();      â”‚
  â”‚    const reviews = await db.reviews.findMany();        â”‚
  â”‚                                                        â”‚
  â”‚    return (                                            â”‚
  â”‚      <div>                                             â”‚
  â”‚        <h1>Sáº£n pháº©m</h1>                             â”‚
  â”‚                                                        â”‚
  â”‚        {/* Client Component: Cáº¦N hydrate! */}         â”‚
  â”‚        <SearchBar />                                   â”‚
  â”‚                                                        â”‚
  â”‚        {/* Server render: KHÃ”NG Cáº¦N hydrate! */}      â”‚
  â”‚        <ul>                                            â”‚
  â”‚          {products.map(p => (                          â”‚
  â”‚            <li key={p.id}>                             â”‚
  â”‚              <h3>{p.name}</h3>                         â”‚
  â”‚              <p>{p.description}</p>                    â”‚
  â”‚              {/* Client Component bÃªn trong! */}       â”‚
  â”‚              <AddToCart productId={p.id} />             â”‚
  â”‚            </li>                                       â”‚
  â”‚          ))}                                           â”‚
  â”‚        </ul>                                           â”‚
  â”‚                                                        â”‚
  â”‚        {/* Server render reviews: KHÃ”NG JS! */}        â”‚
  â”‚        <section>                                       â”‚
  â”‚          <h2>ÄÃ¡nh giÃ¡</h2>                           â”‚
  â”‚          {reviews.map(r => (                           â”‚
  â”‚            <p key={r.id}>{r.text}</p>                  â”‚
  â”‚          ))}                                           â”‚
  â”‚        </section>                                      â”‚
  â”‚      </div>                                            â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚                                                        â”‚
  â”‚  // SearchBar.jsx â€” CLIENT Component!                  â”‚
  â”‚  'use client'; // â† ÄÃNH Dáº¤U lÃ  Client Component!    â”‚
  â”‚                                                        â”‚
  â”‚  import { useState } from 'react';                     â”‚
  â”‚                                                        â”‚
  â”‚  export function SearchBar() {                         â”‚
  â”‚    const [query, setQuery] = useState('');              â”‚
  â”‚    return (                                            â”‚
  â”‚      <input                                            â”‚
  â”‚        value={query}                                   â”‚
  â”‚        onChange={(e) => setQuery(e.target.value)}       â”‚
  â”‚        placeholder="TÃ¬m kiáº¿m..."                     â”‚
  â”‚      />                                                â”‚
  â”‚    );                                                  â”‚
  â”‚  }                                                     â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ 'use client' = ranh giá»›i giá»¯a Server vÃ  Client!  â”‚
  â”‚  â†’ Má»i thá»© KHÃ”NG cÃ³ 'use client' = Server Component! â”‚
  â”‚  â†’ 'use client' = cáº§n JS, cáº§n hydrate!                â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§14. Æ¯u NhÆ°á»£c Äiá»ƒm & Khi NÃ o NÃªn DÃ¹ng

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Æ¯U NHÆ¯á»¢C ÄIá»‚M â€” ÄÃNH GIÃ KHÃCH QUAN!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  Æ¯U ÄIá»‚M:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  âœ… â‘  ThÃºc Ä‘áº©y CODE-SPLITTING:                       â”‚
  â”‚     â†’ Code-splitting lÃ  PHáº¦N Báº®T BUá»˜C!               â”‚
  â”‚     â†’ Má»—i component = 1 chunk riÃªng!                  â”‚
  â”‚     â†’ Káº¿t quáº£: bundle nhá» hÆ¡n!                       â”‚
  â”‚                                                        â”‚
  â”‚  âœ… â‘¡ Cho phÃ©p ON-DEMAND loading:                     â”‚
  â”‚     â†’ Pháº§n Ã­t dÃ¹ng â†’ chá»‰ táº£i khi Cáº¦N!              â”‚
  â”‚     â†’ Component á»Ÿ dÆ°á»›i viewport â†’ táº£i khi CUá»˜N!     â”‚
  â”‚     â†’ Component Ã­t tÆ°Æ¡ng tÃ¡c â†’ táº£i KHI CLICK!        â”‚
  â”‚     â†’ TIáº¾T KIá»†M bandwidth cho user!                   â”‚
  â”‚                                                        â”‚
  â”‚  âœ… â‘¢ GIáº¢M bundle size ban Ä‘áº§u:                      â”‚
  â”‚     â†’ Chá»‰ táº£i JS cho pháº§n QUAN TRá»ŒNG!                â”‚
  â”‚     â†’ FCP â†’ TTI khoáº£ng cÃ¡ch NGáº®N hÆ¡n!               â”‚
  â”‚     â†’ Uncanny Valley GIáº¢M ÄÃNG Ká»‚!                   â”‚
  â”‚                                                        â”‚
  â”‚  âœ… â‘£ KhÃ´ng block main thread:                        â”‚
  â”‚     â†’ Hydrate tá»«ng pháº§n, khÃ´ng "Ä‘Ã³ng bÄƒng" UI!       â”‚
  â”‚     â†’ Animation vÃ  user input váº«n MÆ¯á»¢T!              â”‚
  â”‚                                                        â”‚
  â”‚  âœ… â‘¤ FCP váº«n NHANH (giá»¯ nguyÃªn SSR!):              â”‚
  â”‚     â†’ Server váº«n render HTML Ä‘áº§y Ä‘á»§!                 â”‚
  â”‚     â†’ SEO khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng!                        â”‚
  â”‚     â†’ User tháº¥y ná»™i dung NGAY!                       â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  NHÆ¯á»¢C ÄIá»‚M:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  âŒ â‘  KHÃ”NG phÃ¹ há»£p cho á»©ng dá»¥ng HIGHLY DYNAMIC:    â”‚
  â”‚     â†’ App mÃ  Má»ŒI element Ä‘á»u cáº§n tÆ°Æ¡ng tÃ¡c NGAY!    â”‚
  â”‚     â†’ VD: Google Docs, Figma, Game online...           â”‚
  â”‚     â†’ KhÃ´ng biáº¿t user click ÄÃ‚U trÆ°á»›c!              â”‚
  â”‚     â†’ Progressive hydration khÃ´ng giÃºp Ä‘Æ°á»£c!          â”‚
  â”‚                                                        â”‚
  â”‚  âŒ â‘¡ Phá»©c táº¡p hÆ¡n FULL hydration:                   â”‚
  â”‚     â†’ Cáº§n quyáº¿t Ä‘á»‹nh component nÃ o hydrate TRÆ¯á»šC!    â”‚
  â”‚     â†’ Cáº§n setup IntersectionObserver, idle...          â”‚
  â”‚     â†’ Testing phá»©c táº¡p hÆ¡n!                           â”‚
  â”‚     â†’ Debugging khÃ³ hÆ¡n!                               â”‚
  â”‚                                                        â”‚
  â”‚  âŒ â‘¢ CÃ³ thá»ƒ gÃ¢y DELAY cho tÆ°Æ¡ng tÃ¡c:               â”‚
  â”‚     â†’ User click component chÆ°a hydrate!               â”‚
  â”‚     â†’ Pháº£i Ä‘á»£i táº£i JS + hydrate!                     â”‚
  â”‚     â†’ CÃ³ DELAY nhá»!                                   â”‚
  â”‚     â†’ Cáº§n rootMargin lá»›n Ä‘á»ƒ PRE-LOAD!                 â”‚
  â”‚                                                        â”‚
  â”‚  âŒ â‘£ Server váº«n render Táº¤T Cáº¢:                     â”‚
  â”‚     â†’ Server load khÃ´ng giáº£m!                          â”‚
  â”‚     â†’ Chá»‰ giáº£m CLIENT-SIDE work!                      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  KHI NÃ€O NÃŠN DÃ™NG?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  âœ… NÃŠN DÃ™NG khi:                                     â”‚
  â”‚  â†’ Trang chá»§ yáº¿u TÄ¨NH vá»›i vÃ i pháº§n tÆ°Æ¡ng tÃ¡c!       â”‚
  â”‚  â†’ Blog, tin tá»©c, e-commerce (sáº£n pháº©m + nÃºt mua!)  â”‚
  â”‚  â†’ Trang dÃ i vá»›i nhiá»u ná»™i dung á»Ÿ DÆ¯á»šI viewport!    â”‚
  â”‚  â†’ Mobile users (bandwidth háº¡n cháº¿!)                   â”‚
  â”‚  â†’ Lighthouse / Core Web Vitals quan trá»ng!            â”‚
  â”‚                                                        â”‚
  â”‚  âŒ KHÃ”NG NÃŠN khi:                                    â”‚
  â”‚  â†’ SPA thuáº§n tÃºy (CSR)                                 â”‚
  â”‚  â†’ á»¨ng dá»¥ng mÃ  Má»ŒI THá»¨ cáº§n tÆ°Æ¡ng tÃ¡c NGAY!         â”‚
  â”‚  â†’ Real-time apps (chat, collaborative editing)        â”‚
  â”‚  â†’ Dashboard vá»›i nhiá»u widgets tÆ°Æ¡ng tÃ¡c               â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ KHUYáº¾N NGHá»Š 2024+:                                â”‚
  â”‚  â†’ DÃ¹ng React 18 + Suspense = Äá»¦ cho háº§u háº¿t!      â”‚
  â”‚  â†’ Next.js 13+ App Router = tá»‘t nháº¥t hiá»‡n táº¡i!       â”‚
  â”‚  â†’ Server Components = giáº£m hydration Tá»I ÄA!        â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§15. Best Practices & Phá»ng Váº¥n Q&A

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  BEST PRACTICES + CÃ‚U Há»I PHá»NG Váº¤N!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


  BEST PRACTICES:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â‘  Æ¯U TIÃŠN Above-the-Fold:                            â”‚
  â”‚     â†’ Hydrate pháº§n TRÃŠN MÃ€N HÃŒNH trÆ°á»›c!              â”‚
  â”‚     â†’ Header, Navigation, Hero = Æ°u tiÃªn CAO!         â”‚
  â”‚     â†’ Footer, Sidebar = Æ°u tiÃªn THáº¤P!                 â”‚
  â”‚                                                        â”‚
  â”‚  â‘¡ DÃ¹ng rootMargin Ä‘á»§ lá»›n:                           â”‚
  â”‚     â†’ rootMargin: '200px' - '400px'                    â”‚
  â”‚     â†’ Hydrate TRÆ¯á»šC khi user cuá»™n Ä‘áº¿n!              â”‚
  â”‚     â†’ TrÃ¡nh delay khi user Ä‘áº¿n component!             â”‚
  â”‚                                                        â”‚
  â”‚  â‘¢ Fallback PHáº¢I giá»‘ng HTML server:                   â”‚
  â”‚     â†’ KhÃ´ng "nháº¥p nhÃ¡y" khi chuyá»ƒn Ä‘á»•i!             â”‚
  â”‚     â†’ Skeleton UI nÃªn giá»‘ng layout tháº­t!               â”‚
  â”‚     â†’ fallback={null} náº¿u server HTML Ä‘á»§!            â”‚
  â”‚                                                        â”‚
  â”‚  â‘£ Kiá»ƒm tra vá»›i Lighthouse:                           â”‚
  â”‚     â†’ Äo TTI, TBT, FID trÆ°á»›c vÃ  sau!                 â”‚
  â”‚     â†’ Progressive hydration nÃªn GIáº¢M TTI!             â”‚
  â”‚     â†’ Náº¿u khÃ´ng â†’ xem láº¡i chiáº¿n lÆ°á»£c!                â”‚
  â”‚                                                        â”‚
  â”‚  â‘¤ DÃ¹ng React 18 Suspense khi cÃ³ thá»ƒ:               â”‚
  â”‚     â†’ ÄÆ¡n giáº£n hÆ¡n tá»± viáº¿t Hydrator!                 â”‚
  â”‚     â†’ Selective hydration tÃ­ch há»£p sáºµn!               â”‚
  â”‚     â†’ Streaming SSR miá»…n phÃ­!                         â”‚
  â”‚                                                        â”‚
  â”‚  â‘¥ Server Components cho ná»™i dung tÄ©nh:              â”‚
  â”‚     â†’ Footer, Header (tÄ©nh), Sidebar (tÄ©nh)         â”‚
  â”‚     â†’ ZERO JS gá»­i xuá»‘ng client!                       â”‚
  â”‚     â†’ Tá»‘t nháº¥t cho progressive hydration!             â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  SÆ  Äá»’ Tá»”NG Káº¾T TOÃ€N Bá»˜:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚     EVOLUTION Cá»¦A HYDRATION TRONG REACT:              â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â”‚  React 16: Full Hydration                     â”‚      â”‚
  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚      â”‚
  â”‚  â”‚  hydrate(<App />, root)                        â”‚      â”‚
  â”‚  â”‚  â†’ Hydrate Táº¤T Cáº¢ cÃ¹ng lÃºc!                 â”‚      â”‚
  â”‚  â”‚  â†’ Bundle Lá»šN, TTI CHáº¬M!                     â”‚      â”‚
  â”‚  â”‚                    â”‚                           â”‚      â”‚
  â”‚  â”‚                    â–¼                           â”‚      â”‚
  â”‚  â”‚  React 16+: Progressive Hydration (tá»± viáº¿t) â”‚      â”‚
  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚      â”‚
  â”‚  â”‚  <Hydrator whenVisible>                       â”‚      â”‚
  â”‚  â”‚    <Comments />                               â”‚      â”‚
  â”‚  â”‚  </Hydrator>                                  â”‚      â”‚
  â”‚  â”‚  â†’ Hydrate Tá»ªNG PHáº¦N!                        â”‚      â”‚
  â”‚  â”‚  â†’ Cáº§n Tá»° VIáº¾T logic!                        â”‚      â”‚
  â”‚  â”‚                    â”‚                           â”‚      â”‚
  â”‚  â”‚                    â–¼                           â”‚      â”‚
  â”‚  â”‚  React 18: Selective Hydration (tÃ­ch há»£p!)   â”‚      â”‚
  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚      â”‚
  â”‚  â”‚  <Suspense fallback={<Skeleton />}>            â”‚      â”‚
  â”‚  â”‚    <Comments />                               â”‚      â”‚
  â”‚  â”‚  </Suspense>                                  â”‚      â”‚
  â”‚  â”‚  â†’ React Tá»° Æ°u tiÃªn hydration!               â”‚      â”‚
  â”‚  â”‚  â†’ Streaming SSR!                             â”‚      â”‚
  â”‚  â”‚                    â”‚                           â”‚      â”‚
  â”‚  â”‚                    â–¼                           â”‚      â”‚
  â”‚  â”‚  React 18 + Server Components (Next.js 13+)  â”‚      â”‚
  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚      â”‚
  â”‚  â”‚  Server Components: ZERO JS!                  â”‚      â”‚
  â”‚  â”‚  Client Components: 'use client'              â”‚      â”‚
  â”‚  â”‚  â†’ CHá»ˆ hydrate component Cáº¦N tÆ°Æ¡ng tÃ¡c!     â”‚      â”‚
  â”‚  â”‚  â†’ Pháº§n tÄ©nh: KHÃ”NG Gá»¬I JS!                â”‚      â”‚
  â”‚  â”‚  â†’ GIáº¢I PHÃP Tá»I Æ¯U NHáº¤T!                  â”‚      â”‚
  â”‚  â”‚                                               â”‚      â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  CÃ‚U Há»I PHá»NG Váº¤N THÆ¯á»œNG Gáº¶P:
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Q1: Hydration lÃ  gÃ¬? Táº¡i sao cáº§n?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: Hydration lÃ  quÃ¡ trÃ¬nh gáº¯n JavaScript (events,    â”‚
  â”‚  state, logic) vÃ o HTML tÄ©nh tá»« SSR. Cáº§n vÃ¬ SSR     â”‚
  â”‚  chá»‰ render HTML tÄ©nh â€” user cáº§n tÆ°Æ¡ng tÃ¡c!         â”‚
  â”‚  hydrate() tÃ¡i sá»­ dá»¥ng DOM cÃ³ sáºµn, KHÃ”NG táº¡o má»›i  â”‚
  â”‚  â†’ nhanh hÆ¡n render()!                                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q2: Uncanny Valley lÃ  gÃ¬? CÃ¡ch giáº£i quyáº¿t?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: Khoáº£ng thá»i gian giá»¯a FCP vÃ  TTI â€” UI HIá»†N       â”‚
  â”‚  nhÆ°ng KHÃ”NG tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c. Giáº£i quyáº¿t báº±ng:        â”‚
  â”‚  â‘  Progressive Hydration (hydrate tá»«ng pháº§n)         â”‚
  â”‚  â‘¡ Code-splitting (giáº£m JS ban Ä‘áº§u)                  â”‚
  â”‚  â‘¢ React 18 Selective Hydration (tá»± Ä‘á»™ng Æ°u tiÃªn)   â”‚
  â”‚  â‘£ Server Components (giáº£m JS cáº§n hydrate)           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q3: Progressive Hydration khÃ¡c Full Hydration tháº¿ nÃ o?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: Full Hydration hydrate TOÃ€N Bá»˜ app cÃ¹ng lÃºc â†’   â”‚
  â”‚  cáº§n táº£i Háº¾T JS â†’ TTI cháº­m. Progressive Hydration   â”‚
  â”‚  hydrate Tá»ªNG PHáº¦N theo Ä‘iá»u kiá»‡n (viewport, idle,   â”‚
  â”‚  interaction) â†’ TTI cho pháº§n quan trá»ng NHANH hÆ¡n!   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q4: Khi nÃ o KHÃ”NG nÃªn dÃ¹ng Progressive Hydration?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: Khi á»©ng dá»¥ng highly dynamic (má»i element Ä‘á»u    â”‚
  â”‚  cáº§n tÆ°Æ¡ng tÃ¡c ngay): collaborative editing (Google  â”‚
  â”‚  Docs), real-time dashboards, games. Dev khÃ´ng biáº¿t   â”‚
  â”‚  user click Ä‘Ã¢u trÆ°á»›c â†’ khÃ´ng thá»ƒ Æ°u tiÃªn!          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q5: React 18 Selective Hydration hoáº¡t Ä‘á»™ng tháº¿ nÃ o?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: DÃ¹ng Suspense boundaries. React hydrate Dáº¦N Dáº¦N â”‚
  â”‚  tá»« root. Náº¿u user click vÃ o pháº§n chÆ°a hydrate â†’    â”‚
  â”‚  React Tá»° Äá»˜NG Æ°u tiÃªn hydrate pháº§n Ä‘Ã³ trÆ°á»›c!      â”‚
  â”‚  Káº¿t há»£p renderToPipeableStream = Streaming SSR,      â”‚
  â”‚  server gá»­i HTML Dáº¦N Dáº¦N theo tá»«ng Suspense.         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q6: Server Components khÃ¡c SSR tháº¿ nÃ o?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: SSR render trÃªn server â†’ Gá»¬I HTML + JS â†’ client â”‚
  â”‚  hydrate Táº¤T Cáº¢. Server Components render trÃªn       â”‚
  â”‚  server â†’ Gá»¬I HTML â†’ KHÃ”NG Gá»¬I JS! Component tÄ©nh  â”‚
  â”‚  = ZERO JS. Chá»‰ 'use client' components má»›i cáº§n     â”‚
  â”‚  JS â†’ giáº£m hydration work ÄÃNG Ká»‚!                  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q7: Tá»± implement Progressive Hydration tháº¿ nÃ o?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: Viáº¿t Hydrator component wrapper:                   â”‚
  â”‚  â‘  Giá»¯ server HTML báº±ng dangerouslySetInnerHTML      â”‚
  â”‚  â‘¡ Theo dÃµi Ä‘iá»u kiá»‡n: IntersectionObserver          â”‚
  â”‚     (viewport), requestIdleCallback (idle),            â”‚
  â”‚     addEventListener (interaction)                     â”‚
  â”‚  â‘¢ Khi Ä‘iá»u kiá»‡n thá»a â†’ setHydrated(true)           â”‚
  â”‚  â‘£ Render React component tháº­t (thay vÃ¬ HTML tÄ©nh) â”‚
  â”‚  â‘¤ Káº¿t há»£p dynamic import() cho code-splitting!      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Q8: hydrate() vs hydrateRoot() vs render()?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  A: render() = táº¡o DOM Má»šI (CSR). hydrate() = React  â”‚
  â”‚  17, gáº¯n events vÃ o DOM cÃ³ sáºµn tá»« SSR.               â”‚
  â”‚  hydrateRoot() = React 18+, thay tháº¿ hydrate(), há»—  â”‚
  â”‚  trá»£ concurrent features + selective hydration.        â”‚
  â”‚  hydrateRoot() cho phÃ©p React pause/resume hydration  â”‚
  â”‚  Ä‘á»ƒ Æ°u tiÃªn user interaction!                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

> **Káº¿t luáº­n**: Progressive Hydration lÃ  giáº£i phÃ¡p quan trá»ng Ä‘á»ƒ thu háº¹p khoáº£ng cÃ¡ch
> giá»¯a FCP vÃ  TTI trong á»©ng dá»¥ng SSR. Tá»« viá»‡c tá»± viáº¿t tay Hydrator component vá»›i
> IntersectionObserver vÃ  requestIdleCallback, Ä‘áº¿n React 18 Selective Hydration tÃ­ch
> há»£p sáºµn, vÃ  Server Components khÃ´ng cáº§n hydrate â€” má»—i bÆ°á»›c tiáº¿n giÃºp á»©ng dá»¥ng
> web NHANH hÆ¡n, MÆ¯á»¢T hÆ¡n, vÃ  tá»‘n ÃT tÃ i nguyÃªn hÆ¡n cho user! ğŸš€
