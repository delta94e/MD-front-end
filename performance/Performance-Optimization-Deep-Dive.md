# Performance Optimization â€” Deep Dive!

> **Chá»§ Ä‘á»**: Rendering Chain â†’ URL â†’ DNS â†’ HTTP â†’ Cache â†’ TCP â†’ CDN â†’ GZIP â†’ Render
> **NgÃ´n ngá»¯**: Tiáº¿ng Viá»‡t â€” giáº£i thÃ­ch cá»±c ká»³ chi tiáº¿t!
> **PhÆ°Æ¡ng chÃ¢m**: Tá»± viáº¿t láº¡i báº±ng tay â€” KHÃ”NG dÃ¹ng thÆ° viá»‡n!
> **Nguá»“n**: "Building a Performance Optimization Knowledge System from Scratch" â€” Juejin

---

## Má»¥c Lá»¥c

1. [Â§1. Tá»•ng Quan â€” Táº¡i Sao Performance Quan Trá»ng?](#1)
2. [Â§2. NguyÃªn Táº¯c Tá»‘i Æ¯u â€” KhÃ´ng QuÃ¡ Sá»›m, KhÃ´ng QuÃ¡ Má»©c!](#2)
3. [Â§3. Rendering Chain â€” Tá»« URL Äáº¿n Pixels!](#3)
4. [Â§4. URL Parsing + Encoding!](#4)
5. [Â§5. HSTS â€” HTTP â†’ HTTPS Tá»± Äá»™ng!](#5)
6. [Â§6. DNS Resolution + Tá»‘i Æ¯u!](#6)
7. [Â§7. HTTP/1.1 Protocol + Content-Type!](#7)
8. [Â§8. HTTP/2 â€” Binary, Multiplexing, Server Push!](#8)
9. [Â§9. HTTP Caching â€” Strong vs Conditional!](#9)
10. [Â§10. TCP â€” 3-Way Handshake + 4-Way Wave!](#10)
11. [Â§11. CDN â€” Content Delivery Network!](#11)
12. [Â§12. GZIP â€” Response Compression!](#12)
13. [Â§13. Browser Rendering Pipeline!](#13)
14. [Â§14. SÆ¡ Äá»“ Tá»± Váº½](#14)
15. [Â§15. Tá»± Viáº¿t â€” PerfOptEngine](#15)
16. [Â§16. CÃ¢u Há»i Luyá»‡n Táº­p](#16)

---

## Â§1. Tá»•ng Quan â€” Táº¡i Sao Performance Quan Trá»ng?

```
  Táº I SAO PERFORMANCE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  USER EXPERIENCE PYRAMID (Google I/O 2018):                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                    â•±â•²                                â”‚    â”‚
  â”‚  â”‚                   â•±  â•²                               â”‚    â”‚
  â”‚  â”‚                  â•± ğŸ˜Š â•²   â† Delight!               â”‚    â”‚
  â”‚  â”‚                 â•±â”€â”€â”€â”€â”€â”€â•²                              â”‚    â”‚
  â”‚  â”‚                â•±  Usable â•²  â† Dá»… dÃ¹ng!             â”‚    â”‚
  â”‚  â”‚               â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²                            â”‚    â”‚
  â”‚  â”‚              â•±  Reliable   â•²  â† ÄÃ¡ng tin cáº­y!      â”‚    â”‚
  â”‚  â”‚             â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²                          â”‚    â”‚
  â”‚  â”‚            â•±   â˜… FAST! â˜…    â•²  â† NHANH! Ná»n táº£ng!â”‚    â”‚
  â”‚  â”‚           â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²                        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ FAST = Ná»€N Táº¢NG cá»§a má»i tráº£i nghiá»‡m!           â”‚    â”‚
  â”‚  â”‚ â†’ Trang CHáº¬M = user Bá» ÄI!                        â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Sá» LIá»†U BUSINESS:                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Load time    â”‚ User churn                           â”‚    â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚    â”‚
  â”‚  â”‚ 1-3 giÃ¢y     â”‚ 32% tÄƒng bounce rate!               â”‚    â”‚
  â”‚  â”‚ 1-5 giÃ¢y     â”‚ 90% tÄƒng bounce rate! â˜…            â”‚    â”‚
  â”‚  â”‚ > 5 giÃ¢y     â”‚ 90% USER Bá» ÄI! âŒ               â”‚    â”‚
  â”‚  â”‚ 1 giÃ¢y cháº­m  â”‚ Amazon máº¥t $1.6 Tá»¶/nÄƒm!          â”‚    â”‚
  â”‚  â”‚ 100ms cháº­m   â”‚ 1% giáº£m doanh sá»‘ (Walmart!)      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ PERFORMANCE = TIá»€N!                               â”‚    â”‚
  â”‚  â”‚ â†’ Má»—i millisecond Ä‘á»u CÃ“ GIÃ TRá»Š!               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§2. NguyÃªn Táº¯c Tá»‘i Æ¯u!

```
  NGUYÃŠN Táº®C:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â‘  KHÃ”NG Tá»I Æ¯U QUÃ Sá»šM!                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ "Premature optimization is the root of all evil"   â”‚    â”‚
  â”‚  â”‚                            â€” Donald Knuth           â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Internet = iterate nhanh, thá»­ sai nhanh!        â”‚    â”‚
  â”‚  â”‚ â†’ Tá»‘i Æ°u quÃ¡ sá»›m = LÃƒNG PHÃ effort!              â”‚    â”‚
  â”‚  â”‚ â†’ Feature chÆ°a cháº¯c cÃ²n giá»¯ láº¡i!                 â”‚    â”‚
  â”‚  â”‚ â†’ Æ¯u tiÃªn: SHIP FIRST â†’ optimize LATER!          â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¡ KHÃ”NG Tá»I Æ¯U QUÃ Má»¨C!                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Giai Ä‘oáº¡n khÃ¡c nhau = yÃªu cáº§u khÃ¡c nhau!       â”‚    â”‚
  â”‚  â”‚ â†’ 100 users â‰  1 triá»‡u users!                     â”‚    â”‚
  â”‚  â”‚ â†’ Äáº¡t performance ká»³ vá»ng = Äá»¦! Dá»«ng!           â”‚    â”‚
  â”‚  â”‚ â†’ Over-optimize = tá»‘n thá»i gian + phá»©c táº¡p hÃ³a!  â”‚    â”‚
  â”‚  â”‚ â†’ ROI (Return on Investment) pháº£i dÆ°Æ¡ng!          â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¢ ÄO LÆ¯á»œNG TRÆ¯á»šC KHI Tá»I Æ¯U!                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ "You can't optimize what you can't measure!"    â”‚    â”‚
  â”‚  â”‚ â†’ DÃ¹ng DevTools â†’ Performance tab!                 â”‚    â”‚
  â”‚  â”‚ â†’ Lighthouse â†’ audit score!                         â”‚    â”‚
  â”‚  â”‚ â†’ Web Vitals: LCP, FID, CLS!                      â”‚    â”‚
  â”‚  â”‚ â†’ TÃ¬m BOTTLENECK trÆ°á»›c â†’ tá»‘i Æ°u Ä‘Ãºng chá»—!      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§3. Rendering Chain â€” Tá»« URL Äáº¿n Pixels!

```
  RENDERING CHAIN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  CÃ‚U Há»I PHá»NG Váº¤N:                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ "Tá»« lÃºc gÃµ URL Ä‘áº¿n khi trang hiá»ƒn thá»‹,            â”‚    â”‚
  â”‚  â”‚  chuyá»‡n gÃ¬ xáº£y ra?"                                 â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  9 BÆ¯á»šC:                                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  URL Parsing â€” phÃ¢n tÃ­ch + encode URL!           â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘¡ Cache Check â€” kiá»ƒm tra cache browser!           â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘¢ DNS Resolution â€” domain â†’ IP address!           â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘£ TCP Connection â€” 3-way handshake!               â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘¤ HTTP Request â€” gá»­i request Ä‘áº¿n server!         â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘¥ Server Response â€” HTML + headers!               â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘¦ Parse HTML â€” request sub-resources (CSS/JS/img) â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘§ Render â€” DOM â†’ CSSOM â†’ Layout â†’ Paint!        â”‚    â”‚
  â”‚  â”‚       â†“                                              â”‚    â”‚
  â”‚  â”‚ â‘¨ TCP Close â€” 4-way wave!                         â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Tá»ª KHÃ“A Tá»I Æ¯U:                                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ URL: encoding + HSTS!                               â”‚    â”‚
  â”‚  â”‚ Cache: strong cache + conditional cache!            â”‚    â”‚
  â”‚  â”‚ DNS: prefetch + HTTPDNS!                            â”‚    â”‚
  â”‚  â”‚ TCP: keep-alive + preconnect!                       â”‚    â”‚
  â”‚  â”‚ HTTP: HTTP/2 multiplexing + compression!            â”‚    â”‚
  â”‚  â”‚ Server: CDN + GZIP + load balancing!               â”‚    â”‚
  â”‚  â”‚ Render: Critical Path + lazy load + defer/async!   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§4. URL Parsing + Encoding!

```
  URL PARSING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  URL STRUCTURE:                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ https://www.example.com:443/path?query=val#hash     â”‚    â”‚
  â”‚  â”‚ â”€â”€â”¬â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€ â”€â”¬â”€ â”€â”€â”¬â”€â”€ â”€â”€â”€â”€â”¬â”€â”€â”€â”€ â”€â”€â”¬â”€â”€  â”‚    â”‚
  â”‚  â”‚   â”‚           â”‚          â”‚    â”‚       â”‚        â”‚    â”‚    â”‚
  â”‚  â”‚ scheme     hostname    port  path   query    hash   â”‚    â”‚
  â”‚  â”‚ (protocol)  (domain)                (search) (frag) â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  ENCODING:                                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  encodeURI / decodeURI:                           â”‚    â”‚
  â”‚  â”‚   â†’ Encode TOÃ€N Bá»˜ URL!                           â”‚    â”‚
  â”‚  â”‚   â†’ CHá»ˆ encode: chá»¯ tiáº¿ng Viá»‡t, khoáº£ng tráº¯ng!   â”‚    â”‚
  â”‚  â”‚   â†’ KHÃ”NG encode: :, /, ?, #, &, =               â”‚    â”‚
  â”‚  â”‚   â†’ VD: "abc def" â†’ "abc%20def"                   â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¡ encodeURIComponent / decodeURIComponent:         â”‚    â”‚
  â”‚  â”‚   â†’ Encode Tá»ªNG PHáº¦N (parameter!)                  â”‚    â”‚
  â”‚  â”‚   â†’ CÃ“ encode: :, /, ?, #, &, = â† Táº¤T Cáº¢!     â”‚    â”‚
  â”‚  â”‚   â†’ KHÃ”NG dÃ¹ng cho toÃ n bá»™ URL!                   â”‚    â”‚
  â”‚  â”‚   â†’ CHá»ˆ dÃ¹ng cho THAM Sá»!                        â”‚    â”‚
  â”‚  â”‚   â†’ VD: "a=1&b=2" â†’ "a%3D1%26b%3D2"              â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  SO SÃNH:                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ KÃ½ tá»±   â”‚ encodeURI â”‚ encodeURIComponent           â”‚    â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚    â”‚
  â”‚  â”‚  :      â”‚ GIá»®A (:)  â”‚ ENCODE (%3A) â˜…              â”‚    â”‚
  â”‚  â”‚  /      â”‚ GIá»®A (/)  â”‚ ENCODE (%2F) â˜…              â”‚    â”‚
  â”‚  â”‚  ?      â”‚ GIá»®A (?)  â”‚ ENCODE (%3F) â˜…              â”‚    â”‚
  â”‚  â”‚  #      â”‚ GIá»®A (#)  â”‚ ENCODE (%23) â˜…              â”‚    â”‚
  â”‚  â”‚  &      â”‚ GIá»®A (&)  â”‚ ENCODE (%26) â˜…              â”‚    â”‚
  â”‚  â”‚  =      â”‚ GIá»®A (=)  â”‚ ENCODE (%3D) â˜…              â”‚    â”‚
  â”‚  â”‚  space  â”‚ %20       â”‚ %20                           â”‚    â”‚
  â”‚  â”‚  Viá»‡t   â”‚ %C4%90    â”‚ %C4%90                        â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§5. HSTS!

```
  HSTS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  HSTS = HTTP Strict Transport Security!                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Buá»™c browser dÃ¹ng HTTPS!                         â”‚    â”‚
  â”‚  â”‚ â†’ HTTP tá»± Ä‘á»™ng â†’ HTTPS!                           â”‚    â”‚
  â”‚  â”‚ â†’ KhÃ´ng cáº§n server redirect 301!                   â”‚    â”‚
  â”‚  â”‚ â†’ Browser tá»± rewrite trÆ°á»›c khi gá»­i request!      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  CÃCH HOáº T Äá»˜NG:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ KHÃ”NG CÃ“ HSTS:                                     â”‚    â”‚
  â”‚  â”‚ http://example.com                                  â”‚    â”‚
  â”‚  â”‚   â†’ Server 301 redirect â†’ https://example.com     â”‚    â”‚
  â”‚  â”‚   â†’ Máº¤T 1 round trip! (~100ms)                    â”‚    â”‚
  â”‚  â”‚   â†’ Dá»… bá»‹ táº¥n cÃ´ng man-in-the-middle!             â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CÃ“ HSTS:                                            â”‚    â”‚
  â”‚  â”‚ http://example.com                                  â”‚    â”‚
  â”‚  â”‚   â†’ Browser Tá»° REWRITE â†’ https://example.com     â”‚    â”‚
  â”‚  â”‚   â†’ KHÃ”NG gá»­i HTTP! Trá»±c tiáº¿p HTTPS!             â”‚    â”‚
  â”‚  â”‚   â†’ Tiáº¿t kiá»‡m 1 round trip! âœ…                   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  HEADER:                                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Strict-Transport-Security:                           â”‚    â”‚
  â”‚  â”‚   max-age=31536000;   â† 1 nÄƒm!                    â”‚    â”‚
  â”‚  â”‚   includeSubDomains;  â† cáº£ sub-domain!            â”‚    â”‚
  â”‚  â”‚   preload             â† Chrome preload list!       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§6. DNS Resolution + Tá»‘i Æ¯u!

```
  DNS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  DNS = Domain Name System!                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Domain â†’ IP address!                             â”‚    â”‚
  â”‚  â”‚ â†’ "nike.com" â†’ 104.16.51.111                      â”‚    â”‚
  â”‚  â”‚ â†’ MÃ¡y tÃ­nh chá»‰ hiá»ƒu IP, khÃ´ng hiá»ƒu domain!      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  QUY TRÃŒNH:                                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  Browser DNS cache                                â”‚    â”‚
  â”‚  â”‚    â†“ miss                                            â”‚    â”‚
  â”‚  â”‚ â‘¡ OS DNS cache (/etc/hosts)                        â”‚    â”‚
  â”‚  â”‚    â†“ miss                                            â”‚    â”‚
  â”‚  â”‚ â‘¢ Router DNS cache                                 â”‚    â”‚
  â”‚  â”‚    â†“ miss                                            â”‚    â”‚
  â”‚  â”‚ â‘£ ISP DNS server                                   â”‚    â”‚
  â”‚  â”‚    â†“ miss                                            â”‚    â”‚
  â”‚  â”‚ â‘¤ Root â†’ TLD (.com) â†’ Auth DNS â†’ IP! âœ…         â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Tá»I Æ¯U:                                                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  dns-prefetch:                                    â”‚    â”‚
  â”‚  â”‚   <link rel="dns-prefetch" href="//cdn.example.com">â”‚   â”‚
  â”‚  â”‚   â†’ Resolve DNS TRÆ¯á»šC khi cáº§n! 0ms khi request!   â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¡ Giáº£m sá»‘ domain:                                  â”‚    â”‚
  â”‚  â”‚   â†’ Má»—i domain = 1 DNS lookup!                    â”‚    â”‚
  â”‚  â”‚   â†’ Ãt domain = Ã­t lookup!                         â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¢ HTTPDNS:                                          â”‚    â”‚
  â”‚  â”‚   â†’ Bypass ISP DNS! DÃ¹ng HTTP query DNS server!    â”‚    â”‚
  â”‚  â”‚   â†’ TrÃ¡nh DNS hijacking!                           â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§7. HTTP/1.1 â€” Content-Type!

```
  HTTP/1.1 CONTENT-TYPE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  HTTP = Hypertext Transfer Protocol!                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Quy táº¯c giao tiáº¿p Browser â†” Server!            â”‚    â”‚
  â”‚  â”‚ â†’ Truyá»n Báº¤T Ká»² loáº¡i data! (dÃ¹ng Content-Type!)  â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  3 CONTENT-TYPE QUAN TRá»ŒNG:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  application/x-www-form-urlencoded                â”‚    â”‚
  â”‚  â”‚   â†’ Form submission Máº¶C Äá»ŠNH!                      â”‚    â”‚
  â”‚  â”‚   â†’ Encode: key=val&key2=val2                       â”‚    â”‚
  â”‚  â”‚   â†’ Key + Value Ä‘á»u URL encoded!                   â”‚    â”‚
  â”‚  â”‚   â†’ DÃ¹ng: <form> submit, simple data!              â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¡ multipart/form-data                               â”‚    â”‚
  â”‚  â”‚   â†’ Upload FILE!                                    â”‚    â”‚
  â”‚  â”‚   â†’ new FormData() â†’ KHÃ”NG set Content-Type!       â”‚    â”‚
  â”‚  â”‚   â†’ Browser tá»± set boundary!                        â”‚    â”‚
  â”‚  â”‚   â†’ âš ï¸ Set thá»§ cÃ´ng = Lá»–I truyá»n data!          â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¢ application/json                                  â”‚    â”‚
  â”‚  â”‚   â†’ JSON.stringify(data)!                           â”‚    â”‚
  â”‚  â”‚   â†’ Phá»• biáº¿n NHáº¤T hiá»‡n nay! â˜…                    â”‚    â”‚
  â”‚  â”‚   â†’ API communication standard!                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  HTTP/1.1 Váº¤N Äá»€:                                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  Head-of-line blocking!                            â”‚    â”‚
  â”‚  â”‚   â†’ Request PHáº¢I Ä‘á»£i response trÆ°á»›c khi gá»­i tiáº¿p!â”‚    â”‚
  â”‚  â”‚   â†’ Tuáº§n tá»±! CHáº¬M!                                â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¡ 6 connections / domain limit!                     â”‚    â”‚
  â”‚  â”‚   â†’ Max 6 TCP connections song song!                â”‚    â”‚
  â”‚  â”‚   â†’ 7+ requests = pháº£i CHá»œA!                       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¢ Header khÃ´ng nÃ©n!                                â”‚    â”‚
  â”‚  â”‚   â†’ Má»—i request: ~800 bytes header!               â”‚    â”‚
  â”‚  â”‚   â†’ Cookie, User-Agent... GIá»NG NHAU má»—i láº§n!    â”‚    â”‚
  â”‚  â”‚   â†’ LÃƒNG PHÃ bandwidth!                            â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§8. HTTP/2 â€” 4 Features!

```
  HTTP/2:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â‘  BINARY FRAMING â€” Truyá»n Nhá»‹ PhÃ¢n!                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ HTTP/1.1: text protocol (Ä‘á»c Ä‘Æ°á»£c!)                â”‚    â”‚
  â”‚  â”‚ HTTP/2:   binary frames (hiá»‡u quáº£ hÆ¡n!)           â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ HTTP/1.1:                                           â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚    â”‚
  â”‚  â”‚ â”‚ GET /index.html HTTP/1.1â”‚ â† TEXT!               â”‚    â”‚
  â”‚  â”‚ â”‚ Host: example.com       â”‚                        â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ HTTP/2:                                              â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
  â”‚  â”‚ â”‚HEADERS â”‚â”‚ DATA   â”‚â”‚ DATA   â”‚ â† BINARY FRAMES!  â”‚    â”‚
  â”‚  â”‚ â”‚frame   â”‚â”‚frame 1 â”‚â”‚frame 2 â”‚                     â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
  â”‚  â”‚ â†’ Chia nhá» thÃ nh frames!                           â”‚    â”‚
  â”‚  â”‚ â†’ Encode nhá»‹ phÃ¢n!                                 â”‚    â”‚
  â”‚  â”‚ â†’ Parse nhanh hÆ¡n!                                 â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¡ HEADER COMPRESSION â€” NÃ©n Header! (HPACK!)                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ HTTP/1.1: header PLAIN TEXT, má»—i request láº·p láº¡i! â”‚    â”‚
  â”‚  â”‚ HTTP/2:   HPACK compression!                        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CÃ¡ch nÃ©n:                                            â”‚    â”‚
  â”‚  â”‚ â˜… Static Table: 61 header phá»• biáº¿n pre-defined!   â”‚    â”‚
  â”‚  â”‚   â†’ ":method: GET" = index 2!                      â”‚    â”‚
  â”‚  â”‚   â†’ Gá»­i Sá» thay vÃ¬ TEXT!                          â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Dynamic Table: header custom, cache láº¡i!        â”‚    â”‚
  â”‚  â”‚   â†’ Láº§n 1: gá»­i Ä‘áº§y Ä‘á»§ + lÆ°u!                    â”‚    â”‚
  â”‚  â”‚   â†’ Láº§n 2+: gá»­i INDEX! Tiáº¿t kiá»‡m 95%+!          â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ User-Agent, Cookie KHÃ”NG láº·p láº¡i ná»¯a! âœ…       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¢ MULTIPLEXING â€” GhÃ©p KÃªnh!                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ HTTP/1.1:                                           â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”              â”‚    â”‚
  â”‚  â”‚ â”‚Req 1  â”‚â”€â”€â”€â”€â†’â”‚Res 1  â”‚â”€â”€â”€â”€â†’â”‚Req 2  â”‚â”€â”€â†’...       â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚
  â”‚  â”‚ â†’ TUáº¦N Tá»°! Req 2 Äá»¢I Res 1!                     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ HTTP/2:                                              â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”              â”‚    â”‚
  â”‚  â”‚ â”‚R1 â”‚ â”‚R2 â”‚ â”‚R3 â”‚ â”‚S1 â”‚ â”‚S2 â”‚ â”‚S3 â”‚              â”‚    â”‚
  â”‚  â”‚ â””â”€â”¬â”€â”˜ â””â”€â”¬â”€â”˜ â””â”€â”¬â”€â”˜ â””â”€â”¬â”€â”˜ â””â”€â”¬â”€â”˜ â””â”€â”¬â”€â”˜              â”‚    â”‚
  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜                â”‚    â”‚
  â”‚  â”‚              1 TCP connection!                         â”‚    â”‚
  â”‚  â”‚ â†’ SONG SONG! Táº¥t cáº£ trÃªn 1 connection! â˜…         â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG head-of-line blocking!                      â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG giá»›i háº¡n 6 connections!                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘£ SERVER PUSH â€” Server Äáº©y TÃ i NguyÃªn!                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ HTTP/1.1:                                           â”‚    â”‚
  â”‚  â”‚ â†’ Client request HTML                               â”‚    â”‚
  â”‚  â”‚ â†’ Parse â†’ tháº¥y CSS â†’ request CSS                  â”‚    â”‚
  â”‚  â”‚ â†’ Parse â†’ tháº¥y JS â†’ request JS                   â”‚    â”‚
  â”‚  â”‚ â†’ 3 round trips!                                    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ HTTP/2 Server Push:                                  â”‚    â”‚
  â”‚  â”‚ â†’ Client request HTML                               â”‚    â”‚
  â”‚  â”‚ â†’ Server tráº£ HTML + PUSH CSS + PUSH JS!           â”‚    â”‚
  â”‚  â”‚ â†’ 1 round trip! â˜…                                  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ âš ï¸ CHá»ˆ static resources! KhÃ´ng push dynamic data! â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  SO SÃNH:                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
  â”‚  â”‚              â”‚ HTTP/1.1      â”‚ HTTP/2  â˜…     â”‚            â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
  â”‚  â”‚ Format       â”‚ Text          â”‚ Binary! â˜…     â”‚            â”‚
  â”‚  â”‚ Header       â”‚ Plain, láº·p!  â”‚ HPACK nÃ©n! â˜…  â”‚            â”‚
  â”‚  â”‚ Connection   â”‚ 6/domain      â”‚ 1 (multiplex!)â”‚            â”‚
  â”‚  â”‚ Blocking     â”‚ HOL blocking! â”‚ KHÃ”NG! â˜…      â”‚            â”‚
  â”‚  â”‚ Server Push  â”‚ âŒ            â”‚ âœ… (static!)  â”‚            â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§9. HTTP Caching â€” Strong vs Conditional!

```
  HTTP CACHING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  QUY TRÃŒNH CACHE:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Browser          Cache            Server             â”‚    â”‚
  â”‚  â”‚   â”‚â”€â”€ Request â”€â”€â†’â”‚                  â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚ CÃ³ cache?        â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚ CÃ²n háº¡n?         â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚                  â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚ CÃ“ + CÃ’N Háº N:                 â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚â†â”€ Return cache (200 from disk)  â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚  KHÃ”NG há»i server! â˜…          â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚                                 â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚ CÃ“ + Háº¾T Háº N:                 â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚â”€â”€ If-None-Matchâ”€â”€â†’â”‚               â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚â†â”€â”€ 304! â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚    â”‚
  â”‚  â”‚   â”‚â†â”€ Return cache               â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚                                 â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚ KHÃ”NG CÃ“:                       â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚â”€â”€ Full request â”€â”€â†’â”‚               â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚â†â”€â”€ 200 + data â”€â”€â”€â”‚               â”‚    â”‚
  â”‚  â”‚   â”‚              â”‚ LÆ°u cache!       â”‚                â”‚    â”‚
  â”‚  â”‚   â”‚â†â”€ Return data                 â”‚                â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘  STRONG CACHE (Cache Máº¡nh!):                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ KHÃ”NG há»i server! DÃ¹ng local cache TRá»°C TIáº¾P!  â”‚    â”‚
  â”‚  â”‚ â†’ Status: 200 OK (from disk cache / from memory)  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Expires (HTTP/1.0):                               â”‚    â”‚
  â”‚  â”‚   Expires: Mon, 06 Apr 2020 12:08:42 GMT            â”‚    â”‚
  â”‚  â”‚   â†’ So sÃ¡nh vá»›i client time! â† SAI náº¿u lá»‡ch!     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Cache-Control (HTTP/1.1):  â† Æ¯U TIÃŠN HÆ N!     â”‚    â”‚
  â”‚  â”‚   Cache-Control: max-age=3600  â† 1 giá»!           â”‚    â”‚
  â”‚  â”‚   â†’ Äáº¿m GIÃ‚Y tá»« lÃºc nháº­n response!               â”‚    â”‚
  â”‚  â”‚   â†’ ChÃ­nh xÃ¡c hÆ¡n Expires!                         â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Cáº£ 2 cÃ³? Cache-Control Æ¯U TIÃŠN! (má»›i hÆ¡n!)   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¡ CONDITIONAL CACHE (Cache CÃ³ Äiá»u Kiá»‡n!):                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Strong cache Háº¾T Háº N â†’ há»i server!            â”‚    â”‚
  â”‚  â”‚ â†’ "File cÃ³ thay Ä‘á»•i khÃ´ng?"                       â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG thay Ä‘á»•i? â†’ 304 Not Modified! DÃ¹ng cache!â”‚    â”‚
  â”‚  â”‚ â†’ CÃ“ thay Ä‘á»•i? â†’ 200 + data má»›i!                â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Last-Modified / If-Modified-Since:                â”‚    â”‚
  â”‚  â”‚   Server: Last-Modified: Wed, 25 Mar 2020 08:33:53 â”‚    â”‚
  â”‚  â”‚   Client: If-Modified-Since: Wed, 25 Mar 2020...   â”‚    â”‚
  â”‚  â”‚   â†’ So sÃ¡nh thá»i gian sá»­a file!                  â”‚    â”‚
  â”‚  â”‚   â†’ ChÃ­nh xÃ¡c Ä‘áº¿n GIÃ‚Y!                           â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… ETag / If-None-Match:  â† Æ¯U TIÃŠN HÆ N!         â”‚    â”‚
  â”‚  â”‚   Server: ETag: "5e7b16bd-a0ba"                     â”‚    â”‚
  â”‚  â”‚   Client: If-None-Match: "5e7b16bd-a0ba"           â”‚    â”‚
  â”‚  â”‚   â†’ Unique ID cá»§a file! Hash content!              â”‚    â”‚
  â”‚  â”‚   â†’ ChÃ­nh xÃ¡c hÆ¡n Last-Modified! â˜…               â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Cáº£ 2 cÃ³? ETag Æ¯U TIÃŠN! (chÃ­nh xÃ¡c hÆ¡n!)      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¢ DISABLE CACHE:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Cache-Control: no-cache, no-store, max-age=0,       â”‚    â”‚
  â”‚  â”‚                must-revalidate                        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ no-store: HOÃ€N TOÃ€N Táº®T cache! Data thay Ä‘á»•i liÃªnâ”‚    â”‚
  â”‚  â”‚           tá»¥c! KHÃ”NG lÆ°u gÃ¬ cáº£!                    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ no-cache: CÃ“ cache nhÆ°ng LUÃ”N há»i server trÆ°á»›c!  â”‚    â”‚
  â”‚  â”‚           Server nÃ³i OK â†’ dÃ¹ng cache (304)!        â”‚    â”‚
  â”‚  â”‚           Server nÃ³i má»›i â†’ download má»›i (200)!     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Client trick: thÃªm timestamp!                       â”‚    â”‚
  â”‚  â”‚ GET /api/data?t=1614567890                          â”‚    â”‚
  â”‚  â”‚ â†’ URL má»›i má»—i láº§n â†’ cache KHÃ”NG match!           â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§10. TCP â€” 3-Way Handshake + 4-Way Wave!

```
  TCP:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â‘  3-WAY HANDSHAKE (Má»Ÿ káº¿t ná»‘i!):                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ (Chá»§ Ä‘á»™ng)                       (Bá»‹ Ä‘á»™ng)          â”‚    â”‚
  â”‚  â”‚ Client                         Server                â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚    â”‚
  â”‚  â”‚ â”‚ CLOSED â”‚                     â”‚ CLOSED â”‚            â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚ LISTEN          â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚ (chá» káº¿t ná»‘i!) â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â”€â”€â”€ SYN=1, seq=x â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  â‘               â”‚    â”‚
  â”‚  â”‚     â”‚    "TÃ´i muá»‘n káº¿t ná»‘i!"      â”‚                  â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
  â”‚  â”‚ â”‚SYN-SENTâ”‚                     â”‚ SYN-RCVD â”‚          â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€ SYN=1,ACK=1,seq=y,ack=x+1â”‚  â‘¡              â”‚    â”‚
  â”‚  â”‚     â”‚   "OK! TÃ´i cÅ©ng muá»‘n!"     â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â”€â”€â”€ ACK=1, seq=x+1, ack=y+1â”€â†’â”‚  â‘¢              â”‚    â”‚
  â”‚  â”‚     â”‚   "XÃ¡c nháº­n! Báº¯t Ä‘áº§u!"    â”‚                  â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
  â”‚  â”‚ â”‚ESTABLISHEDâ”‚                 â”‚ESTABLISHEDâ”‚          â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
  â”‚  â”‚     â”‚â†â•â•â•â•â•â•â•â• DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚                 â”‚    â”‚
  â”‚  â”‚     â”‚â•â•â•â•â•â•â•â•â• DATA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â†’â”‚                 â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Táº I SAO 3 BÆ¯á»šC? KhÃ´ng pháº£i 2?                    â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
  â”‚  â”‚ â”‚ BÆ°á»›c 1: Client â†’ Server = Server biáº¿t       â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚         Client NGHE + NÃ“I Ä‘Æ°á»£c!              â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ BÆ°á»›c 2: Server â†’ Client = Client biáº¿t       â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚         Server NGHE + NÃ“I Ä‘Æ°á»£c!              â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ BÆ°á»›c 3: Client â†’ Server = Server biáº¿t       â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚         Client NGHE ÄÆ¯á»¢C response!            â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚                                                â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ â†’ 2 bÆ°á»›c? Server KHÃ”NG biáº¿t client nháº­n Ä‘Æ°á»£c! â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ â†’ Gá»­i data â†’ máº¥t! NGUY HIá»‚M! âŒ             â”‚    â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¡ 4-WAY WAVE (ÄÃ³ng káº¿t ná»‘i!):                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ (Chá»§ Ä‘á»™ng)                       (Bá»‹ Ä‘á»™ng Ä‘Ã³ng)    â”‚    â”‚
  â”‚  â”‚ Client                         Server                â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
  â”‚  â”‚ â”‚ESTABLISHEDâ”‚                 â”‚ESTABLISHEDâ”‚          â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
  â”‚  â”‚     â”‚â•â•â•â•â•â•â• Äang truyá»n data â•â•â•â•â•â•â”‚                â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â”€â”€â”€ FIN=1, seq=u â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  â‘               â”‚    â”‚
  â”‚  â”‚     â”‚   "TÃ´i gá»­i xong rá»“i!"      â”‚                  â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
  â”‚  â”‚ â”‚FIN_WAIT_1â”‚                   â”‚CLOSE_WAITâ”‚          â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€ ACK=1, seq=v, ack=u+1 â”€â”€â”€â”€â”‚  â‘¡              â”‚    â”‚
  â”‚  â”‚     â”‚   "Biáº¿t rá»“i! NhÆ°ng Äá»¢I!"  â”‚                  â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚                  â”‚    â”‚
  â”‚  â”‚ â”‚FIN_WAIT_2â”‚                      â”‚                  â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                      â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚ â† Server Gá»¬I   â”‚    â”‚
  â”‚  â”‚     â”‚â†â•â•â• DATA cÃ²n láº¡i! â•â•â•â•â•â•â•â•â•â•â”‚    Ná»T data!   â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€ FIN=1, seq=w, ack=u+1 â”€â”€â”€â”€â”‚  â‘¢              â”‚    â”‚
  â”‚  â”‚     â”‚   "OK tÃ´i cÅ©ng xong!"      â”‚                  â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
  â”‚  â”‚ â”‚TIME_WAIT â”‚                   â”‚ LAST_ACK â”‚          â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
  â”‚  â”‚     â”‚                              â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚â”€â”€â”€ ACK=1, seq=u+1, ack=w+1â”€â†’â”‚  â‘£              â”‚    â”‚
  â”‚  â”‚     â”‚   "OK! Bye bye!"            â”‚                  â”‚    â”‚
  â”‚  â”‚     â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”              â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”                        â”‚CLOSEDâ”‚              â”‚    â”‚
  â”‚  â”‚ â”‚ç­‰å¾…  â”‚ â† 2 MSL!              â””â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚
  â”‚  â”‚ â”‚2 MSLâ”‚                                               â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”¬â”€â”€â”€â”˜                                               â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”                                               â”‚    â”‚
  â”‚  â”‚ â”‚CLOSEDâ”‚ â† Cuá»‘i cÃ¹ng Ä‘Ã³ng!                          â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜                                               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â˜… Táº I SAO 4 BÆ¯á»šC? KhÃ´ng pháº£i 3?                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ 3-way handshake: SYN+ACK Gá»˜P CHUNG  Ä‘Æ°á»£c!         â”‚    â”‚
  â”‚  â”‚   â†’ Server vá»«a xÃ¡c nháº­n Vá»ªA yÃªu cáº§u!              â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ 4-way wave: ACK vÃ  FIN KHÃ”NG Gá»˜P Ä‘Æ°á»£c!             â”‚    â”‚
  â”‚  â”‚   â†’ Server nháº­n FIN (client xong!)                  â”‚    â”‚
  â”‚  â”‚   â†’ ACK ngay (biáº¿t rá»“i!)                            â”‚    â”‚
  â”‚  â”‚   â†’ NHÆ¯NG server CÃ’N DATA chÆ°a gá»­i!               â”‚    â”‚
  â”‚  â”‚   â†’ Pháº£i gá»­i Ná»T data trÆ°á»›c!                      â”‚    â”‚
  â”‚  â”‚   â†’ Gá»­i xong Má»šI FIN! (tÃ´i cÅ©ng xong!)           â”‚    â”‚
  â”‚  â”‚   â†’ Náº¿u gá»™p ACK+FIN? Máº¥t data! âŒ                 â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â˜… TIME_WAIT + 2MSL:                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ MSL = Maximum Segment Lifetime (thá»i gian sá»‘ng tá»‘i  â”‚    â”‚
  â”‚  â”‚       Ä‘a cá»§a 1 packet trÃªn máº¡ng!) (~30s â†’ 2min)     â”‚    â”‚
  â”‚  â”‚ 2MSL = 2 Ã— MSL = ~1-4 phÃºt!                        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Táº I SAO pháº£i Ä‘á»£i?                                   â”‚    â”‚
  â”‚  â”‚ â‘  Äáº£m báº£o ACK cuá»‘i Tá»šI server!                   â”‚    â”‚
  â”‚  â”‚   â†’ Náº¿u ACK máº¥t? Server gá»­i láº¡i FIN!              â”‚    â”‚
  â”‚  â”‚   â†’ Client pháº£i CÃ’N Sá»NG Ä‘á»ƒ nháº­n + ACK láº¡i!       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¡ Packets CÅ¨ háº¿t háº¡n!                               â”‚    â”‚
  â”‚  â”‚   â†’ Packets tá»« connection cÅ© cÃ²n láº¡c trÃªn máº¡ng!    â”‚    â”‚
  â”‚  â”‚   â†’ 2MSL = Ä‘á»§ thá»i gian Ä‘á»ƒ Táº¤T Cáº¢ háº¿t háº¡n!      â”‚    â”‚
  â”‚  â”‚   â†’ Connection Má»šI khÃ´ng nháº­n packets CÅ¨!          â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Tá»I Æ¯U:                                                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â˜… Keep-Alive: giá»¯ connection Má»! TÃ¡i sá»­ dá»¥ng!   â”‚    â”‚
  â”‚  â”‚   â†’ Connection: keep-alive (HTTP/1.1 máº·c Ä‘á»‹nh!)   â”‚    â”‚
  â”‚  â”‚   â†’ KHÃ”NG Ä‘Ã³ng sau má»—i request! Tiáº¿t kiá»‡m!       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Preconnect: TCP + TLS trÆ°á»›c!                     â”‚    â”‚
  â”‚  â”‚   â†’ <link rel="preconnect" href="//api.example.com">â”‚   â”‚
  â”‚  â”‚   â†’ Handshake TRÆ¯á»šC khi cáº§n!                       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… HTTP/2: 1 connection cho Táº¤T Cáº¢ requests!       â”‚    â”‚
  â”‚  â”‚   â†’ 1 handshake duy nháº¥t! Multiplexing!            â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§11. CDN!

```
  CDN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  CDN = Content Delivery Network!                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Máº¡ng phÃ¢n phá»‘i ná»™i dung!                         â”‚    â”‚
  â”‚  â”‚ â†’ Static resources Ä‘áº·t á»Ÿ SERVER Gáº¦N user!         â”‚    â”‚
  â”‚  â”‚ â†’ User táº£i tá»« server Gáº¦N NHáº¤T! Nhanh hÆ¡n!       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘  KHÃ”NG CÃ“ CDN (Truyá»n thá»‘ng!):                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   User â”€â”€â”€â”€â”€â”€â”€â‘  www.cdn.netâ”€â”€â”€â”€â”€â”€â†’ DNS Server       â”‚    â”‚
  â”‚  â”‚   (VN)           (tÃªn miá»n)         â”‚                â”‚    â”‚
  â”‚  â”‚     â”‚                                â”‚                â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€â”€â”€â”€â”€â”€â‘¡ 210.163.10.100 â”€â”€â”€â”€â”€â”€â”€â”‚ (IP tráº£ vá»)  â”‚    â”‚
  â”‚  â”‚     â”‚                                                â”‚    â”‚
  â”‚  â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â‘¢ 210.163.10.100 â”€â”€â”€â”€â”€â”€â†’ Website        â”‚    â”‚
  â”‚  â”‚     â”‚          (connect!)            Server (US!)    â”‚    â”‚
  â”‚  â”‚     â”‚                                â”‚                â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€â”€â”€â”€â”€â”€â‘£ Responseâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚    â”‚
  â”‚  â”‚     â”‚          (HTML/CSS/JS/IMG)                      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   â†’ User VN â†’ Server US = ~200ms latency! CHáº¬M! âŒâ”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¡ CÃ“ CDN (Edge Node Acceleration!):                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   User â”€â”€â”€â”€â‘  www.cdn.netâ”€â”€â†’ DNS Server              â”‚    â”‚
  â”‚  â”‚   (VN)        (tÃªn miá»n)     â”‚                       â”‚    â”‚
  â”‚  â”‚     â”‚                         â”‚â”€â”€â”€â‘¡ CNAMEâ”€â”€â†’ CDN    â”‚    â”‚
  â”‚  â”‚     â”‚                                     ChuyÃªn Dá»¥ngâ”‚    â”‚
  â”‚  â”‚     â”‚                                     DNS Server â”‚    â”‚
  â”‚  â”‚     â”‚                                       â”‚         â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€â”€ â‘¢ CDN Edge IP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚    â”‚
  â”‚  â”‚     â”‚       (server Gáº¦N NHáº¤T!)                       â”‚    â”‚
  â”‚  â”‚     â”‚                                                â”‚    â”‚
  â”‚  â”‚     â”‚â”€â”€â”€â‘£ Connect â”€â”€â†’ CDN Load Balancer             â”‚    â”‚
  â”‚  â”‚     â”‚                   â”‚                             â”‚    â”‚
  â”‚  â”‚     â”‚                   â”‚â”€â”€â‘¤â”€â”€â†’ Chá»n CDN Cache      â”‚    â”‚
  â”‚  â”‚     â”‚                            Server Tá»T NHáº¤T!   â”‚    â”‚
  â”‚  â”‚     â”‚                            â”‚                    â”‚    â”‚
  â”‚  â”‚     â”‚â†â”€â”€â‘¥ Responseâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (cache HIT!)      â”‚    â”‚
  â”‚  â”‚     â”‚                            â”‚                    â”‚    â”‚
  â”‚  â”‚     â”‚                      Náº¿u MISS:                  â”‚    â”‚
  â”‚  â”‚     â”‚                   â‘¦ â†’ Origin Server â†’ cache!  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   â†’ User VN â†’ CDN Singapore = ~20ms! â˜… NHANH 10x! â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¢ CDN CACHE HIT vs MISS:                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Cache HIT (nhanh!):                                  â”‚    â”‚
  â”‚  â”‚ User â†’ CDN Edge â†’ CÃ“ file! â†’ Tráº£ vá»! âœ…          â”‚    â”‚
  â”‚  â”‚ Latency: ~20ms                                       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Cache MISS (láº§n Ä‘áº§u!):                               â”‚    â”‚
  â”‚  â”‚ User â†’ CDN Edge â†’ KHÃ”NG cÃ³! â†’ Origin Server      â”‚    â”‚
  â”‚  â”‚        â†’ Download â†’ LÆ¯U cache â†’ Tráº£ vá»!          â”‚    â”‚
  â”‚  â”‚ Latency: ~200ms (láº§n Ä‘áº§u) â†’ ~20ms (láº§n sau!)      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Cache Invalidation:                                   â”‚    â”‚
  â”‚  â”‚ â†’ Deploy má»›i? Purge CDN cache!                      â”‚    â”‚
  â”‚  â”‚ â†’ File name hash: app.a1b2c3.js â†’ auto invalidate!â”‚    â”‚
  â”‚  â”‚ â†’ Cache-Control: max-age=31536000 cho hashed files!â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘£ CDN CHá»ŒN SERVER NHÆ¯ THáº¾ NÃ€O?                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Load Balancer xem xÃ©t:                               â”‚    â”‚
  â”‚  â”‚ â˜… Khoáº£ng cÃ¡ch Äá»ŠA LÃ (gáº§n nháº¥t!)               â”‚    â”‚
  â”‚  â”‚ â˜… Server LOAD (Ã­t táº£i nháº¥t!)                       â”‚    â”‚
  â”‚  â”‚ â˜… Tá»‘c Ä‘á»™ Máº NG (nhanh nháº¥t!)                       â”‚    â”‚
  â”‚  â”‚ â˜… Server HEALTH (khá»e máº¡nh!)                       â”‚    â”‚
  â”‚  â”‚ â†’ Káº¿t há»£p Táº¤T Cáº¢ â†’ chá»n OPTIMAL server!          â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  ÃP Dá»¤NG:                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â˜… Static resources: JS, CSS, images, fonts!       â”‚    â”‚
  â”‚  â”‚ â˜… Video streaming!                                  â”‚    â”‚
  â”‚  â”‚ â˜… KHÃ”NG cho dynamic API! (pháº£i vá» origin!)        â”‚    â”‚
  â”‚  â”‚ â†’ Providers: Cloudflare, AWS CloudFront, Akamai!   â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ âš ï¸ CDN Headers quan trá»ng:                         â”‚    â”‚
  â”‚  â”‚ â†’ X-Cache: HIT (tá»« CDN!) vs MISS (tá»« origin!)    â”‚    â”‚
  â”‚  â”‚ â†’ CF-Cache-Status: HIT / MISS / EXPIRED            â”‚    â”‚
  â”‚  â”‚ â†’ Age: 3600 (Ä‘Ã£ cache 1 giá»!)                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§12. GZIP â€” Response Compression!

```
  GZIP:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  GZIP = Compression Algorithm!                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ NÃ©n response body TRÆ¯á»šC khi gá»­i!                â”‚    â”‚
  â”‚  â”‚ â†’ Giáº£m 60-80% kÃ­ch thÆ°á»›c TEXT resources!          â”‚    â”‚
  â”‚  â”‚ â†’ HTML, CSS, JS, JSON â†’ nÃ©n cá»±c tá»‘t!             â”‚    â”‚
  â”‚  â”‚ â†’ Images, videos â†’ KHÃ”NG nÃ©n tá»‘t! (Ä‘Ã£ nÃ©n rá»“i!)â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  CÃCH HOáº T Äá»˜NG:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Client                         Server                â”‚    â”‚
  â”‚  â”‚   â”‚â”€ Accept-Encoding: gzip â”€â”€â”€â†’â”‚                    â”‚    â”‚
  â”‚  â”‚   â”‚  "TÃ´i cháº¥p nháº­n gzip!"    â”‚                    â”‚    â”‚
  â”‚  â”‚   â”‚                             â”‚ NÃ©n response!     â”‚    â”‚
  â”‚  â”‚   â”‚â†â”€ Content-Encoding: gzip â”€â”€â”‚                    â”‚    â”‚
  â”‚  â”‚   â”‚   (data Ä‘Ã£ nÃ©n!)           â”‚                    â”‚    â”‚
  â”‚  â”‚   â”‚                             â”‚                    â”‚    â”‚
  â”‚  â”‚   â”‚ Browser tá»± giáº£i nÃ©n! âœ…   â”‚                    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  âš ï¸ CHÃš Ã:                                          â”‚    â”‚
  â”‚  â”‚  â†’ Accept-Encoding: gzip, deflate, br              â”‚    â”‚
  â”‚  â”‚    (client liá»‡t kÃª Táº¤T Cáº¢ format hiá»ƒu Ä‘Æ°á»£c!)     â”‚    â”‚
  â”‚  â”‚  â†’ Server CHá»ŒN 1 format phÃ¹ há»£p nháº¥t!              â”‚    â”‚
  â”‚  â”‚  â†’ Náº¿u khÃ´ng há»— trá»£? Gá»­i KHÃ”NG NÃ‰N!               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  THUáº¬T TOÃN CHI TIáº¾T:                                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ GZIP = LZ77 + Huffman Coding!                       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… LZ77: TÃ¬m chuá»—i láº·p, Ä‘Ã¡nh dáº¥u, ghi vá»‹ trÃ­!   â”‚    â”‚
  â”‚  â”‚   Sliding Window (cá»­a sá»• trÆ°á»£t) = 32KB             â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   Input:  "ABCABCABC"                                â”‚    â”‚
  â”‚  â”‚   BÆ°á»›c 1: "ABC" â†’ ghi ABC (chÆ°a láº·p)              â”‚    â”‚
  â”‚  â”‚   BÆ°á»›c 2: "ABC" â†’ (3 chars back, length 3)!        â”‚    â”‚
  â”‚  â”‚   BÆ°á»›c 3: "ABC" â†’ (6 chars back, length 3)!        â”‚    â”‚
  â”‚  â”‚   Output: "ABC" + ref(3,3) + ref(6,3)               â”‚    â”‚
  â”‚  â”‚   â†’ 9 chars â†’ ~5 units! Tiáº¿t kiá»‡m! â˜…             â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â˜… Huffman: KÃ½ tá»± xuáº¥t hiá»‡n NHIá»€U = mÃ£ NGáº®N!       â”‚    â”‚
  â”‚  â”‚   Äáº¿m táº§n suáº¥t â†’ xÃ¢y Huffman Tree!                â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   VÃ­ dá»¥ "AAABBC":                                    â”‚    â”‚
  â”‚  â”‚   A: 3 láº§n â†’ mÃ£: 0      (1 bit!)                  â”‚    â”‚
  â”‚  â”‚   B: 2 láº§n â†’ mÃ£: 10     (2 bits!)                 â”‚    â”‚
  â”‚  â”‚   C: 1 láº§n â†’ mÃ£: 11     (2 bits!)                 â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   KhÃ´ng Huffman: 6 Ã— 8 = 48 bits!                   â”‚    â”‚
  â”‚  â”‚   CÃ³ Huffman:    3Ã—1 + 2Ã—2 + 1Ã—2 = 9 bits! â˜…      â”‚    â”‚
  â”‚  â”‚   â†’ Giáº£m 81%!                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Dá»® LIá»†U THá»°C Táº¾ (Production!):                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ File              â”‚ Original â”‚ GZIP    â”‚ Tá»· lá»‡    â”‚    â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€     â”‚    â”‚
  â”‚  â”‚ index.html        â”‚ 10.5 KB  â”‚ 4.1 KB  â”‚ 61% â˜…   â”‚    â”‚
  â”‚  â”‚ index-fa0...css   â”‚ 72.5 KB  â”‚ 13.5 KB â”‚ 82% â˜…â˜…  â”‚    â”‚
  â”‚  â”‚ index-47b...js    â”‚ 589 KB   â”‚ 195 KB  â”‚ 67% â˜…   â”‚    â”‚
  â”‚  â”‚ d497...ef.png     â”‚ 22.3 KB  â”‚ 22.5 KB â”‚ -1% âŒ  â”‚    â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ CSS: NÃ‰N Tá»T NHáº¤T! Nhiá»u pattern láº·p láº¡i!      â”‚    â”‚
  â”‚  â”‚   (class names, property names, { }, ;...)           â”‚    â”‚
  â”‚  â”‚ â†’ JS: nÃ©n tá»‘t! Nhiá»u keywords, identifiers!        â”‚    â”‚
  â”‚  â”‚ â†’ HTML: nÃ©n tá»‘t! Tags láº·p láº¡i!                    â”‚    â”‚
  â”‚  â”‚ â†’ PNG: TÄ‚NG SIZE! âŒ PNG Ä‘Ã£ nÃ©n (DEFLATE)!        â”‚    â”‚
  â”‚  â”‚   GZIP thÃªm header = Tá»’I Tá»† HÆ N!                  â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  GZIP vs BROTLI:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚              â”‚ GZIP       â”‚ Brotli (br) â˜…          â”‚    â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚    â”‚
  â”‚  â”‚ Tá»· lá»‡ nÃ©n  â”‚ 60-80%     â”‚ 70-90%! Tá»‘t hÆ¡n!      â”‚    â”‚
  â”‚  â”‚ Tá»‘c Ä‘á»™ nÃ©n â”‚ Nhanh      â”‚ Cháº­m hÆ¡n (nÃ©n!)       â”‚    â”‚
  â”‚  â”‚ Giáº£i nÃ©n   â”‚ Nhanh      â”‚ Nhanh (tÆ°Æ¡ng Ä‘á»‘i!)    â”‚    â”‚
  â”‚  â”‚ Há»— trá»£     â”‚ Má»i nÆ¡i!  â”‚ Browser hiá»‡n Ä‘áº¡i!     â”‚    â”‚
  â”‚  â”‚ DÃ¹ng khi    â”‚ Dynamic!   â”‚ Static + CDN! â˜…        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Brotli nÃ©n Tá»T HÆ N 15-25% so vá»›i GZIP!         â”‚    â”‚
  â”‚  â”‚ â†’ NhÆ°ng nÃ©n CHáº¬M HÆ N â†’ dÃ¹ng cho pre-compressed!  â”‚    â”‚
  â”‚  â”‚ â†’ CDN: pre-compress báº±ng Brotli â†’ serve trá»±c tiáº¿p!â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  NGINX CONFIG:                                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ gzip on;                                             â”‚    â”‚
  â”‚  â”‚ gzip_types text/plain text/css                       â”‚    â”‚
  â”‚  â”‚            application/javascript                     â”‚    â”‚
  â”‚  â”‚            application/json;                          â”‚    â”‚
  â”‚  â”‚ gzip_min_length 1024;   â† file < 1KB khÃ´ng nÃ©n!   â”‚    â”‚
  â”‚  â”‚ gzip_comp_level 6;      â† level 1-9 (6 = optimal!)â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ âš ï¸ gzip_comp_level:                                 â”‚    â”‚
  â”‚  â”‚ Level 1: nÃ©n Ã­t, CPU tháº¥p!                         â”‚    â”‚
  â”‚  â”‚ Level 6: balance tá»‘t! â˜… (máº·c Ä‘á»‹nh!)               â”‚    â”‚
  â”‚  â”‚ Level 9: nÃ©n max, CPU cao! (Ã­t dÃ¹ng!)              â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§13. Browser Rendering Pipeline!

```
  RENDERING PIPELINE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  FULL PIPELINE FLOW:                                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚    â”‚
  â”‚  â”‚  â”‚ HTML â”‚â”€â”€â†’â”‚  HTML   â”‚â”€â”€â†’â”‚ DOM Tree â”‚â”€â”€â”           â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜   â”‚ Parser â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚           â”‚    â”‚
  â”‚  â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â†‘         â”‚           â”‚    â”‚
  â”‚  â”‚                               â”‚         â”‚           â”‚    â”‚
  â”‚  â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”     â”‚           â”‚    â”‚
  â”‚  â”‚                            â”‚ DOM  â”‚     â”‚           â”‚    â”‚
  â”‚  â”‚                            â”‚(API) â”‚     â”‚           â”‚    â”‚
  â”‚  â”‚                            â””â”€â”€â”€â”€â”€â”€â”˜     â”‚           â”‚    â”‚
  â”‚  â”‚                                         â†“           â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚    â”‚
  â”‚  â”‚  â”‚  Style   â”‚â†’â”‚  CSS   â”‚â†’â”‚ Style Treeâ”‚            â”‚    â”‚
  â”‚  â”‚  â”‚  Sheets  â”‚ â”‚ Parser â”‚ â”‚  (CSSOM)  â”‚            â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚    â”‚
  â”‚  â”‚                                 â”‚                    â”‚    â”‚
  â”‚  â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚    â”‚
  â”‚  â”‚                      â”‚Attachmentâ”‚ â† DOM + CSSOM!   â”‚    â”‚
  â”‚  â”‚                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                    â”‚    â”‚
  â”‚  â”‚                           â†“                          â”‚    â”‚
  â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
  â”‚  â”‚                    â”‚Render Tree â”‚ â† Chá»‰ visible!   â”‚    â”‚
  â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
  â”‚  â”‚                           â†“                          â”‚    â”‚
  â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
  â”‚  â”‚                    â”‚  Layout    â”‚ â† TÃ­nh vá»‹ trÃ­!   â”‚    â”‚
  â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
  â”‚  â”‚                           â†“                          â”‚    â”‚
  â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
  â”‚  â”‚                    â”‚  Painting  â”‚ â† Váº½ pixels!     â”‚    â”‚
  â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
  â”‚  â”‚                           â†“                          â”‚    â”‚
  â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
  â”‚  â”‚                    â”‚  Display   â”‚ â† MÃ€N HÃŒNH! âœ…  â”‚    â”‚
  â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  5 BÆ¯á»šC CHI TIáº¾T:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  HTML â†’ DOM Tree!                                 â”‚    â”‚
  â”‚  â”‚   <html>                                             â”‚    â”‚
  â”‚  â”‚     <body>                                           â”‚    â”‚
  â”‚  â”‚       <h1>Title</h1>                                 â”‚    â”‚
  â”‚  â”‚       <p>Content</p>                                 â”‚    â”‚
  â”‚  â”‚     </body>                                          â”‚    â”‚
  â”‚  â”‚   </html>                                            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   â†’ DOM Tree:                                       â”‚    â”‚
  â”‚  â”‚     html                                             â”‚    â”‚
  â”‚  â”‚     â””â”€ body                                          â”‚    â”‚
  â”‚  â”‚        â”œâ”€ h1 â†’ "Title"                              â”‚    â”‚
  â”‚  â”‚        â””â”€ p â†’ "Content"                             â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   QuÃ¡ trÃ¬nh parse HTML:                               â”‚    â”‚
  â”‚  â”‚   Bytes â†’ Characters â†’ Tokens â†’ Nodes â†’ DOM!       â”‚    â”‚
  â”‚  â”‚   (raw)   (decode)    (lexer)  (parser)  (tree!)    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘¡ CSS â†’ CSSOM Tree!                                â”‚    â”‚
  â”‚  â”‚   h1 { color: red; }                                 â”‚    â”‚
  â”‚  â”‚   p  { font-size: 16px; }                            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   â†’ CSSOM Tree:                                     â”‚    â”‚
  â”‚  â”‚     body (inherited styles)                          â”‚    â”‚
  â”‚  â”‚     â”œâ”€ h1: color=red, display=block, font-weight=700â”‚    â”‚
  â”‚  â”‚     â””â”€ p:  font-size=16px, display=block            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   âš ï¸ CSSOM cÅ©ng parse giá»‘ng DOM:                   â”‚    â”‚
  â”‚  â”‚   Bytes â†’ Characters â†’ Tokens â†’ Nodes â†’ CSSOM!    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   â˜… CSS style cÃ³ CASCADING (thÃ¡c nÆ°á»›c):             â”‚    â”‚
  â”‚  â”‚   Browser default â†’ User agent â†’ Author â†’ Inline  â”‚    â”‚
  â”‚  â”‚   â†’ Äá»˜ Æ¯U TIÃŠN tÄƒng dáº§n!                         â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘¢ DOM + CSSOM â†’ Render Tree (Attachment)!          â”‚    â”‚
  â”‚  â”‚   â†’ Káº¿t há»£p STRUCTURE + STYLE!                    â”‚    â”‚
  â”‚  â”‚   â†’ display:none KHÃ”NG náº±m trong render tree!      â”‚    â”‚
  â”‚  â”‚   â†’ <head>, <script>, <meta> KHÃ”NG render!        â”‚    â”‚
  â”‚  â”‚   â†’ visibility:hidden CÃ“ trong render tree!        â”‚    â”‚
  â”‚  â”‚     (chiáº¿m khÃ´ng gian, chá»‰ áº©n visual!)            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   Render Tree:                                       â”‚    â”‚
  â”‚  â”‚   RenderBody                                         â”‚    â”‚
  â”‚  â”‚   â”œâ”€ RenderBlock (h1)                                â”‚    â”‚
  â”‚  â”‚   â”‚  color: red                                      â”‚    â”‚
  â”‚  â”‚   â”‚  text: "Title"                                   â”‚    â”‚
  â”‚  â”‚   â””â”€ RenderBlock (p)                                 â”‚    â”‚
  â”‚  â”‚      font-size: 16px                                 â”‚    â”‚
  â”‚  â”‚      text: "Content"                                 â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘£ Layout â€” TÃ­nh vá»‹ trÃ­ + kÃ­ch thÆ°á»›c!              â”‚    â”‚
  â”‚  â”‚   â†’ x, y, width, height cho má»—i element!           â”‚    â”‚
  â”‚  â”‚   â†’ Viewport = khung nhÃ¬n (device width!)           â”‚    â”‚
  â”‚  â”‚   â†’ % = tÃ­nh theo parent container!                 â”‚    â”‚
  â”‚  â”‚   â†’ Box Model: content + padding + border + margin! â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘¤ Paint + Composite!                                â”‚    â”‚
  â”‚  â”‚   â†’ Váº¼ pixels: color, border, shadow, text!        â”‚    â”‚
  â”‚  â”‚   â†’ Chia thÃ nh LAYERS (lá»›p)!                       â”‚    â”‚
  â”‚  â”‚   â†’ GPU composite layers â†’ MÃ€N HÃŒNH!              â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚   Paint Order: background â†’ border â†’ content       â”‚    â”‚
  â”‚  â”‚   â†’ outline â†’ children â†’ stacking context!         â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•      â”‚
  â”‚  REFLOW vs REPAINT â€” QUAN TRá»ŒNG!                              â”‚
  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•      â”‚
  â”‚                                                              â”‚
  â”‚  â˜… REFLOW (Layout láº¡i!) â€” Tá»N NHáº¤T! âŒâŒâŒ                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ = TÃ­nh Láº I vá»‹ trÃ­ + kÃ­ch thÆ°á»›c!                   â”‚    â”‚
  â”‚  â”‚ = Layout â†’ Paint â†’ Composite (TOÃ€N Bá»˜ láº¡i!)      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ GÃ¢y ra bá»Ÿi (TRIGGERS):                               â”‚    â”‚
  â”‚  â”‚ â†’ Thay Ä‘á»•i width, height, padding, margin!        â”‚    â”‚
  â”‚  â”‚ â†’ Thay Ä‘á»•i font-size, font-family!                â”‚    â”‚
  â”‚  â”‚ â†’ ThÃªm/xÃ³a DOM elements!                           â”‚    â”‚
  â”‚  â”‚ â†’ window.resize!                                    â”‚    â”‚
  â”‚  â”‚ â†’ Äá»c offsetWidth, clientHeight, scrollTop!        â”‚    â”‚
  â”‚  â”‚   â† Äá»ŒC cÅ©ng gÃ¢y reflow! VÃ¬ browser pháº£i tÃ­nh   â”‚    â”‚
  â”‚  â”‚      layout Má»šI NHáº¤T Ä‘á»ƒ tráº£ giÃ¡ trá»‹ chÃ­nh xÃ¡c!    â”‚    â”‚
  â”‚  â”‚ â†’ display: none â†” block!                           â”‚    â”‚
  â”‚  â”‚ â†’ position: static â†’ absolute!                     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ âš ï¸ Reflow LAN TRUYá»€N!                              â”‚    â”‚
  â”‚  â”‚ â†’ Parent reflow â†’ Táº¤T Cáº¢ children reflow!         â”‚    â”‚
  â”‚  â”‚ â†’ 1 element thay Ä‘á»•i â†’ cáº£ trang tÃ­nh láº¡i!        â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â˜… REPAINT (Váº½ láº¡i!) â€” ÃT Tá»N HÆ N âš¡                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ = Chá»‰ Váº¼ Láº I visual! KhÃ´ng tÃ­nh láº¡i layout!      â”‚    â”‚
  â”‚  â”‚ = Paint â†’ Composite (chá»‰ 2 bÆ°á»›c!)                 â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ GÃ¢y ra bá»Ÿi (TRIGGERS):                               â”‚    â”‚
  â”‚  â”‚ â†’ Thay Ä‘á»•i color, background-color!                â”‚    â”‚
  â”‚  â”‚ â†’ Thay Ä‘á»•i visibility!                              â”‚    â”‚
  â”‚  â”‚ â†’ Thay Ä‘á»•i box-shadow, text-decoration!           â”‚    â”‚
  â”‚  â”‚ â†’ Thay Ä‘á»•i outline!                                â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG thay Ä‘á»•i geometry â†’ KHÃ”NG cáº§n layout!     â”‚    â”‚
  â”‚  â”‚ â†’ Tá»‘n Ã­t hÆ¡n reflow NHIá»€U! â˜…                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â˜… COMPOSITE ONLY (GPU!) â€” NHANH NHáº¤T! â˜…â˜…â˜…                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ = Chá»‰ ghÃ©p layers! KHÃ”NG paint láº¡i!               â”‚    â”‚
  â”‚  â”‚ = GPU xá»­ lÃ½! â† NHANH VÃŒ HARDWARE!                â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Properties CHá»ˆ trigger composite:                    â”‚    â”‚
  â”‚  â”‚ â†’ transform: translate(), scale(), rotate()!       â”‚    â”‚
  â”‚  â”‚ â†’ opacity!                                           â”‚    â”‚
  â”‚  â”‚ â†’ filter!                                            â”‚    â”‚
  â”‚  â”‚ â†’ will-change: transform! â† promote lÃªn GPU layer!â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ DÃ™NG transform thay top/left cho animation! â˜…   â”‚    â”‚
  â”‚  â”‚ â†’ opacity thay visibility cho fade effect! â˜…       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  SO SÃNH:                                                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Reflow:    Layout â†’ Paint â†’ Composite  âŒ CHáº¬M!  â”‚    â”‚
  â”‚  â”‚ Repaint:          â†’ Paint â†’ Composite  âš¡ Táº¡m!   â”‚    â”‚
  â”‚  â”‚ Composite:                â†’ Composite  â˜… NHANH! â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  JS + CSS BLOCKING:                                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ <script> CHáº¶N HTML parsing!                        â”‚    â”‚
  â”‚  â”‚   â†’ Browser Dá»ªNG parse â†’ download â†’ execute!      â”‚    â”‚
  â”‚  â”‚   â†’ Giáº£i phÃ¡p: defer hoáº·c async!                  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ <script defer>:                                      â”‚    â”‚
  â”‚  â”‚   â†’ Download SONG SONG vá»›i HTML parsing!            â”‚    â”‚
  â”‚  â”‚   â†’ Execute SAU khi DOM loaded!                     â”‚    â”‚
  â”‚  â”‚   â†’ Theo THá»¨ Tá»°! script1 â†’ script2! â˜…            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ <script async>:                                      â”‚    â”‚
  â”‚  â”‚   â†’ Download SONG SONG!                              â”‚    â”‚
  â”‚  â”‚   â†’ Execute NGAY khi download xong!                 â”‚    â”‚
  â”‚  â”‚   â†’ KHÃ”NG Ä‘áº£m báº£o thá»© tá»±!                          â”‚    â”‚
  â”‚  â”‚   â†’ DÃ¹ng cho: analytics, ads (khÃ´ng phá»¥ thuá»™c DOM)â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CSS CHáº¶N rendering (khÃ´ng cháº·n parsing!)           â”‚    â”‚
  â”‚  â”‚   â†’ CSS pháº£i load xong trÆ°á»›c khi render!           â”‚    â”‚
  â”‚  â”‚   â†’ VÃ¬ render tree Cáº¦N CSSOM!                     â”‚    â”‚
  â”‚  â”‚   â†’ CSS á»Ÿ <head>! JS á»Ÿ cuá»‘i <body>!               â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Timeline:                                             â”‚    â”‚
  â”‚  â”‚ â”€â”€ HTML parse â”€â”€â”€ â† CSS CHáº¶N á»Ÿ Ä‘Ã¢y â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â”‚
  â”‚  â”‚ â”€â”€ CSS  download â”€â”‚â†’ CSSOM ready!              â”‚    â”‚
  â”‚  â”‚ â”€â”€ JS   download â”€â”€â”‚â†’ execute!                  â”‚    â”‚
  â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Render! Display!         â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Tá»I Æ¯U RENDER:                                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â˜… Critical CSS: inline CSS quan trá»ng trong <head>!â”‚    â”‚
  â”‚  â”‚   â†’ First paint KHÃ”NG cáº§n wait external CSS!       â”‚    â”‚
  â”‚  â”‚ â˜… Lazy load: images, below-the-fold content!      â”‚    â”‚
  â”‚  â”‚   â†’ loading="lazy" cho <img>!                      â”‚    â”‚
  â”‚  â”‚ â˜… Code splitting: chá»‰ load JS cáº§n thiáº¿t!         â”‚    â”‚
  â”‚  â”‚   â†’ React.lazy() + Suspense!                       â”‚    â”‚
  â”‚  â”‚ â˜… defer/async: khÃ´ng block parsing!                â”‚    â”‚
  â”‚  â”‚ â˜… Minimize reflow: batch DOM changes!              â”‚    â”‚
  â”‚  â”‚   â†’ DocumentFragment cho multiple inserts!         â”‚    â”‚
  â”‚  â”‚   â†’ cssText thay vÃ¬ tá»«ng property!                 â”‚    â”‚
  â”‚  â”‚   â†’ Äá»c layout props TRÆ¯á»šC, ghi SAU!              â”‚    â”‚
  â”‚  â”‚ â˜… requestAnimationFrame: smooth animations!       â”‚    â”‚
  â”‚  â”‚   â†’ Sync vá»›i browser refresh rate (60fps = 16ms!)  â”‚    â”‚
  â”‚  â”‚ â˜… will-change: GPU layer promotion!                â”‚    â”‚
  â”‚  â”‚   â†’ will-change: transform, opacity!               â”‚    â”‚
  â”‚  â”‚   â†’ âš ï¸ KHÃ”NG láº¡m dá»¥ng! Tá»‘n memory!              â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  WEB VITALS â€” ÄO LÆ¯á»œNG PERFORMANCE!                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ LCP (Largest Contentful Paint):                      â”‚    â”‚
  â”‚  â”‚   â†’ Thá»i gian element Lá»šN NHáº¤T render!            â”‚    â”‚
  â”‚  â”‚   â†’ Tá»‘t: < 2.5s! â˜…                                â”‚    â”‚
  â”‚  â”‚   â†’ LiÃªn quan: â‘ â‘¡â‘¢ (DOM, CSSOM, Render Tree!)    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ FID (First Input Delay) / INP:                       â”‚    â”‚
  â”‚  â”‚   â†’ Thá»i gian pháº£n há»“i tÆ°Æ¡ng tÃ¡c Äáº¦U TIÃŠN!       â”‚    â”‚
  â”‚  â”‚   â†’ Tá»‘t: < 100ms! â˜…                               â”‚    â”‚
  â”‚  â”‚   â†’ LiÃªn quan: JS blocking! Main thread busy!      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CLS (Cumulative Layout Shift):                       â”‚    â”‚
  â”‚  â”‚   â†’ Layout NHáº¢Y bao nhiÃªu! (visual instability!)   â”‚    â”‚
  â”‚  â”‚   â†’ Tá»‘t: < 0.1! â˜…                                 â”‚    â”‚
  â”‚  â”‚   â†’ LiÃªn quan: â‘£ Layout! Image/font chÆ°a load!    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§14. SÆ¡ Äá»“ Tá»± Váº½!

### SÆ¡ Äá»“ 1: Full Rendering Chain

```
  RENDERING CHAIN â€” URL â†’ PIXELS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â‘  URL Input + Parse                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
  â”‚  â”‚ https://nike.com â”‚ â†’ encode! HSTS check!                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘¡ Cache Check                                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ Strong cache? â†’ 200 (from disk) â†’ DONEâ”‚                 â”‚
  â”‚  â”‚ Miss? â†“                                 â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘¢ DNS Resolution (~20ms)                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ Browser â†’ OS â†’ Router â†’ ISP â†’ Root   â”‚                 â”‚
  â”‚  â”‚ "nike.com" â†’ 104.16.51.111            â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘£ TCP 3-Way Handshake (~30ms)                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ SYN â†’ SYN+ACK â†’ ACK â†’ Connected!     â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘¤ TLS Handshake (~100ms) â€” náº¿u HTTPS!                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ ClientHello â†’ ServerHello â†’ Encrypted!â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘¥ HTTP Request â†’ CDN / Origin Server                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ GET /page â†’ 200 OK + GZIP HTML!       â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘¦ Conditional Cache (náº¿u strong expired)                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ If-None-Match â†’ 304? â†’ dÃ¹ng cache!   â”‚                 â”‚
  â”‚  â”‚ 200? â†’ download má»›i!                   â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘§ Browser Rendering                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ HTML â†’ DOM â†’ CSSOM â†’ Render Tree      â”‚                 â”‚
  â”‚  â”‚ â†’ Layout â†’ Paint â†’ Composite â†’ ğŸ–¥ï¸   â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚          â†“                                                   â”‚
  â”‚  â‘¨ TCP 4-Way Wave                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
  â”‚  â”‚ FIN â†’ ACK â†’ FIN â†’ ACK â†’ Closed!      â”‚                 â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SÆ¡ Äá»“ 2: HTTP Caching Flow

```
  HTTP CACHING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Browser â”€â”€â”€ Request â”€â”€â†’ Cache?                              â”‚
  â”‚                            â”‚                                 â”‚
  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
  â”‚              â”‚ CÃ³ cache?                  â”‚                   â”‚
  â”‚              â”œâ”€â”€ CÃ“ â”€â”€â”     â”œâ”€â”€ KHÃ”NG â”€â”€â”â”‚                  â”‚
  â”‚              â”‚         â”‚     â”‚            â”‚â”‚                  â”‚
  â”‚              â”‚   CÃ²n háº¡n?    â”‚   Server â”€â”€â”˜â”‚                  â”‚
  â”‚              â”‚    â”‚    â”‚     â”‚   200 + data â”‚                  â”‚
  â”‚              â”‚  CÃ“  KHÃ”NG   â”‚   + lÆ°u cacheâ”‚                  â”‚
  â”‚              â”‚    â”‚    â”‚     â”‚              â”‚                  â”‚
  â”‚              â”‚  200    â”‚     â”‚              â”‚                  â”‚
  â”‚              â”‚ (disk)  â”‚     â”‚              â”‚                  â”‚
  â”‚              â”‚ â˜…FAST! â”‚     â”‚              â”‚                  â”‚
  â”‚              â”‚         â”‚     â”‚              â”‚                  â”‚
  â”‚              â”‚   Há»i Server:â”‚              â”‚                  â”‚
  â”‚              â”‚   ETag/Last-Mâ”‚              â”‚                  â”‚
  â”‚              â”‚    â”‚         â”‚              â”‚                  â”‚
  â”‚              â”‚  â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”  â”‚              â”‚                  â”‚
  â”‚              â”‚  â”‚Changed?â”‚  â”‚              â”‚                  â”‚
  â”‚              â”‚  â”œâ”€â”€â”  â”Œâ”€â”€â”¤  â”‚              â”‚                  â”‚
  â”‚              â”‚ KHÃ”NG  CÃ“   â”‚              â”‚                  â”‚
  â”‚              â”‚  304    200   â”‚              â”‚                  â”‚
  â”‚              â”‚(dÃ¹ng   (data  â”‚              â”‚                  â”‚
  â”‚              â”‚cache!) má»›i!) â”‚              â”‚                  â”‚
  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                  â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SÆ¡ Äá»“ 3: HTTP/1.1 vs HTTP/2

```
  HTTP/1.1 vs HTTP/2:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  HTTP/1.1 BASELINE:          HTTP/2 MULTIPLEXING:            â”‚
  â”‚                                                              â”‚
  â”‚  â‘  Open Connection           â‘  Open Connection              â”‚
  â”‚  â”‚                           â”‚                              â”‚
  â”‚  â‘¡ GET /index.html           â‘¡ GET /index.html              â”‚
  â”‚  â”‚                           â”‚                              â”‚
  â”‚  â‘¢ â† RESPONSE               â‘¢ â† RESPONSE                  â”‚
  â”‚  â”‚  (pháº£i Äá»¢I!)            â”‚                              â”‚
  â”‚  â‘£ GET /styles.css           â‘£ GET /styles.css              â”‚
  â”‚  â”‚  (Má»šI gá»­i Ä‘Æ°á»£c!)        â”‚  GET /scripts.js â† SONG SONGâ”‚
  â”‚  â‘¤ â† RESPONSE               â”‚                              â”‚
  â”‚  â”‚  (Äá»¢I tiáº¿p!)            â‘¤ â† RESPONSE (cáº£ 2!)         â”‚
  â”‚  â‘¥ GET /scripts.js           â”‚  â† RESPONSE                 â”‚
  â”‚  â”‚                           â”‚                              â”‚
  â”‚  â‘¦ â† RESPONSE               â‘¥ Client Renders Page          â”‚
  â”‚  â”‚                           â”‚                              â”‚
  â”‚  â‘§ Client Renders Page      â‘¦ Connection Remains Open      â”‚
  â”‚  â”‚                           â”‚                              â”‚
  â”‚  â‘¨ Connection Closed         â”‚                              â”‚
  â”‚                                                              â”‚
  â”‚  â†’ HTTP/1.1: TUáº¦N Tá»°!      â†’ HTTP/2: SONG SONG! â˜…       â”‚
  â”‚  â†’ 9 bÆ°á»›c                   â†’ 7 bÆ°á»›c                      â”‚
  â”‚  â†’ Cháº­m hÆ¡n!               â†’ Nhanh hÆ¡n! âœ…               â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SÆ¡ Äá»“ 4: GZIP Compression

```
  GZIP:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  KHÃ”NG NÃ‰N:                                                   â”‚
  â”‚  Client â†â”€â”€â”€â”€â”€ 265 KB â”€â”€â”€â”€â”€â”€â”€â”€ Server                       â”‚
  â”‚  (jquery.js)   (cháº­m! tá»‘n bandwidth!)                       â”‚
  â”‚                                                              â”‚
  â”‚  CÃ“ GZIP:                                                    â”‚
  â”‚  Client â†â”€â”€â”€â”€â”€â”€ 85 KB â”€â”€â”€â”€â”€â”€â”€â”€ Server                       â”‚
  â”‚  (jquery.js)   (nhanh! -68%!)  (nÃ©n rá»“i!)                  â”‚
  â”‚                                                              â”‚
  â”‚  File         Original  GZIP    Giáº£m                        â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€                       â”‚
  â”‚  jquery.js    265 KB    85 KB   68% â˜…                       â”‚
  â”‚  bootstrap    195 KB    28 KB   86% â˜…â˜…                      â”‚
  â”‚  index.html   50 KB     10 KB   80% â˜…                       â”‚
  â”‚  photo.jpg    200 KB    195 KB  2.5% âŒ (Ä‘Ã£ nÃ©n!)          â”‚
  â”‚                                                              â”‚
  â”‚  â†’ TEXT resources: NÃ‰N Tá»T! âœ…                              â”‚
  â”‚  â†’ Image/video: KHÃ”NG hiá»‡u quáº£! âŒ                          â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SÆ¡ Äá»“ 5: Performance Optimization Map

```
  PERFORMANCE OPTIMIZATION MAP:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€ NETWORK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â”‚ DNS      â†’ dns-prefetch, HTTPDNS, reduce domains  â”‚     â”‚
  â”‚  â”‚ TCP      â†’ preconnect, keep-alive, HTTP/2         â”‚     â”‚
  â”‚  â”‚ TLS      â†’ session resumption, HSTS              â”‚     â”‚
  â”‚  â”‚ HTTP     â†’ multiplexing, header compression       â”‚     â”‚
  â”‚  â”‚ Cache    â†’ strong cache + conditional cache       â”‚     â”‚
  â”‚  â”‚ CDN      â†’ edge servers, static resources        â”‚     â”‚
  â”‚  â”‚ GZIP     â†’ compress text resources               â”‚     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€ RENDERING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â”‚ Critical  â†’ inline critical CSS                    â”‚     â”‚
  â”‚  â”‚ JS Block  â†’ defer / async                          â”‚     â”‚
  â”‚  â”‚ CSS Block â†’ <head>, minimize                       â”‚     â”‚
  â”‚  â”‚ Reflow    â†’ batch DOM changes                      â”‚     â”‚
  â”‚  â”‚ Lazy Load â†’ images, below-fold                     â”‚     â”‚
  â”‚  â”‚ Code Splitâ†’ chá»‰ load JS cáº§n thiáº¿t                â”‚     â”‚
  â”‚  â”‚ Bundle    â†’ tree-shaking, minify                   â”‚     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€ RESOURCE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â”‚ Images   â†’ WebP, lazy load, responsive            â”‚     â”‚
  â”‚  â”‚ Fonts    â†’ font-display: swap                      â”‚     â”‚
  â”‚  â”‚ Icons    â†’ SVG sprite, icon font                   â”‚     â”‚
  â”‚  â”‚ Preload  â†’ <link rel="preload">                   â”‚     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§15. Tá»± Viáº¿t â€” PerfOptEngine!

```javascript
/**
 * PerfOptEngine â€” MÃ´ phá»ng Performance Optimization!
 * Tá»± viáº¿t báº±ng tay, KHÃ”NG dÃ¹ng thÆ° viá»‡n!
 */
var PerfOptEngine = (function () {
  var log = [];
  function reset() {
    log = [];
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 1. URL PARSER + ENCODER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function parseURL(url) {
    log.push("=== URL PARSING ===");
    var match = url.match(
      /^(https?):\/\/([^:\/]+)(?::(\d+))?(\/[^?#]*)?(\?[^#]*)?(#.*)?$/,
    );
    if (!match) {
      log.push("[URL] Invalid URL: " + url);
      return null;
    }
    var result = {
      protocol: match[1],
      hostname: match[2],
      port: match[3] || (match[1] === "https" ? "443" : "80"),
      pathname: match[4] || "/",
      search: match[5] || "",
      hash: match[6] || "",
    };
    log.push("[URL] protocol: " + result.protocol);
    log.push("[URL] hostname: " + result.hostname);
    log.push("[URL] port: " + result.port);
    log.push("[URL] pathname: " + result.pathname);
    log.push("[URL] search: " + result.search);
    log.push("[URL] hash: " + result.hash);
    return result;
  }

  function encodeParam(key, value) {
    // simplified encodeURIComponent
    var encoded = key.replace(/[^a-zA-Z0-9]/g, function (c) {
      return "%" + c.charCodeAt(0).toString(16).toUpperCase();
    });
    var encodedVal = value.replace(/[^a-zA-Z0-9]/g, function (c) {
      return "%" + c.charCodeAt(0).toString(16).toUpperCase();
    });
    log.push(
      "[Encode] " + key + "=" + value + " â†’ " + encoded + "=" + encodedVal,
    );
    return encoded + "=" + encodedVal;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 2. HSTS CHECK
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var hstsHosts = {};

  function hstsCheck(url) {
    log.push("=== HSTS CHECK ===");
    var parsed = url.match(/^(https?):\/\/([^\/]+)/);
    if (!parsed) return url;
    var protocol = parsed[1];
    var host = parsed[2];

    if (protocol === "http" && hstsHosts[host]) {
      var newUrl = url.replace("http://", "https://");
      log.push("[HSTS] " + url + " â†’ " + newUrl + " (auto redirect!)");
      return newUrl;
    }
    log.push("[HSTS] " + url + " (no HSTS, as-is)");
    return url;
  }

  function enableHSTS(host) {
    hstsHosts[host] = true;
    log.push("[HSTS] Enabled for: " + host);
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 3. HTTP CACHE SIMULATOR
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var cache = {};

  function httpRequest(url, headers) {
    headers = headers || {};
    log.push("=== HTTP CACHE ===");

    // Check strong cache
    if (cache[url]) {
      var entry = cache[url];
      var now = Date.now();
      var age = (now - entry.timestamp) / 1000;

      if (age < entry.maxAge) {
        log.push("[Cache] STRONG HIT! " + url);
        log.push(
          "[Cache] Age: " + Math.round(age) + "s / " + entry.maxAge + "s",
        );
        log.push("[Cache] â†’ 200 OK (from disk cache) â˜…");
        return { status: 200, source: "disk-cache", data: entry.data };
      }

      // Strong expired â†’ conditional cache
      log.push("[Cache] Strong EXPIRED! " + url);
      log.push("[Cache] Age: " + Math.round(age) + "s > " + entry.maxAge + "s");

      if (entry.etag) {
        log.push("[Cache] â†’ If-None-Match: " + entry.etag);
        // Simulate server check
        var changed = Math.random() > 0.7;
        if (!changed) {
          log.push("[Cache] â†’ 304 Not Modified!");
          log.push("[Cache] â†’ DÃ¹ng cache! âœ…");
          entry.timestamp = now;
          return { status: 304, source: "conditional", data: entry.data };
        }
        log.push("[Cache] â†’ Resource CHANGED! 200 + new data");
      }
    } else {
      log.push("[Cache] MISS! " + url);
    }

    // Full request
    var data = "<html>Response for " + url + "</html>";
    var etag = '"' + Math.random().toString(36).slice(2, 10) + '"';
    cache[url] = {
      data: data,
      etag: etag,
      maxAge: 3600,
      timestamp: Date.now(),
    };
    log.push("[Cache] â†’ 200 OK (from server)");
    log.push("[Cache] â†’ Stored! max-age=3600, ETag=" + etag);
    return { status: 200, source: "server", data: data };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 4. GZIP SIMULATOR
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function gzipCompress(data, type) {
    log.push("=== GZIP ===");
    var original = data.length;
    var ratio;

    if (type === "js" || type === "css" || type === "html") {
      ratio = 0.3; // ~70% reduction for text!
    } else if (type === "json") {
      ratio = 0.25;
    } else {
      ratio = 0.97; // images: almost no reduction
    }

    var compressed = Math.round(original * ratio);
    var reduction = Math.round((1 - ratio) * 100);

    log.push("[GZIP] Type: " + type);
    log.push("[GZIP] Original: " + original + " bytes");
    log.push("[GZIP] Compressed: " + compressed + " bytes");
    log.push(
      "[GZIP] Reduction: " + reduction + "%" + (reduction > 50 ? " â˜…" : " âŒ"),
    );

    return { original: original, compressed: compressed, reduction: reduction };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 5. RENDERING PIPELINE
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function renderPipeline(html) {
    log.push("=== RENDERING PIPELINE ===");

    log.push("[Render] â‘  Parse HTML â†’ DOM Tree");
    var domNodes = (html.match(/<[^\/][^>]*>/g) || []).length;
    log.push("[Render]    DOM nodes: ~" + domNodes);

    log.push("[Render] â‘¡ Parse CSS â†’ CSSOM Tree");
    log.push("[Render] â‘¢ DOM + CSSOM â†’ Render Tree");
    log.push("[Render]    (display:none elements excluded!)");

    log.push("[Render] â‘£ Layout: x, y, width, height");
    log.push("[Render] â‘¤ Paint + Composite â†’ Screen! âœ…");

    return { domNodes: domNodes };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 6. HTTP/2 vs HTTP/1.1 COMPARISON
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function compareProtocols(resources) {
    log.push("=== HTTP/1.1 vs HTTP/2 ===");

    // HTTP/1.1: sequential, 6 connections max
    log.push("");
    log.push("--- HTTP/1.1 ---");
    var http1Time = 0;
    var concurrent = 6;
    var batches = Math.ceil(resources.length / concurrent);
    for (var b = 0; b < batches; b++) {
      var batchSize = Math.min(concurrent, resources.length - b * concurrent);
      var maxTime = 0;
      for (var i = 0; i < batchSize; i++) {
        var idx = b * concurrent + i;
        var time = 50 + Math.floor(Math.random() * 100);
        log.push(
          "[HTTP/1.1] Batch " +
            (b + 1) +
            ": " +
            resources[idx] +
            " (" +
            time +
            "ms)",
        );
        if (time > maxTime) maxTime = time;
      }
      http1Time += maxTime;
    }
    log.push(
      "[HTTP/1.1] Total: ~" +
        http1Time +
        "ms" +
        " (" +
        batches +
        " batches, max 6 concurrent!)",
    );

    // HTTP/2: all parallel on 1 connection
    log.push("");
    log.push("--- HTTP/2 ---");
    var http2MaxTime = 0;
    for (var j = 0; j < resources.length; j++) {
      var t = 50 + Math.floor(Math.random() * 100);
      log.push("[HTTP/2] Parallel: " + resources[j] + " (" + t + "ms)");
      if (t > http2MaxTime) http2MaxTime = t;
    }
    log.push(
      "[HTTP/2] Total: ~" + http2MaxTime + "ms (ALL parallel! 1 connection!) â˜…",
    );

    log.push("");
    log.push("â†’ HTTP/1.1: " + http1Time + "ms");
    log.push("â†’ HTTP/2:   " + http2MaxTime + "ms");
    log.push(
      "â†’ HTTP/2 nhanh hÆ¡n ~" +
        Math.round(((http1Time - http2MaxTime) / http1Time) * 100) +
        "%! â˜…",
    );

    return { http1: http1Time, http2: http2MaxTime };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 7. FULL PAGE LOAD SIMULATION
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function simulatePageLoad(url, options) {
    options = options || {};
    log.push("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    log.push("â•‘  PAGE LOAD SIMULATION                â•‘");
    log.push("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");

    var totalTime = 0;

    // 1. URL Parse
    parseURL(url);

    // 2. HSTS
    log.push("");
    url = hstsCheck(url);

    // 3. Cache
    log.push("");
    var cached = httpRequest(url);
    if (cached.source === "disk-cache") {
      log.push("");
      log.push("â˜… Cache hit! Skipping network!");
      renderPipeline(cached.data);
      log.push("");
      log.push("TOTAL: ~5ms (cache!)");
      return { time: 5, source: "cache" };
    }

    // 4. DNS (~20ms)
    log.push("");
    log.push("[DNS] Resolving... (~20ms)");
    totalTime += options.dnsPrefetch ? 0 : 20;

    // 5. TCP (~30ms)
    log.push("");
    log.push("[TCP] 3-way handshake... (~30ms)");
    totalTime += options.preconnect ? 0 : 30;

    // 6. TLS (~100ms)
    if (url.indexOf("https") === 0) {
      log.push("");
      log.push("[TLS] Handshake... (~100ms)");
      totalTime += options.preconnect ? 0 : 100;
    }

    // 7. HTTP Response (~100ms)
    log.push("");
    log.push("[HTTP] Response received (~100ms)");
    totalTime += 100;

    // 8. GZIP
    log.push("");
    gzipCompress("x".repeat(50000), "html");

    // 9. Render (~300ms)
    log.push("");
    renderPipeline(cached.data);
    totalTime += 300;

    log.push("");
    log.push("TOTAL: ~" + totalTime + "ms");
    if (options.dnsPrefetch) log.push("  (dns-prefetch saved ~20ms!)");
    if (options.preconnect) log.push("  (preconnect saved ~130ms!)");

    return { time: totalTime };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // DEMO
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function demo() {
    console.log("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘  PerfOpt ENGINE â€” DEMO                      â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");

    // 1. URL Parse
    console.log("\n--- 1. URL PARSE ---");
    reset();
    parseURL("https://www.example.com:443/path?q=hello#top");
    log.forEach(function (l) {
      console.log("  " + l);
    });

    // 2. Encode
    console.log("\n--- 2. ENCODE ---");
    reset();
    encodeParam("name", "Nguyá»…n VÄƒn A");
    encodeParam("query", "a=1&b=2");
    log.forEach(function (l) {
      console.log("  " + l);
    });

    // 3. HSTS
    console.log("\n--- 3. HSTS ---");
    reset();
    enableHSTS("example.com");
    hstsCheck("http://example.com/page");
    log.forEach(function (l) {
      console.log("  " + l);
    });

    // 4. Cache
    console.log("\n--- 4. HTTP CACHE ---");
    reset();
    cache = {};
    httpRequest("/api/data"); // miss
    log.forEach(function (l) {
      console.log("  " + l);
    });
    reset();
    httpRequest("/api/data"); // hit!
    log.forEach(function (l) {
      console.log("  " + l);
    });

    // 5. GZIP
    console.log("\n--- 5. GZIP ---");
    reset();
    gzipCompress("x".repeat(265000), "js");
    gzipCompress("x".repeat(200000), "jpg");
    log.forEach(function (l) {
      console.log("  " + l);
    });

    // 6. HTTP/2 vs 1.1
    console.log("\n--- 6. HTTP/2 vs HTTP/1.1 ---");
    reset();
    compareProtocols([
      "index.html",
      "styles.css",
      "app.js",
      "vendor.js",
      "logo.png",
      "fonts.woff",
      "icons.svg",
      "analytics.js",
    ]);
    log.forEach(function (l) {
      console.log("  " + l);
    });

    // 7. Full page load
    console.log("\n--- 7. PAGE LOAD (no optimization) ---");
    reset();
    cache = {};
    simulatePageLoad("https://www.example.com/page");
    log.forEach(function (l) {
      console.log("  " + l);
    });

    console.log("\n--- 8. PAGE LOAD (with optimization) ---");
    reset();
    cache = {};
    simulatePageLoad("https://www.example.com/page", {
      dnsPrefetch: true,
      preconnect: true,
    });
    log.forEach(function (l) {
      console.log("  " + l);
    });

    console.log("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘  âœ… Demo Complete!                           â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
  }

  return {
    parseURL: parseURL,
    encodeParam: encodeParam,
    hstsCheck: hstsCheck,
    enableHSTS: enableHSTS,
    httpRequest: httpRequest,
    gzipCompress: gzipCompress,
    renderPipeline: renderPipeline,
    compareProtocols: compareProtocols,
    simulatePageLoad: simulatePageLoad,
    demo: demo,
    reset: reset,
  };
})();

// Cháº¡y: PerfOptEngine.demo();
```

---

## Â§16. CÃ¢u Há»i Luyá»‡n Táº­p!

### â“ CÃ¢u 1: Rendering chain gá»“m nhá»¯ng bÆ°á»›c nÃ o?

**Tráº£ lá»i:**

```
â‘  URL Parsing + Encoding + HSTS!
â‘¡ Cache Check (strong cache â†’ conditional cache!)
â‘¢ DNS Resolution (domain â†’ IP!)
â‘£ TCP 3-Way Handshake (SYN â†’ SYN+ACK â†’ ACK!)
â‘¤ TLS Handshake (náº¿u HTTPS!)
â‘¥ HTTP Request â†’ Server / CDN Response!
â‘¦ GZIP Decompress!
â‘§ Parse HTML â†’ DOM â†’ CSSOM â†’ Render Tree
   â†’ Layout â†’ Paint â†’ Composite â†’ Screen!
â‘¨ TCP 4-Way Wave (FIN â†’ ACK â†’ FIN â†’ ACK!)
```

Má»—i bÆ°á»›c = cÆ¡ há»™i tá»‘i Æ°u!

### â“ CÃ¢u 2: Strong cache vs Conditional cache?

**Tráº£ lá»i:**

|                 | Strong Cache            | Conditional Cache    |
| --------------- | ----------------------- | -------------------- |
| **Há»i server?** | âŒ KHÃ”NG!               | âœ… CÃ“!               |
| **Status**      | 200 (from disk)         | 304 Not Modified     |
| **Header**      | Cache-Control, Expires  | ETag, Last-Modified  |
| **Æ¯u tiÃªn**     | Cache-Control > Expires | ETag > Last-Modified |
| **Khi nÃ o?**    | Cache cÃ²n háº¡n!          | Cache Háº¾T háº¡n!       |

- **no-store**: hoÃ n toÃ n Táº®T cache!
- **no-cache**: cache nhÆ°ng LUÃ”N há»i server trÆ°á»›c!

### â“ CÃ¢u 3: HTTP/2 tá»‘i Æ°u gÃ¬ so vá»›i HTTP/1.1?

**Tráº£ lá»i:**

| Feature         | HTTP/1.1          | HTTP/2                 |
| --------------- | ----------------- | ---------------------- |
| **Format**      | Text              | Binary frames! â˜…       |
| **Header**      | Plain, láº·p láº¡i    | HPACK nÃ©n! â˜…           |
| **Connections** | 6/domain, tuáº§n tá»± | 1 (multiplexing!) â˜…    |
| **Blocking**    | Head-of-line!     | KHÃ”NG! â˜…               |
| **Server Push** | âŒ                | âœ… (static resources!) |

**Multiplexing** = táº¥t cáº£ requests/responses trÃªn **1 TCP connection**, **song song**, khÃ´ng blocking!

### â“ CÃ¢u 4: encodeURI vs encodeURIComponent?

**Tráº£ lá»i:**

- **encodeURI**: encode TOÃ€N Bá»˜ URL! KHÃ”NG encode `:`, `/`, `?`, `#`, `&`, `=`!
- **encodeURIComponent**: encode Tá»ªNG THAM Sá»! CÃ“ encode táº¥t cáº£ special chars!
- â†’ encodeURIComponent KHÃ”NG DÃ™NG cho toÃ n bá»™ URL! (vÃ¬ encode cáº£ `/`!)
- â†’ Chá»‰ dÃ¹ng cho **giÃ¡ trá»‹ tham sá»‘**!

### â“ CÃ¢u 5: GZIP hoáº¡t Ä‘á»™ng tháº¿ nÃ o?

**Tráº£ lá»i:**

- Client gá»­i: `Accept-Encoding: gzip` â€” "TÃ´i hiá»ƒu gzip!"
- Server nÃ©n response + tráº£: `Content-Encoding: gzip`
- Browser **tá»± giáº£i nÃ©n**!
- Thuáº­t toÃ¡n: **LZ77** (tÃ¬m chuá»—i láº·p) + **Huffman** (kÃ½ tá»± thÆ°á»ng = mÃ£ ngáº¯n!)
- TEXT: giáº£m **60-80%**! â˜… Images: giáº£m **~2%** âŒ (Ä‘Ã£ nÃ©n rá»“i!)

### â“ CÃ¢u 6: CDN lÃ  gÃ¬? Tá»‘i Æ°u tháº¿ nÃ o?

**Tráº£ lá»i:**

- CDN = Content Delivery Network! Máº¡ng phÃ¢n phá»‘i ná»™i dung!
- Static resources â†’ lÆ°u á»Ÿ **edge server Gáº¦N user**!
- User táº£i tá»« server **Gáº¦N NHáº¤T** â†’ giáº£m latency **10x**!
- VD: User VN â†’ CDN Singapore (20ms) thay vÃ¬ Origin US (200ms)!
- DÃ¹ng cho: JS, CSS, images, fonts, video!
- **KHÃ”NG cho**: dynamic API (pháº£i vá» origin server!)

### â“ CÃ¢u 7: TCP táº¡i sao 3-way handshake vÃ  4-way wave?

**Tráº£ lá»i:**

**3-way handshake** (Má»):

- SYN â†’ SYN+ACK â†’ ACK!
- 3 bÆ°á»›c = **cáº£ 2 bÃªn** Ä‘á»u xÃ¡c nháº­n **nghe + nÃ³i** Ä‘Æ°á»£c!
- 2 bÆ°á»›c? Server khÃ´ng biáº¿t client nghe Ä‘Æ°á»£c! âŒ

**4-way wave** (ÄÃ“NG):

- FIN â†’ ACK â†’ FIN â†’ ACK!
- 4 bÆ°á»›c vÃ¬ **server CÃ’N DATA chÆ°a gá»­i**!
- Server nháº­n FIN â†’ ACK (biáº¿t rá»“i!) â†’ gá»­i ná»‘t data â†’ FIN (tÃ´i xong!)
- 3 bÆ°á»›c? Máº¥t data! âŒ Äáº£m báº£o data **Äáº¦Y Äá»¦**!

---

> ğŸ¯ **Tá»•ng káº¿t Performance Optimization:**
>
> - **NguyÃªn táº¯c**: khÃ´ng quÃ¡ sá»›m, khÃ´ng quÃ¡ má»©c, Ä‘o lÆ°á»ng trÆ°á»›c!
> - **Rendering chain**: URL â†’ Cache â†’ DNS â†’ TCP â†’ TLS â†’ HTTP â†’ Render!
> - **URL**: encodeURI (URL) vs encodeURIComponent (params)!
> - **HSTS**: tá»± Ä‘á»™ng HTTP â†’ HTTPS, tiáº¿t kiá»‡m 1 round trip!
> - **DNS**: dns-prefetch, HTTPDNS, giáº£m domains!
> - **HTTP/1.1**: 6 connections, HOL blocking, header láº·p!
> - **HTTP/2**: binary frames, HPACK, multiplexing, server push!
> - **Cache**: Strong (200 disk) > Conditional (304) > No cache!
> - **TCP**: 3-way handshake (má»Ÿ), 4-way wave (Ä‘Ã³ng)!
> - **CDN**: edge servers gáº§n user â†’ giáº£m latency 10x!
> - **GZIP**: nÃ©n text 60-80%! LZ77 + Huffman!
> - **Render**: DOM â†’ CSSOM â†’ Render Tree â†’ Layout â†’ Paint â†’ Composite!
> - **PerfOptEngine** tá»± viáº¿t: URL, HSTS, cache, GZIP, HTTP/2 compare, page load sim!
> - **7 cÃ¢u há»i** luyá»‡n táº­p vá»›i Ä‘Ã¡p Ã¡n chi tiáº¿t!
