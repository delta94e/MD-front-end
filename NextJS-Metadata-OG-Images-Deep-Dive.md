# Next.js Metadata & OG Images â€” Deep Dive!

> **Chá»§ Ä‘á»**: Metadata vÃ  Open Graph Images trong Next.js App Router
> **NgÃ´n ngá»¯**: Tiáº¿ng Viá»‡t â€” giáº£i thÃ­ch cá»±c ká»³ chi tiáº¿t!
> **PhÆ°Æ¡ng chÃ¢m**: Tá»± viáº¿t láº¡i báº±ng tay â€” KHÃ”NG dÃ¹ng thÆ° viá»‡n!
> **Nguá»“n**: https://nextjs.org/docs/app/getting-started/metadata-and-og-images

---

## Má»¥c Lá»¥c

1. [Â§1. Tá»•ng Quan â€” Metadata APIs](#1)
2. [Â§2. Default Fields â€” Meta Tags Máº·c Äá»‹nh](#2)
3. [Â§3. Static Metadata â€” Export Object](#3)
4. [Â§4. Generated Metadata â€” generateMetadata()](#4)
5. [Â§5. Streaming Metadata & Memoizing](#5)
6. [Â§6. PhÃ¢n TÃ­ch SÆ¡ Äá»“ 1 â€” Favicon File Structure](#6)
7. [Â§7. File-based Metadata â€” Special Files](#7)
8. [Â§8. PhÃ¢n TÃ­ch SÆ¡ Äá»“ 2 â€” Static OG Image](#8)
9. [Â§9. PhÃ¢n TÃ­ch SÆ¡ Äá»“ 3 â€” Route-specific OG Image](#9)
10. [Â§10. Generated OG Images â€” ImageResponse](#10)
11. [Â§11. SÆ¡ Äá»“ Tá»•ng Há»£p â€” Metadata Pipeline](#11)
12. [Â§12. Tá»± Viáº¿t â€” MetadataEngine](#12)
13. [Â§13. CÃ¢u Há»i Luyá»‡n Táº­p](#13)

---

## Â§1. Tá»•ng Quan â€” Metadata APIs!

```
  METADATA & OG IMAGES â€” Táº I SAO Cáº¦N?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  METADATA = thÃ´ng tin MÃ” Táº¢ trang web!                â”‚
  â”‚  â†’ Browser, Search Engine, Social Media Äá»ŒC!          â”‚
  â”‚  â†’ User KHÃ”NG tháº¥y trá»±c tiáº¿p!                         â”‚
  â”‚  â†’ Náº±m trong <head> tag!                              â”‚
  â”‚                                                        â”‚
  â”‚  OG IMAGE = áº£nh preview khi CHIA Sáºº link!             â”‚
  â”‚  â†’ Facebook, Twitter, Slack, Discord hiá»ƒn thá»‹!        â”‚
  â”‚  â†’ TÄƒng click-through rate (CTR)!                     â”‚
  â”‚                                                        â”‚
  â”‚  VÃ Dá»¤ khi share link trÃªn Facebook:                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚              â”‚
  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚              â”‚
  â”‚  â”‚  â”‚  â”‚    OG IMAGE (1200x630) â”‚  â”‚   â”‚              â”‚
  â”‚  â”‚  â”‚  â”‚    áº¢nh preview Ä‘áº¹p!    â”‚  â”‚   â”‚              â”‚
  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚              â”‚
  â”‚  â”‚  â”‚  My Blog Post Title          â”‚   â”‚ â† title      â”‚
  â”‚  â”‚  â”‚  Description of the post...  â”‚   â”‚ â† descriptionâ”‚
  â”‚  â”‚  â”‚  mywebsite.com               â”‚   â”‚ â† domain     â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
  3 CÃCH Äá»ŠNH NGHÄ¨A METADATA TRONG NEXT.JS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â‘  STATIC METADATA OBJECT                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  export const metadata: Metadata = {             â”‚  â”‚
  â”‚  â”‚    title: 'My Blog',                             â”‚  â”‚
  â”‚  â”‚    description: '...',                           â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â”‚  â†’ DÃ¹ng khi metadata KHÃ”NG Ä‘á»•i!                 â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  â‘¡ GENERATE METADATA FUNCTION                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  export async function generateMetadata() {      â”‚  â”‚
  â”‚  â”‚    const data = await fetch(...)                 â”‚  â”‚
  â”‚  â”‚    return { title: data.title }                  â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â”‚  â†’ DÃ¹ng khi metadata Cáº¦N FETCH data!            â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  â‘¢ FILE-BASED (Special Files)                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  app/                                            â”‚  â”‚
  â”‚  â”‚  â”œâ”€â”€ favicon.ico         â† icon tab browser    â”‚  â”‚
  â”‚  â”‚  â”œâ”€â”€ opengraph-image.jpg â† OG image cho social â”‚  â”‚
  â”‚  â”‚  â”œâ”€â”€ robots.txt          â† cho search engines  â”‚  â”‚
  â”‚  â”‚  â””â”€â”€ sitemap.xml         â† cáº¥u trÃºc site       â”‚  â”‚
  â”‚  â”‚  â†’ Chá»‰ cáº§n Äáº¶T FILE Ä‘Ãºng tÃªn!                 â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  âš ï¸ CHá»ˆ SERVER COMPONENTS má»›i export Ä‘Æ°á»£c!             â”‚
  â”‚  â†’ metadata object + generateMetadata                 â”‚
  â”‚  â†’ Client Components KHÃ”NG há»— trá»£!                   â”‚
  â”‚                                                        â”‚
  â”‚  Next.js Tá»° Äá»˜NG generate <head> tags!                â”‚
  â”‚  â†’ Inspect báº±ng DevTools â†’ tháº¥y meta tags!           â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§2. Default Fields â€” Meta Tags Máº·c Äá»‹nh!

```
  DEFAULT META TAGS â€” LUÃ”N CÃ“:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  DÃ¹ route KHÃ”NG define metadata,                       â”‚
  â”‚  Next.js LUÃ”N thÃªm 2 tags nÃ y:                        â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  <meta charset="utf-8" />                        â”‚  â”‚
  â”‚  â”‚  â†‘                                                â”‚  â”‚
  â”‚  â”‚  Character encoding = UTF-8                      â”‚  â”‚
  â”‚  â”‚  â†’ Há»— trá»£ tiáº¿ng Viá»‡t, emoji, kÃ½ tá»± Ä‘áº·c biá»‡t!  â”‚  â”‚
  â”‚  â”‚  â†’ Náº¿u thiáº¿u â†’ chá»¯ hiá»‡n thÃ nh ????              â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  <meta name="viewport"                           â”‚  â”‚
  â”‚  â”‚        content="width=device-width,              â”‚  â”‚
  â”‚  â”‚                 initial-scale=1" />               â”‚  â”‚
  â”‚  â”‚  â†‘                                                â”‚  â”‚
  â”‚  â”‚  Viewport = responsive!                          â”‚  â”‚
  â”‚  â”‚  â†’ width=device-width â†’ trang vá»«a mÃ n hÃ¬nh!    â”‚  â”‚
  â”‚  â”‚  â†’ initial-scale=1 â†’ khÃ´ng zoom máº·c Ä‘á»‹nh!       â”‚  â”‚
  â”‚  â”‚  â†’ Náº¿u thiáº¿u â†’ mobile hiá»ƒn thá»‹ trang desktop!  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  â‡’ Báº N KHÃ”NG Cáº¦N tá»± thÃªm 2 tags nÃ y!                â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§3. Static Metadata â€” Export Object!

```
  STATIC METADATA â€” DÃ™NG KHI NÃ€O?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Khi metadata KHÃ”NG thay Ä‘á»•i (hardcoded)!             â”‚
  â”‚  â†’ Trang About, Contact, Landing page                 â”‚
  â”‚  â†’ KhÃ´ng cáº§n fetch data!                               â”‚
  â”‚                                                        â”‚
  â”‚  CÃCH DÃ™NG:                                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  // app/blog/layout.tsx                          â”‚  â”‚
  â”‚  â”‚  import type { Metadata } from 'next'            â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  export const metadata: Metadata = {             â”‚  â”‚
  â”‚  â”‚    title: 'My Blog',                             â”‚  â”‚
  â”‚  â”‚    description: 'Read my latest articles...',    â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  export default function Layout() { ... }        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  GENERATED HTML:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  <head>                                           â”‚  â”‚
  â”‚  â”‚    <title>My Blog</title>                         â”‚  â”‚
  â”‚  â”‚    <meta name="description"                       â”‚  â”‚
  â”‚  â”‚          content="Read my latest articles..." /> â”‚  â”‚
  â”‚  â”‚  </head>                                          â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  CÃ“ THá»‚ EXPORT Tá»ª:                                    â”‚
  â”‚  â†’ layout.js / layout.tsx (apply cho Má»ŒI page con!)  â”‚
  â”‚  â†’ page.js / page.tsx (apply cho 1 page cá»¥ thá»ƒ!)    â”‚
  â”‚                                                        â”‚
  â”‚  METADATA FIELDS CÃ“ Sáº´N:                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  title         â†’ <title>                         â”‚  â”‚
  â”‚  â”‚  description   â†’ <meta name="description">      â”‚  â”‚
  â”‚  â”‚  keywords      â†’ <meta name="keywords">         â”‚  â”‚
  â”‚  â”‚  openGraph     â†’ og:title, og:description, ...  â”‚  â”‚
  â”‚  â”‚  twitter       â†’ twitter:card, twitter:title     â”‚  â”‚
  â”‚  â”‚  robots        â†’ <meta name="robots">            â”‚  â”‚
  â”‚  â”‚  icons         â†’ <link rel="icon">               â”‚  â”‚
  â”‚  â”‚  ... vÃ  nhiá»u ná»¯a!                               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§4. Generated Metadata â€” generateMetadata()!

```
  GENERATED METADATA â€” DÃ™NG KHI NÃ€O?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Khi metadata Cáº¦N Dá»® LIá»†U DYNAMIC!                   â”‚
  â”‚  â†’ Blog post title tá»« database                        â”‚
  â”‚  â†’ Product name tá»« API                                 â”‚
  â”‚  â†’ User profile information                            â”‚
  â”‚                                                        â”‚
  â”‚  FLOW:                                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  User visit /blog/hello-world                    â”‚  â”‚
  â”‚  â”‚       â”‚                                           â”‚  â”‚
  â”‚  â”‚       â–¼                                           â”‚  â”‚
  â”‚  â”‚  Next.js gá»i generateMetadata({                  â”‚  â”‚
  â”‚  â”‚    params: { slug: 'hello-world' }               â”‚  â”‚
  â”‚  â”‚  })                                              â”‚  â”‚
  â”‚  â”‚       â”‚                                           â”‚  â”‚
  â”‚  â”‚       â–¼                                           â”‚  â”‚
  â”‚  â”‚  HÃ m fetch data tá»« API/DB                        â”‚  â”‚
  â”‚  â”‚  const post = await fetch(.../hello-world)       â”‚  â”‚
  â”‚  â”‚       â”‚                                           â”‚  â”‚
  â”‚  â”‚       â–¼                                           â”‚  â”‚
  â”‚  â”‚  Return { title: post.title,                     â”‚  â”‚
  â”‚  â”‚           description: post.description }        â”‚  â”‚
  â”‚  â”‚       â”‚                                           â”‚  â”‚
  â”‚  â”‚       â–¼                                           â”‚  â”‚
  â”‚  â”‚  Next.js inject vÃ o <head> tags!                 â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```typescript
// GENERATED METADATA â€” VÃ Dá»¤ Äáº¦Y Äá»¦:
import type { Metadata, ResolvingMetadata } from "next";

type Props = {
  params: Promise<{ slug: string }>;
  searchParams: Promise<{ [key: string]: string | string[] | undefined }>;
};

export async function generateMetadata(
  { params, searchParams }: Props,
  parent: ResolvingMetadata, // â† metadata tá»« parent layout!
): Promise<Metadata> {
  const slug = (await params).slug;

  // Fetch data
  const post = await fetch(`https://api.vercel.app/blog/${slug}`).then((res) =>
    res.json(),
  );

  return {
    title: post.title,
    description: post.description,
  };
}

export default function Page({ params, searchParams }: Props) {
  // Page component bÃ¬nh thÆ°á»ng
}
```

---

## Â§5. Streaming Metadata & Memoizing!

```
  STREAMING METADATA:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€: generateMetadata Cáº¦N fetch data...          â”‚
  â”‚  â†’ Náº¿u chá» metadata xong má»›i render â†’ CHáº¬M!          â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I PHÃP: STREAMING METADATA!                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  TIMELINE:                                       â”‚  â”‚
  â”‚  â”‚  t=0ms      t=50ms     t=200ms     t=500ms      â”‚  â”‚
  â”‚  â”‚   â”‚          â”‚          â”‚           â”‚            â”‚  â”‚
  â”‚  â”‚   â–¼          â–¼          â–¼           â–¼            â”‚  â”‚
  â”‚  â”‚  Start    UI stream   User sees   Metadata      â”‚  â”‚
  â”‚  â”‚  request  begins!     content!    injected!     â”‚  â”‚
  â”‚  â”‚           (body HTML)  (visual)   (<head>)      â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â†’ User tháº¥y UI TRÆ¯á»šC khi metadata sáºµn sÃ ng!   â”‚  â”‚
  â”‚  â”‚  â†’ Perceived performance tá»‘t hÆ¡n!               â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  âš ï¸ NGOáº I Lá»† CHO BOTS/CRAWLERS:                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Twitterbot, Slackbot, Bingbot...               â”‚  â”‚
  â”‚  â”‚  â†’ Cáº¦N metadata trong <head> TRÆ¯á»šC!             â”‚  â”‚
  â”‚  â”‚  â†’ Next.js detect User-Agent header              â”‚  â”‚
  â”‚  â”‚  â†’ Táº®T streaming cho bots!                      â”‚  â”‚
  â”‚  â”‚  â†’ Chá» metadata xong â†’ send full HTML!          â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Customizable báº±ng htmlLimitedBots config!      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Static pages â†’ KHÃ”NG streaming (resolved at build)   â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
  MEMOIZING DATA REQUESTS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€: Cáº§n CÃ™NG data cho metadata VÃ€ page!         â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  generateMetadata() â†’ fetch post (láº§n 1)        â”‚  â”‚
  â”‚  â”‚  Page component   â†’ fetch post (láº§n 2) âŒ DUP! â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I PHÃP: React.cache()!                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  import { cache } from 'react'                   â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  export const getPost = cache(async (slug) => {  â”‚  â”‚
  â”‚  â”‚    const res = await db.query.posts.findFirst({  â”‚  â”‚
  â”‚  â”‚      where: eq(posts.slug, slug)                 â”‚  â”‚
  â”‚  â”‚    })                                            â”‚  â”‚
  â”‚  â”‚    return res                                    â”‚  â”‚
  â”‚  â”‚  })                                              â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  // DÃ¹ng 2 láº§n â†’ fetch CHá»ˆ 1 Láº¦N!              â”‚  â”‚
  â”‚  â”‚  generateMetadata() â†’ getPost(slug) â† cached!  â”‚  â”‚
  â”‚  â”‚  Page()             â†’ getPost(slug) â† reuse!   â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  FLOW:                                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Request â†’ generateMetadata('hello')             â”‚  â”‚
  â”‚  â”‚    â”‚         â”œâ”€â”€ getPost('hello') â†’ DB query â‘   â”‚  â”‚
  â”‚  â”‚    â”‚         â””â”€â”€ return { title: ... }            â”‚  â”‚
  â”‚  â”‚    â”‚                                              â”‚  â”‚
  â”‚  â”‚    â””â”€â†’ Page component                            â”‚  â”‚
  â”‚  â”‚          â””â”€â”€ getPost('hello') â†’ CACHED! (no DB) â”‚  â”‚
  â”‚  â”‚              â””â”€â”€ render page                     â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§6. PhÃ¢n TÃ­ch SÆ¡ Äá»“ 1 â€” Favicon File Structure!

**SÆ¡ Ä‘á»“ gá»‘c trÃªn trang:**

![Favicon File Structure](images/nextjs-metadata-favicon-structure.png)

```
  PHÃ‚N TÃCH SÆ  Äá»’ 1 â€” FAVICON:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  SÆ¡ Ä‘á»“ hiá»ƒn thá»‹ Cáº¤U TRÃšC THÆ¯ Má»¤C:                   â”‚
  â”‚                                                        â”‚
  â”‚  app/                                                  â”‚
  â”‚  â”œâ”€â”€ ğŸ“‹ layout.js    â† Root layout                   â”‚
  â”‚  â”œâ”€â”€ ğŸ“„ page.js      â† Root page                     â”‚
  â”‚  â””â”€â”€ ğŸ“„ favicon.ico  ğŸ”µ  â† FAVICON FILE!             â”‚
  â”‚                                                        â”‚
  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
  â”‚                                                        â”‚
  â”‚  Dáº¤U CHáº¤M XANH ğŸ”µ = FILE Äáº¶C BIá»†T!                  â”‚
  â”‚  â†’ favicon.ico lÃ  SPECIAL FILE CONVENTION!            â”‚
  â”‚  â†’ Äáº·t TRá»°C TIáº¾P trong app/ folder ROOT!             â”‚
  â”‚  â†’ Next.js Tá»° Äá»˜NG detect vÃ  thÃªm <link> tag!       â”‚
  â”‚                                                        â”‚
  â”‚  GENERATED HTML:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  <head>                                           â”‚  â”‚
  â”‚  â”‚    <link rel="icon" href="/favicon.ico" />        â”‚  â”‚
  â”‚  â”‚  </head>                                          â”‚  â”‚
  â”‚  â”‚  â†’ KHÃ”NG cáº§n code gÃ¬! Chá»‰ cáº§n Ä‘áº·t file!        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  FAVICON LÃ€ GÃŒ?                                        â”‚
  â”‚  â†’ Icon nhá» trÃªn tab browser!                        â”‚
  â”‚  â†’ Icon trong bookmarks!                              â”‚
  â”‚  â†’ Icon trong search results!                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
  â”‚  â”‚ ğŸ”µ My Website | âœ• â”‚ ğŸŸ¡ Other   â”‚ â† tab bar       â”‚
  â”‚  â”‚  â†‘                              â”‚                  â”‚
  â”‚  â”‚  favicon.ico hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y!    â”‚                  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§7. File-based Metadata â€” Special Files!

```
  FILE-BASED METADATA â€” SPECIAL FILES:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Chá»‰ cáº§n Äáº¶T FILE Ä‘Ãºng tÃªn â†’ Next.js Tá»° Xá»¬ LÃ!    â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚ File         â”‚ Má»¥c Ä‘Ã­ch                         â”‚   â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
  â”‚  â”‚ favicon.ico  â”‚ Icon tab browser                 â”‚   â”‚
  â”‚  â”‚ apple-icon   â”‚ Icon cho iOS (Add to Home Screen)â”‚   â”‚
  â”‚  â”‚  .jpg        â”‚                                  â”‚   â”‚
  â”‚  â”‚ icon.jpg     â”‚ Icon cho cÃ¡c platform            â”‚   â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
  â”‚  â”‚ opengraph-   â”‚ OG image cho Facebook, Slack,   â”‚   â”‚
  â”‚  â”‚  image.jpg   â”‚ Discord, etc.                    â”‚   â”‚
  â”‚  â”‚ twitter-     â”‚ Image cho Twitter cards          â”‚   â”‚
  â”‚  â”‚  image.jpg   â”‚                                  â”‚   â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
  â”‚  â”‚ robots.txt   â”‚ HÆ°á»›ng dáº«n cho search engine     â”‚   â”‚
  â”‚  â”‚              â”‚ crawlers (allow/disallow paths)  â”‚   â”‚
  â”‚  â”‚ sitemap.xml  â”‚ Báº£n Ä‘á»“ site cho SEO             â”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚                                                        â”‚
  â”‚  CÃ“ THá»‚:                                              â”‚
  â”‚  â†’ DÃ¹ng file TÄ¨NH (Ä‘áº·t file sáºµn)                    â”‚
  â”‚  â†’ HOáº¶C generate Äá»˜NG báº±ng code!                     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§8. PhÃ¢n TÃ­ch SÆ¡ Äá»“ 2 â€” Static OG Image!

**SÆ¡ Ä‘á»“ gá»‘c trÃªn trang:**

![Static OG Image File Structure](images/nextjs-metadata-og-image-structure.png)

```
  PHÃ‚N TÃCH SÆ  Äá»’ 2 â€” STATIC OG IMAGE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  SÆ¡ Ä‘á»“ hiá»ƒn thá»‹ Cáº¤U TRÃšC THÆ¯ Má»¤C:                   â”‚
  â”‚                                                        â”‚
  â”‚  app/                                                  â”‚
  â”‚  â”œâ”€â”€ ğŸ“‹ layout.js                                     â”‚
  â”‚  â”œâ”€â”€ ğŸ“„ page.js                                       â”‚
  â”‚  â””â”€â”€ ğŸ“„ opengraph-image.jpg  ğŸ”µ  â† OG IMAGE!        â”‚
  â”‚                                                        â”‚
  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
  â”‚                                                        â”‚
  â”‚  Dáº¤U CHáº¤M XANH ğŸ”µ = FILE Äáº¶C BIá»†T!                  â”‚
  â”‚  â†’ opengraph-image.jpg náº±m á»Ÿ ROOT cá»§a app/           â”‚
  â”‚  â†’ Apply cho TOÃ€N Bá»˜ website!                         â”‚
  â”‚  â†’ Má»—i khi share LINK Báº¤T Ká»² â†’ hiá»‡n áº£nh nÃ y!       â”‚
  â”‚                                                        â”‚
  â”‚  GENERATED META TAG:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  <meta property="og:image"                        â”‚  â”‚
  â”‚  â”‚        content="/opengraph-image.jpg" />          â”‚  â”‚
  â”‚  â”‚  â†’ Tá»± Ä‘á»™ng! KhÃ´ng cáº§n code!                      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  FORMATS Há»– TRá»¢:                                      â”‚
  â”‚  â†’ .jpg / .jpeg                                       â”‚
  â”‚  â†’ .png                                                â”‚
  â”‚  â†’ .gif                                                â”‚
  â”‚                                                        â”‚
  â”‚  KÃCH THÆ¯á»šC KHUYáº¾N NGHá»Š:                              â”‚
  â”‚  â†’ 1200 x 630 pixels (standard OG image)             â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§9. PhÃ¢n TÃ­ch SÆ¡ Äá»“ 3 â€” Route-specific OG Image!

**SÆ¡ Ä‘á»“ gá»‘c trÃªn trang:**

![Route-specific OG Image](images/nextjs-metadata-og-image-blog-structure.png)

```
  PHÃ‚N TÃCH SÆ  Äá»’ 3 â€” ROUTE-SPECIFIC OG IMAGE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  SÆ¡ Ä‘á»“ hiá»ƒn thá»‹ Cáº¤U TRÃšC vá»›i NESTED route:           â”‚
  â”‚                                                        â”‚
  â”‚  app/                                                  â”‚
  â”‚  â”œâ”€â”€ ğŸ“‹ layout.js                                     â”‚
  â”‚  â”œâ”€â”€ ğŸ“„ page.js                                       â”‚
  â”‚  â””â”€â”€ ğŸ“ blog/                                         â”‚
  â”‚      â””â”€â”€ ğŸ“„ opengraph-image.jpg  ğŸ”µ                   â”‚
  â”‚                                                        â”‚
  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
  â”‚                                                        â”‚
  â”‚  KHÃC BIá»†T vá»›i SÆ¡ Äá»“ 2:                              â”‚
  â”‚  â†’ OG image náº±m TRONG thÆ° má»¥c blog/!                 â”‚
  â”‚  â†’ CHá»ˆ apply cho route /blog vÃ  con cá»§a nÃ³!           â”‚
  â”‚  â†’ CÃ¡c route khÃ¡c KHÃ”NG bá»‹ áº£nh hÆ°á»Ÿng!                â”‚
  â”‚                                                        â”‚
  â”‚  ROUTE PRECEDENCE (Æ°u tiÃªn):                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  app/opengraph-image.jpg        â†’ cho "/" (root) â”‚  â”‚
  â”‚  â”‚  app/about/opengraph-image.jpg  â†’ cho "/about"   â”‚  â”‚
  â”‚  â”‚  app/blog/opengraph-image.jpg   â†’ cho "/blog"    â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  QUY Táº®C: Äáº¶C BIá»†T HÆ N â†’ Æ¯U TIÃŠN HÆ N!        â”‚  â”‚
  â”‚  â”‚  â†’ /blog dÃ¹ng app/blog/og-image âœ…              â”‚  â”‚
  â”‚  â”‚  â†’ KHÃ”NG dÃ¹ng app/og-image âŒ                   â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  SO SÃNH 3 SÆ  Äá»’:                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚ SÆ¡ Ä‘á»“               â”‚ Scope     â”‚ File location  â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚ #1 favicon.ico       â”‚ Global    â”‚ app/           â”‚ â”‚
  â”‚  â”‚ #2 og-image (root)   â”‚ Global    â”‚ app/           â”‚ â”‚
  â”‚  â”‚ #3 og-image (blog)   â”‚ /blog/*   â”‚ app/blog/      â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§10. Generated OG Images â€” ImageResponse!

```
  GENERATED OG IMAGES â€” DYNAMIC!
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  KHI NÃ€O Cáº¦N?                                         â”‚
  â”‚  â†’ Má»—i blog post Cáº¦N OG image RIÃŠNG!                â”‚
  â”‚  â†’ Hiá»ƒn thá»‹ TITLE cá»§a post trÃªn áº£nh!                 â”‚
  â”‚  â†’ KhÃ´ng thá»ƒ táº¡o 1000 áº£nh tÄ©nh trÆ°á»›c!               â”‚
  â”‚                                                        â”‚
  â”‚  GIáº¢I PHÃP: ImageResponse tá»« next/og!                  â”‚
  â”‚  â†’ Generate áº£nh Báº°NG CODE (JSX + CSS)!                â”‚
  â”‚  â†’ Má»—i request â†’ render JSX â†’ output PNG!            â”‚
  â”‚                                                        â”‚
  â”‚  FLOW:                                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â‘  Táº¡o file: app/blog/[slug]/opengraph-image.tsxâ”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â‘¡ Export default function tráº£ ImageResponse    â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â‘¢ User share /blog/hello-world                 â”‚  â”‚
  â”‚  â”‚     â”‚                                             â”‚  â”‚
  â”‚  â”‚     â–¼                                             â”‚  â”‚
  â”‚  â”‚  â‘£ Next.js gá»i Image({ params })               â”‚  â”‚
  â”‚  â”‚     â”‚                                             â”‚  â”‚
  â”‚  â”‚     â–¼                                             â”‚  â”‚
  â”‚  â”‚  â‘¤ Fetch post data â†’ post.title = "Hello World"â”‚  â”‚
  â”‚  â”‚     â”‚                                             â”‚  â”‚
  â”‚  â”‚     â–¼                                             â”‚  â”‚
  â”‚  â”‚  â‘¥ Render JSX thÃ nh áº£nh PNG (1200x630)          â”‚  â”‚
  â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
  â”‚  â”‚     â”‚                              â”‚             â”‚  â”‚
  â”‚  â”‚     â”‚      Hello World             â”‚ â† áº£nh PNG! â”‚  â”‚
  â”‚  â”‚     â”‚                              â”‚             â”‚  â”‚
  â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
  â”‚  â”‚     â”‚                                             â”‚  â”‚
  â”‚  â”‚     â–¼                                             â”‚  â”‚
  â”‚  â”‚  â‘¦ Social platform hiá»ƒn thá»‹ áº£nh!                â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```typescript
// GENERATED OG IMAGE â€” VÃ Dá»¤ Äáº¦Y Äá»¦:
// File: app/blog/[slug]/opengraph-image.tsx

import { ImageResponse } from 'next/og'
import { getPost } from '@/app/lib/data'

// Image metadata â€” export constants!
export const size = {
  width: 1200,   // â† standard OG width
  height: 630,   // â† standard OG height
}
export const contentType = 'image/png'

// Image generation function
export default async function Image({
  params,
}: {
  params: { slug: string }
}) {
  const post = await getPost(params.slug)

  return new ImageResponse(
    (
      // JSX element â†’ render thÃ nh PNG!
      <div
        style={{
          fontSize: 128,
          background: 'white',
          width: '100%',
          height: '100%',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
        }}
      >
        {post.title}
      </div>
    )
  )
}
```

```
  ImageResponse â€” BEHIND THE SCENES:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  JSX â”€â”€â†’ Satori â”€â”€â†’ SVG â”€â”€â†’ resvg â”€â”€â†’ PNG           â”‚
  â”‚                                                        â”‚
  â”‚  â‘  JSX code                                           â”‚
  â”‚  â”‚  <div style={{ display: 'flex' }}>Title</div>     â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â–¼                                                     â”‚
  â”‚  â‘¡ Satori (by Vercel)                                  â”‚
  â”‚  â”‚  â†’ Convert JSX + CSS â†’ SVG markup                  â”‚
  â”‚  â”‚  â†’ Chá»‰ há»— trá»£ FLEXBOX!                            â”‚
  â”‚  â”‚  â†’ KHÃ”NG há»— trá»£ CSS Grid!                         â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â–¼                                                     â”‚
  â”‚  â‘¢ resvg                                               â”‚
  â”‚  â”‚  â†’ Convert SVG â†’ PNG bitmap                        â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â–¼                                                     â”‚
  â”‚  â‘£ Output: PNG image (1200x630)                        â”‚
  â”‚                                                        â”‚
  â”‚  CSS Há»– TRá»¢:                                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  âœ… flexbox (display: flex)                      â”‚  â”‚
  â”‚  â”‚  âœ… absolute positioning                         â”‚  â”‚
  â”‚  â”‚  âœ… custom fonts                                 â”‚  â”‚
  â”‚  â”‚  âœ… text wrapping                                â”‚  â”‚
  â”‚  â”‚  âœ… centering (align, justify)                   â”‚  â”‚
  â”‚  â”‚  âœ… nested images                                â”‚  â”‚
  â”‚  â”‚  âŒ display: grid                                â”‚  â”‚
  â”‚  â”‚  âŒ advanced CSS (animation, transform, etc.)   â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§11. SÆ¡ Äá»“ Tá»•ng Há»£p â€” Metadata Pipeline!

```
  NEXT.JS METADATA â€” TOÃ€N Bá»˜ PIPELINE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚             3 NGUá»’N METADATA                     â”‚   â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
  â”‚  â”‚  â”‚ Static   â”‚ Generated  â”‚ File-based        â”‚  â”‚   â”‚
  â”‚  â”‚  â”‚ metadata â”‚ Metadata() â”‚ (special files)   â”‚  â”‚   â”‚
  â”‚  â”‚  â”‚ object   â”‚ async fn   â”‚ favicon.ico, etc. â”‚  â”‚   â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚            â”‚            â”‚            â”‚                  â”‚
  â”‚            â–¼            â–¼            â–¼                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚          METADATA RESOLUTION                     â”‚   â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
  â”‚  â”‚  â”‚  â‘  Merge metadata tá»« táº¥t cáº£ sources      â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  â‘¡ Child OVERRIDES parent (deep merge)    â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  â‘¢ File-based ADDS thÃªm (icons, images) â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  â‘£ Default fields luÃ´n cÃ³ (charset, vp)  â”‚   â”‚   â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚                        â”‚                                â”‚
  â”‚                        â–¼                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
  â”‚  â”‚              <head> OUTPUT                       â”‚   â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
  â”‚  â”‚  â”‚  <meta charset="utf-8" />                 â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  <meta name="viewport" content="..." />   â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  <title>My Blog Post</title>              â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  <meta name="description" content="..." />â”‚   â”‚   â”‚
  â”‚  â”‚  â”‚  <meta property="og:title" content="..." />â”‚  â”‚   â”‚
  â”‚  â”‚  â”‚  <meta property="og:image" content="..." />â”‚  â”‚   â”‚
  â”‚  â”‚  â”‚  <link rel="icon" href="/favicon.ico" />  â”‚   â”‚   â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
  METADATA MERGING â€” CHILD OVERRIDES PARENT:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  app/layout.tsx (Root):                                â”‚
  â”‚  metadata = { title: "My Website", description: "..." }â”‚
  â”‚       â”‚                                                 â”‚
  â”‚       â”‚ INHERIT â†“                                      â”‚
  â”‚       â”‚                                                 â”‚
  â”‚  app/blog/layout.tsx:                                   â”‚
  â”‚  metadata = { title: "Blog" }                          â”‚
  â”‚       â”‚                                                 â”‚
  â”‚       â”‚ OVERRIDE â†“ (title thay Ä‘á»•i!)                   â”‚
  â”‚       â”‚                                                 â”‚
  â”‚  app/blog/[slug]/page.tsx:                              â”‚
  â”‚  generateMetadata = () => { title: "Hello World" }     â”‚
  â”‚       â”‚                                                 â”‚
  â”‚       â–¼                                                 â”‚
  â”‚  FINAL: { title: "Hello World",                        â”‚
  â”‚           description: "..." â† tá»« root! }             â”‚
  â”‚                                                        â”‚
  â”‚  QUY Táº®C:                                              â”‚
  â”‚  â†’ title bá»‹ OVERRIDE (child tháº¯ng!)                   â”‚
  â”‚  â†’ description Ká»ªNG Bá»Š override â†’ giá»¯ tá»« parent!     â”‚
  â”‚  â†’ Deep merge = chá»‰ override field Ä‘Ã£ define!         â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
  DECISION TREE â€” CHá»ŒN CÃCH NÃ€O?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Metadata cáº§n gÃ¬?                                      â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â”œâ”€â”€ Title/description Cá»¨NG (khÃ´ng Ä‘á»•i)?              â”‚
  â”‚  â”‚   â””â”€â”€ âœ… Static metadata object                    â”‚
  â”‚  â”‚       export const metadata = { ... }              â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â”œâ”€â”€ Title/description Tá»ª API/DB?                     â”‚
  â”‚  â”‚   â””â”€â”€ âœ… generateMetadata()                        â”‚
  â”‚  â”‚       â†’ CÃ³ cache() náº¿u cáº§n memoize!               â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â”œâ”€â”€ Favicon?                                          â”‚
  â”‚  â”‚   â””â”€â”€ âœ… Äáº·t favicon.ico trong app/                â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â”œâ”€â”€ OG Image TÄ¨NH (chung cho toÃ n site)?             â”‚
  â”‚  â”‚   â””â”€â”€ âœ… Äáº·t opengraph-image.jpg trong app/       â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â”œâ”€â”€ OG Image RIÃŠNG cho má»—i route?                    â”‚
  â”‚  â”‚   â””â”€â”€ âœ… Äáº·t trong folder tÆ°Æ¡ng á»©ng!              â”‚
  â”‚  â”‚       app/blog/opengraph-image.jpg                 â”‚
  â”‚  â”‚                                                     â”‚
  â”‚  â””â”€â”€ OG Image DYNAMIC (per-post title)?               â”‚
  â”‚      â””â”€â”€ âœ… opengraph-image.tsx + ImageResponse       â”‚
  â”‚          import { ImageResponse } from 'next/og'      â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§12. Tá»± Viáº¿t â€” MetadataEngine!

```javascript
var MetadataEngine = (function () {
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 1. DEFAULT META TAGS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var defaults = {
    charset: "utf-8",
    viewport: "width=device-width, initial-scale=1",
  };

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 2. ROUTES + METADATA REGISTRY
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var routes = {};
  var specialFiles = {};

  function registerStaticMetadata(route, metadata) {
    routes[route] = { type: "static", metadata: metadata };
    console.log("  [Static] Registered metadata for: " + route);
  }

  function registerGeneratedMetadata(route, fetchFn) {
    routes[route] = { type: "generated", fetchFn: fetchFn };
    console.log("  [Generated] Registered generateMetadata for: " + route);
  }

  function registerSpecialFile(route, filename) {
    if (!specialFiles[route]) specialFiles[route] = [];
    specialFiles[route].push(filename);
    console.log("  [File] Registered: " + route + "/" + filename);
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 3. RESOLVE METADATA (MERGE)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function resolveMetadata(targetRoute) {
    // Build route segments: /blog/hello â†’ ['/', '/blog', '/blog/hello']
    var segments = ["/"];
    var parts = targetRoute.split("/").filter(Boolean);
    for (var i = 0; i < parts.length; i++) {
      segments.push("/" + parts.slice(0, i + 1).join("/"));
    }

    // Merge metadata from root â†’ leaf (child overrides parent!)
    var merged = {};
    segments.forEach(function (seg) {
      if (routes[seg]) {
        var meta =
          routes[seg].type === "static"
            ? routes[seg].metadata
            : routes[seg].fetchFn();
        Object.keys(meta).forEach(function (key) {
          merged[key] = meta[key]; // child OVERRIDES!
        });
      }
    });

    return merged;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 4. RESOLVE SPECIAL FILES
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function resolveFiles(targetRoute) {
    var files = {};
    var segments = ["/"];
    var parts = targetRoute.split("/").filter(Boolean);
    for (var i = 0; i < parts.length; i++) {
      segments.push("/" + parts.slice(0, i + 1).join("/"));
    }

    // Most specific file wins!
    segments.forEach(function (seg) {
      if (specialFiles[seg]) {
        specialFiles[seg].forEach(function (f) {
          var type = f.split(".")[0]; // favicon, opengraph-image
          files[type] = { file: f, route: seg };
        });
      }
    });
    return files;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 5. GENERATE HEAD TAGS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function generateHead(route) {
    var meta = resolveMetadata(route);
    var files = resolveFiles(route);
    var tags = [];

    // Defaults (LUÃ”N CÃ“!)
    tags.push('<meta charset="' + defaults.charset + '" />');
    tags.push('<meta name="viewport" content="' + defaults.viewport + '" />');

    // Metadata
    if (meta.title) tags.push("<title>" + meta.title + "</title>");
    if (meta.description) {
      tags.push(
        '<meta name="description" content="' + meta.description + '" />',
      );
    }
    if (meta.title) {
      tags.push('<meta property="og:title" content="' + meta.title + '" />');
    }
    if (meta.description) {
      tags.push(
        '<meta property="og:description" content="' + meta.description + '" />',
      );
    }

    // Special files
    if (files["favicon"]) {
      tags.push('<link rel="icon" href="/' + files["favicon"].file + '" />');
    }
    if (files["opengraph-image"]) {
      var ogPath =
        files["opengraph-image"].route === "/"
          ? "/" + files["opengraph-image"].file
          : files["opengraph-image"].route +
            "/" +
            files["opengraph-image"].file;
      tags.push('<meta property="og:image" content="' + ogPath + '" />');
    }

    return tags;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 6. DEMO
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function demo() {
    console.log("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
    console.log("â•‘ METADATA ENGINE                       â•‘");
    console.log("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");

    // Register metadata
    console.log("\nâ”â”â” 1. Register Metadata â”â”â”");
    registerStaticMetadata("/", {
      title: "My Website",
      description: "Welcome to my site",
    });
    registerStaticMetadata("/blog", {
      title: "Blog",
      description: "Read articles",
    });
    registerGeneratedMetadata("/blog/hello-world", function () {
      return { title: "Hello World â€” My Blog", description: "My first post" };
    });

    // Register special files
    console.log("\nâ”â”â” 2. Register Special Files â”â”â”");
    registerSpecialFile("/", "favicon.ico");
    registerSpecialFile("/", "opengraph-image.jpg");
    registerSpecialFile("/blog", "opengraph-image.jpg");

    // Resolve for /
    console.log("\nâ”â”â” 3. Resolve: / â”â”â”");
    var rootTags = generateHead("/");
    rootTags.forEach(function (t) {
      console.log("  " + t);
    });

    // Resolve for /blog
    console.log("\nâ”â”â” 4. Resolve: /blog â”â”â”");
    var blogTags = generateHead("/blog");
    blogTags.forEach(function (t) {
      console.log("  " + t);
    });

    // Resolve for /blog/hello-world
    console.log("\nâ”â”â” 5. Resolve: /blog/hello-world â”â”â”");
    var postTags = generateHead("/blog/hello-world");
    postTags.forEach(function (t) {
      console.log("  " + t);
    });
    console.log('\n  â†’ title: "Hello World" overrides "Blog"!');
    console.log('  â†’ description: "My first post" overrides "Read articles"!');
    console.log("  â†’ og:image: /blog/og-image wins over /og-image!");
  }

  return { demo: demo };
})();
// Cháº¡y: MetadataEngine.demo();
```

---

## Â§13. CÃ¢u Há»i Luyá»‡n Táº­p!

**CÃ¢u 1**: 3 cÃ¡ch Ä‘á»‹nh nghÄ©a metadata trong Next.js App Router lÃ  gÃ¬?

<details><summary>ÄÃ¡p Ã¡n</summary>

1. **Static metadata object**: Export `const metadata: Metadata = { ... }` tá»« `layout.tsx` hoáº·c `page.tsx` â€” dÃ¹ng khi metadata **khÃ´ng thay Ä‘á»•i**

2. **generateMetadata function**: Export `async function generateMetadata()` â€” dÃ¹ng khi metadata **cáº§n fetch data** tá»« API/DB (dynamic)

3. **File-based metadata**: Äáº·t special files Ä‘Ãºng tÃªn trong thÆ° má»¥c app/ â€” `favicon.ico`, `opengraph-image.jpg`, `robots.txt`, `sitemap.xml` â€” Next.js **tá»± detect** vÃ  generate meta tags!

âš ï¸ Cáº£ `metadata` object vÃ  `generateMetadata` chá»‰ hoáº¡t Ä‘á»™ng trong **Server Components**!

</details>

---

**CÃ¢u 2**: Giáº£i thÃ­ch cÆ¡ cháº¿ "Streaming Metadata" vÃ  táº¡i sao bots bá»‹ Ä‘á»‘i xá»­ khÃ¡c?

<details><summary>ÄÃ¡p Ã¡n</summary>

**Streaming Metadata**: Vá»›i dynamic pages, Next.js **stream UI content trÆ°á»›c** vÃ  inject metadata vÃ o `<head>` sau khi `generateMetadata` resolve. NgÆ°á»i dÃ¹ng tháº¥y ná»™i dung **ngay láº­p tá»©c** mÃ  khÃ´ng pháº£i chá» metadata!

**Bots bá»‹ Ä‘á»‘i xá»­ khÃ¡c** vÃ¬:

- **Twitterbot, Slackbot, Bingbot** cáº§n metadata trong `<head>` **TRÆ¯á»šC** khi parse HTML
- Náº¿u stream â†’ bots **khÃ´ng tháº¥y** metadata â†’ link preview **bá»‹ há»ng**!
- Next.js detect **User-Agent header** â†’ náº¿u lÃ  bot â†’ **táº¯t streaming** â†’ chá» metadata xong rá»“i gá»­i full HTML!
- Customize qua config `htmlLimitedBots`

**Static pages** â†’ khÃ´ng streaming (metadata resolve táº¡i **build time**)

</details>

---

**CÃ¢u 3**: Metadata resolution hoáº¡t Ä‘á»™ng tháº¿ nÃ o khi cÃ³ nhiá»u layout lá»“ng nhau?

<details><summary>ÄÃ¡p Ã¡n</summary>

**Deep merge** + **child overrides parent**:

```
Root layout:   { title: "Website", description: "Welcome", keywords: "next" }
/blog layout:  { title: "Blog" }
/blog/[slug]:  generateMetadata â†’ { title: "Hello World" }

KQUáº¢: {
  title: "Hello World",      â† override bá»Ÿi child (page)
  description: "Welcome",    â† giá»¯ tá»« root (khÃ´ng bá»‹ override)
  keywords: "next",          â† giá»¯ tá»« root
}
```

â†’ Child chá»‰ override **field nÃ³ define**!
â†’ CÃ¡c field khÃ¡c **giá»¯ nguyÃªn** tá»« parent!

</details>

---

**CÃ¢u 4**: PhÃ¢n tÃ­ch cáº¥u trÃºc 3 sÆ¡ Ä‘á»“ trÃªn trang docs â€” Ä‘iá»ƒm chung vÃ  khÃ¡c biá»‡t?

<details><summary>ÄÃ¡p Ã¡n</summary>

|              | SÆ¡ Ä‘á»“ 1            | SÆ¡ Ä‘á»“ 2               | SÆ¡ Ä‘á»“ 3               |
| ------------ | ------------------ | --------------------- | --------------------- |
| **File**     | `favicon.ico`      | `opengraph-image.jpg` | `opengraph-image.jpg` |
| **Location** | `app/` (root)      | `app/` (root)         | `app/blog/` (nested!) |
| **Scope**    | Global (toÃ n site) | Global (toÃ n site)    | `/blog` route only    |
| **Purpose**  | Icon tab browser   | OG image khi share    | OG image cho /blog    |

**Äiá»ƒm chung**: Äá»u náº±m trong `app/` folder, Ä‘á»u lÃ  special file convention, Ä‘á»u cÃ³ dáº¥u **cháº¥m xanh ğŸ”µ**.

**KhÃ¡c biá»‡t chÃ­nh**: SÆ¡ Ä‘á»“ 3 cho tháº¥y **route-scoping** â€” file náº±m **sÃ¢u hÆ¡n** trong cÃ¢y thÆ° má»¥c â†’ **Æ°u tiÃªn hÆ¡n** cho route Ä‘Ã³!

</details>

---

**CÃ¢u 5**: Viáº¿t code cho generated OG image vá»›i ImageResponse â€” giáº£i thÃ­ch tá»«ng pháº§n.

<details><summary>ÄÃ¡p Ã¡n</summary>

```typescript
// File: app/blog/[slug]/opengraph-image.tsx
import { ImageResponse } from 'next/og'    // â† import constructor
import { getPost } from '@/app/lib/data'     // â† data fetching

// Constants báº¯t buá»™c â€” Next.js Ä‘á»c Ä‘á»ƒ biáº¿t size + format:
export const size = { width: 1200, height: 630 }  // Standard OG
export const contentType = 'image/png'              // Output format

// Function chÃ­nh â€” nháº­n params tá»« route:
export default async function Image({
  params
}: { params: { slug: string } }) {
  const post = await getPost(params.slug)  // Fetch data

  return new ImageResponse(
    // JSX â†’ Satori â†’ SVG â†’ resvg â†’ PNG
    <div style={{
      fontSize: 128,
      background: 'white',
      width: '100%', height: '100%',
      display: 'flex',         // â† CHá»ˆ flexbox!
      alignItems: 'center',
      justifyContent: 'center',
    }}>
      {post.title}
    </div>
  )
}
```

**Pipeline**: JSX â†’ `Satori` (convert to SVG) â†’ `resvg` (SVG to PNG bitmap)
**Giá»›i háº¡n**: Chá»‰ **flexbox** CSS, KHÃ”NG há»— trá»£ `display: grid`!

</details>
