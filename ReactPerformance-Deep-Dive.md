# React Performance â€” Deep Dive ğŸš€

> **Nguá»“n gá»‘c**: "How to greatly improve your React app performance" â€” Noam Elboim (Medium, 2017)
>
> **PhÆ°Æ¡ng phÃ¡p**: PhÃ¢n tÃ­ch tá»«ng váº¥n Ä‘á» performance â†’ viáº¿t láº¡i Tá»ª Äáº¦U báº±ng tay â†’ giáº£i thÃ­ch cá»±c ká»³ chi tiáº¿t!
>
> **NguyÃªn táº¯c**: KHÃ”NG dÃ¹ng thÆ° viá»‡n! Tá»± viáº¿t táº¥t cáº£!

---

## Â§1. Tá»•ng Quan â€” 3 Váº¥n Äá» Performance Phá»• Biáº¿n Nháº¥t!

### 1.1. Váº¥n Äá» LÃ  GÃ¬?

```
  HIá»†N TÆ¯á»¢NG KHI APP REACT CHáº¬M:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  User click button...                                  â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
  â”‚  â”‚  Click!  â”‚ â”€â”€â†’ 200ms delay â”€â”€â†’ UI má»›i xuáº¥t hiá»‡n!  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
  â”‚                                                        â”‚
  â”‚  User tháº¥y gÃ¬?                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  "Lag! Giáº­t! Cháº­m! App tá»‡ quÃ¡!"    â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â”‚  Khi dÃ¹ng NHIá»€U component cÃ¹ng lÃºc?                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  Click! â†’ 500ms â†’ 1000ms â†’ UI má»›i! â”‚              â”‚
  â”‚  â”‚  Animation giáº­t tá»«ng frame!          â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2. Ba NguyÃªn NhÃ¢n ChÃ­nh

```
  3 NGUYÃŠN NHÃ‚N CHÃNH â€” PERFORMANCE REACT:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â‘  shouldComponentUpdate sai!                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â†’ PureComponent KHÃ”NG cá»©u báº¡n!                â”‚  â”‚
  â”‚  â”‚  â†’ VÃ¬ ReactElement Má»šI má»—i láº§n render!         â”‚  â”‚
  â”‚  â”‚  â†’ Shallow compare LUÃ”N tráº£ true!               â”‚  â”‚
  â”‚  â”‚  â†’ Component render láº¡i KHÃ”NG Cáº¦N THIáº¾T!       â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  â‘¡ Thay Ä‘á»•i DOM quÃ¡ nhanh!                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â†’ Äá»c/ghi DOM xen káº½ = LAYOUT THRASHING!     â”‚  â”‚
  â”‚  â”‚  â†’ Trigger nhiá»u Layout/Reflow khÃ´ng cáº§n!       â”‚  â”‚
  â”‚  â”‚  â†’ Animation mÆ°á»£t â†’ giáº­t cá»¥c!                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  â‘¢ Láº¡m dá»¥ng events vÃ  callbacks!                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â†’ onChange má»—i keystroke = HÃ€NG TRÄ‚M calls!   â”‚  â”‚
  â”‚  â”‚  â†’ Má»—i call â†’ parent render â†’ DOM update!     â”‚  â”‚
  â”‚  â”‚  â†’ Cáº§n debounce/throttle!                        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§2. shouldComponentUpdate â€” Báº«y MÃ  AI CÅ©ng Máº¯c!

### 2.1. shouldComponentUpdate LÃ  GÃ¬?

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// shouldComponentUpdate â€” LIFECYCLE METHOD Cá»¦A REACT!
// â†’ Quyáº¿t Ä‘á»‹nh component CÃ“ Cáº¦N render láº¡i hay khÃ´ng!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// React.Component Máº¶C Äá»ŠNH:
class MyComponent extends React.Component {
  // shouldComponentUpdate Máº¶C Äá»ŠNH = return true!
  // â†’ LUÃ”N render láº¡i khi parent render!
  // â†’ LUÃ”N render láº¡i khi setState!

  shouldComponentUpdate(nextProps, nextState) {
    return true; // â† Máº¶C Äá»ŠNH! LUÃ”N RENDER!
  }

  render() {
    return <div>{this.props.children}</div>;
  }
}
```

```
  shouldComponentUpdate â€” LUá»’NG HOáº T Äá»˜NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Parent render() Ä‘Æ°á»£c gá»i:                             â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚ Parent   â”‚ â”€â”€â†’â”‚ shouldComponentUpdate â”‚              â”‚
  â”‚  â”‚ render() â”‚    â”‚ (nextProps, nextState)â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                              â”‚                          â”‚
  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚                    â”‚                    â”‚               â”‚
  â”‚                    â–¼                    â–¼               â”‚
  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
  â”‚            â”‚ return   â”‚        â”‚ return   â”‚            â”‚
  â”‚            â”‚ true     â”‚        â”‚ false    â”‚            â”‚
  â”‚            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚                 â”‚                    â”‚                   â”‚
  â”‚                 â–¼                    â–¼                   â”‚
  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
  â”‚         â”‚ render() â”‚        â”‚ KHÃ”NG render â”‚           â”‚
  â”‚         â”‚ CHáº Y!    â”‚        â”‚ TIáº¾T KIá»†M!  â”‚           â”‚
  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
  â”‚                                                        â”‚
  â”‚  â†’ true: render() cháº¡y â†’ VDOM diff â†’ DOM update!     â”‚
  â”‚  â†’ false: SKIP! KhÃ´ng lÃ m gÃ¬ cáº£! NHANH!              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2. Báº«y #1 â€” Shallow Compare Children!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BáºªY #1: So sÃ¡nh shallow vá»›i children!
// â†’ LUÃ”N tráº£ true! KHÃ”NG BAO GIá»œ ngÄƒn render!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class MyWrapper extends React.Component {
  shouldComponentUpdate(nextProps) {
    // âŒ SAI! LUÃ”N TRáº¢ TRUE!
    return this.props.children !== nextProps.children;
  }

  render() {
    return <div className="wrapper">{this.props.children}</div>;
  }
}

// Sá»¬ Dá»¤NG:
function App() {
  return (
    <MyWrapper>
      <p>Hello World</p> {/* â† ÄÃ‚Y LÃ€ BáºªY! */}
    </MyWrapper>
  );
}
```

### 2.3. Táº¡i Sao LUÃ”N Tráº£ True?

```
  Táº I SAO this.props.children !== nextProps.children LUÃ”N TRUE?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Má»—i láº§n App render(), React táº¡o ReactElement Má»šI!   â”‚
  â”‚                                                        â”‚
  â”‚  Láº¦N RENDER 1:                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  React.createElement('p', null,      â”‚              â”‚
  â”‚  â”‚    'Hello World')                    â”‚              â”‚
  â”‚  â”‚                                      â”‚              â”‚
  â”‚  â”‚  â†’ Tráº£ vá» OBJECT Má»šI:              â”‚              â”‚
  â”‚  â”‚  { type: 'p',                        â”‚              â”‚
  â”‚  â”‚    props: { children: 'Hello World' }â”‚              â”‚
  â”‚  â”‚    ref: null,                        â”‚              â”‚
  â”‚  â”‚    key: null }                       â”‚              â”‚
  â”‚  â”‚                                      â”‚              â”‚
  â”‚  â”‚  Tham chiáº¿u: 0x001 â† Äá»ŠA CHá»ˆ A!  â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â”‚  Láº¦N RENDER 2 (parent render láº¡i):                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  React.createElement('p', null,      â”‚              â”‚
  â”‚  â”‚    'Hello World')                    â”‚              â”‚
  â”‚  â”‚                                      â”‚              â”‚
  â”‚  â”‚  â†’ Tráº£ vá» OBJECT Má»šI KHÃC:         â”‚              â”‚
  â”‚  â”‚  { type: 'p',                        â”‚              â”‚
  â”‚  â”‚    props: { children: 'Hello World' }â”‚              â”‚
  â”‚  â”‚    ref: null,                        â”‚              â”‚
  â”‚  â”‚    key: null }                       â”‚              â”‚
  â”‚  â”‚                                      â”‚              â”‚
  â”‚  â”‚  Tham chiáº¿u: 0x002 â† Äá»ŠA CHá»ˆ B!  â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â”‚  SO SÃNH:                                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  0x001 !== 0x002  â†’  TRUE!          â”‚              â”‚
  â”‚  â”‚                                      â”‚              â”‚
  â”‚  â”‚  Ná»˜I DUNG GIá»NG Há»†T NHAU!          â”‚              â”‚
  â”‚  â”‚  NHÆ¯NG THAM CHIáº¾U KHÃC NHAU!        â”‚              â”‚
  â”‚  â”‚                                      â”‚              â”‚
  â”‚  â”‚  â†’ shouldComponentUpdate = true!    â”‚              â”‚
  â”‚  â”‚  â†’ RENDER Láº I! VÃ” ÃCH!            â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ NGUYÃŠN NHÃ‚N Gá»C Rá»„:                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  JSX biÃªn dá»‹ch thÃ nh                 â”‚              â”‚
  â”‚  â”‚  React.createElement() â€”             â”‚              â”‚
  â”‚  â”‚  Má»–I Láº¦N gá»i Táº O OBJECT Má»šI!      â”‚              â”‚
  â”‚  â”‚  â†’ {} !== {} LUÃ”N TRUE!             â”‚              â”‚
  â”‚  â”‚  â†’ Báº¥t ká»ƒ ná»™i dung bÃªn trong!      â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4. Tá»± Viáº¿t â€” Chá»©ng Minh Báº«y!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHá»¨NG MINH: ReactElement Má»šI má»—i láº§n render!
// Cháº¡y trong Node.js hoáº·c Browser!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â‘  MÃ” PHá»NG React.createElement:
function createElement(type, props, ...children) {
  return {
    type: type,
    props: { ...props, children: children },
    ref: null,
    key: null,
  };
}

// â‘¡ Gá»ŒI 2 Láº¦N Vá»šI CÃ™NG THAM Sá»:
var element1 = createElement("p", null, "Hello World");
var element2 = createElement("p", null, "Hello World");

// â‘¢ SO SÃNH:
console.log(element1 === element2);
// false! â† Äá»ŠA CHá»ˆ Bá»˜ NHá»š KHÃC NHAU!

console.log(element1.type === element2.type);
// true! â† 'p' === 'p' (string primitive!)

console.log(element1.props === element2.props);
// false! â† OBJECT Má»šI Má»–I Láº¦N!

console.log(element1.props.children[0] === element2.props.children[0]);
// true! â† 'Hello World' === 'Hello World' (string primitive!)

// â‘£ Káº¾T LUáº¬N:
// â†’ Object literals ({}) Táº O INSTANCE Má»šI má»—i láº§n!
// â†’ Primitive values ('string', 123) thÃ¬ SO SÃNH Báº°NG!
// â†’ ReactElement lÃ  Object â†’ LUÃ”N !== !!!
```

```
  Káº¾T QUáº¢ CHá»¨NG MINH:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  element1 === element2        â†’ false! (object!)      â”‚
  â”‚  element1.type === element2.type â†’ true! (string!)    â”‚
  â”‚  element1.props === element2.props â†’ false! (object!) â”‚
  â”‚  children[0] === children[0]  â†’ true! (string!)       â”‚
  â”‚                                                        â”‚
  â”‚  QUY LUáº¬T:                                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Primitive (string, number, boolean):             â”‚  â”‚
  â”‚  â”‚  â†’ SO SÃNH GIÃ TRá»Š! 'a' === 'a' â†’ true!      â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Object, Array, Function:                         â”‚  â”‚
  â”‚  â”‚  â†’ SO SÃNH THAM CHIáº¾U! {} !== {} â†’ true!       â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  ReactElement = Object:                           â”‚  â”‚
  â”‚  â”‚  â†’ LUÃ”N !== ! KHÃ”NG BAO GIá»œ ===!               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§3. PureComponent â€” TÆ°á»Ÿng Cá»©u MÃ  KhÃ´ng Cá»©u!

### 3.1. PureComponent LÃ  GÃ¬?

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PureComponent â€” shouldComponentUpdate tá»± Ä‘á»™ng!
// â†’ Thay vÃ¬ return true, nÃ³ SHALLOW COMPARE!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â‘  React.Component â€” Máº¶C Äá»ŠNH:
class NormalComponent extends React.Component {
  // shouldComponentUpdate â†’ return true (luÃ´n render!)
  render() {
    return <div>{this.props.children}</div>;
  }
}

// â‘¡ React.PureComponent â€” Tá»° Äá»˜NG:
class PureComp extends React.PureComponent {
  // shouldComponentUpdate â†’ shallow compare props + state!
  // KHÃ”NG Cáº¦N tá»± viáº¿t!
  render() {
    return <div>{this.props.children}</div>;
  }
}

// PureComponent Tá»° Äá»˜NG lÃ m Ä‘iá»u nÃ y:
// shouldComponentUpdate(nextProps, nextState) {
//     return !shallowEqual(this.props, nextProps)
//         || !shallowEqual(this.state, nextState);
// }
```

### 3.2. shallowEqual â€” Tá»± Viáº¿t Tá»« Äáº§u!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SHALLOW EQUAL â€” Tá»° VIáº¾T Tá»ª Äáº¦U!
// ÄÃ¢y chÃ­nh lÃ  logic bÃªn trong PureComponent!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function shallowEqual(objA, objB) {
  // â‘  CÃ™NG THAM CHIáº¾U â†’ báº±ng nhau!
  if (objA === objB) {
    return true;
  }

  // â‘¡ Má»™t trong hai khÃ´ng pháº£i object â†’ khÃ´ng báº±ng!
  if (
    typeof objA !== "object" ||
    objA === null ||
    typeof objB !== "object" ||
    objB === null
  ) {
    return false;
  }

  // â‘¢ Láº¥y danh sÃ¡ch keys:
  var keysA = Object.keys(objA);
  var keysB = Object.keys(objB);

  // â‘£ Sá»‘ lÆ°á»£ng keys khÃ¡c nhau â†’ khÃ´ng báº±ng!
  if (keysA.length !== keysB.length) {
    return false;
  }

  // â‘¤ So sÃ¡nh Tá»ªNG key â€” CHá»ˆ Má»˜T Cáº¤P Äá»˜!
  for (var i = 0; i < keysA.length; i++) {
    var key = keysA[i];

    // Key khÃ´ng tá»“n táº¡i trong objB?
    if (!objB.hasOwnProperty(key)) {
      return false;
    }

    // GiÃ¡ trá»‹ KHÃC THAM CHIáº¾U?
    if (objA[key] !== objB[key]) {
      return false;
    }
  }

  // â‘¥ Táº¥t cáº£ keys giá»‘ng nhau!
  return true;
}
```

```
  SHALLOW EQUAL â€” CÃCH HOáº T Äá»˜NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  "SHALLOW" = CHá»ˆ SO SÃNH Cáº¤P Äá»˜ 1!                  â”‚
  â”‚                                                        â”‚
  â”‚  objA = { name: 'John', age: 30 }                     â”‚
  â”‚  objB = { name: 'John', age: 30 }                     â”‚
  â”‚                                                        â”‚
  â”‚  shallowEqual(objA, objB):                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â‘  objA === objB? â†’ false (khÃ¡c tham chiáº¿u!)  â”‚  â”‚
  â”‚  â”‚  â‘¡ keys: ['name', 'age'] === ['name', 'age']   â”‚  â”‚
  â”‚  â”‚  â‘¢ objA.name === objB.name? 'John' === 'John'  â”‚  â”‚
  â”‚  â”‚     â†’ true! (string primitive!)                 â”‚  â”‚
  â”‚  â”‚  â‘£ objA.age === objB.age? 30 === 30             â”‚  â”‚
  â”‚  â”‚     â†’ true! (number primitive!)                 â”‚  â”‚
  â”‚  â”‚  â‘¤ Káº¿t quáº£: TRUE! Báº°NG NHAU!                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  NHÆ¯NG Náº¾U CÃ“ OBJECT Lá»’NG NHAU (nested):             â”‚
  â”‚                                                        â”‚
  â”‚  objA = { name: 'John', address: { city: 'HN' } }    â”‚
  â”‚  objB = { name: 'John', address: { city: 'HN' } }    â”‚
  â”‚                                                        â”‚
  â”‚  shallowEqual(objA, objB):                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â‘  objA === objB? â†’ false                      â”‚  â”‚
  â”‚  â”‚  â‘¡ objA.name === objB.name? â†’ true (string!)   â”‚  â”‚
  â”‚  â”‚  â‘¢ objA.address === objB.address?               â”‚  â”‚
  â”‚  â”‚     { city: 'HN' } !== { city: 'HN' }          â”‚  â”‚
  â”‚  â”‚     â†’ FALSE! KHÃC THAM CHIáº¾U!                  â”‚  â”‚
  â”‚  â”‚  â‘£ Káº¿t quáº£: FALSE! KHÃ”NG Báº°NG!                â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  âš  Ná»™i dung giá»‘ng nhau                          â”‚  â”‚
  â”‚  â”‚    NHÆ¯NG shallow chá»‰ so sÃ¡nh ===                 â”‚  â”‚
  â”‚  â”‚    á»Ÿ Cáº¤P Äá»˜ 1!                                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3. Táº¡i Sao PureComponent THáº¤T Báº I Vá»›i Children?

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHá»¨NG MINH: PureComponent THáº¤T Báº I Vá»šI CHILDREN!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â‘  COMPONENT:
class PureWrapper extends React.PureComponent {
  render() {
    console.log("PureWrapper rendered!");
    return <div>{this.props.children}</div>;
  }
}

// â‘¡ Sá»¬ Dá»¤NG:
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = { count: 0 };
  }

  render() {
    return (
      <div>
        <button onClick={() => this.setState({ count: this.state.count + 1 })}>
          Click me ({this.state.count})
        </button>

        <PureWrapper>
          <p>Hello World</p>
        </PureWrapper>
      </div>
    );
  }
}

// â‘¢ Káº¾T QUáº¢:
// Má»—i láº§n click button:
// â†’ App render() gá»i
// â†’ <p>Hello World</p> = React.createElement() Má»šI!
// â†’ PureComponent shallow compare:
//   this.props.children !== nextProps.children â†’ TRUE!
// â†’ RENDER Láº I! PureComponent VÃ” Dá»¤NG!
```

```
  Táº I SAO PureComponent KHÃ”NG Cá»¨U ÄÆ¯á»¢C:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  App.render() láº§n 1:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  props cho PureWrapper = {                       â”‚  â”‚
  â”‚  â”‚    children: createElement('p', null, 'Hello')   â”‚  â”‚
  â”‚  â”‚    â†‘ Object A â€” tham chiáº¿u 0x100                â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  App.render() láº§n 2 (click button):                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  props cho PureWrapper = {                       â”‚  â”‚
  â”‚  â”‚    children: createElement('p', null, 'Hello')   â”‚  â”‚
  â”‚  â”‚    â†‘ Object B â€” tham chiáº¿u 0x200  â† Má»šI!      â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  PureComponent.shouldComponentUpdate:                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  shallowEqual(oldProps, newProps):                â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  oldProps.children === newProps.children?         â”‚  â”‚
  â”‚  â”‚  Object A (0x100) === Object B (0x200)?          â”‚  â”‚
  â”‚  â”‚  â†’ FALSE! KHÃC THAM CHIáº¾U!                     â”‚  â”‚
  â”‚  â”‚  â†’ shallowEqual tráº£ FALSE!                      â”‚  â”‚
  â”‚  â”‚  â†’ shouldComponentUpdate tráº£ TRUE!              â”‚  â”‚
  â”‚  â”‚  â†’ RENDER Láº I!                                  â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  ğŸ’¡ PureComponent CHá»ˆ há»¯u Ã­ch khi Táº¤T Cáº¢     â”‚  â”‚
  â”‚  â”‚  props lÃ  primitive (string, number, boolean)! â”‚  â”‚
  â”‚  â”‚  Khi cÃ³ children (ReactElement) â†’ VÃ” Dá»¤NG!    â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§4. Deep Compare â€” Giáº£i PhÃ¡p VÃ  CÃ¡i Báº«y Tiáº¿p Theo!

### 4.1. Ã TÆ°á»Ÿng Äáº§u TiÃªn â€” Deep Equal!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEEP EQUAL â€” Tá»° VIáº¾T Tá»ª Äáº¦U!
// So sÃ¡nh SÃ‚U táº¥t cáº£ cÃ¡c cáº¥p Ä‘á»™!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function deepEqual(objA, objB) {
  // â‘  CÃ¹ng tham chiáº¿u hoáº·c cÃ¹ng primitive:
  if (objA === objB) {
    return true;
  }

  // â‘¡ Náº¿u KHÃ”NG pháº£i object â†’ primitive khÃ¡c nhau!
  if (
    typeof objA !== "object" ||
    objA === null ||
    typeof objB !== "object" ||
    objB === null
  ) {
    return false;
  }

  // â‘¢ Xá»¬ LÃ ARRAY:
  if (Array.isArray(objA) && Array.isArray(objB)) {
    if (objA.length !== objB.length) return false;
    for (var i = 0; i < objA.length; i++) {
      // Äá»† QUY! So sÃ¡nh sÃ¢u tá»«ng pháº§n tá»­!
      if (!deepEqual(objA[i], objB[i])) return false;
    }
    return true;
  }

  // â‘£ Má»™t cÃ¡i array, má»™t cÃ¡i khÃ´ng â†’ khÃ¡c!
  if (Array.isArray(objA) !== Array.isArray(objB)) {
    return false;
  }

  // â‘¤ Xá»¬ LÃ OBJECT:
  var keysA = Object.keys(objA);
  var keysB = Object.keys(objB);

  if (keysA.length !== keysB.length) return false;

  for (var i = 0; i < keysA.length; i++) {
    var key = keysA[i];
    if (!objB.hasOwnProperty(key)) return false;

    // Äá»† QUY! So sÃ¡nh sÃ¢u giÃ¡ trá»‹!
    if (!deepEqual(objA[key], objB[key])) return false;
  }

  return true;
}

// â‘¥ THá»¬ NGHIá»†M:
var a = { name: "John", address: { city: "HN", zip: "100000" } };
var b = { name: "John", address: { city: "HN", zip: "100000" } };

console.log(a === b); // false! (tham chiáº¿u!)
console.log(deepEqual(a, b)); // true!  (ná»™i dung!)
```

### 4.2. Táº¡i Sao Deep Equal KHÃ”NG PHáº¢I Giáº£i PhÃ¡p Tá»‘t?

```
  DEEP EQUAL â€” 2 Váº¤N Äá»€ Lá»šN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€ 1: Tá»N THá»œI GIAN!                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  ReactElement cÃ³ cáº¥u trÃºc PHá»¨C Táº P:            â”‚  â”‚
  â”‚  â”‚  {                                               â”‚  â”‚
  â”‚  â”‚    type: 'div',                                  â”‚  â”‚
  â”‚  â”‚    props: {                                      â”‚  â”‚
  â”‚  â”‚      className: 'container',                     â”‚  â”‚
  â”‚  â”‚      children: [                                 â”‚  â”‚
  â”‚  â”‚        {                                         â”‚  â”‚
  â”‚  â”‚          type: 'h1',                             â”‚  â”‚
  â”‚  â”‚          props: {                                â”‚  â”‚
  â”‚  â”‚            children: [                           â”‚  â”‚
  â”‚  â”‚              {                                   â”‚  â”‚
  â”‚  â”‚                type: 'span',                     â”‚  â”‚
  â”‚  â”‚                props: {                          â”‚  â”‚
  â”‚  â”‚                  children: ['Hello']             â”‚  â”‚
  â”‚  â”‚                }                                 â”‚  â”‚
  â”‚  â”‚              }                                   â”‚  â”‚
  â”‚  â”‚            ]                                     â”‚  â”‚
  â”‚  â”‚          }                                       â”‚  â”‚
  â”‚  â”‚        }                                         â”‚  â”‚
  â”‚  â”‚      ]                                           â”‚  â”‚
  â”‚  â”‚    }                                             â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Deep compare pháº£i DUYá»†T QUA Má»ŒI Cáº¤P Äá»˜!     â”‚  â”‚
  â”‚  â”‚  â†’ Cáº¥u trÃºc cÃ ng sÃ¢u â†’ thá»i gian cÃ ng lÃ¢u!   â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  THá»œI GIAN:                                      â”‚  â”‚
  â”‚  â”‚  shouldComponentUpdate: 5ms                      â”‚  â”‚
  â”‚  â”‚  render():              3ms                      â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â†’ shouldComponentUpdate CHáº¬M HÆ N render!     â”‚  â”‚
  â”‚  â”‚  â†’ PHáº¢N TÃC Dá»¤NG! CHáº¬M HÆ N KHÃ”NG LÃ€M GÃŒ!   â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€ 2: PHá»¤ THUá»˜C VÃ€O IMPLEMENTATION!             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  ReactElement lÃ  internal implementation!        â”‚  â”‚
  â”‚  â”‚  â†’ Cáº¥u trÃºc CÃ“ THá»‚ THAY Äá»”I giá»¯a versions! â”‚  â”‚
  â”‚  â”‚  â†’ React 16 Fiber: cáº¥u trÃºc HOÃ€N TOÃ€N KHÃC!   â”‚  â”‚
  â”‚  â”‚  â†’ Deep compare dá»±a trÃªn cáº¥u trÃºc cÅ© â†’ Há»NG! â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  âŒ KHÃ”NG NÃŠN dá»±a vÃ o internal implementation!â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3. Lá»i KhuyÃªn Tá»« Evan You (Vue.js)

```
  EVAN YOU NÃ“I GÃŒ Vá»€ Váº¤N Äá»€ NÃ€Y?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Evan You (tÃ¡c giáº£ Vue.js) â€” tráº£ lá»i feature request  â”‚
  â”‚  thÃªm shouldComponentUpdate vÃ o Vue:                   â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  "Váº¥n Ä‘á» nÃ y KHÃ”NG THá»‚ giáº£i quyáº¿t báº±ng         â”‚  â”‚
  â”‚  â”‚  'diffing' virtual DOM vÃ¬ cÃ³ QUÃ NHIá»€U           â”‚  â”‚
  â”‚  â”‚  biáº¿n sá»‘ chÆ°a biáº¿t. Dá»±a vÃ o React Elements      â”‚  â”‚
  â”‚  â”‚  Ä‘á»ƒ phÃ¡t hiá»‡n thay Ä‘á»•i state cá»§a component       â”‚  â”‚
  â”‚  â”‚  KHÃ”NG PHáº¢I lÃ  giáº£i phÃ¡p kháº£ thi."              â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Ã NGHÄ¨A:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  âŒ Äá»ªNG so sÃ¡nh ReactElement/children/props   â”‚  â”‚
  â”‚  â”‚     kiá»ƒu object!                                 â”‚  â”‚
  â”‚  â”‚  âœ… HÃƒY dÃ¹ng STATE CHANGES â€” number, string,   â”‚  â”‚
  â”‚  â”‚     boolean â€” Ä‘á»ƒ quyáº¿t Ä‘á»‹nh update!              â”‚  â”‚
  â”‚  â”‚  âœ… So sÃ¡nh primitives NHANH vÃ  TIN Cáº¬Y!       â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§5. Giáº£i PhÃ¡p ÄÃºng â€” State-Based shouldComponentUpdate!

### 5.1. NguyÃªn Táº¯c: DÃ¹ng Primitive Props!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GIáº¢I PHÃP: DÃ™NG PRIMITIVE PROPS THAY VÃŒ CHILDREN!
// â†’ So sÃ¡nh number, string, boolean â€” NHANH vÃ  CHÃNH XÃC!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âŒ SAI â€” so sÃ¡nh children (object):
class BadWrapper extends React.Component {
  shouldComponentUpdate(nextProps) {
    // children lÃ  ReactElement (object)
    // â†’ LUÃ”N tráº£ true vÃ¬ object má»›i má»—i láº§n!
    return this.props.children !== nextProps.children;
  }
  render() {
    return <div>{this.props.children}</div>;
  }
}

// âœ… ÄÃšNG â€” dÃ¹ng primitive prop Ä‘á»ƒ ra quyáº¿t Ä‘á»‹nh:
class GoodWrapper extends React.Component {
  shouldComponentUpdate(nextProps) {
    // version lÃ  number â€” so sÃ¡nh NHANH vÃ  CHÃNH XÃC!
    return this.props.version !== nextProps.version;
  }
  render() {
    return <div>{this.props.children}</div>;
  }
}

// Sá»¬ Dá»¤NG:
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = { data: "Hello", version: 0 };
  }

  updateData() {
    this.setState({
      data: "World",
      version: this.state.version + 1, // â† TÄ‚NG KHI CÃ“ THAY Äá»”I!
    });
  }

  render() {
    return (
      <GoodWrapper version={this.state.version}>
        <p>{this.state.data}</p>
      </GoodWrapper>
    );
  }
}
```

```
  SO SÃNH 2 CÃCH TIáº¾P Cáº¬N:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  âŒ SO SÃNH OBJECT (children):                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  this.props.children !== nextProps.children       â”‚  â”‚
  â”‚  â”‚  â†’ Object A !== Object B                        â”‚  â”‚
  â”‚  â”‚  â†’ LUÃ”N TRUE (vÃ¬ object má»›i má»—i render!)      â”‚  â”‚
  â”‚  â”‚  â†’ LUÃ”N render láº¡i! VÃ” Dá»¤NG!                   â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  âœ… SO SÃNH PRIMITIVE (version, id, name):             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  this.props.version !== nextProps.version         â”‚  â”‚
  â”‚  â”‚  â†’ 0 !== 0                                      â”‚  â”‚
  â”‚  â”‚  â†’ FALSE! KHÃ”NG RENDER! TIáº¾T KIá»†M!             â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â†’ 0 !== 1                                      â”‚  â”‚
  â”‚  â”‚  â†’ TRUE! RENDER! CÃ“ THAY Äá»”I THá»°C Sá»°!        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2. Tá»± Viáº¿t â€” HOC shouldComponentUpdate!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HOC (HIGHER-ORDER COMPONENT) â€” Tá»° VIáº¾T Tá»ª Äáº¦U!
// Má»Ÿ rá»™ng shouldComponentUpdate cho Báº¤T Ká»² component!
// KhÃ´ng cáº§n thÆ° viá»‡n!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â‘  HIá»‚U HOC â€” HÃ m nháº­n Component, tráº£ Component Má»šI:
// HOC = Higher-Order Component = HÃ m báº­c cao cho Component!
//
// Giá»‘ng nhÆ°: hÃ m báº­c cao nháº­n function, tráº£ function má»›i:
//   function double(fn) { return (x) => fn(x) * 2; }
//
// HOC nháº­n Component, tráº£ Component má»›i:
//   function enhance(Comp) { return class extends Comp {...} }

// â‘¡ SHALLOW EQUAL (Ä‘Ã£ viáº¿t á»Ÿ Â§3.2):
function shallowEqual(objA, objB) {
  if (objA === objB) return true;
  if (
    typeof objA !== "object" ||
    objA === null ||
    typeof objB !== "object" ||
    objB === null
  )
    return false;

  var keysA = Object.keys(objA);
  var keysB = Object.keys(objB);
  if (keysA.length !== keysB.length) return false;

  for (var i = 0; i < keysA.length; i++) {
    var key = keysA[i];
    if (!objB.hasOwnProperty(key)) return false;
    if (objA[key] !== objB[key]) return false;
  }
  return true;
}

// â‘¢ HOC â€” THÃ”NG MINH HÆ N PureComponent:
function withSmartUpdate(WrappedComponent, compareKeys) {
  // compareKeys = cÃ¡c props Cáº¦N so sÃ¡nh!
  // â†’ Chá»‰ so sÃ¡nh PRIMITIVE props!
  // â†’ Bá» QUA children vÃ  object props!

  return class SmartComponent extends WrappedComponent {
    shouldComponentUpdate(nextProps, nextState) {
      // Náº¿u cÃ³ compareKeys â†’ chá»‰ so sÃ¡nh keys Ä‘Ã³!
      if (compareKeys && compareKeys.length > 0) {
        for (var i = 0; i < compareKeys.length; i++) {
          var key = compareKeys[i];
          if (this.props[key] !== nextProps[key]) {
            return true; // â† CÃ“ THAY Äá»”I! RENDER!
          }
        }
        // State thay Ä‘á»•i?
        if (!shallowEqual(this.state, nextState)) {
          return true;
        }
        return false; // â† KHÃ”NG THAY Äá»”I! SKIP!
      }

      // Náº¿u khÃ´ng cÃ³ compareKeys â†’ so sÃ¡nh táº¥t cáº£
      // NHÆ¯NG bá» qua children!
      var propsChanged = false;
      var allKeys = Object.keys(nextProps);
      for (var i = 0; i < allKeys.length; i++) {
        var key = allKeys[i];
        if (key === "children") continue; // â† Bá» QUA!
        if (this.props[key] !== nextProps[key]) {
          propsChanged = true;
          break;
        }
      }

      if (propsChanged) return true;
      if (!shallowEqual(this.state, nextState)) return true;
      return false;
    }
  };
}

// â‘£ Sá»¬ Dá»¤NG:
class MyList extends React.Component {
  render() {
    return (
      <ul>
        {this.props.items.map(function (item) {
          return <li key={item.id}>{item.name}</li>;
        })}
      </ul>
    );
  }
}

// Chá»‰ re-render khi 'version' hoáº·c 'filter' thay Ä‘á»•i!
var SmartList = withSmartUpdate(MyList, ["version", "filter"]);
```

```
  HOC withSmartUpdate â€” CÃCH HOáº T Äá»˜NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  withSmartUpdate(MyComponent, ['version', 'filter']):  â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
  â”‚  â”‚ MyComponent      â”‚ â”€â”€â†’ â”‚ SmartComponent    â”‚        â”‚
  â”‚  â”‚ (gá»‘c, ko sCU)   â”‚      â”‚ (extends MyComp) â”‚        â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
  â”‚                                     â”‚                   â”‚
  â”‚                           shouldComponentUpdate:        â”‚
  â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
  â”‚                           â”‚ CHá»ˆ so sÃ¡nh:        â”‚      â”‚
  â”‚                           â”‚ â†’ version (number) â”‚      â”‚
  â”‚                           â”‚ â†’ filter (string)  â”‚      â”‚
  â”‚                           â”‚                     â”‚      â”‚
  â”‚                           â”‚ Bá» QUA:             â”‚      â”‚
  â”‚                           â”‚ â†’ children âŒ      â”‚      â”‚
  â”‚                           â”‚ â†’ items (array) âŒ â”‚      â”‚
  â”‚                           â”‚ â†’ style (object) âŒâ”‚      â”‚
  â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
  â”‚                                                        â”‚
  â”‚  Káº¾T QUáº¢:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  version: 1 â†’ 1?  SKIP! KhÃ´ng render!          â”‚  â”‚
  â”‚  â”‚  filter: 'a' â†’ 'a'?  SKIP! KhÃ´ng render!      â”‚  â”‚
  â”‚  â”‚  version: 1 â†’ 2?  RENDER! CÃ³ thay Ä‘á»•i tháº­t!   â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ KEY INSIGHT:                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â†’ DÃ¹ng INHERITANCE INVERSION!                  â”‚  â”‚
  â”‚  â”‚  â†’ class Smart extends WrappedComponent!        â”‚  â”‚
  â”‚  â”‚  â†’ CÃ³ quyá»n truy cáº­p this.state, this.props!   â”‚  â”‚
  â”‚  â”‚  â†’ Override shouldComponentUpdate!               â”‚  â”‚
  â”‚  â”‚  â†’ Bá» qua props lÃ  object/ReactElement!        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3. So SÃ¡nh Tá»•ng Há»£p â€” CÃ¡c CÃ¡ch Tiáº¿p Cáº­n!

```
  SO SÃNH Táº¤T Cáº¢ CÃC CÃCH TIáº¾P Cáº¬N:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚ CÃ¡ch tiáº¿p cáº­n â”‚ Tá»‘c Ä‘á»™  â”‚ ChÃ­nh xÃ¡câ”‚ Khi nÃ o?   â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Component     â”‚ Cháº­m    â”‚ N/A      â”‚ Máº·c Ä‘á»‹nh   â”‚  â”‚
  â”‚  â”‚ (luÃ´n render) â”‚ nháº¥t    â”‚          â”‚ React      â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ PureComponent â”‚ Nhanh   â”‚ SAI vá»›i  â”‚ Props chá»‰  â”‚  â”‚
  â”‚  â”‚ (shallow)     â”‚ hÆ¡n     â”‚ children â”‚ primitives â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ Deep Compare  â”‚ CÃ“ THá»‚  â”‚ ÄÃºng     â”‚ KHÃ”NG NÃŠN â”‚  â”‚
  â”‚  â”‚               â”‚ CHáº¬M HÆ Nâ”‚ nhÆ°ng    â”‚ DÃ™NG!      â”‚  â”‚
  â”‚  â”‚               â”‚ RENDER! â”‚ cháº­m!    â”‚            â”‚  â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
  â”‚  â”‚ withSmartUp-  â”‚ Nhanh   â”‚ ÄÃºng!    â”‚ KHUYÃŠN    â”‚  â”‚
  â”‚  â”‚ date (HOC)    â”‚ nháº¥t!   â”‚          â”‚ DÃ™NG!      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ KEY TAKEAWAY:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Äá»ªNG so sÃ¡nh ReactElement trong sCU!           â”‚  â”‚
  â”‚  â”‚  â†’ DÃ¹ng STATE CHANGES (primitive values!)       â”‚  â”‚
  â”‚  â”‚  â†’ Hoáº·c dÃ¹ng HOC bá» qua children!              â”‚  â”‚
  â”‚  â”‚  â†’ Hoáº·c dÃ¹ng prop 'version' / 'lastUpdated'!   â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§6. Thao TÃ¡c DOM â€” Layout Thrashing!

### 6.1. Browser Rendering Pipeline

```
  BROWSER RENDERING PIPELINE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  JavaScript â†’ Style â†’ Layout â†’ Paint â†’ Composite     â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â”‚   JS    â”‚â†’â”‚ Style â”‚â†’â”‚ Layout â”‚â†’â”‚ Paint â”‚â†’â”‚ Composite  â”‚
  â”‚  â”‚ Thay Ä‘á»•iâ”‚  â”‚ TÃ­nh  â”‚  â”‚ TÃ­nh   â”‚  â”‚ Váº½ tá»«ngâ”‚  â”‚ GhÃ©p layersâ”‚
  â”‚  â”‚  DOM    â”‚  â”‚ CSS   â”‚  â”‚ vá»‹ trÃ­ â”‚  â”‚ pixel â”‚  â”‚ cuá»‘i cÃ¹ng  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                        â”‚
  â”‚  3 Má»¨C Äá»˜ Náº¶NG:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â‘  Thay Ä‘á»•i LAYOUT properties (náº·ng nháº¥t!):    â”‚  â”‚
  â”‚  â”‚     width, height, margin, padding, top, left   â”‚  â”‚
  â”‚  â”‚     â†’ Trigger: Layout + Paint + Composite!     â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â‘¡ Thay Ä‘á»•i PAINT properties (trung bÃ¬nh):     â”‚  â”‚
  â”‚  â”‚     color, background, border-color, visibility â”‚  â”‚
  â”‚  â”‚     â†’ Trigger: Paint + Composite!              â”‚  â”‚
  â”‚  â”‚     â†’ SKIP Layout!                              â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â‘¢ Thay Ä‘á»•i COMPOSITE properties (nháº¹ nháº¥t!): â”‚  â”‚
  â”‚  â”‚     transform, opacity                           â”‚  â”‚
  â”‚  â”‚     â†’ Trigger: CHá»ˆ Composite!                  â”‚  â”‚
  â”‚  â”‚     â†’ SKIP Layout + Paint!                      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ MUá»N ANIMATION MÆ¯á»¢T â†’ dÃ¹ng transform, opacity!   â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2. Layout Thrashing â€” Káº» Giáº¿t Animation!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LAYOUT THRASHING â€” NGUYÃŠN NHÃ‚N ANIMATION GIáº¬T!
// â†’ Äá»ŒC/GHI DOM XEN Káº¼ = Äá»ŒC/GHI/Äá»ŒC/GHI = CHáº¬M!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âŒ SAI â€” Layout Thrashing!
function badResize(elements) {
  for (var i = 0; i < elements.length; i++) {
    // Äá»ŒC: Ä‘á»c chiá»u cao!
    var height = elements[i].offsetHeight; // â† TRIGGER LAYOUT!

    // GHI: thay Ä‘á»•i style!
    elements[i].style.height = height + "px"; // â† TRIGGER LAYOUT!

    // â†’ Má»—i vÃ²ng láº·p: Äá»ŒC â†’ GHI â†’ Äá»ŒC â†’ GHI!
    // â†’ Browser pháº£i TÃNH Láº I Layout Má»–I Láº¦N!
  }
}
```

```
  LAYOUT THRASHING â€” CÃCH NÃ“ Xáº¢Y RA:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  VÃ’NG Láº¶P 1:                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Äá»ŒC offsetHeight â†’ Browser pháº£i tÃ­nh Layout! â”‚  â”‚
  â”‚  â”‚  GHI style.height â†’ DOM thay Ä‘á»•i! Layout cÅ©!  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                 â†“ Layout Bá»Š VÃ” HIá»†U HÃ“A!             â”‚
  â”‚  VÃ’NG Láº¶P 2:                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Äá»ŒC offsetHeight â†’ Pháº£i TÃNH Láº I Layout!    â”‚  â”‚
  â”‚  â”‚  GHI style.height â†’ Layout cÅ© Láº I Ná»®A!       â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                 â†“ Layout Bá»Š VÃ” HIá»†U HÃ“A Láº¦N Ná»®A!    â”‚
  â”‚  VÃ’NG Láº¶P 3:                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Äá»ŒC offsetHeight â†’ Pháº£i TÃNH Láº I Layout!!!  â”‚  â”‚
  â”‚  â”‚  GHI style.height â†’ Layout cÅ©...              â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  10 elements = 10 Layout calculations!                 â”‚
  â”‚  100 elements = 100 Layout calculations! â† CHáº¬M!     â”‚
  â”‚                                                        â”‚
  â”‚  âœ… LÃ TÆ¯á»NG: CHá»ˆ 1 Layout calculation!               â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3. VÃ­ Dá»¥ Thá»±c Táº¿ â€” Collapse Component!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COLLAPSE COMPONENT â€” VÃ Dá»¤ THá»°C Táº¾!
// Component thay Ä‘á»•i height giá»¯a 0 vÃ  content height!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// âŒ SAI â€” Trigger nhiá»u Layout:
class BadCollapse extends React.Component {
  toggle() {
    if (this.isOpen) {
      // Äá»ŒC: láº¥y chiá»u cao content!
      var contentHeight = this.contentEl.scrollHeight;
      // â† TRIGGER LAYOUT Äá»‚ Äá»ŒC!

      // GHI: set height!
      this.containerEl.style.height = contentHeight + "px";
      // â† TRIGGER LAYOUT Äá»‚ GHI!

      // GHI NGAY: force transition to 0!
      this.containerEl.style.height = "0px";
      // â† TRIGGER LAYOUT Láº¦N Ná»®A!
    } else {
      var contentHeight = this.contentEl.scrollHeight;
      this.containerEl.style.height = contentHeight + "px";
    }
    this.isOpen = !this.isOpen;
  }
}

// â†’ 1 Collapse: 3 Layout calculations!
// â†’ 10 Collapse: 30 Layout calculations! = GIáº¬T!
// â†’ TrÃªn mobile: CÃ’N CHáº¬M HÆ N 6x!
```

```
  COLLAPSE â€” KHI DÃ™NG NHIá»€U Láº¦N:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  1 Collapse:                                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Äá»ŒC scrollHeight â†’ Layout calc #1            â”‚  â”‚
  â”‚  â”‚  GHI style.height  â†’ Layout calc #2            â”‚  â”‚
  â”‚  â”‚  GHI style.height  â†’ Layout calc #3            â”‚  â”‚
  â”‚  â”‚  â†’ 3 layout calcs, HÆ I CHáº¬M nhÆ°ng OK!        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  10 Collapse cÃ¹ng lÃºc:                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Collapse 1: Äá»ŒC â†’ GHI â†’ GHI (3 calcs)      â”‚  â”‚
  â”‚  â”‚  Collapse 2: Äá»ŒC â†’ GHI â†’ GHI (3 calcs)      â”‚  â”‚
  â”‚  â”‚  Collapse 3: Äá»ŒC â†’ GHI â†’ GHI (3 calcs)      â”‚  â”‚
  â”‚  â”‚  ...                                             â”‚  â”‚
  â”‚  â”‚  Collapse 10: Äá»ŒC â†’ GHI â†’ GHI (3 calcs)     â”‚  â”‚
  â”‚  â”‚  â†’ 30 layout calcs! GIáº¬T Náº¶NG!                â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ GIáº¢I PHÃP: Gá»˜P táº¥t cáº£ Äá»ŒC trÆ°á»›c,                â”‚
  â”‚  rá»“i Gá»˜P táº¥t cáº£ GHI sau!                              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§7. requestAnimationFrame â€” Batch DOM Operations!

### 7.1. requestAnimationFrame LÃ  GÃ¬?

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// requestAnimationFrame â€” CÃ“ Sáº´N TRONG BROWSER!
// KhÃ´ng cáº§n thÆ° viá»‡n! Browser API gá»‘c!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// requestAnimationFrame = "Cháº¡y callback á»Ÿ FRAME TIáº¾P THEO!"

// â‘  HIá»‚U FRAME:
// Browser render 60fps = 60 frames/giÃ¢y
// Má»—i frame = 16.67ms
//
//   Frame 1    Frame 2    Frame 3    Frame 4
//   â”œâ”€â”€16msâ”€â”€â”¤â”œâ”€â”€16msâ”€â”€â”¤â”œâ”€â”€16msâ”€â”€â”¤â”œâ”€â”€16msâ”€â”€â”¤
//   JSâ”‚Styleâ”‚Layoutâ”‚Paintâ”‚Compositeâ”‚ ... láº·p láº¡i ...
//
// requestAnimationFrame: cháº¡y callback VÃ€O Äáº¦U frame tiáº¿p!

// â‘¡ CÃš PHÃP:
requestAnimationFrame(function () {
  // Code á»Ÿ Ä‘Ã¢y cháº¡y á»Ÿ FRAME TIáº¾P THEO!
  // â†’ Browser cÃ³ thá»i gian gá»™p cÃ¡c thay Ä‘á»•i DOM!
  console.log("Cháº¡y á»Ÿ frame tiáº¿p!");
});
```

```
  requestAnimationFrame â€” THá»œI ÄIá»‚M CHáº Y:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  FRAME HIá»†N Táº I:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  JavaScript cháº¡y:                    â”‚              â”‚
  â”‚  â”‚  â†’ setState()                       â”‚              â”‚
  â”‚  â”‚  â†’ requestAnimationFrame(callback)  â”‚              â”‚
  â”‚  â”‚    â†‘ ÄÄ‚NG KÃ, chÆ°a cháº¡y!          â”‚              â”‚
  â”‚  â”‚  â†’ style.height = '100px'          â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚             â”‚                                           â”‚
  â”‚             â–¼                                           â”‚
  â”‚  FRAME TIáº¾P THEO (16ms sau):                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  callback() CHáº Y!                    â”‚              â”‚
  â”‚  â”‚  â†’ Táº¥t cáº£ thay Ä‘á»•i DOM á»Ÿ Ä‘Ã¢y      â”‚              â”‚
  â”‚  â”‚  â†’ Browser Gá»˜P thÃ nh 1 Layout!     â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚             â”‚                                           â”‚
  â”‚             â–¼                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚  Style â†’ Layout â†’ Paint â†’ Compositeâ”‚              â”‚
  â”‚  â”‚  CHá»ˆ 1 Láº¦N! NHANH!                 â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2. Tá»± Viáº¿t â€” DOM Scheduler (Batch Read/Write)!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DOM SCHEDULER â€” Tá»° VIáº¾T Tá»ª Äáº¦U!
// Gá»™p táº¥t cáº£ Äá»ŒC trÆ°á»›c, GHI sau!
// TÆ°Æ¡ng tá»± Fastdom nhÆ°ng KHÃ”NG Cáº¦N THÆ¯ VIá»†N!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

var DOMScheduler = (function () {
  // â‘  HÃ€NG Äá»¢I:
  var readQueue = []; // CÃ¡c callback Äá»ŒC DOM
  var writeQueue = []; // CÃ¡c callback GHI DOM
  var scheduled = false;

  // â‘¡ Äá»ŒC: Ä‘Äƒng kÃ½ callback Ä‘á»c DOM:
  function read(callback) {
    readQueue.push(callback);
    scheduleFlush();
  }

  // â‘¢ GHI: Ä‘Äƒng kÃ½ callback ghi DOM:
  function write(callback) {
    writeQueue.push(callback);
    scheduleFlush();
  }

  // â‘£ LÃŠN Lá»ŠCH: Ä‘áº£m báº£o chá»‰ 1 rAF:
  function scheduleFlush() {
    if (!scheduled) {
      scheduled = true;
      requestAnimationFrame(flush);
    }
  }

  // â‘¤ Xáº¢ HÃ€NG Äá»¢I:
  function flush() {
    // BÆ¯á»šC 1: Cháº¡y Táº¤T Cáº¢ Ä‘á»c TRÆ¯á»šC!
    var reads = readQueue.slice();
    readQueue.length = 0;

    for (var i = 0; i < reads.length; i++) {
      reads[i]();
    }

    // BÆ¯á»šC 2: Cháº¡y Táº¤T Cáº¢ ghi SAU!
    var writes = writeQueue.slice();
    writeQueue.length = 0;

    for (var i = 0; i < writes.length; i++) {
      writes[i]();
    }

    scheduled = false;

    // BÆ¯á»šC 3: Náº¿u callback ghi táº¡o thÃªm task â†’ láº·p!
    if (readQueue.length > 0 || writeQueue.length > 0) {
      scheduleFlush();
    }
  }

  return {
    read: read,
    write: write,
  };
})();
```

```
  DOMScheduler â€” CÃCH NÃ“ HOáº T Äá»˜NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  âŒ KHÃ”NG CÃ“ DOMScheduler:                             â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Collapse1: Äá»ŒC â†’ GHI â†’ Äá»ŒC â†’ GHI          â”‚  â”‚
  â”‚  â”‚  Collapse2: Äá»ŒC â†’ GHI â†’ Äá»ŒC â†’ GHI          â”‚  â”‚
  â”‚  â”‚  Collapse3: Äá»ŒC â†’ GHI â†’ Äá»ŒC â†’ GHI          â”‚  â”‚
  â”‚  â”‚  â†’ 12 Layout calculations!                      â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  âœ… CÃ“ DOMScheduler:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  requestAnimationFrame:                           â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  PHASE 1 â€” Äá»ŒC Táº¤T Cáº¢:                        â”‚  â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚
  â”‚  â”‚  â”‚  Collapse1.Äá»ŒC scrollHeight      â”‚          â”‚  â”‚
  â”‚  â”‚  â”‚  Collapse2.Äá»ŒC scrollHeight      â”‚          â”‚  â”‚
  â”‚  â”‚  â”‚  Collapse3.Äá»ŒC scrollHeight      â”‚          â”‚  â”‚
  â”‚  â”‚  â”‚  â†’ 1 Layout calc cho táº¥t cáº£!     â”‚          â”‚  â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  PHASE 2 â€” GHI Táº¤T Cáº¢:                         â”‚  â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚
  â”‚  â”‚  â”‚  Collapse1.GHI style.height       â”‚          â”‚  â”‚
  â”‚  â”‚  â”‚  Collapse2.GHI style.height       â”‚          â”‚  â”‚
  â”‚  â”‚  â”‚  Collapse3.GHI style.height       â”‚          â”‚  â”‚
  â”‚  â”‚  â”‚  â†’ 1 Layout calc cho táº¥t cáº£!     â”‚          â”‚  â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  â†’ Tá»”NG: 2 Layout calcs thay vÃ¬ 12!            â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3. Ãp Dá»¥ng â€” Collapse Tá»‘i Æ¯u!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COLLAPSE COMPONENT â€” Tá»I Æ¯U Vá»šI DOMScheduler!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class OptimizedCollapse extends React.Component {
  constructor(props) {
    super(props);
    this.isOpen = false;
    this.containerRef = React.createRef();
    this.contentRef = React.createRef();
  }

  toggle() {
    var containerEl = this.containerRef.current;
    var contentEl = this.contentRef.current;
    var isOpen = this.isOpen;

    // â‘  Äá»ŒC â€” Ä‘Äƒng kÃ½ vÃ o read queue:
    DOMScheduler.read(function () {
      var contentHeight = contentEl.scrollHeight;

      // â‘¡ GHI â€” Ä‘Äƒng kÃ½ vÃ o write queue:
      DOMScheduler.write(function () {
        if (isOpen) {
          containerEl.style.height = "0px";
        } else {
          containerEl.style.height = contentHeight + "px";
        }
      });
    });

    this.isOpen = !this.isOpen;
  }

  render() {
    return (
      <div
        ref={this.containerRef}
        style={{ overflow: "hidden", transition: "height 0.3s" }}
      >
        <div ref={this.contentRef}>{this.props.children}</div>
      </div>
    );
  }
}

// â†’ 10 Collapse cÃ¹ng toggle:
// â†’ Táº¤T Cáº¢ Ä‘á»c TRÆ¯á»šC (1 Layout calc)
// â†’ Táº¤T Cáº¢ ghi SAU (1 Layout calc)
// â†’ Tá»”NG: 2 Layout calcs! MÆ¯á»¢T!
```

### 7.4. Bonus â€” CSS will-change

```
  CSS will-change â€” Sá»¬ Dá»¤NG Cáº¨N THáº¬N!
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  will-change BÃO CHO BROWSER BIáº¾T:                     â”‚
  â”‚  "Property nÃ y Sáº®P thay Ä‘á»•i! Chuáº©n bá»‹ sáºµn!"         â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  .collapse-container {                           â”‚  â”‚
  â”‚  â”‚    will-change: height;                          â”‚  â”‚
  â”‚  â”‚    /* Browser táº¡o layer riÃªng cho element! */    â”‚  â”‚
  â”‚  â”‚    /* â†’ Tá»‘i Æ°u cho animation! */                â”‚  â”‚
  â”‚  â”‚  }                                               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  âš  Cáº¢NH BÃO:                                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  âŒ Äá»ªNG dÃ¹ng everywhere:                       â”‚  â”‚
  â”‚  â”‚  * { will-change: transform, opacity; }         â”‚  â”‚
  â”‚  â”‚  â†’ Táº¡o QUÃ NHIá»€U layers! Tá»‘n RAM GPU!         â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  âœ… CHá»ˆ dÃ¹ng khi Cáº¦N:                           â”‚  â”‚
  â”‚  â”‚  â†’ ThÃªm will-change TRÆ¯á»šC animation báº¯t Ä‘áº§u!  â”‚  â”‚
  â”‚  â”‚  â†’ XÃ³a will-change SAU KHI animation xong!     â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  âœ… Tá»T HÆ N: dÃ¹ng transform thay height!       â”‚  â”‚
  â”‚  â”‚  â†’ transform CHá»ˆ trigger Composite!             â”‚  â”‚
  â”‚  â”‚  â†’ Nhanh nháº¥t cÃ³ thá»ƒ!                            â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§8. Debounce â€” Tá»± Viáº¿t Tá»« Äáº§u!

### 8.1. Váº¥n Äá» â€” onChange Báº¯n LiÃªn Tá»¥c!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Váº¤N Äá»€: onChange Báº®N Má»–I KEYSTROKE!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class SearchInput extends React.Component {
  handleChange(event) {
    // âŒ Má»—i keystroke â†’ gá»i onChange!
    // â†’ Parent render láº¡i!
    // â†’ Fetch API!
    // â†’ DOM update!
    this.props.onChange(event.target.value);
  }

  render() {
    return (
      <input
        type="text"
        onChange={this.handleChange.bind(this)}
        placeholder="TÃ¬m kiáº¿m..."
      />
    );
  }
}

// User gÃµ "Hello":
// H â†’ onChange('H')      â†’ fetch + render!
// e â†’ onChange('He')     â†’ fetch + render!
// l â†’ onChange('Hel')    â†’ fetch + render!
// l â†’ onChange('Hell')   â†’ fetch + render!
// o â†’ onChange('Hello')  â†’ fetch + render!
//
// â†’ 5 láº§n fetch API! 5 láº§n render! VÃ” ÃCH!
// â†’ User chá»‰ muá»‘n tÃ¬m "Hello"!
```

```
  Váº¤N Äá»€ onChange KHÃ”NG DEBOUNCE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Thá»i gian:  0ms  50ms 100ms 150ms 200ms              â”‚
  â”‚  Keystroke:   H     e     l     l     o                â”‚
  â”‚               â”‚     â”‚     â”‚     â”‚     â”‚                â”‚
  â”‚               â–¼     â–¼     â–¼     â–¼     â–¼                â”‚
  â”‚  onChange:  call  call  call  call  call               â”‚
  â”‚               â”‚     â”‚     â”‚     â”‚     â”‚                â”‚
  â”‚               â–¼     â–¼     â–¼     â–¼     â–¼                â”‚
  â”‚  Fetch API: req1  req2  req3  req4  req5 â† LÃƒG PHÃ!  â”‚
  â”‚               â”‚     â”‚     â”‚     â”‚     â”‚                â”‚
  â”‚               â–¼     â–¼     â–¼     â–¼     â–¼                â”‚
  â”‚  Re-render: #1    #2    #3    #4    #5   â† CHáº¬M!     â”‚
  â”‚                                                        â”‚
  â”‚  â†’ 5 API calls cho 1 tá»« "Hello"!                      â”‚
  â”‚  â†’ 4 trong 5 lÃ  VÃ” ÃCH!                               â”‚
  â”‚  â†’ CHá»ˆ Cáº¦N call cuá»‘i cÃ¹ng!                            â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2. Debounce â€” Tá»± Viáº¿t Tá»« Äáº§u!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEBOUNCE â€” Tá»° VIáº¾T KHÃ”NG Cáº¦N LODASH/UNDERSCORE!
// Chá» user NGá»ªNG gÃµ rá»“i má»›i gá»i callback!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â‘  DEBOUNCE CÆ  Báº¢N:
function debounce(func, wait) {
  var timeoutId = null; // â† Giá»¯ ID cá»§a setTimeout!

  return function () {
    var context = this; // â† Giá»¯ `this`!
    var args = arguments; // â† Giá»¯ arguments!

    // Há»¦Y setTimeout cÅ© (náº¿u cÃ³)!
    if (timeoutId !== null) {
      clearTimeout(timeoutId);
    }

    // Táº O setTimeout Má»šI!
    timeoutId = setTimeout(function () {
      func.apply(context, args);
      timeoutId = null;
    }, wait);
  };
}

// â‘¡ Sá»¬ Dá»¤NG:
var debouncedSearch = debounce(function (query) {
  console.log("Searching:", query);
  // fetch('/api/search?q=' + query);
}, 300); // â† Chá» 300ms sau keystroke cuá»‘i!

// User gÃµ "Hello":
// H â†’ debouncedSearch('H')     â†’ setTimeout 300ms
//   50ms sau:
// e â†’ debouncedSearch('He')    â†’ Há»¦Y cÅ©! setTimeout Má»šI!
//   50ms sau:
// l â†’ debouncedSearch('Hel')   â†’ Há»¦Y cÅ©! setTimeout Má»šI!
//   50ms sau:
// l â†’ debouncedSearch('Hell')  â†’ Há»¦Y cÅ©! setTimeout Má»šI!
//   50ms sau:
// o â†’ debouncedSearch('Hello') â†’ Há»¦Y cÅ©! setTimeout Má»šI!
//   300ms sau (user ngá»«ng gÃµ):
// â†’ 'Searching: Hello' â† CHá»ˆ 1 Láº¦N!!!
```

```
  DEBOUNCE â€” CÃCH NÃ“ HOáº T Äá»˜NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Thá»i gian:  0ms  50   100  150  200  500ms            â”‚
  â”‚  Keystroke:   H    e     l    l    o   (ngá»«ng!)        â”‚
  â”‚               â”‚    â”‚     â”‚    â”‚    â”‚                    â”‚
  â”‚               â–¼    â–¼     â–¼    â–¼    â–¼                    â”‚
  â”‚  Timer:    [300ms]                                      â”‚
  â”‚            â””â”€Há»¦Y!â”€â”˜                                    â”‚
  â”‚                 [300ms]                                  â”‚
  â”‚                 â””â”€Há»¦Y!â”€â”˜                                â”‚
  â”‚                      [300ms]                             â”‚
  â”‚                      â””â”€Há»¦Y!â”€â”˜                           â”‚
  â”‚                           [300ms]                        â”‚
  â”‚                           â””â”€Há»¦Y!â”€â”˜                      â”‚
  â”‚                                [300msâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
  â”‚                                                 â–¼        â”‚
  â”‚                                             Gá»ŒI FUNC!   â”‚
  â”‚                                             search()    â”‚
  â”‚                                                         â”‚
  â”‚  â†’ CHá»ˆ 1 API call! Thay vÃ¬ 5!                         â”‚
  â”‚  â†’ CHá»ˆ 1 re-render! Thay vÃ¬ 5!                        â”‚
  â”‚  â†’ TIáº¾T KIá»†M 80% cÃ´ng viá»‡c!                           â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3. Debounce NÃ¢ng Cao â€” Leading Edge!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEBOUNCE NÃ‚NG CAO â€” Vá»šI LEADING EDGE!
// â†’ Gá»i ngay Láº¦N Äáº¦U, rá»“i chá»!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function debounceAdvanced(func, wait, options) {
  var timeoutId = null;
  var lastArgs = null;
  var lastContext = null;

  // Option: immediate = gá»i ngay láº§n Ä‘áº§u!
  var immediate = options && options.leading === true;

  function debounced() {
    lastContext = this;
    lastArgs = arguments;

    // CÃ³ timer Ä‘ang cháº¡y?
    var callNow = immediate && timeoutId === null;

    // Há»¦Y timer cÅ©:
    if (timeoutId !== null) {
      clearTimeout(timeoutId);
    }

    // Táº O timer má»›i:
    timeoutId = setTimeout(function () {
      timeoutId = null;

      // Trailing edge: gá»i á»Ÿ CUá»I náº¿u khÃ´ng immediate:
      if (!immediate) {
        func.apply(lastContext, lastArgs);
      }
      lastArgs = null;
      lastContext = null;
    }, wait);

    // Leading edge: gá»i NGAY láº§n Ä‘áº§u!
    if (callNow) {
      func.apply(lastContext, lastArgs);
    }
  }

  // CANCEL method:
  debounced.cancel = function () {
    if (timeoutId !== null) {
      clearTimeout(timeoutId);
      timeoutId = null;
    }
    lastArgs = null;
    lastContext = null;
  };

  return debounced;
}

// VÃ Dá»¤:
var searchLeading = debounceAdvanced(
  function (q) {
    console.log("Search:", q);
  },
  300,
  { leading: true },
);

// User gÃµ "H":
// â†’ Gá»ŒI NGAY! search('H') â† Pháº£n há»“i tá»©c thÃ¬!
// User tiáº¿p tá»¥c gÃµ "ello":
// â†’ KHÃ”NG gá»i! Chá» ngá»«ng...
// â†’ 300ms sau khi ngá»«ng: KHÃ”NG Gá»ŒI (vÃ¬ leading, ko trailing)!
```

---

## Â§9. Throttle â€” Tá»± Viáº¿t Tá»« Äáº§u!

### 9.1. Throttle vs Debounce

```
  DEBOUNCE vs THROTTLE â€” Sá»° KHÃC BIá»†T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  DEBOUNCE â€” "Chá» ngá»«ng rá»“i má»›i gá»i!"                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Events:  â— â— â— â— â— â— â— â— â—    (ngá»«ng)        â”‚  â”‚
  â”‚  â”‚  Calls:                            â—  â† 1 láº§n! â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  DÃ¹ng khi: search input, resize xong!           â”‚  â”‚
  â”‚  â”‚  Ã nghÄ©a: chá»‰ cáº§n Káº¾T QUáº¢ CUá»I!              â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  THROTTLE â€” "Gá»i tá»‘i Ä‘a N láº§n má»—i giÃ¢y!"            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Events:  â— â— â— â— â— â— â— â— â—    (ngá»«ng)        â”‚  â”‚
  â”‚  â”‚  Calls:   â—       â—       â—       â† Ä‘á»u Ä‘áº·n!  â”‚  â”‚
  â”‚  â”‚           |â†200msâ†’|â†200msâ†’|                      â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  DÃ¹ng khi: scroll, mousemove, resize liÃªn tá»¥c!  â”‚  â”‚
  â”‚  â”‚  Ã nghÄ©a: VáºªN Cáº¦N pháº£n há»“i, nhÆ°ng GIáº¢M Táº¦N!  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  KHI NÃ€O DÃ™NG CÃI NÃ€O?                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Search input â†’ DEBOUNCE (chá» gÃµ xong!)        â”‚  â”‚
  â”‚  â”‚  Window resize â†’ DEBOUNCE (chá» resize xong!)   â”‚  â”‚
  â”‚  â”‚  Scroll event  â†’ THROTTLE (cáº­p nháº­t vá»‹ trÃ­!)   â”‚  â”‚
  â”‚  â”‚  Mouse move    â†’ THROTTLE (theo dÃµi chuá»™t!)    â”‚  â”‚
  â”‚  â”‚  Button click  â†’ THROTTLE (chá»‘ng double click!) â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2. Throttle â€” Tá»± Viáº¿t Tá»« Äáº§u!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// THROTTLE â€” Tá»° VIáº¾T KHÃ”NG Cáº¦N LODASH!
// Gá»i tá»‘i Ä‘a 1 láº§n má»—i `wait` ms!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function throttle(func, wait) {
  var lastCallTime = 0; // Thá»i Ä‘iá»ƒm gá»i gáº§n nháº¥t!
  var timeoutId = null; // Timer cho trailing call!

  return function () {
    var context = this;
    var args = arguments;
    var now = Date.now();
    var timeSinceLastCall = now - lastCallTime;

    // â‘  Äá»¦ THá»œI GIAN â†’ gá»i NGAY!
    if (timeSinceLastCall >= wait) {
      // Há»§y timer trailing (náº¿u cÃ³):
      if (timeoutId !== null) {
        clearTimeout(timeoutId);
        timeoutId = null;
      }
      lastCallTime = now;
      func.apply(context, args);
    }
    // â‘¡ CHÆ¯A Äá»¦ THá»œI GIAN â†’ Ä‘áº·t timer!
    else if (timeoutId === null) {
      var remaining = wait - timeSinceLastCall;
      timeoutId = setTimeout(function () {
        lastCallTime = Date.now();
        timeoutId = null;
        func.apply(context, args);
      }, remaining);
    }
    // â‘¢ ÄÃƒ CÃ“ timer â†’ KHÃ”NG LÃ€M GÃŒ!
  };
}

// Sá»¬ Dá»¤NG:
var throttledScroll = throttle(function () {
  console.log("Scroll position:", window.scrollY);
}, 200); // â† Tá»‘i Ä‘a 5 láº§n/giÃ¢y (1000ms / 200ms)!

window.addEventListener("scroll", throttledScroll);
```

```
  THROTTLE â€” CÃCH NÃ“ HOáº T Äá»˜NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Thá»i gian:  0   50  100 150 200 250 300 350 400      â”‚
  â”‚  Events:     â—    â—   â—   â—   â—   â—   â—   â—   â—      â”‚
  â”‚              â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚        â”‚
  â”‚  wait=200ms: â”‚    â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚        â”‚
  â”‚              â–¼    X   X   X   â–¼   X   X   X   â–¼        â”‚
  â”‚  Calls:     Gá»ŒI              Gá»ŒI              Gá»ŒI     â”‚
  â”‚              â”‚â†â”€â”€ 200ms â”€â”€â†’â”‚â†â”€â”€ 200ms â”€â”€â†’â”‚           â”‚
  â”‚                                                        â”‚
  â”‚  9 events â†’ chá»‰ 3 calls! GIáº¢M 67%!                  â”‚
  â”‚                                                        â”‚
  â”‚  SO SÃNH Vá»šI DEBOUNCE (wait=200ms):                    â”‚
  â”‚  Events:     â—    â—   â—   â—   â—   â—   â—   â—   â—      â”‚
  â”‚  Debounce:   X    X   X   X   X   X   X   X   â”‚       â”‚
  â”‚                                                â–¼        â”‚
  â”‚                                (200ms sau)    Gá»ŒI      â”‚
  â”‚  9 events â†’ 1 call! NHÆ¯NG pháº£i chá» ngá»«ng!             â”‚
  â”‚                                                        â”‚
  â”‚  ğŸ’¡ Throttle = "Ä‘á»u Ä‘áº·n cáº­p nháº­t"                     â”‚
  â”‚  ğŸ’¡ Debounce = "chá» ngá»«ng rá»“i cáº­p nháº­t"              â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3. Ãp Dá»¥ng VÃ o React Component!

```javascript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ÃP Dá»¤NG DEBOUNCE VÃ€O REACT COMPONENT!
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class SmartSearchInput extends React.Component {
  constructor(props) {
    super(props);
    this.state = { value: "" };

    // â‘  Táº O debounced function TRONG CONSTRUCTOR!
    // QUAN TRá»ŒNG: táº¡o 1 láº§n, REUSE má»—i render!
    this.debouncedOnChange = debounce(function (value) {
      // Gá»i parent onChange SAU KHI user ngá»«ng gÃµ!
      if (props.onChange) {
        props.onChange(value);
      }
    }, 300);
  }

  handleChange(event) {
    var value = event.target.value;

    // â‘¡ Cáº¬P NHáº¬T UI ngay láº­p tá»©c (controlled input!):
    this.setState({ value: value });

    // â‘¢ Gá»ŒI parent onChange SAU 300ms:
    this.debouncedOnChange(value);
  }

  componentWillUnmount() {
    // â‘£ CLEANUP! Há»§y timer khi unmount!
    if (this.debouncedOnChange.cancel) {
      this.debouncedOnChange.cancel();
    }
  }

  render() {
    return (
      <input
        type="text"
        value={this.state.value}
        onChange={this.handleChange.bind(this)}
        placeholder="TÃ¬m kiáº¿m..."
      />
    );
  }
}

// Sá»¬ Dá»¤NG:
// <SmartSearchInput onChange={query => fetchResults(query)} />
//
// User gÃµ "React performance":
// â†’ Input hiá»ƒn thá»‹ NGAY má»—i keystroke (UX tá»‘t!)
// â†’ fetchResults() CHá»ˆ Gá»ŒI 1 Láº¦N sau khi ngá»«ng gÃµ!
// â†’ TIáº¾T KIá»†M tÃ i nguyÃªn!
```

```
  REACT + DEBOUNCE â€” LUá»’NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  User gÃµ: R â†’ e â†’ a â†’ c â†’ t                          â”‚
  â”‚                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Keystroke "R":                                   â”‚  â”‚
  â”‚  â”‚  â‘  setState({value: 'R'}) â†’ RE-RENDER INPUT!   â”‚  â”‚
  â”‚  â”‚  â‘¡ debouncedOnChange('R') â†’ set timer 300ms!   â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Keystroke "e" (50ms sau):                        â”‚  â”‚
  â”‚  â”‚  â‘  setState({value: 'Re'}) â†’ RE-RENDER INPUT! â”‚  â”‚
  â”‚  â”‚  â‘¡ debouncedOnChange('Re') â†’ Há»¦Y timer cÅ©!    â”‚  â”‚
  â”‚  â”‚                              â†’ set timer Má»šI!  â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  ... (tiáº¿p tá»¥c gÃµ) ...                           â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Keystroke "t":                                    â”‚  â”‚
  â”‚  â”‚  â‘  setState({value: 'React'}) â†’ RE-RENDER!    â”‚  â”‚
  â”‚  â”‚  â‘¡ debouncedOnChange('React') â†’ set timer!     â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  300ms sau (user ngá»«ng gÃµ):                       â”‚  â”‚
  â”‚  â”‚  â‘¢ props.onChange('React') â†’ FETCH API!        â”‚  â”‚
  â”‚  â”‚  â†’ CHá»ˆ 1 API CALL cho 5 keystroke!              â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  âš  QUAN TRá»ŒNG:                                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  â†’ Input re-render NGAY (UX mÆ°á»£t!)              â”‚  â”‚
  â”‚  â”‚  â†’ Parent CHá»ˆ Ä‘Æ°á»£c thÃ´ng bÃ¡o SAU KHI ngá»«ng gÃµ! â”‚  â”‚
  â”‚  â”‚  â†’ TÃ¡ch biá»‡t: UI update vs Data update!        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§10. Tá»•ng Káº¿t & CÃ¢u Há»i Phá»ng Váº¥n!

### 10.1. SÆ¡ Äá»“ Tá»•ng Há»£p â€” 3 Váº¥n Äá» + 3 Giáº£i PhÃ¡p!

```
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REACT PERFORMANCE â€” Tá»”NG Káº¾T 3 Váº¤N Äá»€ + 3 GIáº¢I PHÃP!
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€ 1: shouldComponentUpdate sai!                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  NguyÃªn nhÃ¢n: ReactElement Má»šI má»—i render!     â”‚  â”‚
  â”‚  â”‚  â†’ Shallow compare children LUÃ”N true!          â”‚  â”‚
  â”‚  â”‚  â†’ PureComponent cÅ©ng THáº¤T Báº I!                â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Giáº£i phÃ¡p:                                      â”‚  â”‚
  â”‚  â”‚  â†’ DÃ¹ng PRIMITIVE props cho so sÃ¡nh!            â”‚  â”‚
  â”‚  â”‚  â†’ HOC bá» qua children!                         â”‚  â”‚
  â”‚  â”‚  â†’ Prop 'version' / 'lastUpdated'!              â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€ 2: Layout Thrashing!                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  NguyÃªn nhÃ¢n: Äá»c/ghi DOM xen káº½!              â”‚  â”‚
  â”‚  â”‚  â†’ Má»—i láº§n Ä‘á»c sau ghi = TÃNH Láº I Layout!    â”‚  â”‚
  â”‚  â”‚  â†’ Nhiá»u component = nhiá»u Layout calcs!        â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Giáº£i phÃ¡p:                                      â”‚  â”‚
  â”‚  â”‚  â†’ Batch read/write vá»›i DOMScheduler!           â”‚  â”‚
  â”‚  â”‚  â†’ requestAnimationFrame!                        â”‚  â”‚
  â”‚  â”‚  â†’ DÃ¹ng transform thay height cho animation!    â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Váº¤N Äá»€ 3: Callback báº¯n liÃªn tá»¥c!                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  NguyÃªn nhÃ¢n: onChange má»—i keystroke!            â”‚  â”‚
  â”‚  â”‚  â†’ Má»—i call = parent render + API call!        â”‚  â”‚
  â”‚  â”‚  â†’ 10 keystroke = 10 renders! VÃ” ÃCH!          â”‚  â”‚
  â”‚  â”‚                                                  â”‚  â”‚
  â”‚  â”‚  Giáº£i phÃ¡p:                                      â”‚  â”‚
  â”‚  â”‚  â†’ Debounce: chá» ngá»«ng rá»“i gá»i!                â”‚  â”‚
  â”‚  â”‚  â†’ Throttle: giá»›i háº¡n táº§n suáº¥t gá»i!            â”‚  â”‚
  â”‚  â”‚  â†’ Táº¡o trong constructor, cleanup trong         â”‚  â”‚
  â”‚  â”‚    componentWillUnmount!                         â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2. CÃ¢u Há»i Phá»ng Váº¥n!

```
  CÃ‚U Há»I PHá»NG Váº¤N â€” REACT PERFORMANCE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  Q1: Táº¡i sao PureComponent khÃ´ng ngÄƒn Ä‘Æ°á»£c render      â”‚
  â”‚  khi dÃ¹ng children?                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  A: VÃ¬ JSX táº¡o ReactElement Má»šI má»—i render!    â”‚  â”‚
  â”‚  â”‚  â†’ React.createElement() tráº£ OBJECT Má»šI!      â”‚  â”‚
  â”‚  â”‚  â†’ Shallow compare (===) luÃ´n false!            â”‚  â”‚
  â”‚  â”‚  â†’ shouldComponentUpdate luÃ´n true!             â”‚  â”‚
  â”‚  â”‚  â†’ Giáº£i phÃ¡p: so sÃ¡nh primitive props!          â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Q2: Layout Thrashing lÃ  gÃ¬? CÃ¡ch kháº¯c phá»¥c?          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  A: Äá»c/ghi DOM xen káº½ buá»™c browser tÃ­nh       â”‚  â”‚
  â”‚  â”‚  Layout Láº I má»—i láº§n Ä‘á»c!                       â”‚  â”‚
  â”‚  â”‚  â†’ Kháº¯c phá»¥c: batch read trÆ°á»›c, write sau!     â”‚  â”‚
  â”‚  â”‚  â†’ DÃ¹ng requestAnimationFrame!                  â”‚  â”‚
  â”‚  â”‚  â†’ Hoáº·c dÃ¹ng transform thay Ä‘á»•i CSS properties â”‚  â”‚
  â”‚  â”‚    trigger Layout!                               â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Q3: Debounce vs Throttle â€” khÃ¡c gÃ¬ nhau?              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  A: Debounce = chá» NGá»ªNG rá»“i gá»i!              â”‚  â”‚
  â”‚  â”‚     â†’ DÃ¹ng cho: search input, resize!           â”‚  â”‚
  â”‚  â”‚  Throttle = gá»i Äá»€U Äáº¶N theo interval!        â”‚  â”‚
  â”‚  â”‚     â†’ DÃ¹ng cho: scroll, mousemove!              â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Q4: Viáº¿t debounce báº±ng tay!                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  A: function debounce(fn, wait) {                â”‚  â”‚
  â”‚  â”‚       var timer = null;                          â”‚  â”‚
  â”‚  â”‚       return function() {                        â”‚  â”‚
  â”‚  â”‚         var ctx = this, args = arguments;        â”‚  â”‚
  â”‚  â”‚         clearTimeout(timer);                     â”‚  â”‚
  â”‚  â”‚         timer = setTimeout(function() {          â”‚  â”‚
  â”‚  â”‚           fn.apply(ctx, args);                   â”‚  â”‚
  â”‚  â”‚         }, wait);                                â”‚  â”‚
  â”‚  â”‚       };                                         â”‚  â”‚
  â”‚  â”‚     }                                            â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Q5: Viáº¿t throttle báº±ng tay!                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  A: function throttle(fn, wait) {                â”‚  â”‚
  â”‚  â”‚       var lastTime = 0;                          â”‚  â”‚
  â”‚  â”‚       return function() {                        â”‚  â”‚
  â”‚  â”‚         var now = Date.now();                     â”‚  â”‚
  â”‚  â”‚         if (now - lastTime >= wait) {             â”‚  â”‚
  â”‚  â”‚           lastTime = now;                        â”‚  â”‚
  â”‚  â”‚           fn.apply(this, arguments);             â”‚  â”‚
  â”‚  â”‚         }                                        â”‚  â”‚
  â”‚  â”‚       };                                         â”‚  â”‚
  â”‚  â”‚     }                                            â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Q6: CSS property nÃ o trigger Layout? Paint? Composite?â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  Layout: width, height, margin, padding, top,   â”‚  â”‚
  â”‚  â”‚    left, font-size, display, position            â”‚  â”‚
  â”‚  â”‚  Paint: color, background, border, box-shadow,  â”‚  â”‚
  â”‚  â”‚    outline, visibility                           â”‚  â”‚
  â”‚  â”‚  Composite ONLY: transform, opacity             â”‚  â”‚
  â”‚  â”‚  â†’ Animation tá»‘t nháº¥t: dÃ¹ng transform, opacity!â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â”‚  Q7: requestAnimationFrame dÃ¹ng khi nÃ o?               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  A: Khi cáº§n thao tÃ¡c DOM cho animation!         â”‚  â”‚
  â”‚  â”‚  â†’ Äáº£m báº£o code cháº¡y á»Ÿ frame tiáº¿p theo!       â”‚  â”‚
  â”‚  â”‚  â†’ Browser gá»™p cÃ¡c thay Ä‘á»•i thÃ nh 1 layout!    â”‚  â”‚
  â”‚  â”‚  â†’ 60fps = 16.67ms/frame!                       â”‚  â”‚
  â”‚  â”‚  â†’ Batch read/write DOM Ä‘á»ƒ trÃ¡nh thrashing!     â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3. Checklist Performance â€” Kiá»ƒm Tra TrÆ°á»›c Khi Deploy!

```
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REACT PERFORMANCE CHECKLIST:
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                        â”‚
  â”‚  â–¡ shouldComponentUpdate:                              â”‚
  â”‚    â–¡ KHÃ”NG so sÃ¡nh children/ReactElement?              â”‚
  â”‚    â–¡ DÃ¹ng primitive props Ä‘á»ƒ quyáº¿t Ä‘á»‹nh update?        â”‚
  â”‚    â–¡ PureComponent CHá»ˆ dÃ¹ng vá»›i primitive-only props?  â”‚
  â”‚    â–¡ HOC bá» qua children náº¿u cáº§n?                     â”‚
  â”‚                                                        â”‚
  â”‚  â–¡ DOM Performance:                                     â”‚
  â”‚    â–¡ KHÃ”NG Ä‘á»c/ghi DOM xen káº½?                        â”‚
  â”‚    â–¡ Batch read trÆ°á»›c, write sau?                       â”‚
  â”‚    â–¡ DÃ¹ng requestAnimationFrame cho animation?         â”‚
  â”‚    â–¡ DÃ¹ng transform/opacity thay width/height?         â”‚
  â”‚    â–¡ will-change CHá»ˆ khi cáº§n, KHÃ”NG everywhere?        â”‚
  â”‚                                                        â”‚
  â”‚  â–¡ Events & Callbacks:                                  â”‚
  â”‚    â–¡ Input onChange â†’ debounce?                        â”‚
  â”‚    â–¡ Scroll/resize â†’ throttle?                        â”‚
  â”‚    â–¡ Debounced function táº¡o trong constructor?         â”‚
  â”‚    â–¡ Cleanup trong componentWillUnmount?               â”‚
  â”‚                                                        â”‚
  â”‚  â–¡ General:                                             â”‚
  â”‚    â–¡ Chrome DevTools Performance tab?                   â”‚
  â”‚    â–¡ React DevTools Profiler?                          â”‚
  â”‚    â–¡ 6x slowdown trÃªn mobile?                          â”‚
  â”‚    â–¡ Component tree khÃ´ng quÃ¡ sÃ¢u?                     â”‚
  â”‚                                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
