# React Composition Patterns (Vercel Agent Skills) â€” Deep Dive!

> **Nguá»“n**: https://github.com/vercel-labs/agent-skills/tree/main/skills/composition-patterns
> **NgÃ´n ngá»¯**: Tiáº¿ng Viá»‡t â€” giáº£i thÃ­ch cá»±c ká»³ chi tiáº¿t!
> **Trang nÃ y KHÃ”NG cÃ³ hÃ¬nh/diagram** â€” chá»‰ cÃ³ text + code blocks!

---

## Â§1. Tá»•ng Quan â€” Composition Patterns!

```
  COMPOSITION PATTERNS â€” Tá»”NG QUAN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  WHAT:                                                        â”‚
  â”‚  â†’ Patterns cho flexible, maintainable React! â˜…â˜…â˜…         â”‚
  â”‚  â†’ TrÃ¡nh boolean prop proliferation! â˜…â˜…â˜…                  â”‚
  â”‚  â†’ Compound components + Lift state + Compose! â˜…â˜…â˜…        â”‚
  â”‚  â†’ Dá»… scale cho cáº£ humans + AI agents! â˜…                  â”‚
  â”‚                                                              â”‚
  â”‚  4 CATEGORIES (theo priority):                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
  â”‚  â”‚  â”‚ #  â”‚ Category              â”‚ Impact â”‚ Prefix     â”‚â”‚    â”‚
  â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚    â”‚
  â”‚  â”‚  â”‚ 1  â”‚ Component Architectureâ”‚ HIGH   â”‚ architect- â”‚â”‚    â”‚
  â”‚  â”‚  â”‚ 2  â”‚ State Management      â”‚ MEDIUM â”‚ state-     â”‚â”‚    â”‚
  â”‚  â”‚  â”‚ 3  â”‚ Implementation Patternâ”‚ MEDIUM â”‚ patterns-  â”‚â”‚    â”‚
  â”‚  â”‚  â”‚ 4  â”‚ React 19 APIs         â”‚ MEDIUM â”‚ react19-   â”‚â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  8 RULES:                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  ARCHITECTURE:                                        â”‚    â”‚
  â”‚  â”‚  â‘  avoid-boolean-props (CRITICAL!) â˜…â˜…â˜…               â”‚    â”‚
  â”‚  â”‚  â‘¡ compound-components (HIGH!) â˜…â˜…â˜…                   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  STATE:                                                â”‚    â”‚
  â”‚  â”‚  â‘¢ decouple-implementation (MEDIUM) â˜…â˜…               â”‚    â”‚
  â”‚  â”‚  â‘£ context-interface (MEDIUM) â˜…â˜…                     â”‚    â”‚
  â”‚  â”‚  â‘¤ lift-state (HIGH!) â˜…â˜…â˜…                            â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  PATTERNS:                                             â”‚    â”‚
  â”‚  â”‚  â‘¥ explicit-variants (MEDIUM) â˜…â˜…                     â”‚    â”‚
  â”‚  â”‚  â‘¦ children-over-render-props (MEDIUM) â˜…â˜…            â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  REACT 19:                                             â”‚    â”‚
  â”‚  â”‚  â‘§ no-forwardref (MEDIUM) â˜…â˜…                         â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§2. Rule 1 â€” Avoid Boolean Prop Proliferation! (CRITICAL!)

```
  RULE 1 â€” AVOID BOOLEAN PROPS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: CRITICAL â˜…â˜…â˜…                                      â”‚
  â”‚  â†’ Má»—i boolean NHÃ‚N ÄÃ”I possible states! â˜…â˜…â˜…             â”‚
  â”‚  â†’ 4 booleans = 2â´ = 16 tráº¡ng thÃ¡i! â˜…â˜…â˜…                  â”‚
  â”‚  â†’ Conditional logic bÃ¹ng ná»•! â˜…â˜…â˜…                        â”‚
  â”‚                                                              â”‚
  â”‚  Váº¤N Äá»€:                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  Boolean props = exponential complexity!               â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  isThread + isEditing + isDMThread + isForwarding      â”‚    â”‚
  â”‚  â”‚       â†“                                                â”‚    â”‚
  â”‚  â”‚  2 Ã— 2 Ã— 2 Ã— 2 = 16 combinations! â˜…â˜…â˜…                â”‚    â”‚
  â”‚  â”‚       â†“                                                â”‚    â”‚
  â”‚  â”‚  if/else soup! Unmaintainable! â˜…â˜…â˜…                    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  GIáº¢I PHÃP: Composition!                                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âŒ SAI:                                                â”‚    â”‚
  â”‚  â”‚  <Composer                                             â”‚    â”‚
  â”‚  â”‚    isThread                                            â”‚    â”‚
  â”‚  â”‚    isEditing={false}                                   â”‚    â”‚
  â”‚  â”‚    isDMThread                                          â”‚    â”‚
  â”‚  â”‚    isForwarding={false}                                â”‚    â”‚
  â”‚  â”‚  />                                                    â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âœ… ÄÃšNG:                                               â”‚    â”‚
  â”‚  â”‚  <ChannelComposer />   â† rÃµ rÃ ng! â˜…â˜…â˜…                â”‚    â”‚
  â”‚  â”‚  <ThreadComposer />    â† explicit! â˜…â˜…â˜…                â”‚    â”‚
  â”‚  â”‚  <EditComposer />      â† self-documenting! â˜…â˜…â˜…       â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  Má»—i variant compose shared parts! â˜…â˜…â˜…                â”‚    â”‚
  â”‚  â”‚  <Composer.Frame>                                      â”‚    â”‚
  â”‚  â”‚    <Composer.Input />                                  â”‚    â”‚
  â”‚  â”‚    <Composer.Footer>                                   â”‚    â”‚
  â”‚  â”‚      <Composer.Submit />                               â”‚    â”‚
  â”‚  â”‚    </Composer.Footer>                                  â”‚    â”‚
  â”‚  â”‚  </Composer.Frame>                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§3. Rule 2 â€” Compound Components! (HIGH!)

```
  RULE 2 â€” COMPOUND COMPONENTS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: HIGH â˜…â˜…â˜…                                          â”‚
  â”‚  â†’ Shared context, khÃ´ng prop drilling! â˜…â˜…â˜…               â”‚
  â”‚  â†’ Consumer compose pieces they need! â˜…â˜…â˜…                 â”‚
  â”‚                                                              â”‚
  â”‚  PATTERN:                                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âŒ SAI â€” Monolithic + render props:                    â”‚    â”‚
  â”‚  â”‚  <Composer                                             â”‚    â”‚
  â”‚  â”‚    renderHeader={...}                                  â”‚    â”‚
  â”‚  â”‚    renderFooter={...}                                  â”‚    â”‚
  â”‚  â”‚    showAttachments                                     â”‚    â”‚
  â”‚  â”‚    showFormatting                                      â”‚    â”‚
  â”‚  â”‚  />                                                    â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âœ… ÄÃšNG â€” Compound components:                         â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  1) Context:                                           â”‚    â”‚
  â”‚  â”‚  ComposerContext = createContext(null) â˜…â˜…â˜…             â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  2) Provider:                                          â”‚    â”‚
  â”‚  â”‚  <ComposerContext value={{ state, actions, meta }}>    â”‚    â”‚
  â”‚  â”‚    {children}                                          â”‚    â”‚
  â”‚  â”‚  </ComposerContext>                                    â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  3) Sub-components (use context):                      â”‚    â”‚
  â”‚  â”‚  ComposerInput()  â†’ use(ComposerContext) â˜…â˜…â˜…          â”‚    â”‚
  â”‚  â”‚  ComposerSubmit() â†’ use(ComposerContext) â˜…            â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  4) Export as namespace:                               â”‚    â”‚
  â”‚  â”‚  Composer = {                                          â”‚    â”‚
  â”‚  â”‚    Provider, Frame, Input, Submit,                     â”‚    â”‚
  â”‚  â”‚    Header, Footer, Attachments, ...                    â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  FLOW:                                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  Provider (state + actions + meta)                     â”‚    â”‚
  â”‚  â”‚       â†“ Context                                        â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚    â”‚
  â”‚  â”‚  â”‚ Composer.Frame      â”‚                               â”‚    â”‚
  â”‚  â”‚  â”‚  â”œâ”€â”€ Composer.Input  â† use(context).state â˜…â˜…â˜…     â”‚    â”‚
  â”‚  â”‚  â”‚  â”œâ”€â”€ Composer.Header                                â”‚    â”‚
  â”‚  â”‚  â”‚  â””â”€â”€ Composer.Footer                                â”‚    â”‚
  â”‚  â”‚  â”‚       â”œâ”€â”€ Composer.Formatting                       â”‚    â”‚
  â”‚  â”‚  â”‚       â””â”€â”€ Composer.Submit â† use(context).actions â˜… â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§4. Rule 3 â€” Decouple State from UI! (MEDIUM)

```
  RULE 3 â€” DECOUPLE STATE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: MEDIUM â˜…â˜…                                          â”‚
  â”‚  â†’ Provider = ONLY place knowing state impl! â˜…â˜…â˜…          â”‚
  â”‚  â†’ UI chá»‰ biáº¿t context interface! â˜…â˜…â˜…                    â”‚
  â”‚  â†’ Swap useState / Zustand / server â†’ UI unchanged! â˜…â˜…â˜…  â”‚
  â”‚                                                              â”‚
  â”‚  âŒ SAI â€” UI coupled to state:                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  function ChannelComposer({ channelId }) {            â”‚    â”‚
  â”‚  â”‚    const state = useGlobalChannelState(channelId)      â”‚    â”‚
  â”‚  â”‚    //      â†‘ UI BIáº¾T state implementation! â˜…â˜…â˜…        â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âœ… ÄÃšNG â€” State trong Provider:                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  Provider (biáº¿t state impl) â˜…â˜…â˜…                       â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚    â”‚
  â”‚  â”‚  â”‚ useGlobalChannel(channelId)     â”‚                   â”‚    â”‚
  â”‚  â”‚  â”‚      â†“                          â”‚                   â”‚    â”‚
  â”‚  â”‚  â”‚ <Composer.Provider              â”‚                   â”‚    â”‚
  â”‚  â”‚  â”‚   state={state}                 â”‚                   â”‚    â”‚
  â”‚  â”‚  â”‚   actions={{ update, submit }}  â”‚                   â”‚    â”‚
  â”‚  â”‚  â”‚ >                               â”‚                   â”‚    â”‚
  â”‚  â”‚  â”‚   {children}     â† UI chá»‰ biáº¿t interface! â˜…â˜…â˜…     â”‚    â”‚
  â”‚  â”‚  â”‚ </Composer.Provider>            â”‚                   â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  SAME UI, DIFFERENT PROVIDERS:                         â”‚    â”‚
  â”‚  â”‚  ForwardMessageProvider â†’ useState (local) â˜…          â”‚    â”‚
  â”‚  â”‚  ChannelProvider â†’ useGlobalChannel (global) â˜…        â”‚    â”‚
  â”‚  â”‚  Same <Composer.Input /> works! â˜…â˜…â˜…                   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§5. Rule 4 â€” Generic Context Interface (DI)! (MEDIUM)

```
  RULE 4 â€” CONTEXT INTERFACE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: MEDIUM â˜…â˜…                                          â”‚
  â”‚  â†’ Generic interface: state + actions + meta! â˜…â˜…â˜…         â”‚
  â”‚  â†’ Contract cho má»i provider implement! â˜…â˜…â˜…               â”‚
  â”‚  â†’ Dependency Injection pattern! â˜…â˜…â˜…                      â”‚
  â”‚                                                              â”‚
  â”‚  INTERFACE:                                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  ComposerContextValue {                                â”‚    â”‚
  â”‚  â”‚    state: {                                            â”‚    â”‚
  â”‚  â”‚      input: string                                     â”‚    â”‚
  â”‚  â”‚      attachments: Attachment[]                         â”‚    â”‚
  â”‚  â”‚      isSubmitting: boolean                             â”‚    â”‚
  â”‚  â”‚    }                                                   â”‚    â”‚
  â”‚  â”‚    actions: {                                          â”‚    â”‚
  â”‚  â”‚      update: (fn) => void â˜…â˜…â˜…                         â”‚    â”‚
  â”‚  â”‚      submit: () => void â˜…â˜…â˜…                           â”‚    â”‚
  â”‚  â”‚    }                                                   â”‚    â”‚
  â”‚  â”‚    meta: {                                             â”‚    â”‚
  â”‚  â”‚      inputRef: RefObject â˜…                            â”‚    â”‚
  â”‚  â”‚    }                                                   â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  KEY INSIGHT:                                                 â”‚
  â”‚  â†’ Provider boundary matters â€” NOT visual nesting! â˜…â˜…â˜…   â”‚
  â”‚  â†’ ForwardButton NGOÃ€I Composer.Frame                     â”‚
  â”‚    nhÆ°ng TRONG Provider â†’ váº«n access state! â˜…â˜…â˜…          â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <ForwardMessageProvider>    â† state boundary â˜…â˜…â˜…    â”‚    â”‚
  â”‚  â”‚    <Dialog>                                            â”‚    â”‚
  â”‚  â”‚      <Composer.Frame>        â† visual boundary        â”‚    â”‚
  â”‚  â”‚        <Composer.Input />                              â”‚    â”‚
  â”‚  â”‚      </Composer.Frame>                                 â”‚    â”‚
  â”‚  â”‚      <MessagePreview />      â† NGOÃ€I Frame, IN Providerâ”‚   â”‚
  â”‚  â”‚      <ForwardButton />       â† access actions! â˜…â˜…â˜…    â”‚    â”‚
  â”‚  â”‚    </Dialog>                                           â”‚    â”‚
  â”‚  â”‚  </ForwardMessageProvider>                             â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§6. Rule 5 â€” Lift State into Providers! (HIGH!)

```
  RULE 5 â€” LIFT STATE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: HIGH â˜…â˜…â˜…                                          â”‚
  â”‚  â†’ Move state vÃ o provider! â˜…â˜…â˜…                           â”‚
  â”‚  â†’ Sibling components access state! â˜…â˜…â˜…                   â”‚
  â”‚  â†’ KhÃ´ng prop drilling, khÃ´ng awkward refs! â˜…â˜…â˜…           â”‚
  â”‚                                                              â”‚
  â”‚  3 CÃCH SAI:                                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  âŒ 1: State trapped inside component                  â”‚    â”‚
  â”‚  â”‚     â†’ Sibling khÃ´ng access Ä‘Æ°á»£c!                      â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âŒ 2: useEffect sync state lÃªn parent                 â”‚    â”‚
  â”‚  â”‚     â†’ onInputChange(state.input) má»—i change! ğŸ˜¬       â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âŒ 3: Ref hack                                         â”‚    â”‚
  â”‚  â”‚     â†’ stateRef.current trÃªn submit! ğŸ˜¬                 â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âœ… CÃCH ÄÃšNG: Lift to Provider!                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  <ForwardMessageProvider>  â† state lives HERE! â˜…â˜…â˜…   â”‚    â”‚
  â”‚  â”‚    <Dialog>                                            â”‚    â”‚
  â”‚  â”‚      <ForwardMessageComposer />  â† access state â˜…    â”‚    â”‚
  â”‚  â”‚      <MessagePreview />          â† access state â˜…    â”‚    â”‚
  â”‚  â”‚      <DialogActions>                                   â”‚    â”‚
  â”‚  â”‚        <CancelButton />                                â”‚    â”‚
  â”‚  â”‚        <ForwardButton />    â† access actions! â˜…â˜…â˜…     â”‚    â”‚
  â”‚  â”‚      </DialogActions>                                  â”‚    â”‚
  â”‚  â”‚    </Dialog>                                           â”‚    â”‚
  â”‚  â”‚  </ForwardMessageProvider>                             â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  KEY: Components cÃ¹ng Provider = share state! â˜…â˜…â˜…     â”‚    â”‚
  â”‚  â”‚  KHÃ”NG cáº§n visually nested! â˜…â˜…â˜…                       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§7. Rule 6 â€” Explicit Variants! (MEDIUM)

```
  RULE 6 â€” EXPLICIT VARIANTS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: MEDIUM â˜…â˜…                                          â”‚
  â”‚  â†’ Self-documenting code! â˜…â˜…â˜…                             â”‚
  â”‚  â†’ No hidden conditionals! â˜…â˜…â˜…                            â”‚
  â”‚  â†’ No impossible states! â˜…â˜…â˜…                              â”‚
  â”‚                                                              â”‚
  â”‚  âŒ SAI â€” Boolean modes:                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <Composer isThread isEditing={false}                  â”‚    â”‚
  â”‚  â”‚    channelId="abc" showAttachments />                  â”‚    â”‚
  â”‚  â”‚  â†’ Renders gÃ¬?? KhÃ´ng rÃµ! â˜…â˜…â˜…                       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âœ… ÄÃšNG â€” Named variants:                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <ThreadComposer channelId="abc" />      â†’ RÃ•! â˜…â˜…â˜…   â”‚    â”‚
  â”‚  â”‚  <EditMessageComposer messageId="xyz" /> â†’ RÃ•! â˜…â˜…â˜…   â”‚    â”‚
  â”‚  â”‚  <ForwardMessageComposer messageId="1" />â†’ RÃ•! â˜…â˜…â˜…   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  Má»—i variant:                                          â”‚    â”‚
  â”‚  â”‚  â†’ Own Provider (state riÃªng) â˜…                       â”‚    â”‚
  â”‚  â”‚  â†’ Compose shared parts â˜…â˜…â˜…                           â”‚    â”‚
  â”‚  â”‚  â†’ Explicit UI elements â˜…                             â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§8. Rule 7 â€” Children Over Render Props! (MEDIUM)

```
  RULE 7 â€” CHILDREN > RENDER PROPS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Impact: MEDIUM â˜…â˜…                                          â”‚
  â”‚  â†’ children readable hÆ¡n! â˜…â˜…â˜…                             â”‚
  â”‚  â†’ Compose naturally! â˜…â˜…â˜…                                 â”‚
  â”‚  â†’ KhÃ´ng cáº§n hiá»ƒu callback signatures! â˜…                  â”‚
  â”‚                                                              â”‚
  â”‚  âŒ SAI â€” render props:                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <Composer                                             â”‚    â”‚
  â”‚  â”‚    renderHeader={() => <CustomHeader />}               â”‚    â”‚
  â”‚  â”‚    renderFooter={() => <>                              â”‚    â”‚
  â”‚  â”‚      <Formatting />                                    â”‚    â”‚
  â”‚  â”‚      <Emojis />                                        â”‚    â”‚
  â”‚  â”‚    </>}                                                â”‚    â”‚
  â”‚  â”‚    renderActions={() => <SubmitButton />}              â”‚    â”‚
  â”‚  â”‚  />                                                    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âœ… ÄÃšNG â€” children:                                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <Composer.Frame>                                      â”‚    â”‚
  â”‚  â”‚    <CustomHeader />                                    â”‚    â”‚
  â”‚  â”‚    <Composer.Input />                                  â”‚    â”‚
  â”‚  â”‚    <Composer.Footer>                                   â”‚    â”‚
  â”‚  â”‚      <Composer.Formatting />                           â”‚    â”‚
  â”‚  â”‚      <Composer.Emojis />                               â”‚    â”‚
  â”‚  â”‚      <SubmitButton />                                  â”‚    â”‚
  â”‚  â”‚    </Composer.Footer>                                  â”‚    â”‚
  â”‚  â”‚  </Composer.Frame>                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  KHI NÃ€O render props OK:                                     â”‚
  â”‚  â†’ Parent cáº§n pass DATA xuá»‘ng child! â˜…                    â”‚
  â”‚  â†’ <List renderItem={({ item }) => ...} /> â˜…             â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§9. Rule 8 â€” React 19 API Changes! (MEDIUM)

```
  RULE 8 â€” REACT 19:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  âš ï¸ React 19+ only! Skip náº¿u React 18! â˜…â˜…â˜…                  â”‚
  â”‚                                                              â”‚
  â”‚  THAY Äá»”I 1 â€” ref as regular prop:                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  âŒ SAI (React 18):                                    â”‚    â”‚
  â”‚  â”‚  const Input = forwardRef((props, ref) => ...)        â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âœ… ÄÃšNG (React 19):                                    â”‚    â”‚
  â”‚  â”‚  function Input({ ref, ...props }) { ... }            â”‚    â”‚
  â”‚  â”‚  â†’ ref lÃ  regular prop! KhÃ´ng cáº§n forwardRef! â˜…â˜…â˜…    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  THAY Äá»”I 2 â€” use() thay useContext():                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  âŒ SAI:                                                â”‚    â”‚
  â”‚  â”‚  const value = useContext(MyContext)                   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  âœ… ÄÃšNG:                                               â”‚    â”‚
  â”‚  â”‚  const value = use(MyContext) â˜…â˜…â˜…                     â”‚    â”‚
  â”‚  â”‚  â†’ use() cÃ³ thá»ƒ gá»i conditionally! â˜…â˜…â˜…               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§10. Tá»•ng SÆ¡ Äá»“ â€” Full Architecture!

```
  FULL COMPOSITION ARCHITECTURE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  LAYER 1: Context Interface (contract) â˜…â˜…â˜…                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  ComposerContextValue {                               â”‚    â”‚
  â”‚  â”‚    state: { input, attachments, isSubmitting }         â”‚    â”‚
  â”‚  â”‚    actions: { update, submit }                         â”‚    â”‚
  â”‚  â”‚    meta: { inputRef }                                  â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“ implemented by                                        â”‚
  â”‚                                                              â”‚
  â”‚  LAYER 2: Providers (state implementation) â˜…â˜…â˜…                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  ChannelProvider      â†’ useGlobalChannel â˜…            â”‚    â”‚
  â”‚  â”‚  ThreadProvider       â†’ useThreadState â˜…              â”‚    â”‚
  â”‚  â”‚  EditMessageProvider  â†’ useEditMessage â˜…              â”‚    â”‚
  â”‚  â”‚  ForwardMsgProvider   â†’ useState (local) â˜…            â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“ wraps                                                 â”‚
  â”‚                                                              â”‚
  â”‚  LAYER 3: Compound Components (UI) â˜…â˜…â˜…                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  Composer.Frame    Composer.Input                      â”‚    â”‚
  â”‚  â”‚  Composer.Header   Composer.Footer                     â”‚    â”‚
  â”‚  â”‚  Composer.Submit   Composer.Attachments                â”‚    â”‚
  â”‚  â”‚  Composer.Formatting  Composer.Emojis                  â”‚    â”‚
  â”‚  â”‚  â†’ use(ComposerContext) to access state! â˜…â˜…â˜…          â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“ composed into                                         â”‚
  â”‚                                                              â”‚
  â”‚  LAYER 4: Explicit Variants (final UI) â˜…â˜…â˜…                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <ChannelComposer />                                   â”‚    â”‚
  â”‚  â”‚  <ThreadComposer channelId="abc" />                    â”‚    â”‚
  â”‚  â”‚  <EditMessageComposer messageId="xyz" />               â”‚    â”‚
  â”‚  â”‚  <ForwardMessageComposer messageId="123" />            â”‚    â”‚
  â”‚  â”‚  â†’ Each wraps Provider + composes Components! â˜…â˜…â˜…     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§11. Decision Tree â€” Chá»n Pattern NÃ o?

```
  DECISION TREE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Component cÃ³ nhiá»u boolean props?                            â”‚
  â”‚       â”‚                                                       â”‚
  â”‚       â”œâ”€â”€ YES â†’ CÃ³ bao nhiÃªu?                                â”‚
  â”‚       â”‚    â”œâ”€â”€ 1-2 booleans â†’ OK, nhÆ°ng watch out! â˜…         â”‚
  â”‚       â”‚    â”œâ”€â”€ 3+ booleans â†’ REFACTOR! â˜…â˜…â˜…                  â”‚
  â”‚       â”‚    â”‚    â”œâ”€â”€ Behaviors khÃ¡c nhau? â†’ Explicit Variants! â”‚
  â”‚       â”‚    â”‚    â””â”€â”€ Layout khÃ¡c nhau? â†’ Compound Components! â”‚
  â”‚       â”‚    â””â”€â”€ Mutations overlap? â†’ Shared pieces! â˜…         â”‚
  â”‚       â””â”€â”€ NO â†’ Component OK âœ…                                â”‚
  â”‚                                                              â”‚
  â”‚  State cáº§n share giá»¯a siblings?                               â”‚
  â”‚       â”‚                                                       â”‚
  â”‚       â”œâ”€â”€ YES â†’ Lift State to Provider! â˜…â˜…â˜…                  â”‚
  â”‚       â”‚    â”œâ”€â”€ State local (ephemeral)? â†’ useState â˜…         â”‚
  â”‚       â”‚    â”œâ”€â”€ State global (persistent)? â†’ Zustand/Redux â˜…  â”‚
  â”‚       â”‚    â””â”€â”€ State server (synced)? â†’ React Query â˜…        â”‚
  â”‚       â””â”€â”€ NO â†’ State local OK âœ…                              â”‚
  â”‚                                                              â”‚
  â”‚  Cáº§n customize UI slots?                                      â”‚
  â”‚       â”‚                                                       â”‚
  â”‚       â”œâ”€â”€ Parent truyá»n DATA xuá»‘ng? â†’ Render Props OK! â˜…     â”‚
  â”‚       â””â”€â”€ Static layout? â†’ Children composition! â˜…â˜…â˜…        â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§12. Anti-Patterns Deep Dive â€” Váº¥n Äá» Thá»±c Táº¿!

```
  ANTI-PATTERNS CHI TIáº¾T:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  âŒ ANTI-PATTERN 1: "God Component" â˜…â˜…â˜…                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  function SuperForm({                                  â”‚    â”‚
  â”‚  â”‚    isLogin, isRegister, isReset,                       â”‚    â”‚
  â”‚  â”‚    isOAuth, isMFA, isSSO,                              â”‚    â”‚
  â”‚  â”‚    showCaptcha, showTerms, showAvatar,                 â”‚    â”‚
  â”‚  â”‚    onSubmit, onCancel, onReset, ...                    â”‚    â”‚
  â”‚  â”‚  }) {                                                  â”‚    â”‚
  â”‚  â”‚    // 500+ lines of if/else! ğŸ˜±                        â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  TOÃN Há»ŒC: 9 booleans = 2â¹ = 512 states! â˜…â˜…â˜…        â”‚    â”‚
  â”‚  â”‚  NhÆ°ng pháº§n lá»›n lÃ  IMPOSSIBLE states! â˜…â˜…â˜…             â”‚    â”‚
  â”‚  â”‚  Login + Register = ??? Impossible! â˜…                 â”‚    â”‚
  â”‚  â”‚  â†’ Type system KHÃ”NG báº¯t Ä‘Æ°á»£c! â˜…â˜…â˜…                   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âŒ ANTI-PATTERN 2: "Prop Drilling Waterfall" â˜…â˜…              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <App>                                                 â”‚    â”‚
  â”‚  â”‚    <Layout user={user}>          â† pass user          â”‚    â”‚
  â”‚  â”‚      <Sidebar user={user}>       â† pass again         â”‚    â”‚
  â”‚  â”‚        <UserMenu user={user}>    â† pass again         â”‚    â”‚
  â”‚  â”‚          <Avatar user={user} />  â† finally used!      â”‚    â”‚
  â”‚  â”‚        </UserMenu>                                     â”‚    â”‚
  â”‚  â”‚      </Sidebar>                                        â”‚    â”‚
  â”‚  â”‚    </Layout>                                           â”‚    â”‚
  â”‚  â”‚  </App>                                                â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  3 components truyá»n KHÃ”NG dÃ¹ng! â˜…â˜…â˜…                  â”‚    â”‚
  â”‚  â”‚  â†’ DÃ¹ng Context Provider thay tháº¿! â˜…â˜…â˜…               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âŒ ANTI-PATTERN 3: "useEffect State Sync" â˜…â˜…â˜…                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // Child â†’ Parent state sync                          â”‚    â”‚
  â”‚  â”‚  useEffect(() => {                                     â”‚    â”‚
  â”‚  â”‚    onInputChange(state.input) // ğŸ˜¬                     â”‚    â”‚
  â”‚  â”‚  }, [state.input])                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  Váº¤N Äá»€:                                               â”‚    â”‚
  â”‚  â”‚  â†’ Render 2 láº§n (child â†’ effect â†’ parent re-render)   â”‚    â”‚
  â”‚  â”‚  â†’ Race conditions! â˜…â˜…â˜…                               â”‚    â”‚
  â”‚  â”‚  â†’ Circular dependencies! â˜…                           â”‚    â”‚
  â”‚  â”‚  â†’ GIáº¢I PHÃP: Lift state lÃªn Provider! â˜…â˜…â˜…           â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  âŒ ANTI-PATTERN 4: "Mixed Exports" â˜…â˜…                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // File exports component + non-component! â˜…â˜…â˜…       â”‚    â”‚
  â”‚  â”‚  export function Composer() { ... }                   â”‚    â”‚
  â”‚  â”‚  export const COMPOSER_CONFIG = { ... }    // âŒ!       â”‚    â”‚
  â”‚  â”‚  export type ComposerProps = { ... }       // OK       â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  Váº¤N Äá»€: Tree shaking khÃ³ optimize! â˜…                â”‚    â”‚
  â”‚  â”‚  GIáº¢I PHÃP: TÃ¡ch constants/utils ra file riÃªng! â˜…    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§13. Performance â€” Re-render Optimization!

```
  PERFORMANCE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  CONTEXT RE-RENDER PROBLEM:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  Khi context value thay Ä‘á»•i:                           â”‚    â”‚
  â”‚  â”‚  â†’ Táº¤T Cáº¢ consumers re-render! â˜…â˜…â˜…                   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  state = { input: "a", attachments: [], isSubmitting } â”‚    â”‚
  â”‚  â”‚       â†“ input thay Ä‘á»•i thÃ nh "ab"                      â”‚    â”‚
  â”‚  â”‚  Composer.Submit RE-RENDER dÃ¹ chá»‰ care submit! â˜…â˜…â˜…   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  GIáº¢I PHÃP 1: Split Contexts! â˜…â˜…â˜…                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // TÃ¡ch state vs actions vs meta! â˜…â˜…â˜…                 â”‚    â”‚
  â”‚  â”‚  const StateCtx = createContext(null)                  â”‚    â”‚
  â”‚  â”‚  const ActionsCtx = createContext(null)                â”‚    â”‚
  â”‚  â”‚  const MetaCtx = createContext(null)                   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  // Composer.Submit chá»‰ subscribe ActionsCtx! â˜…â˜…â˜…     â”‚    â”‚
  â”‚  â”‚  function ComposerSubmit() {                           â”‚    â”‚
  â”‚  â”‚    const { submit } = use(ActionsCtx) // stable ref!  â”‚    â”‚
  â”‚  â”‚    return <Button onPress={submit}>Send</Button>       â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â”‚  â†’ input thay Ä‘á»•i â†’ Submit KHÃ”NG re-render! âœ… â˜…â˜…â˜…    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  GIáº¢I PHÃP 2: useMemo context value! â˜…â˜…                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  function Provider({ children }) {                     â”‚    â”‚
  â”‚  â”‚    const [state, setState] = useState(init)            â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚    // âŒ SAI: new object má»—i render!                    â”‚    â”‚
  â”‚  â”‚    // value={{ state, actions: { update, submit } }}   â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚    // âœ… ÄÃšNG: memoize!                                 â”‚    â”‚
  â”‚  â”‚    const actions = useMemo(() => ({                    â”‚    â”‚
  â”‚  â”‚      update: setState,                                 â”‚    â”‚
  â”‚  â”‚      submit: handleSubmit                              â”‚    â”‚
  â”‚  â”‚    }), [handleSubmit])                                  â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚    const value = useMemo(() => ({                      â”‚    â”‚
  â”‚  â”‚      state, actions                                    â”‚    â”‚
  â”‚  â”‚    }), [state, actions])                                â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  GIáº¢I PHÃP 3: useCallback cho actions! â˜…â˜…                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  const submit = useCallback(async () => {              â”‚    â”‚
  â”‚  â”‚    // submit logic                                     â”‚    â”‚
  â”‚  â”‚  }, [dependencies])                                    â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  â†’ Stable function reference! â˜…â˜…â˜…                     â”‚    â”‚
  â”‚  â”‚  â†’ Children dÃ¹ng React.memo sáº½ skip re-render! â˜…     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§14. Testing â€” Compound Components!

```
  TESTING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  UNIT TEST Sub-components:                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // Test tá»«ng sub-component vá»›i mock provider! â˜…â˜…â˜…    â”‚    â”‚
  â”‚  â”‚  function renderWithProvider(ui, providerProps) {      â”‚    â”‚
  â”‚  â”‚    return render(                                      â”‚    â”‚
  â”‚  â”‚      <Composer.Provider                                â”‚    â”‚
  â”‚  â”‚        state={providerProps.state ?? defaultState}     â”‚    â”‚
  â”‚  â”‚        actions={providerProps.actions ?? defaultActs}  â”‚    â”‚
  â”‚  â”‚        meta={providerProps.meta ?? defaultMeta}        â”‚    â”‚
  â”‚  â”‚      >                                                 â”‚    â”‚
  â”‚  â”‚        {ui}                                            â”‚    â”‚
  â”‚  â”‚      </Composer.Provider>                              â”‚    â”‚
  â”‚  â”‚    )                                                   â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  test('Input hiá»ƒn thá»‹ state.input', () => {            â”‚    â”‚
  â”‚  â”‚    renderWithProvider(<Composer.Input />, {             â”‚    â”‚
  â”‚  â”‚      state: { input: 'Hello', ... }                    â”‚    â”‚
  â”‚  â”‚    })                                                  â”‚    â”‚
  â”‚  â”‚    expect(screen.getByValue('Hello')).toBeTruthy()     â”‚    â”‚
  â”‚  â”‚  })                                                    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  INTEGRATION TEST Variants:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  test('ThreadComposer has channel field', () => {      â”‚    â”‚
  â”‚  â”‚    render(<ThreadComposer channelId="abc" />)          â”‚    â”‚
  â”‚  â”‚    expect(screen.getByText('Also send to'))            â”‚    â”‚
  â”‚  â”‚      .toBeTruthy()  // â˜…â˜…â˜…                            â”‚    â”‚
  â”‚  â”‚  })                                                    â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  test('EditComposer has cancel/save', () => {          â”‚    â”‚
  â”‚  â”‚    render(<EditComposer messageId="xyz" />)            â”‚    â”‚
  â”‚  â”‚    expect(screen.getByText('Cancel')).toBeTruthy()     â”‚    â”‚
  â”‚  â”‚    expect(screen.getByText('Save')).toBeTruthy()       â”‚    â”‚
  â”‚  â”‚  })                                                    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  TEST Provider Swap:                                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // Same UI, different providers! â˜…â˜…â˜…                  â”‚    â”‚
  â”‚  â”‚  test('Same Input works with both providers', () => { â”‚    â”‚
  â”‚  â”‚    const { rerender } = render(                        â”‚    â”‚
  â”‚  â”‚      <ChannelProvider channelId="abc">                 â”‚    â”‚
  â”‚  â”‚        <Composer.Input />                              â”‚    â”‚
  â”‚  â”‚      </ChannelProvider>                                â”‚    â”‚
  â”‚  â”‚    )                                                   â”‚    â”‚
  â”‚  â”‚    expect(screen.getByRole('textbox')).toBeTruthy()    â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚    rerender(                                           â”‚    â”‚
  â”‚  â”‚      <ForwardMessageProvider>                          â”‚    â”‚
  â”‚  â”‚        <Composer.Input />                              â”‚    â”‚
  â”‚  â”‚      </ForwardMessageProvider>                         â”‚    â”‚
  â”‚  â”‚    )                                                   â”‚    â”‚
  â”‚  â”‚    expect(screen.getByRole('textbox')).toBeTruthy()    â”‚    â”‚
  â”‚  â”‚  })                                                    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§15. Migration Guide â€” Tá»« Monolithic â†’ Compound!

```
  MIGRATION 5 BÆ¯á»šC:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  STEP 1: Identify boolean props â˜…â˜…â˜…                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  Liá»‡t kÃª táº¥t cáº£ boolean props:                        â”‚    â”‚
  â”‚  â”‚  isThread, isEditing, isDMThread, isForwarding...      â”‚    â”‚
  â”‚  â”‚  Äáº¿m: n booleans = 2â¿ combinations â˜…â˜…â˜…               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“                                                       â”‚
  â”‚  STEP 2: Define Context Interface â˜…â˜…â˜…                         â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  interface MyContextValue {                            â”‚    â”‚
  â”‚  â”‚    state: { ... }   // shared state                    â”‚    â”‚
  â”‚  â”‚    actions: { ... } // shared mutations                â”‚    â”‚
  â”‚  â”‚    meta: { ... }    // refs, configs                    â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“                                                       â”‚
  â”‚  STEP 3: Extract Sub-components â˜…â˜…â˜…                           â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // TÃ¡ch má»—i pháº§n UI thÃ nh component riÃªng            â”‚    â”‚
  â”‚  â”‚  function MyInput() { use(Context)... }               â”‚    â”‚
  â”‚  â”‚  function MySubmit() { use(Context)... }              â”‚    â”‚
  â”‚  â”‚  function MyHeader() { ... }                           â”‚    â”‚
  â”‚  â”‚  // Export as namespace:                               â”‚    â”‚
  â”‚  â”‚  const My = { Frame, Input, Submit, Header }          â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“                                                       â”‚
  â”‚  STEP 4: Create Providers â˜…â˜…â˜…                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // Má»—i use case = 1 provider                         â”‚    â”‚
  â”‚  â”‚  function ChannelProvider({ channelId, children })     â”‚    â”‚
  â”‚  â”‚  function ThreadProvider({ threadId, children })       â”‚    â”‚
  â”‚  â”‚  function EditProvider({ messageId, children })        â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚       â†“                                                       â”‚
  â”‚  STEP 5: Compose Variants â˜…â˜…â˜…                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  function ChannelComposer() {                          â”‚    â”‚
  â”‚  â”‚    return (                                            â”‚    â”‚
  â”‚  â”‚      <ChannelProvider>                                 â”‚    â”‚
  â”‚  â”‚        <My.Frame>                                      â”‚    â”‚
  â”‚  â”‚          <My.Input />                                  â”‚    â”‚
  â”‚  â”‚          <My.Submit />                                 â”‚    â”‚
  â”‚  â”‚        </My.Frame>                                     â”‚    â”‚
  â”‚  â”‚      </ChannelProvider>                                â”‚    â”‚
  â”‚  â”‚    )                                                   â”‚    â”‚
  â”‚  â”‚  }                                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§16. Real-World Examples â€” KhÃ´ng chá»‰ Composer!

```
  REAL-WORLD EXAMPLES:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  EXAMPLE 1: Tabs Component â˜…â˜…â˜…                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  // Context: activeTab + setActiveTab                  â”‚    â”‚
  â”‚  â”‚  <Tabs.Provider defaultTab="overview">                 â”‚    â”‚
  â”‚  â”‚    <Tabs.List>                                         â”‚    â”‚
  â”‚  â”‚      <Tabs.Tab value="overview">Overview</Tabs.Tab>    â”‚    â”‚
  â”‚  â”‚      <Tabs.Tab value="settings">Settings</Tabs.Tab>   â”‚    â”‚
  â”‚  â”‚    </Tabs.List>                                        â”‚    â”‚
  â”‚  â”‚    <Tabs.Panel value="overview">...</Tabs.Panel>       â”‚    â”‚
  â”‚  â”‚    <Tabs.Panel value="settings">...</Tabs.Panel>       â”‚    â”‚
  â”‚  â”‚  </Tabs.Provider>                                      â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  â†’ Tab.Tab + Tabs.Panel share activeTab qua context!  â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  EXAMPLE 2: Modal / Dialog â˜…â˜…                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <Modal.Provider>                                      â”‚    â”‚
  â”‚  â”‚    <Modal.Trigger>Open</Modal.Trigger>                 â”‚    â”‚
  â”‚  â”‚    <Modal.Content>                                     â”‚    â”‚
  â”‚  â”‚      <Modal.Header>Title</Modal.Header>                â”‚    â”‚
  â”‚  â”‚      <Modal.Body>Content</Modal.Body>                  â”‚    â”‚
  â”‚  â”‚      <Modal.Footer>                                    â”‚    â”‚
  â”‚  â”‚        <Modal.Close>Cancel</Modal.Close>               â”‚    â”‚
  â”‚  â”‚        <Modal.Action>Confirm</Modal.Action>            â”‚    â”‚
  â”‚  â”‚      </Modal.Footer>                                   â”‚    â”‚
  â”‚  â”‚    </Modal.Content>                                    â”‚    â”‚
  â”‚  â”‚  </Modal.Provider>                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  â†’ Trigger/Close share isOpen state! â˜…â˜…â˜…              â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  EXAMPLE 3: Multi-Step Form â˜…â˜…â˜…                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <Form.Provider>                                       â”‚    â”‚
  â”‚  â”‚    <Form.Steps>                                        â”‚    â”‚
  â”‚  â”‚      <Form.Step index={0}>                             â”‚    â”‚
  â”‚  â”‚        <PersonalInfoFields />                          â”‚    â”‚
  â”‚  â”‚      </Form.Step>                                      â”‚    â”‚
  â”‚  â”‚      <Form.Step index={1}>                             â”‚    â”‚
  â”‚  â”‚        <AddressFields />                               â”‚    â”‚
  â”‚  â”‚      </Form.Step>                                      â”‚    â”‚
  â”‚  â”‚      <Form.Step index={2}>                             â”‚    â”‚
  â”‚  â”‚        <ReviewSubmit />                                â”‚    â”‚
  â”‚  â”‚      </Form.Step>                                      â”‚    â”‚
  â”‚  â”‚    </Form.Steps>                                       â”‚    â”‚
  â”‚  â”‚    <Form.Navigation />  â† Previous/Next buttons        â”‚    â”‚
  â”‚  â”‚    <Form.Progress />    â† Step indicator                â”‚    â”‚
  â”‚  â”‚  </Form.Provider>                                      â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  â†’ Steps/Navigation/Progress share currentStep!       â”‚    â”‚
  â”‚  â”‚  â†’ Form.Navigation NGOÃ€I Form.Steps nhÆ°ng IN Provider â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  EXAMPLE 4: Data Table â˜…â˜…                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚  <Table.Provider data={users} columns={cols}>          â”‚    â”‚
  â”‚  â”‚    <Table.Toolbar>                                     â”‚    â”‚
  â”‚  â”‚      <Table.Search />                                  â”‚    â”‚
  â”‚  â”‚      <Table.ColumnToggle />                            â”‚    â”‚
  â”‚  â”‚    </Table.Toolbar>                                    â”‚    â”‚
  â”‚  â”‚    <Table.Grid />                                      â”‚    â”‚
  â”‚  â”‚    <Table.Pagination />                                â”‚    â”‚
  â”‚  â”‚  </Table.Provider>                                     â”‚    â”‚
  â”‚  â”‚                                                       â”‚    â”‚
  â”‚  â”‚  â†’ Toolbar/Grid/Pagination share filter/sort/page!    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§17. Tá»± Viáº¿t â€” CompositionPatternEngine!

```javascript
var CompositionPatternEngine = (function () {
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 1. BOOLEAN COMPLEXITY CALCULATOR
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function calculateComplexity(booleanProps) {
    var count = booleanProps.length;
    var totalStates = Math.pow(2, count);
    var severity;
    if (count <= 2) severity = "LOW";
    else if (count <= 4) severity = "MEDIUM";
    else severity = "CRITICAL â˜…â˜…â˜…";

    return {
      booleanCount: count,
      possibleStates: totalStates,
      severity: severity,
      recommendation:
        count >= 3
          ? "REFACTOR to Compound Components + Explicit Variants! â˜…â˜…â˜…"
          : "OK for now, but monitor â˜…",
      impossibleStates: "Many combinations are IMPOSSIBLE â†’ type-unsafe! â˜…â˜…â˜…",
    };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 2. PATTERN MATCHER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var PATTERNS = {
    "compound-components": {
      when: "Complex UI with shared state between sub-components",
      structure: "Context + Provider + Sub-components + Namespace export",
      example: "Composer.Frame, Composer.Input, Composer.Submit",
    },
    "explicit-variants": {
      when: "Multiple use cases with different UIs",
      structure: "Each variant = Provider + composed sub-components",
      example: "ChannelComposer, ThreadComposer, EditComposer",
    },
    "lift-state": {
      when: "Sibling components need shared state",
      structure: "State in Provider, UI in children",
      example: "ForwardButton outside Composer.Frame accessing submit",
    },
    "decouple-state": {
      when: "Same UI, different state sources",
      structure: "Generic interface (state/actions/meta) + Provider DI",
      example: "useState vs Zustand vs server sync",
    },
    "children-over-render-props": {
      when: "Customizable layout without data passing",
      structure: "children prop for static composition",
      example: "<Composer.Footer>{children}</Composer.Footer>",
    },
  };

  function matchPattern(problem) {
    var results = [];
    if (problem.booleanProps && problem.booleanProps > 2) {
      results.push("compound-components", "explicit-variants");
    }
    if (problem.siblingStateSharing) results.push("lift-state");
    if (problem.multipleStateSources) results.push("decouple-state");
    if (problem.customizableLayout) results.push("children-over-render-props");

    return results.map(function (name) {
      return { pattern: name, details: PATTERNS[name] };
    });
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 3. CONTEXT INTERFACE GENERATOR
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function generateContextInterface(config) {
    return {
      name: config.name + "ContextValue",
      state: {
        type: config.name + "State",
        fields: config.stateFields || [],
      },
      actions: {
        type: config.name + "Actions",
        methods: config.actionMethods || [],
      },
      meta: {
        type: config.name + "Meta",
        fields: config.metaFields || [],
      },
      code:
        "interface " +
        config.name +
        "ContextValue {\n" +
        "  state: " +
        config.name +
        "State\n" +
        "  actions: " +
        config.name +
        "Actions\n" +
        "  meta: " +
        config.name +
        "Meta\n" +
        "}",
    };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 4. RE-RENDER ANALYZER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function analyzeRerenders(contextShape) {
    var fields = Object.keys(contextShape);
    var consumers = contextShape._consumers || [];
    var warnings = [];

    for (var i = 0; i < consumers.length; i++) {
      var c = consumers[i];
      if (c.usesFields.length < fields.length) {
        warnings.push({
          component: c.name,
          usesOnly: c.usesFields,
          unnecessaryRerenders: fields.filter(function (f) {
            return c.usesFields.indexOf(f) < 0;
          }),
          fix: "Split context or use selector â˜…â˜…â˜…",
        });
      }
    }
    return { totalFields: fields.length, warnings: warnings };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 5. MIGRATION PLANNER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function planMigration(component) {
    var steps = [];
    steps.push(
      "1. Identify " +
        (component.booleanProps || []).length +
        " boolean props â˜…",
    );
    steps.push("2. Define context interface (state/actions/meta) â˜…â˜…â˜…");
    steps.push(
      "3. Extract " + (component.subComponents || 0) + " sub-components â˜…â˜…â˜…",
    );
    steps.push("4. Create " + (component.variants || 0) + " providers â˜…â˜…â˜…");
    steps.push(
      "5. Compose " + (component.variants || 0) + " explicit variants â˜…â˜…â˜…",
    );
    steps.push("6. Delete original monolithic component â˜…");
    steps.push("7. Update all call sites â˜…â˜…â˜…");

    return {
      component: component.name,
      effort:
        component.booleanProps && component.booleanProps.length > 4
          ? "HIGH"
          : "MEDIUM",
      steps: steps,
    };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 6. DEMO
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function demo() {
    console.log("â•â•â• CompositionPattern Engine â•â•â•");

    console.log("\nâ”€â”€ 1. Boolean Complexity â”€â”€");
    console.log(
      calculateComplexity([
        "isThread",
        "isEditing",
        "isDM",
        "isForwarding",
        "isReply",
      ]),
    );

    console.log("\nâ”€â”€ 2. Pattern Matcher â”€â”€");
    console.log(
      matchPattern({
        booleanProps: 5,
        siblingStateSharing: true,
        multipleStateSources: true,
      }),
    );

    console.log("\nâ”€â”€ 3. Context Interface â”€â”€");
    console.log(
      generateContextInterface({
        name: "Composer",
        stateFields: ["input", "attachments", "isSubmitting"],
        actionMethods: ["update", "submit"],
        metaFields: ["inputRef"],
      }),
    );

    console.log("\nâ”€â”€ 4. Re-render Analysis â”€â”€");
    console.log(
      analyzeRerenders({
        state: {},
        actions: {},
        meta: {},
        _consumers: [
          { name: "Submit", usesFields: ["actions"] },
          { name: "Input", usesFields: ["state", "actions", "meta"] },
        ],
      }),
    );

    console.log("\nâ”€â”€ 5. Migration Plan â”€â”€");
    console.log(
      planMigration({
        name: "SuperComposer",
        booleanProps: [
          "isThread",
          "isEditing",
          "isDM",
          "isForwarding",
          "isReply",
        ],
        subComponents: 8,
        variants: 5,
      }),
    );
  }

  return { demo: demo };
})();
// Cháº¡y: CompositionPatternEngine.demo();
```

---

## Â§18. CÃ¢u Há»i Phá»ng Váº¥n Má»Ÿ Rá»™ng!

```
  CÃ‚U Há»I (Má» Rá»˜NG):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â“ 1: Táº¡i sao trÃ¡nh boolean props?                            â”‚
  â”‚  â†’ Má»—i boolean nhÃ¢n Ä‘Ã´i states! â˜…â˜…â˜…                      â”‚
  â”‚  â†’ 4 booleans = 16 combinations! â˜…â˜…â˜…                     â”‚
  â”‚  â†’ Nhiá»u combinations = IMPOSSIBLE states! â˜…â˜…â˜…            â”‚
  â”‚  â†’ TypeScript KHÃ”NG báº¯t Ä‘Æ°á»£c impossible states! â˜…â˜…â˜…      â”‚
  â”‚  â†’ DÃ¹ng composition + explicit variants thay tháº¿! â˜…â˜…â˜…   â”‚
  â”‚                                                              â”‚
  â”‚  â“ 2: Compound Components pattern?                            â”‚
  â”‚  â†’ Shared context thay prop drilling! â˜…â˜…â˜…                 â”‚
  â”‚  â†’ Sub-components access state qua use()! â˜…â˜…â˜…            â”‚
  â”‚  â†’ Consumer compose pieces they need! â˜…â˜…â˜…                â”‚
  â”‚  â†’ Export as namespace: Composer.Input, etc.! â˜…           â”‚
  â”‚  â†’ VD: Radix UI, Headless UI, Chakra UI! â˜…               â”‚
  â”‚                                                              â”‚
  â”‚  â“ 3: Decouple State from UI?                                 â”‚
  â”‚  â†’ Provider = ONLY place biáº¿t state impl! â˜…â˜…â˜…            â”‚
  â”‚  â†’ UI only knows context interface! â˜…â˜…â˜…                  â”‚
  â”‚  â†’ Swap useState/Zustand â†’ UI unchanged! â˜…â˜…â˜…            â”‚
  â”‚  â†’ Dependency Injection pattern! â˜…â˜…â˜…                      â”‚
  â”‚  â†’ Giá»‘ng Strategy pattern trong OOP! â˜…                    â”‚
  â”‚                                                              â”‚
  â”‚  â“ 4: Lift State â€” táº¡i sao?                                   â”‚
  â”‚  â†’ Sibling components share state! â˜…â˜…â˜…                    â”‚
  â”‚  â†’ Provider boundary matters, NOT visual nesting! â˜…â˜…â˜…    â”‚
  â”‚  â†’ TrÃ¡nh 3 anti-patterns: â˜…â˜…â˜…                            â”‚
  â”‚    1) State trapped in component                           â”‚
  â”‚    2) useEffect sync (double render!)                      â”‚
  â”‚    3) Ref hack (stateRef.current)                          â”‚
  â”‚                                                              â”‚
  â”‚  â“ 5: React 19 thay Ä‘á»•i gÃ¬?                                   â”‚
  â”‚  â†’ ref = regular prop â†’ bye forwardRef! â˜…â˜…â˜…              â”‚
  â”‚  â†’ use() thay useContext() â†’ conditional OK! â˜…â˜…â˜…         â”‚
  â”‚  â†’ use() cÅ©ng Ä‘á»c Ä‘Æ°á»£c Promise! â˜…                        â”‚
  â”‚                                                              â”‚
  â”‚  â“ 6: Context re-render problem?                              â”‚
  â”‚  â†’ Context value thay Ä‘á»•i â†’ ALL consumers re-render! â˜…â˜…â˜…â”‚
  â”‚  â†’ Fix: Split contexts (state vs actions)! â˜…â˜…â˜…           â”‚
  â”‚  â†’ Fix: useMemo context value! â˜…â˜…                        â”‚
  â”‚  â†’ Fix: useCallback stable actions! â˜…â˜…                   â”‚
  â”‚                                                              â”‚
  â”‚  â“ 7: Test compound components tháº¿ nÃ o?                       â”‚
  â”‚  â†’ Unit: mock Provider + test sub-component! â˜…â˜…â˜…         â”‚
  â”‚  â†’ Integration: render variant, assert UI! â˜…â˜…â˜…           â”‚
  â”‚  â†’ Provider swap: same UI works with both! â˜…â˜…â˜…           â”‚
  â”‚                                                              â”‚
  â”‚  â“ 8: Khi nÃ o render props váº«n OK?                            â”‚
  â”‚  â†’ Parent truyá»n DATA xuá»‘ng child! â˜…â˜…â˜…                   â”‚
  â”‚  â†’ VD: <List renderItem={({ item }) => ...} /> â˜…         â”‚
  â”‚  â†’ Children cho static layout! â˜…                          â”‚
  â”‚  â†’ Render props cho dynamic data injection! â˜…             â”‚
  â”‚                                                              â”‚
  â”‚  â“ 9: So sÃ¡nh vá»›i Higher-Order Components?                    â”‚
  â”‚  â†’ HOC: wrapper function, implicit props! â˜…               â”‚
  â”‚  â†’ Compound: explicit composition! â˜…â˜…â˜…                    â”‚
  â”‚  â†’ HOC: prop collision, wrapper hell! â˜…â˜…â˜…                â”‚
  â”‚  â†’ Compound: no collision, clear structure! â˜…â˜…â˜…          â”‚
  â”‚  â†’ React khuyáº¿n nghá»‹ hooks + composition! â˜…â˜…â˜…            â”‚
  â”‚                                                              â”‚
  â”‚  â“ 10: Migration strategy?                                    â”‚
  â”‚  â†’ 5 bÆ°á»›c: identify â†’ interface â†’ extract â†’ providers     â”‚
  â”‚    â†’ compose variants! â˜…â˜…â˜…                                â”‚
  â”‚  â†’ Gradual: migrate 1 variant at a time! â˜…â˜…â˜…             â”‚
  â”‚  â†’ Keep old component running during migration! â˜…         â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§19. GIáº¢I THÃCH SÃ‚U â€” Avoid Boolean Props!

### 19.1 "Monolithic Component" lÃ  gÃ¬? Táº¡i sao nÃ³ cá»“ng ká»nh?

"Monolithic" = **Má»˜T KHá»I**, nghÄ©a lÃ  Táº¤T Cáº¢ logic Ä‘Æ°á»£c nhá»“i vÃ o 1 component
duy nháº¥t. HÃ£y xem vÃ­ dá»¥ cá»¥ thá»ƒ â€” má»™t chat app cÃ³ component `Composer` (Ã´ soáº¡n
tin nháº¯n). App cáº§n há»— trá»£ nhiá»u cháº¿ Ä‘á»™: soáº¡n tin bÃ¬nh thÆ°á»ng, soáº¡n trong thread,
soáº¡n DM, chá»‰nh sá»­a tin, forward tin. Thay vÃ¬ tÃ¡ch riÃªng, team NHá»’I Háº¾T vÃ o 1 file:

```tsx
// âŒ MONOLITHIC COMPONENT â€” File: Composer.tsx
// Táº¤T Cáº¢ cháº¿ Ä‘á»™ nhá»“i vÃ o 1 file duy nháº¥t!

interface ComposerProps {
  onSubmit: () => void
  isThread?: boolean       // â† boolean #1: "cÃ³ pháº£i thread khÃ´ng?"
  channelId?: string       // â† data riÃªng cho thread
  isDMThread?: boolean     // â† boolean #2: "cÃ³ pháº£i DM thread khÃ´ng?"
  dmId?: string            // â† data riÃªng cho DM
  isEditing?: boolean      // â† boolean #3: "Ä‘ang edit tin nháº¯n?"
  isForwarding?: boolean   // â† boolean #4: "Ä‘ang forward tin nháº¯n?"
  isScheduled?: boolean    // â† boolean #5: "Ä‘ang schedule tin nháº¯n?"
}

function Composer({
  onSubmit, isThread, channelId, isDMThread,
  dmId, isEditing, isForwarding, isScheduled
}: ComposerProps) {
  return (
    <form>
      {/* â”€â”€â”€ HEADER â”€â”€â”€ */}
      {/* Pháº£i check 2 booleans: edit thÃ¬ khÃ´ng cÃ³ header,
          forward cÅ©ng khÃ´ng cÃ³ header */}
      {!isEditing && !isForwarding && <Header />}

      {/* â”€â”€â”€ INPUT â”€â”€â”€ */}
      <Input />

      {/* â”€â”€â”€ MIDDLE: "Also send to..." â”€â”€â”€ */}
      {/* Pháº£i check 3 booleans lá»“ng nhau!
          DM thread â†’ show "Also send to DM"
          Regular thread â†’ show "Also send to Channel"
          KhÃ´ng pháº£i thread â†’ khÃ´ng show gÃ¬ */}
      {isDMThread ? (
        <AlsoSendToDMField id={dmId} />
      ) : isThread ? (
        <AlsoSendToChannelField id={channelId} />
      ) : null}

      {/* â”€â”€â”€ SCHEDULE PICKER â”€â”€â”€ */}
      {/* Chá»‰ show khi schedule VÃ€ khÃ´ng edit */}
      {isScheduled && !isEditing && <SchedulePicker />}

      {/* â”€â”€â”€ FOOTER ACTIONS â”€â”€â”€ */}
      {/* Check 3 booleans Ä‘á»ƒ quyáº¿t Ä‘á»‹nh render nÃºt nÃ o! */}
      {isEditing ? (
        <EditActions />       {/* "Save" + "Cancel" */}
      ) : isForwarding ? (
        <ForwardActions />    {/* "Forward" + "Cancel" */}
      ) : (
        <DefaultActions onSubmit={onSubmit} />  {/* "Send" */}
      )}
    </form>
  )
}
```

**Táº¡i sao code trÃªn Cá»’N Ká»€NH vÃ  nguy hiá»ƒm?**

- **500+ dÃ²ng** trong 1 file (khi thÃªm styles, handlers, hooks...)
- Sá»­a logic "edit" â†’ cÃ³ thá»ƒ **VÃ” TÃŒNH** phÃ¡ há»ng logic "thread"
  vÃ¬ chÃºng náº±m CÃ™NG 1 function!
- Developer má»›i má»Ÿ file â†’ "Ã” my god, 500 dÃ²ng, báº¯t Ä‘áº§u tá»« Ä‘Ã¢u?" ğŸ˜±
- ÄÃ¢y gá»i lÃ  **"God Component"** â€” nÃ³ biáº¿t quÃ¡ nhiá»u thá»©!

### 19.2 "Exponential Branching" lÃ  gÃ¬? â€” Giáº£i thÃ­ch tá»«ng bÆ°á»›c!

**CÃ¢u há»i**: "5 booleans = 32 nhÃ¡nh" nghÄ©a lÃ  gÃ¬?

HÃ£y báº¯t Ä‘áº§u **ÄÆ N GIáº¢N** â€” chá»‰ 3 booleans trÆ°á»›c:

```
  3 BOOLEANS = 2 Ã— 2 Ã— 2 = 8 Tá»” Há»¢P â€” LIá»†T KÃŠ Äáº¦Y Äá»¦:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Component cÃ³ 3 boolean props:                                â”‚
  â”‚  â€¢ isThread    â†’ T hoáº·c F  (2 giÃ¡ trá»‹)                      â”‚
  â”‚  â€¢ isEditing   â†’ T hoáº·c F  (2 giÃ¡ trá»‹)                      â”‚
  â”‚  â€¢ isForwardingâ†’ T hoáº·c F  (2 giÃ¡ trá»‹)                      â”‚
  â”‚                                                              â”‚
  â”‚  Tá»•ng tá»• há»£p = 2 Ã— 2 Ã— 2 = 2Â³ = 8                           â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚ #  â”‚ isThread â”‚ isEditing â”‚ isForwarding â”‚ Há»£p lá»‡?      â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚ 1  â”‚ false    â”‚ false     â”‚ false        â”‚ âœ… Default    â”‚ â”‚
  â”‚  â”‚ 2  â”‚ true     â”‚ false     â”‚ false        â”‚ âœ… Thread     â”‚ â”‚
  â”‚  â”‚ 3  â”‚ false    â”‚ true      â”‚ false        â”‚ âœ… Edit       â”‚ â”‚
  â”‚  â”‚ 4  â”‚ false    â”‚ false     â”‚ true         â”‚ âœ… Forward    â”‚ â”‚
  â”‚  â”‚ 5  â”‚ true     â”‚ true      â”‚ false        â”‚ âŒ VÃ” NGHÄ¨A! â”‚ â”‚
  â”‚  â”‚ 6  â”‚ true     â”‚ false     â”‚ true         â”‚ âŒ VÃ” NGHÄ¨A! â”‚ â”‚
  â”‚  â”‚ 7  â”‚ false    â”‚ true      â”‚ true         â”‚ âŒ VÃ” NGHÄ¨A! â”‚ â”‚
  â”‚  â”‚ 8  â”‚ true     â”‚ true      â”‚ true         â”‚ âŒ VÃ” NGHÄ¨A! â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â”‚                                                              â”‚
  â”‚  â†’ 8 tá»• há»£p nhÆ°ng CHá»ˆ 4 CÃI há»£p lá»‡!                        â”‚
  â”‚  â†’ 4 cÃ¡i cÃ²n láº¡i (50%) lÃ  IMPOSSIBLE STATES! â˜…â˜…â˜…            â”‚
  â”‚                                                              â”‚
  â”‚  VÃ Dá»¤ impossible state #5: isThread=T + isEditing=T         â”‚
  â”‚  NghÄ©a lÃ : "User Ä‘ang á»Ÿ trong Thread VÃ€ Äá»’NG THá»œI Ä‘ang     â”‚
  â”‚  edit tin nháº¯n". NhÆ°ng trong UI thá»±c táº¿:                      â”‚
  â”‚  â†’ Khi edit â†’ UI chá»‰ show Ã´ input + nÃºt Save/Cancel         â”‚
  â”‚  â†’ KHÃ”NG Cáº¦N "Also send to channel" (feature cá»§a thread)    â”‚
  â”‚  â†’ Váº­y UI pháº£i render GÃŒ? KhÃ´ng ai biáº¿t! â†’ BUG! â˜…â˜…â˜…        â”‚
  â”‚                                                              â”‚
  â”‚  Impossible state #8: Táº¤T Cáº¢ true cÃ¹ng lÃºc                  â”‚
  â”‚  â†’ "Vá»«a á»Ÿ thread, vá»«a edit, vá»«a forward" â€” VÃ” LÃ!          â”‚
  â”‚  â†’ NhÆ°ng TypeScript váº«n cho phÃ©p viáº¿t:                       â”‚
  â”‚    <Composer isThread isEditing isForwarding />               â”‚
  â”‚  â†’ Compiler KHÃ”NG bÃ¡o lá»—i! â˜…â˜…â˜…                              â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Giá» **nhÃ¢n lÃªn 5 booleans** (thÃªm isDMThread, isScheduled):

```
  5 BOOLEANS = 2âµ = 32 Tá»” Há»¢P! â€” Code trÃ´ng tháº¿ nÃ o?
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Trong 32 tá»• há»£p, chá»‰ khoáº£ng 6 cÃ¡i Há»¢P Lá»†:                 â”‚
  â”‚  1. Default (all false)                                      â”‚
  â”‚  2. Thread only                                              â”‚
  â”‚  3. DM Thread only                                           â”‚
  â”‚  4. Edit only                                                â”‚
  â”‚  5. Forward only                                             â”‚
  â”‚  6. Scheduled only                                           â”‚
  â”‚  â†’ 26/32 = 81% tá»• há»£p lÃ  VÃ” NGHÄ¨A! â˜…â˜…â˜…                    â”‚
  â”‚                                                              â”‚
  â”‚  Náº¿u dev MUá»N handle Ä‘áº§y Ä‘á»§, code sáº½ nhÆ° tháº¿ nÃ y:           â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```tsx
// âŒ CODE THá»°C Táº¾ khi cá»‘ handle 5 booleans:
function Composer({
  isThread,
  isDMThread,
  isEditing,
  isForwarding,
  isScheduled,
}) {
  // NHÃNH 1/32: Táº¥t cáº£ false â†’ Default channel composer
  if (!isThread && !isDMThread && !isEditing && !isForwarding && !isScheduled) {
    return <DefaultComposer />;
  }

  // NHÃNH 2/32: Chá»‰ isThread = true â†’ Regular thread
  if (isThread && !isDMThread && !isEditing && !isForwarding && !isScheduled) {
    return (
      <form>
        <Input />
        <AlsoSendToChannel />
        <Submit />
      </form>
    );
  }

  // NHÃNH 3/32: Chá»‰ isDMThread = true â†’ DM thread
  if (!isThread && isDMThread && !isEditing && !isForwarding && !isScheduled) {
    return (
      <form>
        <Input />
        <AlsoSendToDM />
        <Submit />
      </form>
    );
  }

  // NHÃNH 5/32: isThread + isEditing â†’ ???
  if (isThread && !isDMThread && isEditing && !isForwarding && !isScheduled) {
    // "Thread + Edit" â†’ UI NÃ€O? Thiáº¿t káº¿ KHÃ”NG CÃ“ case nÃ y!
    // Dev A: return null  (crash!)
    // Dev B: return <EditComposer /> (bá» qua thread logic)
    // Dev C: khÃ´ng biáº¿t â†’ Ä‘á»ƒ trá»‘ng â†’ BUG RUNTIME! â˜…â˜…â˜…
  }

  // ... CÃ’N 27 NHÃNH Ná»®A mÃ  dev pháº£i viáº¿t code cho!
  // NhÆ°ng KHÃ”NG AI viáº¿t háº¿t â†’ bug áº©n trong cÃ¡c nhÃ¡nh bá»‹ bá» qua!
}
```

**So sÃ¡nh: Composition chá»‰ cáº§n 6 files riÃªng biá»‡t, KHÃ”NG CÃ“ nhÃ¡nh nÃ o!**

```tsx
// âœ… COMPOSITION: Má»—i cháº¿ Ä‘á»™ = 1 file riÃªng biá»‡t!

// File 1: ChannelComposer.tsx (50 dÃ²ng)
function ChannelComposer() {
  return (
    <Composer.Frame>
      <Composer.Header />
      <Composer.Input />
      <Composer.Footer>
        <Composer.Submit />
      </Composer.Footer>
    </Composer.Frame>
  );
}

// File 2: ThreadComposer.tsx (60 dÃ²ng)
function ThreadComposer({ channelId }: { channelId: string }) {
  return (
    <Composer.Frame>
      <Composer.Header />
      <Composer.Input />
      <AlsoSendToChannelField id={channelId} />
      <Composer.Footer>
        <Composer.Submit />
      </Composer.Footer>
    </Composer.Frame>
  );
}

// File 3: EditComposer.tsx (45 dÃ²ng)
function EditComposer() {
  return (
    <Composer.Frame>
      <Composer.Input />
      <Composer.Footer>
        <Composer.CancelEdit />
        <Composer.SaveEdit />
      </Composer.Footer>
    </Composer.Frame>
  );
}

// KHÃ”NG THá»‚ Táº O impossible state! VÃ­ dá»¥:
// <ThreadComposer isEditing /> â†’ âŒ TypeScript ERROR!
// VÃ¬ ThreadComposer CHá»ˆ nháº­n { channelId: string }
// NÃ³ KHÃ”NG CÃ“ prop isEditing â†’ compiler cháº·n ngay! â˜…â˜…â˜…
```

```
  SO SÃNH TRá»°C QUAN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  âŒ MONOLITHIC + BOOLEAN PROPS:                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚  â”‚       Composer.tsx (1 file, 500+ dÃ²ng!)     â”‚              â”‚
  â”‚  â”‚                                             â”‚              â”‚
  â”‚  â”‚  if (!isThread && !isDM && !isEdit...) {    â”‚              â”‚
  â”‚  â”‚  } else if (isThread && !isDM...) {         â”‚              â”‚
  â”‚  â”‚  } else if (isThread && isDM...) {          â”‚              â”‚
  â”‚  â”‚  } else if (...) { ??? }                    â”‚              â”‚
  â”‚  â”‚  ... 32 nhÃ¡nh, 26 cÃ¡i VÃ” NGHÄ¨A!            â”‚              â”‚
  â”‚  â”‚                                             â”‚              â”‚
  â”‚  â”‚  Developer má»›i: "TÃ´i Sá»¢ file nÃ y!" ğŸ˜±      â”‚              â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚                                                              â”‚
  â”‚  âœ… COMPOSITION (má»—i variant 1 file nhá»):                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
  â”‚  â”‚ Channel  â”‚ â”‚ Thread   â”‚ â”‚ DMThread â”‚                     â”‚
  â”‚  â”‚ 50 dÃ²ng  â”‚ â”‚ 60 dÃ²ng  â”‚ â”‚ 55 dÃ²ng  â”‚                     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
  â”‚  â”‚ Edit     â”‚ â”‚ Forward  â”‚ â”‚ Schedule â”‚                     â”‚
  â”‚  â”‚ 45 dÃ²ng  â”‚ â”‚ 50 dÃ²ng  â”‚ â”‚ 55 dÃ²ng  â”‚                     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
  â”‚  â†’ 6 files nhá», má»—i file Äá»˜C Láº¬P!                          â”‚
  â”‚  â†’ ZERO impossible states!                                   â”‚
  â”‚  â†’ Developer má»›i: "Dá»… hiá»ƒu quÃ¡!" ğŸ˜Š â˜…â˜…â˜…                   â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 19.3 "32 nhÃ¡nh >> 7 â†’ COGNITIVE OVERLOAD" â€” nghÄ©a lÃ  gÃ¬?

**Miller's Law (1956)**: Bá»™ nhá»› ngáº¯n háº¡n (working memory) cá»§a con ngÆ°á»i chá»‰
giá»¯ Ä‘Æ°á»£c **7 Â± 2 thá»©** cÃ¹ng lÃºc. Giá»‘ng nhÆ° RAM mÃ¡y tÃ­nh â€” chá»‰ chá»©a Ä‘Æ°á»£c
7 items, thÃªm cÃ¡i thá»© 8 thÃ¬ cÃ¡i Ä‘áº§u tiÃªn bá»‹ "Ä‘áº©y ra"!

**Váº¥n Ä‘á»**: Khi developer Ä‘á»c code cÃ³ boolean props, há» pháº£i "náº¡p" vÃ o nÃ£o
Tá»ªNG boolean má»™t. HÃ£y xem vÃ­ dá»¥ Cá»¤ THá»‚:

```tsx
// âŒ Developer Ä‘á»c dÃ²ng code nÃ y trong codebase:
<Composer
  isThread
  isDMThread={false}
  isEditing={false}
  isForwarding={false}
  channelId="abc"
/>
```

**NÃ£o developer pháº£i LÃ€M GÃŒ khi Ä‘á»c dÃ²ng trÃªn?**

```
  Tá»ªNG BÆ¯á»šC NÃƒO PHáº¢I Xá»¬ LÃ:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 1: Äá»c "isThread" (khÃ´ng cÃ³ ={...})                   â”‚
  â”‚  â†’ NÃ£o lÆ°u: "isThread = true" â† ğŸ§  slot 1/7               â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 2: Äá»c "isDMThread={false}"                            â”‚
  â”‚  â†’ NÃ£o lÆ°u: "isDMThread = false" â† ğŸ§  slot 2/7             â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 3: Äá»c "isEditing={false}"                             â”‚
  â”‚  â†’ NÃ£o lÆ°u: "isEditing = false" â† ğŸ§  slot 3/7              â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 4: Äá»c "isForwarding={false}"                          â”‚
  â”‚  â†’ NÃ£o lÆ°u: "isForwarding = false" â† ğŸ§  slot 4/7           â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 5: NÃ£o pháº£i SUY LUáº¬N â€” káº¿t há»£p 4 giÃ¡ trá»‹ trÃªn:       â”‚
  â”‚  â†’ "isThread=T nhÆ°ng isDMThread=F â†’ Ä‘Ã¢y lÃ  Regular Thread,  â”‚
  â”‚     khÃ´ng pháº£i DM Thread" â† ğŸ§  slot 5/7                     â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 6: NÃ£o pháº£i KIá»‚M TRA â€” "isEditing=F vÃ  isForwarding=F â”‚
  â”‚  â†’ OK, khÃ´ng pháº£i edit cÅ©ng khÃ´ng pháº£i forward,              â”‚
  â”‚  â†’ Váº­y Ä‘Ã¢y THUáº¦N lÃ  thread mode" â† ğŸ§  slot 6/7             â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 7: Äá»c channelId="abc"                                 â”‚
  â”‚  â†’ "channelId cáº§n cho thread" â† ğŸ§  slot 7/7                 â”‚
  â”‚                                                              â”‚
  â”‚  â†’ ÄÃšNG 7 ITEMS! Äáº¦Y RAM! â˜…â˜…â˜…                              â”‚
  â”‚  â†’ ThÃªm 1 prop ná»¯a (isScheduled?) â†’ NÃƒO QUAY Láº I          â”‚
  â”‚    vÃ¬ vÆ°á»£t giá»›i háº¡n working memory!                          â”‚
  â”‚  â†’ Developer pháº£i Äá»ŒC Láº I Tá»ª Äáº¦U! â˜…â˜…â˜…                     â”‚
  â”‚  â†’ ÄÃ¢y gá»i lÃ  COGNITIVE OVERLOAD!                            â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**BÃ¢y giá» so sÃ¡nh: náº¿u dÃ¹ng Composition thÃ¬ nÃ£o chá»‰ cáº§n 2 slots!**

```tsx
// âœ… Developer Ä‘á»c dÃ²ng code nÃ y:
<ThreadComposer channelId="abc" />
```

```
  NÃƒO CHá»ˆ Cáº¦N 2 BÆ¯á»šC:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 1: Äá»c "ThreadComposer"                                â”‚
  â”‚  â†’ NÃ£o hiá»ƒu ngay: "Ã€, Ä‘Ã¢y lÃ  Composer cho Thread!"          â”‚
  â”‚  â†’ TÃªn component = tÃ i liá»‡u! â† ğŸ§  slot 1/7                 â”‚
  â”‚                                                              â”‚
  â”‚  BÆ°á»›c 2: Äá»c channelId="abc"                                 â”‚
  â”‚  â†’ "Channel ID cho thread nÃ y" â† ğŸ§  slot 2/7                â”‚
  â”‚                                                              â”‚
  â”‚  â†’ CHá»ˆ 2 ITEMS! CÃ²n dÆ° 5 slots! â˜…â˜…â˜…                        â”‚
  â”‚  â†’ KHÃ”NG Cáº¦N suy luáº­n "cÃ¡i nÃ o true, cÃ¡i nÃ o false"         â”‚
  â”‚  â†’ KHÃ”NG Cáº¦N má»Ÿ file component xem bÃªn trong                â”‚
  â”‚  â†’ Developer HIá»‚U NGAY, khÃ´ng cáº§n nghÄ©! â˜…â˜…â˜…                 â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Váº­y "32 >> 7" nghÄ©a lÃ  gÃ¬?**
â†’ Component cÃ³ 5 booleans = 32 tá»• há»£p tráº¡ng thÃ¡i
â†’ Developer pháº£i giá»¯ trong Ä‘áº§u: "Tá»• há»£p NÃ€O Ä‘ang active?"
â†’ NhÆ°ng nÃ£o chá»‰ giá»¯ Ä‘Æ°á»£c 7 thá»© cÃ¹ng lÃºc!
â†’ 32 >> 7 (32 lá»›n hÆ¡n Ráº¤T NHIá»€U so vá»›i 7)
â†’ Káº¿t luáº­n: **KHÃ”NG THá»‚ hiá»ƒu component trong 1 láº§n Ä‘á»c!** â˜…â˜…â˜…

### 19.4 Team Impact â€” áº¢nh hÆ°á»Ÿng thá»±c táº¿ lÃªn team!

**1) PR Review â€” Monolithic vs Composition:**

```tsx
// âŒ MONOLITHIC: Dev A sá»­a 1 dÃ²ng trong Composer.tsx
// PR diff: +1 line, -1 line â€” nhÃ¬n Ä‘Æ¡n giáº£n!
// NhÆ°ng reviewer pháº£i há»i:

//   Reviewer: "DÃ²ng 234 báº¡n sá»­a `{isThread && !isDM && ...}`
//   thÃ nh `{isThread && ...}` â€” báº¡n bá» check `!isDM`.
//   Váº­y khi isDM=true VÃ€ isThread=true thÃ¬ sao?"
//
//   Dev A: "Uh... Ä‘á»ƒ tÃ´i check láº¡i..."
//   (15 phÃºt sau)
//   Dev A: "Hmm, trÆ°á»ng há»£p Ä‘Ã³ cÃ³ thá»ƒ xáº£y ra khÃ´ng nhá»‰?"
//   Reviewer: "TÃ´i cÅ©ng khÃ´ng cháº¯c, pháº£i Ä‘á»c láº¡i caller..."
//   (45 phÃºt sau, cáº£ 2 váº«n khÃ´ng cháº¯c)
//
//   â†’ Review time: 2-3 GIá»œ cho 1 thay Ä‘á»•i nhá»! â˜…â˜…â˜…
//   â†’ VÃ¬ reviewer pháº£i hiá»ƒu Táº¤T Cáº¢ 32 tá»• há»£p boolean!
```

```tsx
// âœ… COMPOSITION: Dev A sá»­a ThreadComposer.tsx
// PR diff: rÃµ rÃ ng 100%!
//
//   Reviewer: "PR nÃ y chá»‰ sá»­a ThreadComposer.
//   File 60 dÃ²ng, tÃ´i Ä‘á»c háº¿t trong 5 phÃºt.
//   Change nÃ y CHá»ˆ áº£nh hÆ°á»Ÿng thread mode.
//   Edit, Forward, DM â€” KHÃ”NG LIÃŠN QUAN.
//   LGTM! âœ…"
//
//   â†’ Review time: 15-30 PHÃšT! â˜…â˜…â˜…
```

**2) Onboarding â€” Dev má»›i vÃ o team:**

```tsx
// âŒ MONOLITHIC: Dev má»›i ngÃ y Ä‘áº§u tiÃªn
// PM: "Sá»­a nÃºt Submit trong Composer khi Ä‘ang edit"
// Dev má»›i má»Ÿ Composer.tsx â†’ 500 dÃ²ng! ğŸ˜±
//
//   Dev má»›i: "isThread, isDMThread, isEditing, isForwarding,
//   isScheduled... cÃ¡i nÃ o liÃªn quan Ä‘áº¿n edit?"
//   â†’ Äá»c tá»« dÃ²ng 1 â†’ dÃ²ng 234 â†’ tÃ¬m isEditing
//   â†’ NhÆ°ng isEditing xuáº¥t hiá»‡n á»Ÿ 15 chá»— khÃ¡c nhau!
//   â†’ "Sá»­a chá»— nÃ y cÃ³ áº£nh hÆ°á»Ÿng chá»— khÃ¡c khÃ´ng?"
//   â†’ Há»i senior â†’ Senior cÅ©ng pháº£i Ä‘á»c láº¡i!
//   â†’ Máº¤T 2 NGÃ€Y Ä‘á»ƒ hiá»ƒu 1 component! â˜…â˜…â˜…
```

```tsx
// âœ… COMPOSITION: Dev má»›i ngÃ y Ä‘áº§u tiÃªn
// PM: "Sá»­a nÃºt Submit trong EditComposer"
// Dev má»›i má»Ÿ EditComposer.tsx â†’ 45 dÃ²ng!
//
//   Dev má»›i: "Ã€, file nÃ y CHá»ˆ cÃ³ edit logic!
//   NÃºt Submit á»Ÿ dÃ²ng 35. Sá»­a xong!"
//   â†’ Máº¤T 5 PHÃšT! â˜…â˜…â˜…
//   â†’ KHÃ”NG Cáº¦N há»i senior!
//   â†’ KHÃ”NG Cáº¦N hiá»ƒu thread, DM, forward...
```

**3) Production Incident â€” Bug thá»±c táº¿:**

```tsx
// âŒ MONOLITHIC: Bug report tá»« production!
// User báº±ng cÃ¡ch nÃ o Ä‘Ã³ trigger: isEditing=true + isForwarding=true
// (vÃ­ dá»¥: click Edit â†’ nhanh tay click Forward trÆ°á»›c khi state update)

function Composer({ isEditing, isForwarding, ...rest }) {
  return (
    <form>
      {/* FOOTER: check 2 booleans */}
      {isEditing ? (
        <EditActions /> // â† isEditing=T â†’ vÃ o Ä‘Ã¢y
      ) : isForwarding ? (
        <ForwardActions /> // â† KHÃ”NG BAO GIá»œ Ä‘áº¿n Ä‘Ã¢y khi cáº£ 2 true!
      ) : (
        <DefaultActions />
      )}
      {/* NhÆ°ng á»Ÿ chá»— khÃ¡c trong component: */}
      {isForwarding && <ForwardPreview />} // â† isForwarding=T â†’ RENDER!
      {/* Káº¾T QUáº¢: Footer show "Edit" buttons
          nhÆ°ng giá»¯a form show "Forward Preview"!
          â†’ UI LOáº N! User tháº¥y cáº£ Edit láº«n Forward!
          â†’ Data cÃ³ thá»ƒ bá»‹ máº¥t! â˜…â˜…â˜… */}
    </form>
  );
}

// Hotfix:
// Dev thÃªm: if (isEditing && isForwarding) return <ErrorState />
// â†’ ThÃªm 1 conditional Ná»®A â†’ file phÃ¬nh thÃªm â†’ vÃ²ng xoÃ¡y! â˜…â˜…â˜…
```

```tsx
// âœ… COMPOSITION: Bug KHÃ”NG THá»‚ xáº£y ra!
// VÃ¬ EditComposer vÃ  ForwardComposer lÃ  2 files RIÃŠNG BIá»†T.
// KhÃ´ng cÃ³ cÃ¡ch nÃ o "vá»«a Edit vá»«a Forward" cÃ¹ng lÃºc!
// Parent component quyáº¿t Ä‘á»‹nh render CÃI NÃ€O:

function ChatApp({ mode }) {
  switch (mode) {
    case "edit":
      return <EditComposer />; // HOáº¶C edit
    case "forward":
      return <ForwardComposer />; // HOáº¶C forward
    default:
      return <ChannelComposer />; // HOáº¶C default
  }
  // â†’ CHá»ˆ 1 variant Ä‘Æ°á»£c render táº¡i 1 thá»i Ä‘iá»ƒm!
  // â†’ ZERO impossible states! â˜…â˜…â˜…
}
```

**4) Parallel Development â€” Git conflicts:**

```
  âŒ MONOLITHIC: 3 devs cÃ¹ng sá»­a Composer.tsx
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Dev A: sá»­a thread logic (dÃ²ng 100-150)                      â”‚
  â”‚  Dev B: sá»­a edit logic (dÃ²ng 200-250)                        â”‚
  â”‚  Dev C: sá»­a forward logic (dÃ²ng 300-350)                     â”‚
  â”‚                                                              â”‚
  â”‚  Khi merge:                                                   â”‚
  â”‚  â†’ Dev A merge trÆ°á»›c â†’ OK                                    â”‚
  â”‚  â†’ Dev B merge â†’ CONFLICT! VÃ¬ Dev A thay Ä‘á»•i cÃ¡c dÃ²ng        â”‚
  â”‚    import á»Ÿ Ä‘áº§u file mÃ  Dev B cÅ©ng dÃ¹ng! â˜…â˜…â˜…                â”‚
  â”‚  â†’ Dev C merge â†’ CONFLICT Náº¶NG HÆ N! VÃ¬ cáº£ A vÃ  B           â”‚
  â”‚    Ä‘á»u sá»­a shared state logic! â˜…â˜…â˜…                           â”‚
  â”‚  â†’ 3 devs tá»‘n thÃªm Ná»¬A NGÃ€Y resolve conflicts! â˜…â˜…â˜…         â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âœ… COMPOSITION: 3 devs sá»­a 3 files khÃ¡c nhau
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Dev A: sá»­a ThreadComposer.tsx                                â”‚
  â”‚  Dev B: sá»­a EditComposer.tsx                                  â”‚
  â”‚  Dev C: sá»­a ForwardComposer.tsx                               â”‚
  â”‚                                                              â”‚
  â”‚  Khi merge:                                                   â”‚
  â”‚  â†’ Dev A merge â†’ OK (file riÃªng)                             â”‚
  â”‚  â†’ Dev B merge â†’ OK (file riÃªng)                             â”‚
  â”‚  â†’ Dev C merge â†’ OK (file riÃªng)                             â”‚
  â”‚  â†’ ZERO CONFLICTS! Ship nhanh gáº¥p 3 láº§n! â˜…â˜…â˜…                â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 19.5 Composition Benefits â€” Vá»›i code vÃ­ dá»¥ cá»¥ thá»ƒ!

**1) Linear vs Exponential â€” vÃ­ dá»¥ báº±ng sá»‘:**

```
  THÃŠM 1 VARIANT Má»šI ("ScheduledComposer"):
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  âŒ Boolean: thÃªm isScheduled (boolean thá»© 6)                â”‚
  â”‚  â†’ TrÆ°á»›c: 5 booleans = 2âµ = 32 tá»• há»£p                      â”‚
  â”‚  â†’ Sau:   6 booleans = 2â¶ = 64 tá»• há»£p                      â”‚
  â”‚  â†’ NHÃ‚N ÄÃ”I! Tá»« 32 â†’ 64 tá»• há»£p pháº£i handle! â˜…â˜…â˜…           â”‚
  â”‚                                                              â”‚
  â”‚  âœ… Composition: thÃªm 1 file ScheduledComposer.tsx            â”‚
  â”‚  â†’ TrÆ°á»›c: 5 files                                            â”‚
  â”‚  â†’ Sau:   6 files                                            â”‚
  â”‚  â†’ CHá»ˆ THÃŠM 1! Tá»« 5 â†’ 6 files! â˜…â˜…â˜…                        â”‚
  â”‚  â†’ CÃ¡c file cÅ© KHÃ”NG Bá»Š áº¢NH HÆ¯á»NG GÃŒ!                      â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**2) Type-safe â€” TypeScript báº¯t lá»—i ngay:**

```tsx
// âŒ Boolean: TypeScript KHÃ”NG báº¯t Ä‘Æ°á»£c impossible state!
interface ComposerProps {
  isThread?: boolean;
  isEditing?: boolean;
}

// Viáº¿t code sai â€” KHÃ”NG BÃO Lá»–I:
<Composer isThread isEditing />; // â† TS: "OK!" â†’ Runtime: BUG!
```

```tsx
// âœ… Composition: TypeScript Báº®T NGAY!
interface ThreadComposerProps {
  channelId: string; // CHá»ˆ CÃ“ channelId, khÃ´ng cÃ³ isEditing!
}

<ThreadComposer isEditing />;
// â† TS ERROR: "Property 'isEditing' does not exist
//   on type 'ThreadComposerProps'" â˜…â˜…â˜…
// â†’ Bug bá»‹ báº¯t Táº I COMPILE TIME, khÃ´ng pháº£i runtime!
```

**3) Testing â€” So sÃ¡nh sá»‘ test cases:**

```tsx
// âŒ Boolean: Pháº£i test Má»ŒI tá»• há»£p!
describe("Composer (monolithic)", () => {
  // 5 booleans = 32 tá»• há»£p cáº§n test!
  it("renders default", () => {
    /* ... */
  });
  it("renders with isThread=T", () => {
    /* ... */
  });
  it("renders with isEditing=T", () => {
    /* ... */
  });
  it("renders with isThread=T, isEditing=T", () => {
    /* ... */
  });
  it("renders with isThread=T, isForwarding=T", () => {
    /* ... */
  });
  // ... 27 test cases ná»¯a! Ai viáº¿t háº¿t? KHÃ”NG AI! â˜…â˜…â˜…
});
```

```tsx
// âœ… Composition: Chá»‰ test ÄÃšNG logic cá»§a tá»«ng variant!
describe("ThreadComposer", () => {
  it('renders "Also send to channel" field', () => {
    /* ... */
  });
  it("passes channelId correctly", () => {
    /* ... */
  });
  it("submits message to thread", () => {
    /* ... */
  });
  // â†’ 3 tests! RÃµ rÃ ng, dá»… maintain! â˜…â˜…â˜…
});

describe("EditComposer", () => {
  it("shows Save and Cancel buttons", () => {
    /* ... */
  });
  it("pre-fills input with original message", () => {
    /* ... */
  });
  // â†’ 2 tests! â˜…â˜…â˜…
});

// Tá»”NG: 3 + 2 + ... = ~15 tests (linear)
// thay vÃ¬ 32 tests (exponential)! â˜…â˜…â˜…
```

### 19.6 Trade-offs â€” Khi nÃ o KHÃ”NG Cáº¦N composition?

```tsx
// âœ… Boolean OK cho component ÄÆ N GIáº¢N (1-2 booleans):
<Button variant="primary" />  // OK! Chá»‰ styling, khÃ´ng logic!
<Badge isNew />               // OK! Chá»‰ 2 states!
<Input disabled />            // OK! Standard HTML attribute!

// âŒ Boolean KHÃ”NG OK khi (â‰¥ 3 booleans hoáº·c logic phá»©c táº¡p):
<Composer isThread isDM isEditing isForwarding isScheduled />
// â†’ 5 booleans = 32 tá»• há»£p â†’ PHáº¢I refactor! â˜…â˜…â˜…
```

```
  QUY Táº®C NGÃ“N TAY CÃI:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â‰¤ 2 booleans â†’ OK, giá»¯ nguyÃªn                              â”‚
  â”‚    VD: <Button isPrimary />, <Modal isOpen />                â”‚
  â”‚                                                              â”‚
  â”‚  = 3 booleans â†’ Cáº¢NH BÃO! LÃªn káº¿ hoáº¡ch refactor!            â”‚
  â”‚    VD: <Card isHovered isSelected isDisabled />              â”‚
  â”‚    â†’ Báº¯t Ä‘áº§u cÃ³ impossible states!                           â”‚
  â”‚                                                              â”‚
  â”‚  â‰¥ 4 booleans â†’ Báº®T BUá»˜C refactor NGAY!                     â”‚
  â”‚    VD: <Composer isThread isDM isEditing isForwarding />     â”‚
  â”‚    â†’ 16+ tá»• há»£p, Ä‘a sá»‘ vÃ´ nghÄ©a!                            â”‚
  â”‚    â†’ TÃ¡ch thÃ nh: ThreadComposer, EditComposer, v.v.          â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```

---

## Â§20. GIáº¢I THÃCH SÃ‚U â€” Compound Components!

```

Táº I SAO DÃ™NG COMPOUND COMPONENTS? â€” GIáº¢I THÃCH Cá»°C Ká»² CHI TIáº¾T!
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… TRIáº¾T LÃ Cá»T LÃ•I: â”‚
â”‚ â”‚
â”‚ "Consumers COMPOSE pieces they need" â”‚
â”‚ HÃ£y nghÄ© vá» LEGO: báº¡n mua 1 bá»™ LEGO City, nháº­n Ä‘Æ°á»£c â”‚
â”‚ hÃ ng trÄƒm viÃªn gáº¡ch (bricks). Má»—i viÃªn gáº¡ch Äá»˜C Láº¬P â”‚
â”‚ nhÆ°ng COMPATIBLE vá»›i nhau. Báº¡n cÃ³ thá»ƒ: â”‚
â”‚ â†’ GhÃ©p theo cÃ¡ch hÆ°á»›ng dáº«n (default layout) â˜… â”‚
â”‚ â†’ Bá» bá»›t vÃ i pháº§n â†’ custom layout â˜…â˜… â”‚
â”‚ â†’ ThÃªm viÃªn tá»« bá»™ khÃ¡c â†’ extend! â˜…â˜…â˜… â”‚
â”‚ â†’ SÃ¡ng táº¡o hoÃ n toÃ n má»›i â†’ unrestricted! â˜…â˜…â˜… â”‚
â”‚ â”‚
â”‚ Compound Components hoáº¡t Ä‘á»™ng CHÃNH XÃC nhÆ° LEGO: â”‚
â”‚ â†’ Má»—i sub-component = 1 viÃªn gáº¡ch â˜… â”‚
â”‚ â†’ Context = "chá»‘t gáº¯n" káº¿t ná»‘i cÃ¡c viÃªn â˜…â˜…â˜… â”‚
â”‚ â†’ Consumer decide "ghÃ©p tháº¿ nÃ o" â˜…â˜…â˜… â”‚
â”‚ â†’ Creator provide "viÃªn gáº¡ch" vÃ  "chá»‘t gáº¯n" â˜… â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Táº I SAO Cáº¦N? â€” 4 LÃ DO CHI TIáº¾T: â”‚
â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1) FLEXIBILITY â€” Consumer Kiá»ƒm SoÃ¡t Layout! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Váº¥n Ä‘á»: Khi library author táº¡o component, há» â”‚ â”‚
â”‚ â”‚ KHÃ”NG THá»‚ biáº¿t trÆ°á»›c consumer muá»‘n layout tháº¿ nÃ o! â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ VD: Composer cho chat app. Author nghÄ© layout: â”‚ â”‚
â”‚ â”‚ â†’ Header â†’ Input â†’ Footer â”‚ â”‚
â”‚ â”‚ NhÆ°ng Consumer A muá»‘n: Input â†’ Header â†’ Footer â”‚ â”‚
â”‚ â”‚ Consumer B muá»‘n: Input â†’ Footer (bá» Header!) â”‚ â”‚
â”‚ â”‚ Consumer C muá»‘n: Input â†’ CustomAI â†’ Footer â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Monolithic: KHÃ”NG THá»‚ accommodate! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Author pháº£i: showHeader={false} â”‚ â”‚
â”‚ â”‚ â†’ Author pháº£i: headerPosition="bottom" â”‚ â”‚
â”‚ â”‚ â†’ Author pháº£i: renderCustomSlot={() => ...} â”‚ â”‚
â”‚ â”‚ â†’ Má»–I consumer request = Sá»¬A library gá»‘c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Compound: CÃ“ THá»‚ accommodate Má»ŒI THá»¨! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Consumer Tá»° compose theo Ã½ muá»‘n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Author KHÃ”NG Cáº¦N biáº¿t consumer layout! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ÄÃ¢y lÃ  INVERSION OF CONTROL cho UI! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) IMPLICIT STATE SHARING â€” Qua Context! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Váº¥n Ä‘á» kinh Ä‘iá»ƒn: Prop Drilling! â”‚ â”‚
â”‚ â”‚ â†’ Parent cÃ³ state â”‚ â”‚
â”‚ â”‚ â†’ Con cáº§n state â”‚ â”‚
â”‚ â”‚ â†’ NhÆ°ng giá»¯a parent vÃ  con cÃ³ 5 layers! â”‚ â”‚
â”‚ â”‚ â†’ Props pháº£i "khoan xuyÃªn" qua 5 layers! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Compound Components giáº£i quyáº¿t Má»¸ MÃƒN: â”‚ â”‚
â”‚ â”‚ â†’ State náº±m trong CONTEXT (Provider) â”‚ â”‚
â”‚ â”‚ â†’ Má»—i sub-component Tá»° Äá»ŒC context cáº§n â”‚ â”‚
â”‚ â”‚ â†’ ZERO props passing! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Consumer KHÃ”NG Cáº¦N biáº¿t state structure! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ VÃ Dá»¤ SO SÃNH: â”‚ â”‚
â”‚ â”‚ âŒ Prop drilling: â”‚ â”‚
â”‚ â”‚ <Form state={s} onUpdate={fn} ref={r}> â”‚ â”‚
â”‚ â”‚ <Input value={s.input} onChange={fn} ref={r} /> â”‚ â”‚
â”‚ â”‚ <Footer state={s}> â”‚ â”‚
â”‚ â”‚ <Submit onClick={fn} disabled={s.isSubmitting} /> â”‚ â”‚
â”‚ â”‚ </Footer> â”‚ â”‚
â”‚ â”‚ </Form> â”‚ â”‚
â”‚ â”‚ â†’ 7 props pháº£i pass qua! Ãc má»™ng! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… Compound (implicit): â”‚ â”‚
â”‚ â”‚ <Composer.Frame> â”‚ â”‚
â”‚ â”‚ <Composer.Input /> â† tá»± Ä‘á»c state.input â”‚ â”‚
â”‚ â”‚ <Composer.Footer> â”‚ â”‚
â”‚ â”‚ <Composer.Submit /> â† tá»± Ä‘á»c actions.submit â”‚ â”‚
â”‚ â”‚ </Composer.Footer> â”‚ â”‚
â”‚ â”‚ </Composer.Frame> â”‚ â”‚
â”‚ â”‚ â†’ ZERO props! Má»—i component tá»± lo! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) DISCOVERABILITY â€” Namespace Pattern! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Namespace export pattern táº¡o DX TUYá»†T Vá»œI: â”‚ â”‚
â”‚ â”‚ â†’ Developer gÃµ "Composer." trong IDE â”‚ â”‚
â”‚ â”‚ â†’ Autocomplete show: .Input, .Footer, .Submit... â”‚ â”‚
â”‚ â”‚ â†’ Developer INSTANTLY biáº¿t cÃ³ gÃ¬ available! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ So sÃ¡nh DX: â”‚ â”‚
â”‚ â”‚ âŒ Regular imports: â”‚ â”‚
â”‚ â”‚ import { ComposerInput } from './Composer' â”‚ â”‚
â”‚ â”‚ import { ComposerFooter } from './Composer' â”‚ â”‚
â”‚ â”‚ import { ComposerSubmit } from './Composer' â”‚ â”‚
â”‚ â”‚ â†’ 3 imports! Developer pháº£i biáº¿t tÃªn! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Grep "Composer" â†’ 1000 results! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… Namespace: â”‚ â”‚
â”‚ â”‚ import { Composer } from './Composer' â”‚ â”‚
â”‚ â”‚ â†’ 1 import! GÃµ "Composer." â†’ tháº¥y Háº¾T! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ API surface CLEAR! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 4) ENCAPSULATION â€” Logic áº¨n Trong Context! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Consumer chá»‰ tháº¥y UI pieces â€” KHÃ”NG BIáº¾T: â”‚ â”‚
â”‚ â”‚ â†’ State management dÃ¹ng hook gÃ¬ â”‚ â”‚
â”‚ â”‚ â†’ Data fetching strategy nÃ o â”‚ â”‚
â”‚ â”‚ â†’ Validation logic phá»©c táº¡p tháº¿ nÃ o â”‚ â”‚
â”‚ â”‚ â†’ Side effects xáº£y ra khi nÃ o â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Consumer chá»‰ cáº§n biáº¿t: â”‚ â”‚
â”‚ â”‚ â†’ "Composer.Input = Ã´ nháº­p text" â”‚ â”‚
â”‚ â”‚ â†’ "Composer.Submit = nÃºt gá»­i" â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG Cáº¦N biáº¿t thÃªm gÃ¬! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ ÄÃ¢y lÃ  INFORMATION HIDING principle (Parnas, 1972)! â”‚ â”‚
â”‚ â”‚ â†’ Má»—i sub-component HIDE internal complexity â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Consumer interface = MINIMAL surface area â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ Náº¾U KHÃ”NG DÃ™NG COMPOUND â†’ Monolithic Component: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âŒ CÃCH 1: Render Props Hell! â”‚ â”‚
â”‚ â”‚ <Composer â”‚ â”‚
â”‚ â”‚ renderHeader={() => ...} â”‚ â”‚
â”‚ â”‚ renderFooter={() => ...} â”‚ â”‚
â”‚ â”‚ renderActions={() => ...} â”‚ â”‚
â”‚ â”‚ renderSidebar={() => ...} â”‚ â”‚
â”‚ â”‚ renderCustomSlot1={() => ...} â”‚ â”‚
â”‚ â”‚ renderCustomSlot2={() => ...} â”‚ â”‚
â”‚ â”‚ /> â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Váº¤N Äá»€ NGHIÃŠM TRá»ŒNG: â”‚ â”‚
â”‚ â”‚ a) Component pháº£i biáº¿t Táº¤T Cáº¢ slots tá»« trÆ°á»›c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ThÃªm slot = Sá»¬A component gá»‘c â”‚ â”‚
â”‚ â”‚ â†’ Vi pháº¡m Open/Closed Principle! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ b) Consumer bá»‹ GIá»šI Háº N bá»Ÿi slots cÃ³ sáºµn! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Muá»‘n slot á»Ÿ vá»‹ trÃ­ khÃ¡c? KHÃ”NG ÄÆ¯á»¢C! â”‚ â”‚
â”‚ â”‚ â†’ Muá»‘n 2 footers? KHÃ”NG ÄÆ¯á»¢C! â”‚ â”‚
â”‚ â”‚ â†’ Muá»‘n custom layout? KHÃ”NG ÄÆ¯á»¢C! â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ c) Callback signatures phá»©c táº¡p! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ renderFooter nháº­n gÃ¬? Tráº£ vá» gÃ¬? â”‚ â”‚
â”‚ â”‚ â†’ TypeScript signature dÃ i dÃ²ng! â”‚ â”‚
â”‚ â”‚ â†’ Error-prone! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ d) Performance: render props táº¡o má»›i function â”‚ â”‚
â”‚ â”‚ EVERY render! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Má»—i render = new closure = new reference â”‚ â”‚
â”‚ â”‚ â†’ Children re-render EVERY TIME! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Fix: useCallback... thÃªm boilerplate â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âŒ CÃCH 2: Config Object! â”‚ â”‚
â”‚ â”‚ <Composer â”‚ â”‚
â”‚ â”‚ config={{                                            â”‚    â”‚
  â”‚  â”‚      showHeader: true,                                 â”‚    â”‚
  â”‚  â”‚      headerVariant: "compact",                         â”‚    â”‚
  â”‚  â”‚      footerActions: ["submit", "cancel"],              â”‚    â”‚
  â”‚  â”‚      layout: "vertical",                               â”‚    â”‚
  â”‚  â”‚      theme: "dark"                                     â”‚    â”‚
  â”‚  â”‚    }} â”‚ â”‚
â”‚ â”‚ /> â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Váº¤N Äá»€: â”‚ â”‚
â”‚ â”‚ â†’ Config object = BOOLEAN PROPS in disguise! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Váº«n exponential combinations! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ TypeScript cÅ©ng khÃ´ng báº¯t impossible combos â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Chá»‰ Ä‘á»•i syntax, khÃ´ng Ä‘á»•i problem! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ REAL-WORLD â€” Libs Ná»•i Tiáº¿ng DÃ¹ng Pattern NÃ y: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 1) Radix UI (by WorkOS): â”‚ â”‚
â”‚ â”‚ <Dialog.Root> â”‚ â”‚
â”‚ â”‚ <Dialog.Trigger>Open</Dialog.Trigger> â”‚ â”‚
â”‚ â”‚ <Dialog.Portal> â”‚ â”‚
â”‚ â”‚ <Dialog.Overlay /> â”‚ â”‚
â”‚ â”‚ <Dialog.Content> â”‚ â”‚
â”‚ â”‚ <Dialog.Title>Title</Dialog.Title> â”‚ â”‚
â”‚ â”‚ <Dialog.Description>...</Dialog.Description> â”‚ â”‚
â”‚ â”‚ <Dialog.Close>Ã—</Dialog.Close> â”‚ â”‚
â”‚ â”‚ </Dialog.Content> â”‚ â”‚
â”‚ â”‚ </Dialog.Portal> â”‚ â”‚
â”‚ â”‚ </Dialog.Root> â”‚ â”‚
â”‚ â”‚ â†’ Consumer control: Portal placement, overlay style â”‚ â”‚
â”‚ â”‚ â†’ Accessibility: ARIA attributes auto-applied! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) Headless UI (by Tailwind Labs): â”‚ â”‚
â”‚ â”‚ <Menu> â”‚ â”‚
â”‚ â”‚ <Menu.Button>Options</Menu.Button> â”‚ â”‚
â”‚ â”‚ <Menu.Items> â”‚ â”‚
â”‚ â”‚ <Menu.Item>{({ active }) => ...}</Menu.Item> â”‚ â”‚
â”‚ â”‚ </Menu.Items> â”‚ â”‚
â”‚ â”‚ </Menu> â”‚ â”‚
â”‚ â”‚ â†’ "Headless" = ZERO styling â†’ consumer Tá»° style â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Maximum flexibility! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) React Aria (by Adobe): â”‚ â”‚
â”‚ â”‚ â†’ Hooks-based compound components â˜… â”‚ â”‚
â”‚ â”‚ â†’ Accessibility-first design â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Used by: Spectrum design system â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Táº I SAO Táº¤T Cáº¢ libs chá»n Compound? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ libs KHÃ”NG THá»‚ predict consumer layout! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Compound = MAXIMUM flexibility cho consumers â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Boolean/Config = CONSTRAINED by author â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ CÆ  CHáº¾ HOáº T Äá»˜NG BÃŠN TRONG: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ STEP 1: Provider Ä‘áº·t state vÃ o Fiber tree â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ React táº¡o Fiber node cho <ComposerContext> â”‚ â”‚
â”‚ â”‚ â†’ Value { state, actions, meta } GHI vÃ o node Ä‘Ã³ â”‚ â”‚
â”‚ â”‚ â†’ Giá»‘ng set biáº¿n trong scope chain! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ STEP 2: Sub-component gá»i use(Context) â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ React walk UP Fiber tree tá»« component â”‚ â”‚
â”‚ â”‚ â†’ TÃ¬m Fiber node gáº§n nháº¥t cÃ³ Context value â”‚ â”‚
â”‚ â”‚ â†’ Tráº£ vá» value Ä‘Ã³! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Giá»‘ng prototype chain trong JS! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ STEP 3: Re-render subscription â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ React ÄÃNH Dáº¤U component lÃ  consumer â”‚ â”‚
â”‚ â”‚ â†’ Khi Provider value thay Ä‘á»•i: â”‚ â”‚
â”‚ â”‚ â†’ React so sÃ¡nh old vs new value (Object.is) â”‚ â”‚
â”‚ â”‚ â†’ Náº¿u KHÃC â†’ re-render ALL consumers! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Náº¿u GIá»NG â†’ skip! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ ÄÃ‚Y LÃ€ PUB/SUB PATTERN! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Provider = Publisher (emit state changes) â”‚ â”‚
â”‚ â”‚ â†’ Sub-components = Subscribers (react to changes) â”‚ â”‚
â”‚ â”‚ â†’ Context = Event bus (delivery mechanism) â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ ÄIá»‚M Máº NH â€” CHI TIáº¾T: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… 1. CONSUMER CONTROL: Layout hoÃ n toÃ n do consumer! â”‚ â”‚
â”‚ â”‚ â†’ ThÃªm, bá»›t, sáº¯p xáº¿p sub-components thoáº£i mÃ¡i â”‚ â”‚
â”‚ â”‚ â†’ Author KHÃ”NG Cáº¦N predict layouts! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… 2. IMPLICIT STATE: Zero prop drilling! â”‚ â”‚
â”‚ â”‚ â†’ Sub-components Tá»° Äá»ŒC state qua context â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Consumer khÃ´ng cáº§n biáº¿t state structure! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… 3. OCP (Open/Closed Principle): â”‚ â”‚
â”‚ â”‚ â†’ Open for extension: consumer add new pieces â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Closed for modification: library unchanged â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ThÃªm feature = thÃªm sub-component! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG Sá»¬A existing code! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… 4. IDE AUTOCOMPLETE: Namespace DX! â”‚ â”‚
â”‚ â”‚ â†’ Composer. â†’ show Táº¤T Cáº¢ available pieces â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Self-documenting API surface! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… 5. TESTING: Mock provider, test sub-component! â”‚ â”‚
â”‚ â”‚ â†’ Wrap sub-component trong mock provider â˜… â”‚ â”‚
â”‚ â”‚ â†’ Inject fake state â†’ assert render output â˜… â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG cáº§n full app setup! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âœ… 6. ACCESSIBLE: Má»—i sub-component tá»± handle a11y! â”‚ â”‚
â”‚ â”‚ â†’ Dialog.Content auto-add role="dialog" â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Dialog.Title auto-link aria-labelledby â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Focus management BUILT-IN! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ ÄIá»‚M Yáº¾U â€” CHI TIáº¾T: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âš ï¸ 1. LEARNING CURVE: â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Junior devs chÆ°a quen Context API â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Pháº£i hiá»ƒu Provider/Consumer model â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ NHÆ¯NG: 1 láº§n hiá»ƒu = dÃ¹ng mÃ£i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Investment learning = HIGH ROI! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âš ï¸ 2. CONTEXT PERFORMANCE: â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Context thay Ä‘á»•i â†’ ALL consumers re-render â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 50 sub-components subscribe = 50 re-renderers â”‚ â”‚
â”‚ â”‚ â†’ MITIGATION: â”‚ â”‚
â”‚ â”‚ a) Split context: StateCtx + ActionsCtx â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ b) useMemo cho context value â˜…â˜… â”‚ â”‚
â”‚ â”‚ c) React.memo cho sub-components â˜…â˜… â”‚ â”‚
â”‚ â”‚ d) Zustand/Jotai selector cho fine-grained â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âš ï¸ 3. ERROR HANDLING: â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ DÃ¹ng sub-component NGOÃ€I Provider â†’ crash! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Default error: "Cannot read property of null" â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG HELPFUL! Developer máº¥t thá»i gian debug! â”‚ â”‚
â”‚ â”‚ â†’ FIX: Custom hook throw descriptive error: â”‚ â”‚
â”‚ â”‚ if (!ctx) throw new Error( â”‚ â”‚
â”‚ â”‚ "Composer.Input must be used within â”‚ â”‚
â”‚ â”‚ <Composer.Provider>!" â”‚ â”‚
â”‚ â”‚ ) â”‚ â”‚
â”‚ â”‚ â†’ Developer hiá»ƒu ngay váº¥n Ä‘á»! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âš ï¸ 4. BOILERPLATE: â˜… â”‚ â”‚
â”‚ â”‚ â†’ Context, Provider, useMyContext hook â˜… â”‚ â”‚
â”‚ â”‚ â†’ Namespace export object â˜… â”‚ â”‚
â”‚ â”‚ â†’ ~50-80 lines setup â˜… â”‚ â”‚
â”‚ â”‚ â†’ NhÆ°ng: 1x setup vs Nx benefit! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ TRADE-OFF MATRIX CHI TIáº¾T: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ TiÃªu chÃ­ â”‚ Boolean â”‚ Compound â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚ â”‚ Sá»‘ files â”‚ 1 (Ã­t!) â”‚ N files â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Setup time â”‚ 5 phÃºt â”‚ 30 phÃºt â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Complexity â”‚ 2â¿ â˜…â˜…â˜… â”‚ N (linear!) â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Extensibility â”‚ Sá»­a gá»‘c â”‚ ThÃªm piece â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Coupling â”‚ Tight â”‚ Loose via ctx â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Testing â”‚ 2â¿ casesâ”‚ N cases â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Cognitive â”‚ Decode â”‚ Self-doc â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ PR review â”‚ 2-3 hrs â”‚ 15-30 mins â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Parallel dev â”‚ 1 dev â”‚ N devs â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Tree-shake â”‚ No â”‚ Yes â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Learning â”‚ Easy â”‚ Medium â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ Compound WIN overwhelmingly khi scale! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Boolean OK CHá»ˆ cho tiny components (1-2 flags)! â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§21. GIáº¢I THÃCH SÃ‚U â€” Decouple State from UI!

```

Táº I SAO TÃCH STATE KHá»I UI?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… NGUYÃŠN LÃ: Dependency Inversion Principle (SOLID!) â”‚
â”‚ "High-level modules should not depend on low-level modules" â”‚
â”‚ â†’ UI (high-level) KHÃ”NG NÃŠN biáº¿t state impl! â˜…â˜…â˜… â”‚
â”‚ â†’ Giá»‘ng Strategy Pattern trong OOP! â˜…â˜…â˜… â”‚
â”‚ â”‚
â”‚ Táº I SAO Cáº¦N? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1) SWAPPABLE STATE: Äá»•i state engine â†’ UI unchanged! â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ useState â”‚ â”‚ Zustand â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ (prototype) â”‚ â”‚ (product) â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â–¼ â–¼ â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ SAME UI COMPONENTS â”‚ â† KHÃ”NG thay Ä‘á»•i! â”‚ â”‚
â”‚ â”‚ â”‚ Composer.Input â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Composer.Submit â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) TESTABILITY: Mock state dá»… dÃ ng! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Test UI vá»›i fake state â”‚ â”‚
â”‚ â”‚ â†’ Test state logic riÃªng biá»‡t â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) REUSABILITY: Same UI, different contexts! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Chat app: useState (forward form) â”‚ â”‚
â”‚ â”‚ â†’ Chat app: Zustand (channel messages) â”‚ â”‚
â”‚ â”‚ â†’ Chat app: React Query (server sync) â”‚ â”‚
â”‚ â”‚ â†’ ALL dÃ¹ng SAME <Composer.Input />! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ Náº¾U KHÃ”NG TÃCH? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ UI component Gá»ŒI TRá»°C TIáº¾P hook cá»¥ thá»ƒ! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ function Input() { â”‚ â”‚
â”‚ â”‚ const { input } = useZustandStore() // âŒ coupledâ”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â†’ Äá»•i Zustand â†’ Redux? Sá»¬A Táº¤T Cáº¢ components! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Test pháº£i mock Zustand store! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ KhÃ´ng thá»ƒ dÃ¹ng component á»Ÿ context khÃ¡c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ ÄIá»‚M Máº NH: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Future-proof: Ä‘á»•i state lib mÃ  khÃ´ng sá»­a UI â”‚ â”‚
â”‚ â”‚ âœ… Testable: inject mock state vÃ o Provider â”‚ â”‚
â”‚ â”‚ âœ… Reusable: same component, many contexts â”‚ â”‚
â”‚ â”‚ âœ… Clean architecture: separation of concerns â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ ÄIá»‚M Yáº¾U: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âš ï¸ Indirection: pháº£i trace Provider â†’ UI! â˜…â˜… â”‚ â”‚
â”‚ â”‚ âš ï¸ Debugging khÃ³ hÆ¡n: state á»Ÿ Ä‘Ã¢u? â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Fix: React DevTools show context values â”‚ â”‚
â”‚ â”‚ âš ï¸ Overhead náº¿u chá»‰ cÃ³ 1 state source! â˜… â”‚ â”‚
â”‚ â”‚ âš ï¸ Interface pháº£i Ä‘á»§ generic nhÆ°ng khÃ´ng quÃ¡ rá»™ng â˜…â˜…â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ KHI NÃ€O NÃŠN DÃ™NG / KHÃ”NG NÃŠN: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… NÃŠN: Component dÃ¹ng á»Ÿ 2+ contexts khÃ¡c nhau â”‚ â”‚
â”‚ â”‚ âœ… NÃŠN: State cÃ³ thá»ƒ thay Ä‘á»•i (useState â†’ Zustand) â”‚ â”‚
â”‚ â”‚ âœ… NÃŠN: Cáº§n test riÃªng UI vs state logic â”‚ â”‚
â”‚ â”‚ âŒ KHÃ”NG: Component chá»‰ dÃ¹ng 1 láº§n, 1 context â”‚ â”‚
â”‚ â”‚ âŒ KHÃ”NG: Prototype/MVP nhanh â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§22. GIáº¢I THÃCH SÃ‚U â€” Context Interface (DI)!

```

Táº I SAO Cáº¦N GENERIC CONTEXT INTERFACE?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… NGUYÃŠN LÃ: Dependency Injection (DI)! â”‚
â”‚ "Program to an interface, not an implementation" â”‚
â”‚ â†’ UI chá»‰ biáº¿t CONTRACT (state/actions/meta)! â˜…â˜…â˜… â”‚
â”‚ â†’ Provider IMPLEMENT contract! â˜…â˜…â˜… â”‚
â”‚ â”‚
â”‚ Táº I SAO CHIA 3 PHáº¦N (state / actions / meta)? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1) STATE: dá»¯ liá»‡u reactive (trigger re-render) â”‚ â”‚
â”‚ â”‚ â†’ input, attachments, isSubmitting â”‚ â”‚
â”‚ â”‚ â†’ Thay Ä‘á»•i = re-render consumers! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) ACTIONS: mutations (STABLE references) â”‚ â”‚
â”‚ â”‚ â†’ update, submit, cancel â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG nÃªn thay Ä‘á»•i â†’ useCallback! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Náº¿u stable â†’ consumers dÃ¹ng actions â”‚ â”‚
â”‚ â”‚ KHÃ”NG RE-RENDER khi state thay Ä‘á»•i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) META: non-reactive metadata â”‚ â”‚
â”‚ â”‚ â†’ inputRef, config, featureFlags â”‚ â”‚
â”‚ â”‚ â†’ Refs KHÃ”NG trigger re-render! â˜… â”‚ â”‚
â”‚ â”‚ â†’ DÃ¹ng cho imperative operations! â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ KEY INSIGHT â€” Provider vs Visual Boundary: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ÄÃ‚Y LÃ€ INSIGHT QUAN TRá»ŒNG NHáº¤T! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Component KHÃ”NG Cáº¦N náº±m trong visual parent â”‚ â”‚
â”‚ â”‚ Ä‘á»ƒ access state! â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ <Provider> â† STATE BOUNDARY â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ <Dialog> â”‚ â”‚
â”‚ â”‚ <Composer.Frame> â† VISUAL BOUNDARY â”‚ â”‚
â”‚ â”‚ <Composer.Input /> â† IN cáº£ 2 âœ… â”‚ â”‚
â”‚ â”‚ </Composer.Frame> â”‚ â”‚
â”‚ â”‚ <ForwardButton /> â† NGOÃ€I visual, IN state âœ… â”‚ â”‚
â”‚ â”‚ <Preview /> â† NGOÃ€I visual, IN state âœ… â”‚ â”‚
â”‚ â”‚ </Dialog> â”‚ â”‚
â”‚ â”‚ </Provider> â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ ForwardButton access actions.submit OK! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Preview read state.input OK! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Cáº£ 2 NGOÃ€I Composer.Frame nhÆ°ng IN Provider! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ Náº¾U KHÃ”NG DÃ™NG INTERFACE â†’ Direct Coupling: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ function ComposerInput() { â”‚ â”‚
â”‚ â”‚ const { input } = useChannelComposerState() // âŒ â”‚ â”‚
â”‚ â”‚ // â†‘ COUPLED to channel impl! â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ KhÃ´ng thá»ƒ reuse cho ForwardMessage context! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Má»—i context cáº§n CLONE component! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ N contexts Ã— M components = NÃ—M files! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Vá»›i interface: N + M files! (additive, not Ã—) â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ TRADE-OFF: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Reusability cá»±c cao â”‚ â”‚
â”‚ â”‚ âœ… TypeScript enforce contract â”‚ â”‚
â”‚ â”‚ âœ… Provider swap = zero UI changes â”‚ â”‚
â”‚ â”‚ âš ï¸ Interface pháº£i thiáº¿t káº¿ cáº©n tháº­n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ QuÃ¡ háº¹p: provider khÃ³ implement â”‚ â”‚
â”‚ â”‚ â†’ QuÃ¡ rá»™ng: consumer bá»‹ overloaded â”‚ â”‚
â”‚ â”‚ âš ï¸ Breaking change interface = sá»­a Táº¤T Cáº¢! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§23. GIáº¢I THÃCH SÃ‚U â€” Lift State to Providers!

```

Táº I SAO LIFT STATE?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… Váº¤N Äá»€ Gá»C: State Trapped In Component! â”‚
â”‚ â”‚
â”‚ TÃŒNH HUá»NG THá»°C Táº¾: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Báº¡n cÃ³ ForwardMessageDialog: â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ ForwardMessageDialogâ”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ Composer â”‚ â”‚ â† state TRAPPED á»Ÿ Ä‘Ã¢y! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ (input, files)â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ Preview â”‚ â”‚ â† Cáº¦N input! KHÃ”NG CÃ“! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ Forward Btn â”‚ â”‚ â† Cáº¦N submit! KHÃ”NG CÃ“! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Preview + ForwardButton lÃ  SIBLINGS cá»§a Composer! â”‚ â”‚
â”‚ â”‚ State TRAPPED trong Composer â†’ siblings KHÃ”NG access! â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ 3 GIáº¢I PHÃP SAI (vÃ  táº¡i sao sai): â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âŒ 1: useEffect sync lÃªn parent â”‚ â”‚
â”‚ â”‚ â†’ DOUBLE RENDER: child render â†’ effect fire â†’ â”‚ â”‚
â”‚ â”‚ parent setState â†’ parent + child RE-RENDER! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Performance: 2x renders per keystroke! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Race condition: effect async, state stale! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Violates "single source of truth"! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âŒ 2: Callback prop (onInputChange) â”‚ â”‚
â”‚ â”‚ â†’ Parent giá»¯ duplicate state! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 2 sources of truth â†’ out of sync! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Parent re-renders child má»—i keypress! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ âŒ 3: Ref hack (stateRef.current) â”‚ â”‚
â”‚ â”‚ â†’ Ref KHÃ”NG trigger re-render! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Preview hiá»ƒn thá»‹ STALE data! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ForwardButton submit STALE state! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Defeats React's declarative model! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ âœ… GIáº¢I PHÃP ÄÃšNG: Lift State! â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ State Äáº¶T trong Provider (parent of ALL)! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Provider (state ÄÃ‚Y)â”‚ â† single source of truth! â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ Composer â”‚ â”‚ â† use(Context) â†’ state âœ… â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ Preview â”‚ â”‚ â† use(Context) â†’ state âœ… â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ Forward Btn â”‚ â”‚ â† use(Context) â†’ actions âœ… â”‚ â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ 1 source of truth! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 0 double renders! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 0 stale data! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ TRADE-OFF: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Single source of truth â”‚ â”‚
â”‚ â”‚ âœ… No double renders â”‚ â”‚
â”‚ â”‚ âœ… All siblings access state â”‚ â”‚
â”‚ â”‚ âœ… Declarative React model maintained â”‚ â”‚
â”‚ â”‚ âš ï¸ State scope rá»™ng hÆ¡n cáº§n thiáº¿t! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Táº¥t cáº£ children re-render khi state changes â”‚ â”‚
â”‚ â”‚ â†’ Fix: split context, React.memo â”‚ â”‚
â”‚ â”‚ âš ï¸ Provider nesting sÃ¢u náº¿u nhiá»u layers! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Fix: compose providers function â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§24. GIáº¢I THÃCH SÃ‚U â€” Explicit Variants!

```

Táº I SAO Táº O EXPLICIT VARIANTS?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… NGUYÃŠN LÃ: Make Impossible States Impossible! â”‚
â”‚ â”‚
â”‚ SO SÃNH: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Boolean approach â€” IMPOSSIBLE STATES Tá»’N Táº I: â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ isThread â”‚ isEdit â”‚ isFwd â”‚ káº¿t quáº£ â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚ â”‚ false â”‚ false â”‚ false â”‚ âœ… Channel â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ true â”‚ false â”‚ false â”‚ âœ… Thread â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ false â”‚ true â”‚ false â”‚ âœ… Edit â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ false â”‚ false â”‚ true â”‚ âœ… Forward â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ true â”‚ true â”‚ false â”‚ âŒ ??? â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ true â”‚ false â”‚ true â”‚ âŒ ??? â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ false â”‚ true â”‚ true â”‚ âŒ ??? â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ true â”‚ true â”‚ true â”‚ âŒ ??? â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â†’ 4/8 combinations = IMPOSSIBLE! 50%! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ TypeScript cho phÃ©p all 8! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Runtime bugs chá» sáºµn! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Variant approach â€” IMPOSSIBLE STATES ELIMINATED: â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Component â”‚ props â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚ â”‚ <ChannelComposer /> â”‚ (none) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ <ThreadComposer /> â”‚ channelId â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ <EditComposer /> â”‚ messageId â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ <ForwardComposer /> â”‚ messageId â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â†’ 4 variants = 4 valid states! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ IMPOSSIBLE states = COMPILE ERROR! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 0 runtime bugs! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ Náº¾U KHÃ”NG DÃ™NG EXPLICIT VARIANTS? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ Code review: "cÃ¡i nÃ y isThread + isEditing â”‚ â”‚
â”‚ â”‚ cÃ¹ng true thÃ¬ chuyá»‡n gÃ¬ xáº£y ra?" â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Answer: "Uh... nobody knows" â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Bug in production: user somehow triggers â”‚ â”‚
â”‚ â”‚ impossible state combination! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Fix: add MORE if/else â†’ MORE complexity! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ ÄIá»‚M Máº NH: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Type-safe: chá»‰ valid states tá»“n táº¡i â”‚ â”‚
â”‚ â”‚ âœ… Self-documenting: tÃªn = Ã½ nghÄ©a â”‚ â”‚
â”‚ â”‚ âœ… Independent: sá»­a 1 variant â‰  áº£nh hÆ°á»Ÿng others â”‚ â”‚
â”‚ â”‚ âœ… Deleteable: xÃ³a variant = xÃ³a 1 file, done â”‚ â”‚
â”‚ â”‚ âœ… Code review dá»…: "thÃªm DMThreadComposer" clear â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ ÄIá»‚M Yáº¾U: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âš ï¸ Code duplication nháº¹ giá»¯a variants! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Mitigate: shared sub-components (Composer.\*) â”‚ â”‚
â”‚ â”‚ â†’ DRY á»Ÿ level SUB-COMPONENT, khÃ´ng component! â˜… â”‚ â”‚
â”‚ â”‚ âš ï¸ Nhiá»u files hÆ¡n trong codebase! â˜… â”‚ â”‚
â”‚ â”‚ â†’ Trade: nhiá»u files NHá» > 1 file KHá»”NG Lá»’ â”‚ â”‚
â”‚ â”‚ âš ï¸ Khi variants quÃ¡ nhiá»u (>10): tá»• chá»©c folder â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§25. GIáº¢I THÃCH SÃ‚U â€” Children vs Render Props!

```

Táº I SAO CHILDREN > RENDER PROPS?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… SO SÃNH CHI TIáº¾T: â”‚
â”‚ â”‚
â”‚ RENDER PROPS: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ <Composer â”‚ â”‚
â”‚ â”‚ renderHeader={() => <h1>Title</h1>} â”‚ â”‚
â”‚ â”‚ renderFooter={() => <footer>...</footer>} â”‚ â”‚
â”‚ â”‚ renderActions={() => <Button>Submit</Button>} â”‚ â”‚
â”‚ â”‚ /> â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Váº¤N Äá»€: â”‚ â”‚
â”‚ â”‚ 1) SLOTS Cá» Äá»ŠNH: component quyáº¿t Ä‘á»‹nh slots! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Muá»‘n thÃªm slot? Sá»¬A component gá»‘c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Vi pháº¡m Open/Closed Principle! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) CALLBACK OVERHEAD: má»—i render táº¡o function má»›i! â˜… â”‚ â”‚
â”‚ â”‚ â†’ CÃ³ thá»ƒ gÃ¢y re-render con â”‚ â”‚
â”‚ â”‚ â†’ Fix: useCallback, nhÆ°ng thÃªm noise! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) READABILITY: callbacks khÃ³ Ä‘á»c! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Nested: renderFooter(() => renderInner(...)) ğŸ˜± â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 4) TYPE COMPLEXITY: signature phá»©c táº¡p! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ renderItem: (args: {item, index}) => ReactNode â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ CHILDREN COMPOSITION: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ <Composer.Frame> â”‚ â”‚
â”‚ â”‚ <h1>Title</h1> â† tá»± do chÃ¨n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ <Composer.Input /> â”‚ â”‚
â”‚ â”‚ <CustomBanner /> â† thÃªm gÃ¬ cÅ©ng Ä‘Æ°á»£c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ <Composer.Footer> â”‚ â”‚
â”‚ â”‚ <Composer.Submit /> â”‚ â”‚
â”‚ â”‚ </Composer.Footer> â”‚ â”‚
â”‚ â”‚ </Composer.Frame> â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Æ¯U ÄIá»‚M: â”‚ â”‚
â”‚ â”‚ 1) UNLIMITED SLOTS: chÃ¨n báº¥t cá»© gÃ¬! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ 2) NATURAL JSX: Ä‘á»c nhÆ° HTML! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ 3) NO CALLBACK: khÃ´ng function wrapper! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ 4) OPEN FOR EXTENSION: khÃ´ng sá»­a component gá»‘c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ KHI NÃ€O RENDER PROPS VáºªN Tá»T? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Parent cáº§n PASS DATA xuá»‘ng child! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ <VirtualList â”‚ â”‚
â”‚ â”‚ data={items} â”‚ â”‚
â”‚ â”‚ renderItem={({ item, index, style }) => â”‚ â”‚
â”‚ â”‚ <Row item={item} style={style} /> â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ /> â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ item, index, style INJECT Bá»I parent! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Children KHÃ”NG THá»‚ nháº­n data nÃ y! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ÄÃ¢y lÃ  USE CASE ÄÃšNG cho render props! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ ThÃªm VD: â”‚ â”‚
â”‚ â”‚ <Formik render={({ values, errors }) => ...} /> â”‚ â”‚
â”‚ â”‚ <AnimatePresence children={...}  /> â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ QUY Táº®C: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Static layout, no data passing â†’ CHILDREN! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ Dynamic data injection â†’ RENDER PROPS! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ Mix cáº£ 2 â†’ children cho layout, render prop cho â”‚ â”‚
â”‚ â”‚ dynamic slots! â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§26. GIáº¢I THÃCH SÃ‚U â€” React 19 API Changes!

```

Táº I SAO REACT 19 Äá»”I API?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… THAY Äá»”I 1: ref AS REGULAR PROP â”‚
â”‚ â”‚
â”‚ Táº I SAO Bá» forwardRef? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ forwardRef Váº¤N Äá»€: â”‚ â”‚
â”‚ â”‚ 1) BOILERPLATE: wrapper function quÃ¡ verbose! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ const Input = forwardRef<HTMLInputElement, Props>( â”‚ â”‚
â”‚ â”‚ (props, ref) => ... â”‚ â”‚
â”‚ â”‚ ) â”‚ â”‚
â”‚ â”‚ â†’ 3 layers: forwardRef() â†’ anonymous fn â†’ JSX â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) TYPE COMPLEXITY: 2 generic params! â˜…â˜… â”‚ â”‚
â”‚ â”‚ forwardRef<RefType, PropsType> â”‚ â”‚
â”‚ â”‚ â†’ Dá»… nháº§m thá»© tá»±! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) DISPLAY NAME: máº¥t khi dÃ¹ng forwardRef! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Input.displayName = 'Input' (manual fix) â”‚ â”‚
â”‚ â”‚ â†’ React DevTools hiá»ƒn thá»‹ "ForwardRef" â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 4) HOC INCOMPATIBLE: wrap forwardRef trong HOC?! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ memo(forwardRef(...)) â†’ wrapper hell! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ React 19 FIX: ref = just a prop! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ function Input({ ref, ...props }) { ... } â”‚ â”‚
â”‚ â”‚ â†’ Clean, simple, no wrapper! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ TypeScript: Props & { ref?: Ref<HTMLInput> } â”‚ â”‚
â”‚ â”‚ â†’ displayName tá»± Ä‘á»™ng! â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… THAY Äá»”I 2: use() THAY useContext() â”‚
â”‚ â”‚
â”‚ Táº I SAO Bá» useContext? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ useContext Váº¤N Äá»€: â”‚ â”‚
â”‚ â”‚ 1) KHÃ”NG conditional: â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ // âŒ Error! â”‚ â”‚
â”‚ â”‚ if (condition) { â”‚ â”‚
â”‚ â”‚ const value = useContext(MyContext) // RULES! â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ use() FIX: conditional OK! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ // âœ… OK in React 19! â”‚ â”‚
â”‚ â”‚ if (condition) { â”‚ â”‚
â”‚ â”‚ const value = use(MyContext) // WORKS! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) use() UNIFIED: context + Promise! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ const data = use(fetchPromise) // async data â˜… â”‚ â”‚
â”‚ â”‚ const theme = use(ThemeContext) // context â˜… â”‚ â”‚
â”‚ â”‚ â†’ 1 API cho cáº£ 2! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) SUSPENSE INTEGRATION: â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ const data = use(fetchPromise) â”‚ â”‚
â”‚ â”‚ // Tá»± Suspend náº¿u Promise chÆ°a resolve! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ // KhÃ´ng cáº§n useEffect + useState pattern! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ MIGRATION: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ React 18 â†’ 19 migration: â”‚ â”‚
â”‚ â”‚ 1) TÃ¬m táº¥t cáº£ forwardRef â†’ thay báº±ng ref prop â˜… â”‚ â”‚
â”‚ â”‚ 2) TÃ¬m táº¥t cáº£ useContext â†’ thay báº±ng use() â˜… â”‚ â”‚
â”‚ â”‚ 3) Codemod cÃ³ sáºµn: react-codemod! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ BACKWARD COMPAT: â”‚ â”‚
â”‚ â”‚ â†’ forwardRef váº«n hoáº¡t Ä‘á»™ng (deprecated) â˜… â”‚ â”‚
â”‚ â”‚ â†’ useContext váº«n hoáº¡t Ä‘á»™ng (deprecated) â˜… â”‚ â”‚
â”‚ â”‚ â†’ Migrate dáº§n dáº§n, khÃ´ng breaking! â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ TRADE-OFF: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ âœ… Less boilerplate (no forwardRef wrapper) â”‚ â”‚
â”‚ â”‚ âœ… Conditional context reads â”‚ â”‚
â”‚ â”‚ âœ… Unified API (use for context + promises) â”‚ â”‚
â”‚ â”‚ âœ… Better TypeScript DX â”‚ â”‚
â”‚ â”‚ âš ï¸ Breaking change for libraries! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Library pháº£i support cáº£ React 18 + 19 â”‚ â”‚
â”‚ â”‚ âš ï¸ use() chÆ°a quen vá»›i nhiá»u devs! â˜… â”‚ â”‚
â”‚ â”‚ âš ï¸ Suspense boundary Báº®T BUá»˜C cho use(Promise)! â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§27. Pattern TÆ° Duy 1 â€” Äá»‡ Quy "Táº¡i Sao" (5 Whys)!

```

5 WHYS â€” ÃP Dá»¤NG CHO COMPOSITION PATTERNS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… CHUá»–I 1: Táº¡i sao dÃ¹ng Compound Components? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WHY 1: Táº¡i sao dÃ¹ng Compound Components? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ component monolithic quÃ¡ cá»“ng ká»nh! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 2: Táº¡i sao monolithic cá»“ng ká»nh? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ boolean props táº¡o exponential branching! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 5 booleans = 32 nhÃ¡nh if/else trong 1 file! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 3: Táº¡i sao exponential branching xáº¥u? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ nÃ£o ngÆ°á»i chá»‰ giá»¯ ~7 items trong working â”‚ â”‚
â”‚ â”‚ memory (Miller's Law)! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ 32 nhÃ¡nh >> 7 â†’ COGNITIVE OVERLOAD! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 4: Táº¡i sao cognitive overload â†’ bugs? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ dev khÃ´ng thá»ƒ reason about Táº¤T Cáº¢ states! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Bá» sÃ³t case â†’ undefined behavior! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Test coverage giáº£m theo exponential! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 5: Táº¡i sao test coverage giáº£m critical? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ bugs escape to production! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ User gáº·p impossible state â†’ crash/blank screen! â˜…â˜…â˜…â”‚ â”‚
â”‚ â”‚ â†’ Revenue loss + trust erosion! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚
â”‚ â”‚ ROOT CAUSE: Giá»›i háº¡n cognitive cá»§a con ngÆ°á»i â”‚ â”‚
â”‚ â”‚ (Miller's Law: 7Â±2 items) â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Composition = giáº£m complexity PER FILE â”‚ â”‚
â”‚ â”‚ xuá»‘ng dÆ°á»›i ngÆ°á»¡ng cognitive! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… CHUá»–I 2: Táº¡i sao Lift State vÃ o Provider? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WHY 1: Táº¡i sao lift state vÃ o Provider? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ sibling components cáº§n share data! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 2: Táº¡i sao siblings khÃ´ng thá»ƒ trá»±c tiáº¿p share? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ React UNIDIRECTIONAL data flow! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Data chá»‰ cháº£y PARENT â†’ CHILD, khÃ´ng ngang! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 3: Táº¡i sao React chá»n unidirectional? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ bidirectional (Angular 1) â†’ update cycles! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ $digest loop cháº¡y láº·p Ä‘áº¿n stable â†’ cháº­m! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Race conditions + debugging nightmare! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 4: Táº¡i sao bidirectional gÃ¢y update cycles? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ A update B â†’ B update A â†’ A update B â†’ âˆ! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ KhÃ´ng cÃ³ single source of truth! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 5: Táº¡i sao single source of truth quan trá»ng? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ DETERMINISTIC rendering! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Same state â†’ same UI â†’ predictable! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ f(state) = UI (pure function!) â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚
â”‚ â”‚ ROOT CAUSE: React's fundamental model lÃ  â”‚ â”‚
â”‚ â”‚ UI = f(state) â†’ unidirectional flow â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Provider = mechanism Ä‘á»ƒ share state â”‚ â”‚
â”‚ â”‚ WITHIN unidirectional model! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… CHUá»–I 3: Táº¡i sao Decouple State from UI? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WHY 1: Táº¡i sao tÃ¡ch state khá»i UI? â”‚ â”‚
â”‚ â”‚ â†’ Äá»ƒ swap state engine mÃ  khÃ´ng sá»­a UI! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 2: Táº¡i sao cáº§n swap state engine? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ requirements thay Ä‘á»•i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Prototype dÃ¹ng useState â†’ production cáº§n Zustand â”‚ â”‚
â”‚ â”‚ â†’ Real-time features cáº§n server sync! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 3: Táº¡i sao requirements luÃ´n thay Ä‘á»•i? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ business evolve! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ MVP â†’ growth â†’ scale â†’ enterprise! â˜… â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG THá»‚ predict requirements! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 4: Táº¡i sao unpredictable requirements = problem? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ tightly coupled code = COSTLY change! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ N components Ã— M contexts = NÃ—M rewrites! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ WHY 5: Táº¡i sao costly change is business risk? â”‚ â”‚
â”‚ â”‚ â†’ VÃ¬ Time-to-Market! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Competitor ship nhanh hÆ¡n â†’ lose market! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Engineering velocity = competitive advantage! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚
â”‚ â”‚ ROOT CAUSE: Software pháº£i ADAPT nhanh vá»›i â”‚ â”‚
â”‚ â”‚ business changes â†’ loose coupling = survival! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§28. Pattern TÆ° Duy 2 â€” First Principles Thinking!

```

FIRST PRINCIPLES â€” PHÃ‚N RÃƒ COMPOSITION PATTERNS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… Sá»° THáº¬T CÆ  Báº¢N 1: React Component = Function â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ KHÃ”NG THá»‚ CHá»I CÃƒI: â”‚ â”‚
â”‚ â”‚ â†’ Component = function nháº­n props, tráº£ JSX â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ f(props) = JSX â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ SUY RA: â”‚ â”‚
â”‚ â”‚ â†’ Function cÃ³ thá»ƒ COMPOSE (g âˆ˜ f)(x) = g(f(x))! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Compound Components = function composition! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ <A><B><C/></B></A> = A(B(C())) â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Composition > Inheritance (vÃ¬ functions!) â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Sá»° THáº¬T CÆ  Báº¢N 2: State = Memory â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ KHÃ”NG THá»‚ CHá»I CÃƒI: â”‚ â”‚
â”‚ â”‚ â†’ State = RAM allocation cho component â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ useState/useReducer = reserved memory slot â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ SUY RA: â”‚ â”‚
â”‚ â”‚ â†’ State "thuá»™c vá»" component nÃ o Gá»ŒI hook! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Lift state = MOVE memory slot lÃªn parent! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Provider = parent giá»¯ memory â†’ children READ! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Context = POINTER Ä‘áº¿n parent's memory! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ use(Context) = dereference pointer! â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Sá»° THáº¬T CÆ  Báº¢N 3: Re-render = Recomputation â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ KHÃ”NG THá»‚ CHá»I CÃƒI: â”‚ â”‚
â”‚ â”‚ â†’ Re-render = gá»i láº¡i function component â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Gá»i láº¡i = tá»‘n CPU time â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ CPU time = bounded resource â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ SUY RA: â”‚ â”‚
â”‚ â”‚ â†’ Context thay Ä‘á»•i â†’ ALL consumers RE-CALL! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ N consumers Ã— re-call per state change! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Split context = giáº£m N per context! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ useMemo = cache return value â†’ skip re-call â˜… â”‚ â”‚
â”‚ â”‚ â†’ React.memo = skip re-call náº¿u props same â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ GIá»šI Háº N Váº¬T LÃ: â”‚ â”‚
â”‚ â”‚ â†’ 60fps = 16.67ms per frame â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Táº¥t cáº£ re-renders PHáº¢I < 16.67ms! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ VÆ°á»£t quÃ¡ = jank/lag = bad UX â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Sá»° THáº¬T CÆ  Báº¢N 4: Boolean = Binary â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ KHÃ”NG THá»‚ CHá»I CÃƒI: â”‚ â”‚
â”‚ â”‚ â†’ Boolean = 1 bit = 2 giÃ¡ trá»‹ â˜… â”‚ â”‚
â”‚ â”‚ â†’ N booleans = N bits = 2â¿ giÃ¡ trá»‹ â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ÄÃ¢y lÃ  combinatorics cÆ¡ báº£n! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ SUY RA: â”‚ â”‚
â”‚ â”‚ â†’ Boolean props = EXPONENTIAL state space â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Variant = ENUM = LINEAR state space â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ "Channel" | "Thread" | "Edit" | "Forward" â”‚ â”‚
â”‚ â”‚ â†’ 4 variants = 4 states (not 2â´=16!) â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ TOÃN Há»ŒC THUáº¦N TÃšY: â”‚ â”‚
â”‚ â”‚ â†’ Sum type (union): |A| + |B| + |C| â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Product type (boolean): |A| Ã— |B| Ã— |C| â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ SUM < PRODUCT for |A|,|B|,|C| > 1 â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Variant = Sum type = tá»‘t hÆ¡n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Sá»° THáº¬T CÆ  Báº¢N 5: Interface = Contract â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ KHÃ”NG THá»‚ CHá»I CÃƒI: â”‚ â”‚
â”‚ â”‚ â†’ Interface = táº­p há»£p method signatures â˜… â”‚ â”‚
â”‚ â”‚ â†’ Caller chá»‰ biáº¿t interface, khÃ´ng biáº¿t impl â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ÄÃ¢y lÃ  fundamental CS concept tá»« 1970s! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ SUY RA: â”‚ â”‚
â”‚ â”‚ â†’ ComposerContextValue = interface! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ UI components = callers â†’ chá»‰ biáº¿t interface â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Providers = implementations â†’ swap thoáº£i mÃ¡i â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ N impls Ã— M callers = M + N files! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ (thay vÃ¬ M Ã— N náº¿u coupled!) â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§29. Pattern TÆ° Duy 3 â€” PhÃ¢n TÃ­ch ÄÃ¡nh Äá»•i (Trade-off Analysis)!

```

TRADE-OFF ANALYSIS â€” COMPOSITION PATTERNS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… TRADE-OFF 1: Flexibility vs Simplicity â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Compound Components: â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Flexibilityâ”‚ â”‚ Simplicityâ”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â– â– â– â– â– â– â– â– â– â– â”‚ â”‚ â– â– â– â– â–‘â–‘â–‘â–‘â–‘â–‘â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 10/10 â”‚ â”‚ 4/10 â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Monolithic + Boolean Props: â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Flexibilityâ”‚ â”‚ Simplicityâ”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â– â– â– â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ â”‚ â– â– â– â– â– â– â– â– â–‘â–‘â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 3/10 â”‚ â”‚ 8/10 â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ CÃI GIÃ Cá»¦A COMPOUND: â”‚ â”‚
â”‚ â”‚ â†’ Nhiá»u files hÆ¡n â˜… â”‚ â”‚
â”‚ â”‚ â†’ Context setup boilerplate â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Learning curve cho team â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Debugging qua context indirection â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ CÃI GIÃ Cá»¦A BOOLEAN: â”‚ â”‚
â”‚ â”‚ â†’ Exponential complexity khi scale â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Impossible states â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Unmaintainable code â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Káº¾T LUáº¬N: Boolean ráº» BAN Äáº¦U, Ä‘áº¯t Vá»€ SAU! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ Compound Ä‘áº¯t BAN Äáº¦U, ráº» Vá»€ SAU! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… TRADE-OFF 2: Performance vs Reusability â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Context-based Composition: â”‚ â”‚
â”‚ â”‚ âœ… Reusability: TUYá»†T Vá»œI (swap providers) â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ âš ï¸ Performance: context changes â†’ ALL consumers â”‚ â”‚
â”‚ â”‚ re-render! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Direct props (no context): â”‚ â”‚
â”‚ â”‚ âš ï¸ Reusability: poor (props coupled) â˜… â”‚ â”‚
â”‚ â”‚ âœ… Performance: chá»‰ component nháº­n props re-render â˜…â˜…â˜…â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ MITIGATION (giáº£m trade-off): â”‚ â”‚
â”‚ â”‚ â†’ Split contexts â†’ fewer consumers per context â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ useMemo/useCallback â†’ stable references â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ React.memo â†’ skip unnecessary re-renders â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Káº¾T LUáº¬N: Performance cost = MANAGEABLE! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ Reusability benefit = ENORMOUS! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… TRADE-OFF 3: DRY vs Explicit â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Explicit Variants: â”‚ â”‚
â”‚ â”‚ â†’ Má»—i variant Láº¶P Láº I 1 sá»‘ sub-components â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ThreadComposer + EditComposer cáº£ 2 cÃ³ â”‚ â”‚
â”‚ â”‚ Composer.Input + Composer.Footer â˜… â”‚ â”‚
â”‚ â”‚ â†’ Vi pháº¡m DRY á»Ÿ LEVEL COMPOSITION? â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ NHÆ¯NG: â”‚ â”‚
â”‚ â”‚ â†’ DRY á»Ÿ level SUB-COMPONENT! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Composer.Input code = 1 láº§n, dÃ¹ng N láº§n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Variant chá»‰ láº·p COMPOSITION (cÃ¡ch ghÃ©p) â”‚ â”‚
â”‚ â”‚ khÃ´ng láº·p IMPLEMENTATION (code bÃªn trong)! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ "Duplication is far cheaper than the wrong â”‚ â”‚
â”‚ â”‚ abstraction" â€” Sandi Metz â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ Káº¾T LUáº¬N: Explicit > DRY khi abstractions wrong! â˜…â˜…â˜…â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Ká»Š Bá»ŠCH Báº N NÃ€O THÃŒ COMPOSITION THáº¤T Báº I? â˜…â˜…â˜… â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1) Component Cá»°C ÄÆ N GIáº¢N (1 boolean, 2 variants) â”‚ â”‚
â”‚ â”‚ â†’ Overhead > benefit! DÃ¹ng boolean OK! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) Prototype/Hackathon (time pressure!) â”‚ â”‚
â”‚ â”‚ â†’ Boilerplate quÃ¡ nhiá»u â†’ ship cháº­m! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Boolean nhanh hÆ¡n â†’ refactor SAU! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) Solo developer, single-use component â”‚ â”‚
â”‚ â”‚ â†’ Reusability benefit = 0! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Overhead setup khÃ´ng justify! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 4) Team khÃ´ng hiá»ƒu Context API â”‚ â”‚
â”‚ â”‚ â†’ Bugs from misuse > bugs from boolean! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Cáº§n training trÆ°á»›c! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 5) PERFORMANCE-CRITICAL UI (animation, gaming) â”‚ â”‚
â”‚ â”‚ â†’ Context re-renders gÃ¢y frame drops! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Direct state manipulation tá»‘t hÆ¡n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§30. Pattern TÆ° Duy 4 â€” Mental Mapping!

```

MENTAL MAP â€” Vá»Š TRÃ COMPOSITION TRONG Há»† THá»NG:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… Báº¢N Äá»’ TOÃ€N Cáº¢NH: â”‚
â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Táº¦NG 5: Design System / Component Library â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Radix UI, Headless UI, Custom Design System â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ DÃ™NG Compound Components pattern! â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ Tabs._, Dialog._, Menu._, Accordion._ â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â†“ sá»­ dá»¥ng bá»Ÿi â”‚ â”‚
â”‚ â”‚ Táº¦NG 4: Feature Components (Business Logic) â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ ChannelComposer, ThreadComposer, EditComposer â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ DÃ™NG Explicit Variants + Providers! â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ Decouple state from UI! â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â†“ state tá»« â”‚ â”‚
â”‚ â”‚ Táº¦NG 3: State Management â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ useState, Zustand, Redux, React Query, Jotai â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ ÄÆ¯á»¢C INJECT qua Context Interface! â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ Provider = adapter giá»¯a state lib + UI! â˜…â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â†“ data tá»« â”‚ â”‚
â”‚ â”‚ Táº¦NG 2: Data Layer â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ REST API, GraphQL, WebSocket, Server Actions â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ Provider fetch data â†’ inject vÃ o context â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â†“ network qua â”‚ â”‚
â”‚ â”‚ Táº¦NG 1: Runtime & Framework â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ React 19 (use, ref as prop), Next.js, Vite â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â†’ React 19 APIs áº£nh hÆ°á»Ÿng HOW we compose! â˜…â˜… â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Má»–I RULE áº¢NH HÆ¯á»NG Táº¦NG NÃ€O? â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ # â”‚ Rule â”‚ Táº§ng áº£nh hÆ°á»Ÿng â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚ â”‚ â‘  â”‚ Avoid Boolean Props â”‚ 4 + 5 (UI arch) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘¡ â”‚ Compound Components â”‚ 5 (Design System)â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘¢ â”‚ Decouple State â”‚ 3 â†” 4 (boundary) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘£ â”‚ Context Interface â”‚ 3 (State Layer) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘¤ â”‚ Lift State â”‚ 3 â†” 4 (boundary) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘¥ â”‚ Explicit Variants â”‚ 4 (Features) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘¦ â”‚ Children > Render â”‚ 4 + 5 (UI comp) â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â‘§ â”‚ React 19 APIs â”‚ 1 (Runtime) â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… TÃC Äá»˜NG XUá»NG Táº¦NG DÆ¯á»šI: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1 dÃ²ng code <Composer.Input /> á»Ÿ Táº¦NG 5 â”‚ â”‚
â”‚ â”‚ â†“ â”‚ â”‚
â”‚ â”‚ React call use(ComposerContext) â†’ Táº¦NG 3 â”‚ â”‚
â”‚ â”‚ â†“ â”‚ â”‚
â”‚ â”‚ Context value = pointer trong Fiber tree (RAM) â˜… â”‚ â”‚
â”‚ â”‚ â†“ â”‚ â”‚
â”‚ â”‚ Re-render â†’ React reconciliation â†’ VDOM diff â˜… â”‚ â”‚
â”‚ â”‚ â†“ â”‚ â”‚
â”‚ â”‚ DOM mutation â†’ Browser repaint â†’ GPU composite â˜… â”‚ â”‚
â”‚ â”‚ â†“ â”‚ â”‚
â”‚ â”‚ Pixels on screen! â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ Composition pattern quyáº¿t Ä‘á»‹nh HOW MANY layers â”‚ â”‚
â”‚ â”‚ bá»‹ trigger khi state thay Ä‘á»•i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§31. Pattern TÆ° Duy 5 â€” Reverse Engineering & Implementation!

```

REVERSE ENGINEERING â€” Tá»° XÃ‚Y Láº I COMPOSITION:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ "What I cannot create, I do not understand" â”‚
â”‚ â€” Richard Feynman â˜…â˜…â˜… â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Tá»° BUILD: Mini Compound Component System! â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ // STEP 1: Hiá»ƒu Context = global variable scoped â”‚ â”‚
â”‚ â”‚ // to a subtree! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ const ctx = createContext(null) â”‚ â”‚
â”‚ â”‚ // â†’ React táº¡o 1 "slot" trong Fiber tree â”‚ â”‚
â”‚ â”‚ // â†’ Provider GHI vÃ o slot â”‚ â”‚
â”‚ â”‚ // â†’ Consumer Äá»ŒC tá»« slot â”‚ â”‚
â”‚ â”‚ // â†’ Giá»‘ng global variable nhÆ°ng SCOPED! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ // STEP 2: Provider = setter â”‚ â”‚
â”‚ â”‚ function Provider({ children, value }) { â”‚ â”‚
â”‚ â”‚ return <ctx value={value}>{children}</ctx> â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ // â†’ Write value vÃ o Fiber node â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ // STEP 3: Consumer = getter â”‚ â”‚
â”‚ â”‚ function useMyContext() { â”‚ â”‚
â”‚ â”‚ const value = use(ctx) â”‚ â”‚
â”‚ â”‚ if (!value) throw new Error( â”‚ â”‚
â”‚ â”‚ "Must be used within Provider!" // â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ ) â”‚ â”‚
â”‚ â”‚ return value â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ // â†’ Walk UP Fiber tree tÃ¬m Provider gáº§n nháº¥t â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ // â†’ Giá»‘ng prototype chain lookup! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ // STEP 4: Sub-components â”‚ â”‚
â”‚ â”‚ function Input() { â”‚ â”‚
â”‚ â”‚ const { state, actions } = useMyContext() â”‚ â”‚
â”‚ â”‚ return <input â”‚ â”‚
â”‚ â”‚ value={state.text} â”‚ â”‚
â”‚ â”‚ onChange={e => actions.update(e.target.value)} â”‚ â”‚
â”‚ â”‚ /> â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ function Submit() { â”‚ â”‚
â”‚ â”‚ const { actions } = useMyContext() â”‚ â”‚
â”‚ â”‚ return <button onClick={actions.submit}>Send</button>â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ // STEP 5: Namespace export â”‚ â”‚
â”‚ â”‚ const MyComponent = { Provider, Input, Submit } â”‚ â”‚
â”‚ â”‚ // â†’ This IS compound components! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚
â”‚ â”‚ INSIGHT KHI Tá»° BUILD: â”‚ â”‚
â”‚ â”‚ â†’ Context = KHÃ”NG MAGIC, chá»‰ lÃ  Fiber tree lookup! â”‚ â”‚
â”‚ â”‚ â†’ Provider = SET value lÃªn Fiber node â˜… â”‚ â”‚
â”‚ â”‚ â†’ use() = WALK UP tree tÃ¬m Provider â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Re-render = React BIáº¾T consumer nÃ o subscribe â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Giá»‘ng pub/sub pattern! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… Tá»° BUILD: Mini Boolean Complexity Checker! â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ // Äáº¿m impossible states tá»« boolean props! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ function checkComplexity(booleans) { â”‚ â”‚
â”‚ â”‚ const n = booleans.length â”‚ â”‚
â”‚ â”‚ const total = 2 \*_ n // tá»•ng combinations â”‚ â”‚
â”‚ â”‚ const valid = n + 1 // chá»‰ ~n+1 há»£p lá»‡! â”‚ â”‚
â”‚ â”‚ const impossible = total - valid â”‚ â”‚
â”‚ â”‚ const wasteRatio = impossible / total _ 100 â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ return { â”‚ â”‚
â”‚ â”‚ total, valid, impossible, â”‚ â”‚
â”‚ â”‚ waste: wasteRatio.toFixed(1) + "%", â”‚ â”‚
â”‚ â”‚ verdict: wasteRatio > 50 â”‚ â”‚
â”‚ â”‚ ? "REFACTOR NOW! â˜…â˜…â˜…" â”‚ â”‚
â”‚ â”‚ : "Monitor â˜…" â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ checkComplexity(["isThread","isEdit","isFwd"]) â”‚ â”‚
â”‚ â”‚ // â†’ { total: 8, valid: 4, impossible: 4, â”‚ â”‚
â”‚ â”‚ // waste: "50.0%", verdict: "Monitor â˜…" } â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ checkComplexity(["a","b","c","d","e"]) â”‚ â”‚
â”‚ â”‚ // â†’ { total: 32, valid: 6, impossible: 26, â”‚ â”‚
â”‚ â”‚ // waste: "81.2%", verdict: "REFACTOR NOW! â˜…â˜…â˜…" }â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Â§32. Pattern TÆ° Duy 6 â€” Lá»‹ch Sá»­ vÃ  Sá»± Tiáº¿n HÃ³a!

```

CONTEXTUAL HISTORY â€” Táº I SAO COMPOSITION Tá»’N Táº I?
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”‚
â”‚ â˜…â˜…â˜… TIMELINE TIáº¾N HÃ“A: â”‚
â”‚ â”‚
â”‚ 2010 â”€â”€â”€ jQuery era â˜… â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ DOM manipulation trá»±c tiáº¿p! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ $.ajax + $(".class").html("...") â”‚ â”‚
â”‚ â”‚ â†’ KHÃ”NG cÃ³ component concept! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Code = spaghetti jQuery chains! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Reusability: copy-paste! ğŸ˜± â”‚ â”‚
â”‚ â”‚ â†’ Váº¤N Äá»€: Unmaintainable khi app lá»›n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â†“ giáº£i quyáº¿t báº±ng â”‚
â”‚ â”‚
â”‚ 2012 â”€â”€â”€ Angular 1 (Components + Two-way Binding) â˜…â˜… â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ Directives + Controllers + Scopes! â˜… â”‚ â”‚
â”‚ â”‚ â†’ Two-way data binding: ng-model â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Váº¤N Äá»€: $digest cycle â†’ performance hell! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Váº¤N Äá»€: Scope inheritance â†’ data confusing! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Component reuse = khÃ³ vÃ¬ scope coupling! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â†“ giáº£i quyáº¿t báº±ng â”‚
â”‚ â”‚
â”‚ 2013 â”€â”€â”€ React (Unidirectional + Components) â˜…â˜…â˜… â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ UI = f(state) â†’ predictable! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Unidirectional data flow! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Component = function/class! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ JSX = HTML in JS! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ BAN Äáº¦U: Class components + Inheritance â˜… â”‚ â”‚
â”‚ â”‚ â†’ Váº¤N Äá»€: Mixins â†’ name collision! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Váº¤N Äá»€: HOC â†’ wrapper hell! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Váº¤N Äá»€: Render props â†’ callback pyramid! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â†“ giáº£i quyáº¿t báº±ng â”‚
â”‚ â”‚
â”‚ 2019 â”€â”€â”€ React Hooks â˜…â˜…â˜… â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ useState, useEffect, useContext! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Bye class components! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Bye HOC wrapper hell! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Composition qua hooks! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ NHÆ¯NG VáºªN CÃ’N Váº¤N Äá»€: â”‚ â”‚
â”‚ â”‚ â†’ Boolean props váº«n proliferate! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ forwardRef boilerplate! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ useContext khÃ´ng conditional! â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Prop drilling váº«n xáº£y ra! â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â†“ giáº£i quyáº¿t báº±ng â”‚
â”‚ â”‚
â”‚ 2024 â”€â”€â”€ Composition Patterns + React 19 â˜…â˜…â˜… â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†’ Compound Components (structured composition)! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Context Interface (DI for React)! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Explicit Variants (kill booleans)! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Lift State to Providers! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ React 19: ref as prop, use() API! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ ÄÃ¢y lÃ  STATE OF THE ART hiá»‡n táº¡i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Vercel codify thÃ nh Agent Skills! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… BÃ€I Há»ŒC Tá»ª Lá»ŠCH Sá»¬: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 1) Má»—i tháº¿ há»‡ GIáº¢I QUYáº¾T váº¥n Ä‘á» tháº¿ há»‡ trÆ°á»›c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ jQuery â†’ Angular â†’ React â†’ Hooks â†’ Composition â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 2) Má»—i giáº£i phÃ¡p Táº O RA váº¥n Ä‘á» má»›i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ React â†’ hooks OK nhÆ°ng boolean props váº«n cÃ³ â”‚ â”‚
â”‚ â”‚ Composition â†’ OK nhÆ°ng context re-renders â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 3) Pattern tiáº¿n hÃ³a theo SPIRAL khÃ´ng LINEAR! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ Mixins â†’ HOC â†’ Render Props â†’ Hooks â†’ Compound â”‚ â”‚
â”‚ â”‚ â†’ Má»—i vÃ²ng giáº£i quyáº¿t reuse KHÃC NHAU! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ 4) CÃ‚U Há»I THEN CHá»T cho tÆ°Æ¡ng lai: â”‚ â”‚
â”‚ â”‚ â†’ Composition sáº½ tháº¥t báº¡i á»Ÿ Ä‘Ã¢u? â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Context re-render problem â†’ Signals? â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ React Compiler (React Forget) cÃ³ thá»ƒ â”‚ â”‚
â”‚ â”‚ auto-memoize â†’ giáº£m re-render trade-off? â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ Server Components + Composition = ??? â”‚ â”‚
â”‚ â”‚ â†’ New patterns cháº¯c cháº¯n sáº½ xuáº¥t hiá»‡n! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â˜…â˜…â˜… SO SÃNH EVOLUTION Cá»¦A CODE REUSE: â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Era â”‚ Pattern â”‚ Váº¥n Ä‘á» â”‚ â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚ â”‚ 2013 Classes â”‚ Mixins â”‚ Name collision â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 2015 Classes â”‚ HOC â”‚ Wrapper hell â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 2017 Classes â”‚ Render propâ”‚ Callback nest â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 2019 Functions â”‚ Hooks â”‚ Boolean props â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 2024 Functions â”‚ Compound â”‚ Context perf â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ 202? Functions â”‚ Signals? â”‚ ??? â”‚ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â†’ Má»—i row giáº£i quyáº¿t Váº¤N Äá»€ row trÆ°á»›c! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ NhÆ°ng táº¡o ra Váº¤N Äá»€ Má»šI á»Ÿ cá»™t cuá»‘i! â˜…â˜…â˜… â”‚ â”‚
â”‚ â”‚ â†’ ÄÃ¢y lÃ  NATURE of software engineering! â˜…â˜…â˜… â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

```
