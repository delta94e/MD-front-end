# Next.js loading.js â€” Deep Dive!

> **Chá»§ Ä‘á»**: `loading.js` â€” Instant Loading UI vá»›i React Suspense
> **NgÃ´n ngá»¯**: Tiáº¿ng Viá»‡t â€” giáº£i thÃ­ch cá»±c ká»³ chi tiáº¿t!
> **PhÆ°Æ¡ng chÃ¢m**: Tá»± viáº¿t láº¡i báº±ng tay â€” KHÃ”NG dÃ¹ng thÆ° viá»‡n!
> **Nguá»“n**: https://nextjs.org/docs/app/api-reference/file-conventions/loading
> **HÃ¬nh áº£nh trang gá»‘c**: 3 diagrams (phÃ¢n tÃ­ch toÃ n bá»™ bÃªn dÆ°á»›i!)

---

## Má»¥c Lá»¥c

1. [Â§1. Tá»•ng Quan â€” loading.js lÃ  gÃ¬?](#1)
2. [Â§2. Reference â€” Parameters + Component Type](#2)
3. [Â§3. Behavior â€” Navigation, Instant Loading, SEO](#3)
4. [Â§4. Status Codes + Browser Limits](#4)
5. [Â§5. Streaming with Suspense â€” Manual Boundaries](#5)
6. [Â§6. PhÃ¢n TÃ­ch 3 Diagrams Tá»« Trang Docs!](#6)
7. [Â§7. SÆ¡ Äá»“ Tá»± Váº½ â€” Tá»•ng Há»£p](#7)
8. [Â§8. Tá»± Viáº¿t â€” LoadingEngine](#8)
9. [Â§9. CÃ¢u Há»i Luyá»‡n Táº­p](#9)

---

## Â§1. Tá»•ng Quan â€” loading.js lÃ  gÃ¬?

```
  loading.js â€” Tá»”NG QUAN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  Äá»ŠNH NGHÄ¨A:                                                 â”‚
  â”‚  loading.js lÃ  SPECIAL FILE giÃºp táº¡o Loading UI              â”‚
  â”‚  vá»›i React Suspense! Hiá»ƒn thá»‹ UI táº¡m thá»i tá»« server          â”‚
  â”‚  trong khi content cá»§a route segment Ä‘ang STREAMING vÃ o.     â”‚
  â”‚  Content má»›i tá»± Ä‘á»™ng SWAP IN khi hoÃ n thÃ nh!                 â”‚
  â”‚                                                              â”‚
  â”‚  CÃCH HOáº T Äá»˜NG:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  User navigate sang route má»›i                        â”‚    â”‚
  â”‚  â”‚       â”‚                                              â”‚    â”‚
  â”‚  â”‚       â–¼                                              â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
  â”‚  â”‚  â”‚ Server báº¯t Ä‘áº§u render...         â”‚               â”‚    â”‚
  â”‚  â”‚  â”‚ â†’ Layout shared UI giá»¯ nguyÃªn!  â”‚               â”‚    â”‚
  â”‚  â”‚  â”‚ â†’ loading.js hiá»‡n THá»€ CHÃˆN!     â”‚               â”‚    â”‚
  â”‚  â”‚  â”‚ â†’ User tháº¥y skeleton/spinner... â”‚               â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
  â”‚  â”‚                 â”‚ (streaming...)                     â”‚    â”‚
  â”‚  â”‚                 â–¼                                    â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
  â”‚  â”‚  â”‚ Page content DONE!               â”‚               â”‚    â”‚
  â”‚  â”‚  â”‚ â†’ loading.js AUTO SWAP OUT!     â”‚               â”‚    â”‚
  â”‚  â”‚  â”‚ â†’ Page content SWAP IN!         â”‚               â”‚    â”‚
  â”‚  â”‚  â”‚ â†’ Seamless transition!          â”‚               â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  CODE CÆ  Báº¢N:                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ // app/dashboard/loading.js                          â”‚    â”‚
  â”‚  â”‚ export default function Loading() {                  â”‚    â”‚
  â”‚  â”‚   // Hoáº·c custom loading skeleton component          â”‚    â”‚
  â”‚  â”‚   return <p>Loading...</p>                           â”‚    â”‚
  â”‚  â”‚ }                                                    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ // CÃ³ thá»ƒ dÃ¹ng báº¥t ká»³ UI nháº¹ nÃ o:                   â”‚    â”‚
  â”‚  â”‚ â†’ <LoadingSkeleton />                               â”‚    â”‚
  â”‚  â”‚ â†’ <Spinner />                                       â”‚    â”‚
  â”‚  â”‚ â†’ Shimmer effects                                   â”‚    â”‚
  â”‚  â”‚ â†’ Cover photo + title preview                       â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Äáº¶C ÄIá»‚M QUAN TRá»ŒNG:                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â€¢ Máº·c Ä‘á»‹nh: Server Component!                       â”‚    â”‚
  â”‚  â”‚ â€¢ CÃ³ thá»ƒ chuyá»ƒn thÃ nh Client: thÃªm "use client"     â”‚    â”‚
  â”‚  â”‚ â€¢ KHÃ”NG nháº­n báº¥t ká»³ parameter nÃ o!                  â”‚    â”‚
  â”‚  â”‚ â€¢ Tá»± Ä‘á»™ng wrap page.js trong <Suspense>!            â”‚    â”‚
  â”‚  â”‚ â€¢ DÃ¹ng React DevTools Ä‘á»ƒ test toggle Suspense!      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§2. Reference â€” Parameters + Component Type

```
  REFERENCE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  PARAMETERS:                                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Loading UI components KHÃ”NG nháº­n báº¥t ká»³ parameter!  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG cÃ³ params                                   â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG cÃ³ searchParams                             â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG cÃ³ props nÃ o cáº£!                            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Táº¡i sao? VÃ¬ loading.js lÃ  FALLBACK tÄ©nh!            â”‚    â”‚
  â”‚  â”‚ â†’ Hiá»‡n ngay láº­p tá»©c khi navigate                    â”‚    â”‚
  â”‚  â”‚ â†’ KhÃ´ng cáº§n biáº¿t route cá»¥ thá»ƒ nÃ o                   â”‚    â”‚
  â”‚  â”‚ â†’ Chá»‰ cáº§n hiá»‡n skeleton/spinner chung               â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  COMPONENT TYPE:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ Máº·c Ä‘á»‹nh: SERVER Component!                         â”‚    â”‚
  â”‚  â”‚ â†’ Render trÃªn server                                â”‚    â”‚
  â”‚  â”‚ â†’ Gá»­i HTML skeleton cho client ngay láº­p tá»©c        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ TÃ¹y chá»n: CLIENT Component!                         â”‚    â”‚
  â”‚  â”‚ â†’ ThÃªm "use client" á»Ÿ Ä‘áº§u file                    â”‚    â”‚
  â”‚  â”‚ â†’ Khi cáº§n: animation, interactive spinners...       â”‚    â”‚
  â”‚  â”‚ â†’ VÃ­ dá»¥: progress bar cáº§n state!                   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§3. Behavior â€” Navigation, Instant Loading, SEO!

```
  BEHAVIOR â€” HÃ€NH VI:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â‘  NAVIGATION:                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Fallback UI Ä‘Æ°á»£c PREFETCHED!                      â”‚    â”‚
  â”‚  â”‚   â†’ Loading skeleton gá»­i trÆ°á»›c khi user click!     â”‚    â”‚
  â”‚  â”‚   â†’ Navigation gáº§n nhÆ° NGAY Láº¬P Tá»¨C! (instant!)   â”‚    â”‚
  â”‚  â”‚   â†’ Trá»« khi prefetch chÆ°a hoÃ n thÃ nh                â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Navigation lÃ  INTERRUPTIBLE!                      â”‚    â”‚
  â”‚  â”‚   â†’ User Ä‘ang navigate sang Route A                 â”‚    â”‚
  â”‚  â”‚   â†’ User Ä‘á»•i Ã½, click Route B                      â”‚    â”‚
  â”‚  â”‚   â†’ KHÃ”NG cáº§n Ä‘á»£i Route A load xong!               â”‚    â”‚
  â”‚  â”‚   â†’ Chuyá»ƒn sang Route B ngay láº­p tá»©c!               â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Shared layouts REMAIN INTERACTIVE!                 â”‚    â”‚
  â”‚  â”‚   â†’ Sidebar, nav, header... váº«n click Ä‘Æ°á»£c!        â”‚    â”‚
  â”‚  â”‚   â†’ Chá»‰ content area hiá»‡n loading state!           â”‚    â”‚
  â”‚  â”‚   â†’ User KHÃ”NG bá»‹ "Ä‘Ã³ng bÄƒng"!                     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¡ INSTANT LOADING STATES:                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ WHAT: Fallback UI hiá»‡n NGAY Láº¬P Tá»¨C khi navigate!  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CÃ“ THá»‚ LÃ€:                                          â”‚    â”‚
  â”‚  â”‚ â†’ Skeletons (xÆ°Æ¡ng content layout)                  â”‚    â”‚
  â”‚  â”‚ â†’ Spinners (loading wheels)                         â”‚    â”‚
  â”‚  â”‚ â†’ Pháº§n nhá» cÃ³ Ã½ nghÄ©a: áº£nh bÃ¬a, title...         â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Táº I SAO QUAN TRá»ŒNG?                                 â”‚    â”‚
  â”‚  â”‚ â†’ App PHáº¢N Há»’I ngay â†’ user biáº¿t Ä‘ang load!        â”‚    â”‚
  â”‚  â”‚ â†’ Better UX (perceived performance!)               â”‚    â”‚
  â”‚  â”‚ â†’ Giáº£m "thá»i gian chá» cáº£m nháº­n"                   â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ AUTO WRAP:                                           â”‚    â”‚
  â”‚  â”‚ Trong cÃ¹ng 1 folder, loading.js sáº½:                 â”‚    â”‚
  â”‚  â”‚ â†’ Náº±m TRONG layout.js (nested inside!)             â”‚    â”‚
  â”‚  â”‚ â†’ Tá»± Ä‘á»™ng WRAP page.js trong <Suspense>!           â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ COMPONENT HIERARCHY (tá»± Ä‘á»™ng!):                      â”‚    â”‚
  â”‚  â”‚ <Layout>                                             â”‚    â”‚
  â”‚  â”‚   <Header />                                         â”‚    â”‚
  â”‚  â”‚   <SideNav />                                        â”‚    â”‚
  â”‚  â”‚   <Suspense fallback={<Loading />}>                  â”‚    â”‚
  â”‚  â”‚     <Page />   â† Chá»‰ pháº§n nÃ y bá»‹ "suspend"!       â”‚    â”‚
  â”‚  â”‚   </Suspense>                                        â”‚    â”‚
  â”‚  â”‚ </Layout>                                            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  â‘¢ SEO:                                                       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Streaming server-rendered â†’ KHÃ”NG áº£nh hÆ°á»Ÿng SEO! â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CHO BOTS (Twitter, etc.) â€” khÃ´ng cháº¡y JS:          â”‚    â”‚
  â”‚  â”‚ â†’ Next.js resolve generateMetadata TRÆ¯á»šC streaming â”‚    â”‚
  â”‚  â”‚ â†’ Metadata Ä‘áº·t vÃ o <head> cá»§a initial HTML         â”‚    â”‚
  â”‚  â”‚ â†’ Bot tháº¥y full metadata!                           â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ CHO BROWSERS â€” cháº¡y JS:                              â”‚    â”‚
  â”‚  â”‚ â†’ Streaming metadata cÃ³ thá»ƒ dÃ¹ng!                   â”‚    â”‚
  â”‚  â”‚ â†’ Next.js auto detect user-agent                    â”‚    â”‚
  â”‚  â”‚ â†’ Chá»n blocking vs streaming tá»± Ä‘á»™ng!               â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ KIá»‚M TRA:                                            â”‚    â”‚
  â”‚  â”‚ â†’ Google Rich Results Test tool                     â”‚    â”‚
  â”‚  â”‚ â†’ Xem serialized HTML mÃ  Google crawler tháº¥y       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§4. Status Codes + Browser Limits!

```
  STATUS CODES + BROWSER LIMITS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  STATUS CODES KHI STREAMING:                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ Streaming LUÃ”N tráº£ vá» 200 status code!            â”‚    â”‚
  â”‚  â”‚ â†’ Headers ÄÃƒ Gá»¬I trÆ°á»›c khi stream báº¯t Ä‘áº§u!       â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG THá»‚ thay Ä‘á»•i status code SAU KHI stream!   â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ Váº¤N Äá»€ 404:                                         â”‚    â”‚
  â”‚  â”‚ â†’ Khi stream 404 page â†’ HTTP váº«n lÃ  200!          â”‚    â”‚
  â”‚  â”‚ â†’ Next.js thÃªm <meta name="robots"                  â”‚    â”‚
  â”‚  â”‚   content="noindex"> vÃ o streamed HTML!              â”‚    â”‚
  â”‚  â”‚ â†’ NgÄƒn search engines index URL Ä‘Ã³!                 â”‚    â”‚
  â”‚  â”‚ â†’ Google gá»i Ä‘Ã¢y lÃ  "soft 404"                     â”‚    â”‚
  â”‚  â”‚ â†’ KHÃ”NG bá»‹ index vÃ¬ cÃ³ noindex tag!                 â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ GIáº¢I PHÃP cáº§n THá»°C 404 status:                      â”‚    â”‚
  â”‚  â”‚ â†’ Kiá»ƒm tra resource Tá»’N Táº I trÆ°á»›c khi stream!     â”‚    â”‚
  â”‚  â”‚ â†’ DÃ¹ng proxy Ä‘á»ƒ rewrite sang not-found route       â”‚    â”‚
  â”‚  â”‚ â†’ Äáº·t notFound() TRÆ¯á»šC Suspense boundaries!       â”‚    â”‚
  â”‚  â”‚ â†’ Äáº·t notFound() TRÆ¯á»šC báº¥t ká»³ await nÃ o!           â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ TIMELINE:                                            â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
  â”‚  â”‚ â”‚ Response headers SET (status=200) â† ÄÃƒ FIX!â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚       â”‚                                      â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚       â–¼                                      â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ Suspense fallback renders (loading.js)       â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚       â”‚                                      â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚       â–¼                                      â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ Server Component suspends (await fetch...)   â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚       â”‚                                      â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚       â–¼                                      â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ Content streams in â†’ SWAP vÃ o!              â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚                                              â”‚    â”‚    â”‚
  â”‚  â”‚ â”‚ âš ï¸ notFound() PHáº¢I gá»i TRÆ¯á»šC bÆ°á»›c 2!       â”‚    â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  BROWSER LIMITS:                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Má»™t sá»‘ browsers BUFFER streaming response!        â”‚    â”‚
  â”‚  â”‚ â†’ KhÃ´ng hiá»‡n content cho Ä‘áº¿n khi > 1024 bytes!     â”‚    â”‚
  â”‚  â”‚ â†’ CHá»ˆ áº£nh hÆ°á»Ÿng "hello world" apps nhá»!           â”‚    â”‚
  â”‚  â”‚ â†’ Apps thá»±c táº¿ â†’ vÆ°á»£t 1024 bytes â†’ OK!            â”‚    â”‚
  â”‚  â”‚ â†’ Safari/WebKit lÃ  vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh!                 â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§5. Streaming with Suspense â€” Manual Boundaries!

```
  STREAMING WITH SUSPENSE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  NGOÃ€I loading.js (auto), báº¡n cÃ³ thá»ƒ Tá»° Táº O                 â”‚
  â”‚  Suspense boundaries cho riÃªng UI components!                â”‚
  â”‚                                                              â”‚
  â”‚  <Suspense> HOáº T Äá»˜NG:                                        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ 1. Wrap component cÃ³ async action (fetch data...)    â”‚    â”‚
  â”‚  â”‚ 2. Hiá»‡n FALLBACK UI (skeleton, spinner) trong lÃºc   â”‚    â”‚
  â”‚  â”‚    async Ä‘ang cháº¡y                                   â”‚    â”‚
  â”‚  â”‚ 3. SWAP IN component tháº­t khi async DONE!           â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  CODE VÃ Dá»¤ â€” MULTIPLE SUSPENSE BOUNDARIES:                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ import { Suspense } from 'react'                     â”‚    â”‚
  â”‚  â”‚ import { PostFeed, Weather } from './Components'      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ export default function Posts() {                     â”‚    â”‚
  â”‚  â”‚   return (                                           â”‚    â”‚
  â”‚  â”‚     <section>                                        â”‚    â”‚
  â”‚  â”‚       <Suspense fallback={<p>Loading feed...</p>}>   â”‚    â”‚
  â”‚  â”‚         <PostFeed />                                  â”‚    â”‚
  â”‚  â”‚       </Suspense>                                    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚       <Suspense fallback={<p>Loading weather...</p>}>â”‚    â”‚
  â”‚  â”‚         <Weather />                                   â”‚    â”‚
  â”‚  â”‚       </Suspense>                                    â”‚    â”‚
  â”‚  â”‚     </section>                                       â”‚    â”‚
  â”‚  â”‚   )                                                  â”‚    â”‚
  â”‚  â”‚ }                                                    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â†’ PostFeed vÃ  Weather load Äá»˜C Láº¬P!               â”‚    â”‚
  â”‚  â”‚ â†’ Weather xong trÆ°á»›c? Hiá»‡n trÆ°á»›c!                    â”‚    â”‚
  â”‚  â”‚ â†’ PostFeed xong sau? Swap in sau!                    â”‚    â”‚
  â”‚  â”‚ â†’ KhÃ´ng cáº§n Ä‘á»£i cáº£ 2 cÃ¹ng xong!                   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  2 Lá»¢I ÃCH Cá»¦A SUSPENSE:                                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘  Streaming Server Rendering                        â”‚    â”‚
  â”‚  â”‚   â†’ HTML render Dáº¦N Dáº¦N tá»« server â†’ client         â”‚    â”‚
  â”‚  â”‚   â†’ KhÃ´ng Ä‘á»£i Táº¤T Cáº¢ data xong má»›i gá»­i!          â”‚    â”‚
  â”‚  â”‚   â†’ User tháº¥y content Sá»šM HÆ N!                     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â‘¡ Selective Hydration                               â”‚    â”‚
  â”‚  â”‚   â†’ React Æ°u tiÃªn hydrate COMPONENT NÃ€O trÆ°á»›c!    â”‚    â”‚
  â”‚  â”‚   â†’ Dá»±a trÃªn USER INTERACTION!                      â”‚    â”‚
  â”‚  â”‚   â†’ User hover/click component â†’ hydrate ngay!     â”‚    â”‚
  â”‚  â”‚   â†’ Component khÃ¡c â†’ hydrate sau!                  â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  SO SÃNH: loading.js vs Manual <Suspense>:                     â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
  â”‚  â”‚ â”‚              â”‚ loading.js    â”‚ <Suspense>      â”‚   â”‚    â”‚
  â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚    â”‚
  â”‚  â”‚ â”‚ Scope        â”‚ TOÃ€N Bá»˜ page â”‚ Tá»«ng component  â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚ Auto wrap    â”‚ CÃ“ (auto!)   â”‚ KHÃ”NG (manual!) â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚ Granularity  â”‚ ThÃ´ (1 file) â”‚ Má»‹n (per comp) â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚ Parameters   â”‚ KHÃ”NG        â”‚ N/A             â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚ Khi dÃ¹ng     â”‚ Page-level   â”‚ Component-level â”‚   â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§6. PhÃ¢n TÃ­ch 3 Diagrams Tá»« Trang Docs!

### ğŸ“Š Diagram 1: Loading State Transition â€” Skeleton â†’ Content Swap

```
  PHÃ‚N TÃCH DIAGRAM 1: "Loading State Transition"
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  SÆ¡ Ä‘á»“ gá»“m 2 CARD cáº¡nh nhau + MÅ¨I TÃŠN XANH:                â”‚
  â”‚                                                              â”‚
  â”‚  CARD BÃŠN TRÃI â€” "Partial content with loading state":       â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                      â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â—‹ â”‚  â•â•â•â•â•â•â•â•â•â•â•                          â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â””â”€â”€â”€â”˜                                        â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”     â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â•                                     â•     â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â•  â–‘â–‘â–‘ LOADING AREA â–‘â–‘â–‘               â•     â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â•  (viá»n Ä‘á»©t XANH = loading state!)  â•     â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â•                                     â•     â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â””â•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ•Œâ”˜     â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â†’ Profile placeholder (vÃ²ng trÃ²n xÃ¡m)              â”‚    â”‚
  â”‚  â”‚  â†’ Text placeholder (thanh ngang xÃ¡m)                â”‚    â”‚
  â”‚  â”‚  â†’ Khu vá»±c loading VIá»€N XANH Äá»¨T = Suspense area! â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚             â”€â”€â”€â†’ MÅ¨I TÃŠN XANH (swap!) â”€â”€â”€â†’                  â”‚
  â”‚                                                              â”‚
  â”‚  CARD BÃŠN PHáº¢I â€” "Loaded content":                            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                      â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â—‹ â”‚  â•â•â•â•â•â•â•â•â•â•â•                          â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â””â”€â”€â”€â”˜                                        â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ ğŸ”ï¸ (áº£nh tháº­t)                      â”‚       â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                â”‚       â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                â”‚       â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ (text tháº­t â€” full content!)        â”‚       â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚    â”‚
  â”‚  â”‚  â”‚                                              â”‚    â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â†’ CÃ¹ng profile phÃ­a trÃªn GIá»® NGUYÃŠN!               â”‚    â”‚
  â”‚  â”‚  â†’ Khu vá»±c loading â†’ THAY Báº°NG content tháº­t!       â”‚    â”‚
  â”‚  â”‚  â†’ Viá»n Ä‘á»©t xanh â†’ viá»n solid (content loaded!)    â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  Ã NGHÄ¨A:                                                    â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ Left = TRÆ¯á»šC khi data load (skeleton/loading)     â”‚    â”‚
  â”‚  â”‚ â†’ Right = SAU khi data load (real content)           â”‚    â”‚
  â”‚  â”‚ â†’ Pháº§n NGOÃ€I viá»n Ä‘á»©t = layout (KHÃ”NG Ä‘á»•i!)        â”‚    â”‚
  â”‚  â”‚ â†’ Pháº§n TRONG viá»n Ä‘á»©t = page content (SWAP!)        â”‚    â”‚
  â”‚  â”‚ â†’ Blue arrow = quÃ¡ trÃ¬nh streaming + swap           â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š Diagram 2: File System Tree â€” loading.js Placement

```
  PHÃ‚N TÃCH DIAGRAM 2: "File System Tree"
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  SÆ¡ Ä‘á»“ hiá»ƒn thá»‹ Cáº¤U TRÃšC THÆ¯ Má»¤C dáº¡ng cÃ¢y:                  â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â”‚  ğŸ“ app/                                            â”‚     â”‚
  â”‚  â”‚  â”œâ”€â”€ ğŸ“„ layout.js           (root layout)          â”‚     â”‚
  â”‚  â”‚  â””â”€â”€ ğŸ“ dashboard/                                  â”‚     â”‚
  â”‚  â”‚      â”œâ”€â”€ ï¿½ï¿½ layout.js       (dashboard layout)     â”‚     â”‚
  â”‚  â”‚      â”œâ”€â”€ ğŸ“„ loading.js â—    â† BLUE DOT + TEXT!    â”‚     â”‚
  â”‚  â”‚      â””â”€â”€ ğŸ“„ page.js         (dashboard page)       â”‚     â”‚
  â”‚  â”‚                                                     â”‚     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
  â”‚                                                              â”‚
  â”‚  BLUE DOT (â—):                                                â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â†’ loading.js Ä‘Æ°á»£c HIGHLIGHT báº±ng blue dot + text!  â”‚    â”‚
  â”‚  â”‚ â†’ Cho tháº¥y vá»‹ trÃ­ Ä‘áº·t file trong route segment     â”‚    â”‚
  â”‚  â”‚ â†’ loading.js CÃ™NG LEVEL vá»›i page.js vÃ  layout.js   â”‚    â”‚
  â”‚  â”‚ â†’ CHá»ˆ áº£nh hÆ°á»Ÿng dashboard/ segment vÃ  children!    â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  HIERARCHY:                                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ app/layout.js        â†’  Root layout (outer shell)   â”‚    â”‚
  â”‚  â”‚   dashboard/layout.js â†’  Dashboard layout (nested)  â”‚    â”‚
  â”‚  â”‚     dashboard/loading.js â†’ Loading fallback!        â”‚    â”‚
  â”‚  â”‚       dashboard/page.js  â†’ Actual page content     â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚ loading.js náº±m GIá»®A layout.js vÃ  page.js!           â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š Diagram 3: Component Hierarchy â€” Suspense Mapping

```
  PHÃ‚N TÃCH DIAGRAM 3: "Component Hierarchy + Suspense Mapping"
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  SÆ¡ Ä‘á»“ PHá»¨C Táº P NHáº¤T! Gá»“m 3 pháº§n liÃªn káº¿t:                  â”‚
  â”‚                                                              â”‚
  â”‚  PHáº¦N 1 â€” loading.js CODE BLOCK (nhá», trÃ¡i):                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
  â”‚  â”‚ â”‚ // loading.js                        â”‚             â”‚    â”‚
  â”‚  â”‚ â”‚ export default function Loading() {  â”‚             â”‚    â”‚
  â”‚  â”‚ â”‚   return "Loading..."                â”‚             â”‚    â”‚
  â”‚  â”‚ â”‚ }                                     â”‚             â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
  â”‚  â”‚                â”‚                                     â”‚    â”‚
  â”‚  â”‚                â”‚ MÅ¨I TÃŠN XANH â†“                     â”‚    â”‚
  â”‚  â”‚                â–¼                                     â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  PHáº¦N 2 â€” COMPONENT HIERARCHY (code block, giá»¯a):            â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
  â”‚  â”‚ â”‚ <Layout>                                  â”‚ â”€â”€â”€â”€â”   â”‚    â”‚
  â”‚  â”‚ â”‚   <Header />                              â”‚     â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚   <SideNav />                             â”‚     â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚   <Suspense fallback={<Loading />}>       â”‚     â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚     <Page />                              â”‚     â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚   </Suspense>                             â”‚     â”‚   â”‚    â”‚
  â”‚  â”‚ â”‚ </Layout>                                 â”‚     â”‚   â”‚    â”‚
  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚    â”‚
  â”‚  â”‚                                                   â”‚   â”‚    â”‚
  â”‚  â”‚ â†’ loading.js â†’ <Loading /> component!            â”‚   â”‚    â”‚
  â”‚  â”‚ â†’ ÄÆ°á»£c dÃ¹ng lÃ m fallback cho <Suspense>!        â”‚   â”‚    â”‚
  â”‚  â”‚ â†’ <Suspense> tá»± Ä‘á»™ng wrap <Page />!             â”‚   â”‚    â”‚
  â”‚  â”‚ â†’ <Header />, <SideNav /> NGOÃ€I <Suspense>!    â”‚   â”‚    â”‚
  â”‚  â”‚   â†’ GIá»® NGUYÃŠN, luÃ´n interactive!               â”‚   â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜    â”‚
  â”‚                                                     â”‚        â”‚
  â”‚  PHáº¦N 3 â€” UI WIREFRAME (visual, pháº£i):              â”‚        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                  â”‚   â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚    â”‚
  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€ Header Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚   â”‚   â”‚   â”‚    â”‚
  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚    â”‚
  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ Side   â”‚ â”‚                        â”‚   â”‚â†â”€â”€â”˜   â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ Nav    â”‚ â”‚    "Loading..."         â”‚   â”‚       â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆ   â”‚ â”‚   (text XANH!)         â”‚   â”‚       â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆ   â”‚ â”‚                        â”‚   â”‚       â”‚    â”‚
  â”‚  â”‚  â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆ   â”‚ â”‚  (Suspense content!)   â”‚   â”‚       â”‚    â”‚
  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â†’ Header Bar = <Header /> (luÃ´n hiá»‡n!)              â”‚    â”‚
  â”‚  â”‚  â†’ SideNav = <SideNav /> (luÃ´n interactive!)         â”‚    â”‚
  â”‚  â”‚  â†’ Content area = "Loading..." (fallback!)           â”‚    â”‚
  â”‚  â”‚  â†’ MÅ¨I TÃŠN XANH ná»‘i code â†’ wireframe               â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  KEY INSIGHTS Tá»ª DIAGRAM 3:                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚ â‘  loading.js â†’ <Loading /> â†’ fallback prop!        â”‚    â”‚
  â”‚  â”‚ â‘¡ <Suspense> Tá»° Äá»˜NG wrap <Page />!                â”‚    â”‚
  â”‚  â”‚ â‘¢ <Header /> + <SideNav /> NGOÃ€I â†’ KHÃ”NG loading!  â”‚    â”‚
  â”‚  â”‚ â‘£ CHá»ˆ content area hiá»‡n "Loading..."!               â”‚    â”‚
  â”‚  â”‚ â‘¤ Layout parts INTERACTIVE trong khi page streams!  â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§7. SÆ¡ Äá»“ Tá»± Váº½ â€” Tá»•ng Há»£p!

### SÆ¡ Äá»“ 1: Streaming Timeline â€” Tá»« Request â†’ Content

```
  STREAMING TIMELINE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  User click Link â†’ navigate sang /dashboard                  â”‚
  â”‚                                                              â”‚
  â”‚  â”€â”€â”€â”€ TIMELINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’     â”‚
  â”‚                                                              â”‚
  â”‚  t0: User clicks                                             â”‚
  â”‚   â”‚                                                          â”‚
  â”‚   â–¼                                                          â”‚
  â”‚  t1: Prefetched loading.js skeleton gá»­i NGAY!               â”‚
  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚   â”‚  â”‚ <Layout>                                â”‚              â”‚
  â”‚   â”‚  â”‚   <Header /> â† interactive!            â”‚              â”‚
  â”‚   â”‚  â”‚   <SideNav /> â† interactive!           â”‚              â”‚
  â”‚   â”‚  â”‚   <Suspense fallback={<Loading />}>     â”‚              â”‚
  â”‚   â”‚  â”‚     ğŸ”„ Loading... (skeleton hiá»‡n!)      â”‚              â”‚
  â”‚   â”‚  â”‚   </Suspense>                           â”‚              â”‚
  â”‚   â”‚  â”‚ </Layout>                               â”‚              â”‚
  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚   â”‚                                                          â”‚
  â”‚   â”‚  User tháº¥y: Header + SideNav + Skeleton!                â”‚
  â”‚   â”‚  User CÃ“ THá»‚ click sidebar links! (interactive!)        â”‚
  â”‚   â”‚                                                          â”‚
  â”‚   â–¼                                                          â”‚
  â”‚  t2: Server Ä‘ang fetch data... (streaming!)                  â”‚
  â”‚   â”‚  â†’ Navigation INTERRUPTIBLE!                             â”‚
  â”‚   â”‚  â†’ User Ä‘á»•i Ã½? Click khÃ¡c? â†’ OK!                       â”‚
  â”‚   â”‚                                                          â”‚
  â”‚   â–¼                                                          â”‚
  â”‚  t3: Data DONE! Content streams vÃ o client!                  â”‚
  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
  â”‚   â”‚  â”‚ <Layout>                                â”‚              â”‚
  â”‚   â”‚  â”‚   <Header /> â† UNCHANGED!              â”‚              â”‚
  â”‚   â”‚  â”‚   <SideNav /> â† UNCHANGED!             â”‚              â”‚
  â”‚   â”‚  â”‚   <Suspense>                            â”‚              â”‚
  â”‚   â”‚  â”‚     <Page /> â† SWAPPED IN! âœ…          â”‚              â”‚
  â”‚   â”‚  â”‚   </Suspense>                           â”‚              â”‚
  â”‚   â”‚  â”‚ </Layout>                               â”‚              â”‚
  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
  â”‚   â”‚                                                          â”‚
  â”‚   â–¼                                                          â”‚
  â”‚  t4: Hydration â†’ Page interactive!                          â”‚
  â”‚      â†’ Selective hydration based on user interaction!        â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SÆ¡ Äá»“ 2: loading.js vs Manual Suspense â€” Granularity

```
  GRANULARITY COMPARISON:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  CÃCH 1: loading.js (AUTO â€” page-level)                      â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€  Header  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚      â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—        â”‚    â”‚
  â”‚  â”‚  â”‚ Side  â”‚ â•‘                               â•‘        â”‚    â”‚
  â”‚  â”‚  â”‚ Nav   â”‚ â•‘    ğŸ”„ TOÃ€N Bá»˜ page loading!   â•‘        â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â•‘    (1 skeleton cho cáº£ page)   â•‘        â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â•‘                               â•‘        â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â•‘    â† loading.js fallback!     â•‘        â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•        â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â”‚  CÃCH 2: Manual <Suspense> (MANUAL â€” component-level)        â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€  Header  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚      â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
  â”‚  â”‚  â”‚ Side  â”‚ â”‚               â”‚ â”‚              â”‚      â”‚    â”‚
  â”‚  â”‚  â”‚ Nav   â”‚ â”‚ ğŸ”„ PostFeed   â”‚ â”‚ âœ… Weather   â”‚      â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â”‚  (loading...) â”‚ â”‚  (loaded!)   â”‚      â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â”‚               â”‚ â”‚              â”‚      â”‚    â”‚
  â”‚  â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆ  â”‚ â”‚  Suspense #1  â”‚ â”‚ Suspense #2  â”‚      â”‚    â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â”‚  â†’ Má»—i component cÃ³ Suspense RIÃŠNG!                 â”‚    â”‚
  â”‚  â”‚  â†’ Weather xong trÆ°á»›c â†’ hiá»‡n trÆ°á»›c!                  â”‚    â”‚
  â”‚  â”‚  â†’ PostFeed váº«n loading â†’ skeleton riÃªng!            â”‚    â”‚
  â”‚  â”‚  â†’ INDEPENDENT streaming!                            â”‚    â”‚
  â”‚  â”‚                                                      â”‚    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SÆ¡ Äá»“ 3: Status Code â€” Streaming Timeline

```
  STATUS CODE + STREAMING TIMING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                              â”‚
  â”‚  â”€â”€â”€â”€ RESPONSE TIMELINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’     â”‚
  â”‚                                                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
  â”‚  â”‚ Response Headers â”‚ â†’ Status: 200                         â”‚
  â”‚  â”‚ (SENT FIRST!)    â”‚ â†’ ÄÃƒ Cá» Äá»ŠNH! KhÃ´ng thá»ƒ Ä‘á»•i!       â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚           â”‚                                                  â”‚
  â”‚           â–¼                                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
  â”‚  â”‚ notFound()?      â”‚ â† PHáº¢I gá»i TRÆ¯á»šC Ä‘Ã¢y!                â”‚
  â”‚  â”‚ redirect()?      â”‚ â† Náº¿u cáº§n 404/redirect tháº­t!         â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚           â”‚                                                  â”‚
  â”‚           â–¼                                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
  â”‚  â”‚ Suspense fallbackâ”‚ â†’ loading.js renders!                 â”‚
  â”‚  â”‚ (Body streaming  â”‚ â†’ HTML báº¯t Ä‘áº§u stream!               â”‚
  â”‚  â”‚  STARTS!)        â”‚ â†’ KHÃ”NG THá»‚ Ä‘á»•i status ná»¯a!          â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚           â”‚                                                  â”‚
  â”‚           â–¼                                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
  â”‚  â”‚ Server Component â”‚ â†’ await fetch(...)                    â”‚
  â”‚  â”‚ suspends!        â”‚ â†’ Data loading...                     â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚           â”‚                                                  â”‚
  â”‚           â–¼                                                  â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
  â”‚  â”‚ Content done!    â”‚ â†’ Swap vÃ o <Suspense>!                â”‚
  â”‚  â”‚ Stream complete! â”‚ â†’ Connection Ä‘Ã³ng!                    â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
  â”‚                                                              â”‚
  â”‚  âš ï¸ Náº¿u cáº§n 404 tháº­t:                                       â”‚
  â”‚  â†’ Kiá»ƒm tra resource Tá»’N Táº I trÆ°á»›c khi stream!             â”‚
  â”‚  â†’ Gá»i notFound() trÆ°á»›c Suspense boundary!                  â”‚
  â”‚  â†’ Náº¿u 404 stream: Next.js thÃªm <meta noindex>             â”‚
  â”‚                                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§8. Tá»± Viáº¿t â€” LoadingEngine!

```javascript
/**
 * LoadingEngine â€” MÃ´ phá»ng Next.js loading.js System!
 * Tá»± viáº¿t báº±ng tay, KHÃ”NG dÃ¹ng thÆ° viá»‡n nÃ o!
 * Covers: Suspense wrapping, streaming simulation,
 *         fallback/swap mechanism, status code behavior
 */
var LoadingEngine = (function () {

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 1. COMPONENT HIERARCHY BUILDER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function buildComponentHierarchy(routeSegment) {
    var hasLoadingFile = routeSegment.files &&
      routeSegment.files.indexOf('loading.js') !== -1;
    var hasPageFile = routeSegment.files &&
      routeSegment.files.indexOf('page.js') !== -1;
    var hasLayoutFile = routeSegment.files &&
      routeSegment.files.indexOf('layout.js') !== -1;

    var hierarchy = [];

    if (hasLayoutFile) {
      hierarchy.push({
        component: '<Layout>',
        reRendersOnNav: false,
        note: 'Outermost â€” preserved on navigation!'
      });
    }

    if (hasLoadingFile && hasPageFile) {
      hierarchy.push({
        component: '<Suspense fallback={<Loading />}>',
        autoGenerated: true,
        note: 'Next.js Tá»° Äá»˜NG wrap page trong Suspense!'
      });
      hierarchy.push({
        component: '<Page />',
        insideSuspense: true,
        note: 'Content streamed â€” swap khi done!'
      });
    } else if (hasPageFile) {
      hierarchy.push({
        component: '<Page />',
        insideSuspense: false,
        note: 'KhÃ´ng cÃ³ loading.js â†’ khÃ´ng cÃ³ Suspense auto-wrap!'
      });
    }

    return {
      segment: routeSegment.path,
      files: routeSegment.files,
      hierarchy: hierarchy,
      hasSuspenseBoundary: hasLoadingFile
    };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 2. STREAMING SIMULATOR
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function simulateStreaming(components) {
    var timeline = [];
    var statusCode = 200;

    // Step 1: Headers sent
    timeline.push({
      time: 't0',
      event: 'Response headers sent',
      statusCode: statusCode,
      note: 'Status code Cá» Äá»ŠNH tá»« Ä‘Ã¢y! KhÃ´ng thá»ƒ Ä‘á»•i!'
    });

    // Step 2: Layout + Loading fallback
    timeline.push({
      time: 't1',
      event: 'Layout renders + Loading fallback hiá»‡n!',
      visible: ['<Layout />', '<Header />', '<SideNav />', '<Loading />'],
      interactive: ['Header', 'SideNav'],
      note: 'Shared UI interactive! Chá»‰ content area loading!'
    });

    // Step 3: Server Component suspends
    for (var i = 0; i < components.length; i++) {
      var comp = components[i];
      timeline.push({
        time: 't' + (i + 2),
        event: comp.name + ' data loaded!',
        action: 'SWAP: Loading fallback â†’ ' + comp.name + ' content!',
        duration: comp.estimatedMs + 'ms'
      });
    }

    // Final: All done
    timeline.push({
      time: 't_final',
      event: 'All content streamed! Hydration begins.',
      note: 'Selective hydration: React Æ°u tiÃªn component user tÆ°Æ¡ng tÃ¡c!'
    });

    return { timeline: timeline };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 3. STATUS CODE CHECKER
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function checkStatusCodeBehavior(scenario) {
    switch (scenario) {
      case 'normal':
        return {
          httpStatus: 200,
          behavior: 'Content streams bÃ¬nh thÆ°á»ng!',
          seo: 'Indexable â€” no issues!'
        };
      case '404-after-stream':
        return {
          httpStatus: 200,
          actualStatus: '404 (soft)',
          behavior: 'HTTP váº«n 200 vÃ¬ headers Ä‘Ã£ gá»­i!',
          mitigation: 'Next.js thÃªm <meta name="robots" content="noindex">',
          googleLabel: 'Soft 404 â€” KHÃ”NG bá»‹ index!',
          solution: 'Gá»i notFound() TRÆ¯á»šC Suspense boundary!'
        };
      case '404-before-stream':
        return {
          httpStatus: 404,
          behavior: 'Kiá»ƒm tra resource trÆ°á»›c khi stream!',
          method: 'DÃ¹ng proxy hoáº·c notFound() trÆ°á»›c await!',
          seo: 'Real 404 â€” proper SEO handling!'
        };
      default:
        return { error: 'Unknown scenario!' };
    }
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // 4. SUSPENSE COMPARISON
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function compareSuspenseApproaches() {
    return {
      loadingJs: {
        name: 'loading.js (Automatic)',
        scope: 'ToÃ n bá»™ page.js',
        autoWrap: true,
        granularity: 'ThÃ´ â€” 1 skeleton cho cáº£ page!',
        parameters: 'KHÃ”NG nháº­n parameters!',
        useCase: 'Page-level loading (Ä‘Æ¡n giáº£n, nhanh!)',
        componentType: 'Server Component (máº·c Ä‘á»‹nh)',
        canBeClient: true
      },
      manualSuspense: {
        name: '<Suspense> Manual',
        scope: 'Tá»«ng component riÃªng biá»‡t',
        autoWrap: false,
        granularity: 'Má»‹n â€” má»—i component 1 skeleton!',
        parameters: 'N/A â€” tá»± set fallback prop!',
        useCase: 'Component-level (fine-grained streaming!)',
        benefits: [
          'Streaming Server Rendering (dáº§n dáº§n)',
          'Selective Hydration (Æ°u tiÃªn interaction)'
        ]
      }
    };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // DEMO
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function demo() {
    console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
    console.log('â•‘  LOADING ENGINE â€” DEMO                    â•‘');
    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');

    // 1. Component Hierarchy
    console.log('\nâ”€â”€â”€ 1. COMPONENT HIERARCHY â”€â”€â”€');
    console.log(JSON.stringify(buildComponentHierarchy({
      path: '/dashboard',
      files: ['layout.js', 'loading.js', 'page.js']
    }), null, 2));

    console.log(JSON.stringify(buildComponentHierarchy({
      path: '/about',
      files: ['page.js']
    }), null, 2));

    // 2. Streaming Sim
    console.log('\nâ”€â”€â”€ 2. STREAMING SIM â”€â”€â”€');
    console.log(JSON.stringify(simulateStreaming([
      { name: 'PostFeed', estimatedMs: 800 },
      { name: 'Weather', estimatedMs: 300 }
    ]), null, 2));

    // 3. Status Code
    console.log('\nâ”€â”€â”€ 3. STATUS CODES â”€â”€â”€');
    console.log('Normal:', JSON.stringify(
      checkStatusCodeBehavior('normal'), null, 2));
    console.log('404 after stream:', JSON.stringify(
      checkStatusCodeBehavior('404-after-stream'), null, 2));
    console.log('404 before stream:', JSON.stringify(
      checkStatusCodeBehavior('404-before-stream'), null, 2));

    // 4. Comparison
    console.log('\nâ”€â”€â”€ 4. SUSPENSE COMPARISON â”€â”€â”€');
    console.log(JSON.stringify(compareSuspenseApproaches(), null, 2));

    console.log('\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
    console.log('â•‘  âœ… Demo Complete!                         â•‘');
    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  }

  return {
    buildComponentHierarchy: buildComponentHierarchy,
    simulateStreaming: simulateStreaming,
    checkStatusCodeBehavior: checkStatusCodeBehavior,
    compareSuspenseApproaches: compareSuspenseApproaches,
    demo: demo
  };
})();

// Cháº¡y: LoadingEngine.demo();
```

---

## Â§9. CÃ¢u Há»i Luyá»‡n Táº­p!

### â“ CÃ¢u 1: loading.js tá»± Ä‘á»™ng táº¡o cáº¥u trÃºc component nÃ o?

**Tráº£ lá»i:**

Next.js tá»± Ä‘á»™ng wrap `page.js` trong `<Suspense>` boundary vá»›i `loading.js` lÃ m fallback:

```
<Layout>
  <Header />          â† NGOÃ€I Suspense! LuÃ´n interactive!
  <SideNav />         â† NGOÃ€I Suspense! LuÃ´n interactive!
  <Suspense fallback={<Loading />}>
    <Page />          â† BÃŠN TRONG Suspense! Streaming!
  </Suspense>
</Layout>
```

â†’ Layout parts **interactive** trong khi page **streams**!

### â“ CÃ¢u 2: loading.js cÃ³ nháº­n parameters khÃ´ng?

**Tráº£ lá»i:**

**KHÃ”NG!** Loading UI components khÃ´ng nháº­n **báº¥t ká»³ parameter nÃ o**.

- KhÃ´ng cÃ³ `params`, khÃ´ng cÃ³ `searchParams`, khÃ´ng cÃ³ props
- VÃ¬ loading.js lÃ  **fallback tÄ©nh** â€” hiá»‡n ngay láº­p tá»©c khi navigate
- ÄÃ£ Ä‘Æ°á»£c **prefetched** sáºµn!

### â“ CÃ¢u 3: Táº¡i sao streaming luÃ´n tráº£ vá» status 200?

**Tráº£ lá»i:**

VÃ¬ **response headers** (bao gá»“m status code) pháº£i gá»­i **TRÆ¯á»šC KHI** body streaming báº¯t Ä‘áº§u!

- Headers gá»­i â†’ status 200 â†’ **Cá» Äá»ŠNH!**
- Body báº¯t Ä‘áº§u stream â†’ khÃ´ng thá»ƒ Ä‘á»•i status ná»¯a!
- Náº¿u cáº§n 404 tháº­t: gá»i `notFound()` **TRÆ¯á»šC** Suspense boundary!
- Náº¿u 404 sau stream: Next.js thÃªm `<meta name="robots" content="noindex">` â†’ "soft 404"

### â“ CÃ¢u 4: Sá»± khÃ¡c biá»‡t loading.js vs manual <Suspense>?

**Tráº£ lá»i:**

| TiÃªu chÃ­ | `loading.js` | `<Suspense>` manual |
|---|---|---|
| Scope | **ToÃ n bá»™** page | **Tá»«ng** component |
| Auto wrap | âœ… Tá»± Ä‘á»™ng | âŒ Pháº£i tá»± viáº¿t |
| Granularity | ThÃ´ (1 skeleton/page) | Má»‹n (per component) |
| Independent loading | âŒ Cáº£ page 1 láº§n | âœ… Má»—i component riÃªng! |
| Use case | Page-level Ä‘Æ¡n giáº£n | Fine-grained streaming |

### â“ CÃ¢u 5: Navigation interruptible nghÄ©a lÃ  gÃ¬?

**Tráº£ lá»i:**

User **KHÃ”NG cáº§n Ä‘á»£i** route hiá»‡n táº¡i load xong!

- Äang navigate sang Route A (loading...)
- User Ä‘á»•i Ã½ â†’ click Route B
- â†’ Route A bá»‹ **Há»¦Y!** â†’ Chuyá»ƒn ngay sang Route B!
- Shared layouts (header, sidebar) **luÃ´n interactive** â†’ user luÃ´n click Ä‘Æ°á»£c!

### â“ CÃ¢u 6: Streaming cÃ³ áº£nh hÆ°á»Ÿng SEO khÃ´ng?

**Tráº£ lá»i:**

**KHÃ”NG!** Streaming server-rendered **khÃ´ng áº£nh hÆ°á»Ÿng SEO**.

- **Bots** (Twitter, etc.): Next.js resolve `generateMetadata` **TRÆ¯á»šC** streaming â†’ metadata náº±m trong `<head>` initial HTML
- **Browsers**: cÃ³ thá»ƒ dÃ¹ng streaming metadata â€” Next.js auto detect user-agent
- Kiá»ƒm tra: dÃ¹ng Google **Rich Results Test** tool

---

> ğŸ¯ **Tá»•ng káº¿t**: Guide phÃ¢n tÃ­ch TOÃ€N Bá»˜ trang `loading.js`:
> - **3 diagrams** tá»« trang gá»‘c: loading state transition, file tree, component hierarchy + Suspense mapping
> - **3 sÆ¡ Ä‘á»“ tá»± váº½**: streaming timeline, granularity comparison, status code timeline
> - **LoadingEngine** tá»± viáº¿t vá»›i 4 functions mÃ´ phá»ng
> - **6 cÃ¢u há»i luyá»‡n táº­p** vá»›i Ä‘Ã¡p Ã¡n chi tiáº¿t
> - **Platform Support**: Node.js server, Docker, Static export, Adapters
> - **Version History**: v13.0.0 (loading introduced)
