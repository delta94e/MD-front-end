# WebSocket & SSE â€” Real-Time Communication Deep Dive

> ğŸ“… 2026-02-11 Â· â± 25 phÃºt Ä‘á»c
>
> PhÃ¢n tÃ­ch chuyÃªn sÃ¢u vá» WebSocket, SSE (Server-Sent Events), vÃ  cÃ¡c ká»¹ thuáº­t real-time communication.
> Bao gá»“m: WebSocket Protocol, Handshake, Polling vs Long Polling vs SSE vs WebSocket,
> AI Streaming patterns, Nginx pitfalls, vÃ  cÃ¢u há»i phá»ng váº¥n.
> Äá»™ khÃ³: â­ï¸â­ï¸â­ï¸â­ï¸ | Chá»§ Ä‘á»: Network Protocol + Real-Time + TypeScript

---

## Má»¥c Lá»¥c

**PHáº¦N I â€” Ná»€N Táº¢NG REAL-TIME**

0. [WebSocket LÃ  GÃ¬? â€” Hiá»ƒu Tá»« Gá»‘c](#0-websocket-lÃ -gÃ¬--hiá»ƒu-tá»«-gá»‘c)
1. [So SÃ¡nh 4 Ká»¹ Thuáº­t Real-Time](#1-so-sÃ¡nh-4-ká»¹-thuáº­t-real-time)

**PHáº¦N II â€” SSE CHO AI STREAMING**

2. [SSE LÃ  GÃ¬?](#2-sse-lÃ -gÃ¬)
3. [Sá»­ Dá»¥ng CÆ¡ Báº£n â€” EventSource](#3-sá»­-dá»¥ng-cÆ¡-báº£n--eventsource)
4. [Thá»±c Chiáº¿n â€” Fetch SSE Cho AI](#4-thá»±c-chiáº¿n--fetch-sse-cho-ai)
5. [Nginx â€” Báº«y Cháº¿t NgÆ°á»i](#5-nginx--báº«y-cháº¿t-ngÆ°á»i)

**PHáº¦N III â€” SO SÃNH & KIáº¾N TRÃšC**

6. [SSE vs WebSocket â€” So SÃ¡nh Chi Tiáº¿t](#6-sse-vs-websocket--so-sÃ¡nh-chi-tiáº¿t)
7. [Táº¡i Sao AI Chá»n SSE Thay VÃ¬ WebSocket?](#7-táº¡i-sao-ai-chá»n-sse-thay-vÃ¬-websocket)
8. [Kiáº¿n TrÃºc Tá»•ng Quan Streaming](#8-kiáº¿n-trÃºc-tá»•ng-quan-streaming)
9. [CÃ¢u Há»i Phá»ng Váº¥n](#9-cÃ¢u-há»i-phá»ng-váº¥n)

---

## 0. WebSocket LÃ  GÃ¬? â€” Hiá»ƒu Tá»« Gá»‘c

> **ğŸ¯ Há»c xong pháº§n nÃ y, báº¡n sáº½ biáº¿t:**
>
> - WebSocket protocol hoáº¡t Ä‘á»™ng tháº¿ nÃ o (handshake, frames, close)
> - Táº¡i sao WebSocket ra Ä‘á»i vÃ  giáº£i quyáº¿t váº¥n Ä‘á» gÃ¬ cá»§a HTTP
> - API cÆ¡ báº£n cá»§a WebSocket trong browser

### WebSocket â€” Giáº£i thÃ­ch cho Beginner

```
WEBSOCKET â€” Táº I SAO Cáº¦N RÃ•?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  TRÆ¯á»šC KHI CÃ“ WEBSOCKET:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  HTTP = "Gá»­i thÆ° qua bÆ°u Ä‘iá»‡n":                         â”‚
  â”‚                                                          â”‚
  â”‚  Client â”€â”€â”€â”€ Request â”€â”€â”€â”€â–º Server                       â”‚
  â”‚         â—„â”€â”€ Response â”€â”€â”€â”€â”€                              â”‚
  â”‚  (káº¿t ná»‘i ÄÃ“NG)                                          â”‚
  â”‚                                                          â”‚
  â”‚  Client â”€â”€â”€â”€ Request â”€â”€â”€â”€â–º Server                       â”‚
  â”‚         â—„â”€â”€ Response â”€â”€â”€â”€â”€                              â”‚
  â”‚  (káº¿t ná»‘i ÄÃ“NG láº¡i)                                      â”‚
  â”‚                                                          â”‚
  â”‚  â†’ Má»–I Láº¦N há»i â†’ pháº£i Gá»¬I THÆ¯ Má»šI                     â”‚
  â”‚  â†’ Server KHÃ”NG THá»‚ chá»§ Ä‘á»™ng gá»­i tin cho Client         â”‚
  â”‚  â†’ ÄÃ¢y gá»i lÃ  "half-duplex" = Ná»¬A HAI CHIá»€U            â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  SAU KHI CÃ“ WEBSOCKET:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  WebSocket = "Gá»i Ä‘iá»‡n thoáº¡i":                           â”‚
  â”‚                                                          â”‚
  â”‚  Client â”€â”€â”€â”€ Gá»i Ä‘iá»‡n â”€â”€â”€â”€â–º Server                      â”‚
  â”‚  (Má» ÄÆ¯á»œNG DÃ‚Y THÆ¯á»œNG TRá»°C)                             â”‚
  â”‚                                                          â”‚
  â”‚         â”€â”€â”€â”€ nÃ³i â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                             â”‚
  â”‚         â—„â”€â”€â”€â”€ nghe â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
  â”‚         â”€â”€â”€â”€ nÃ³i â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                             â”‚
  â”‚         â—„â”€â”€â”€â”€ nghe â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
  â”‚         â—„â”€â”€â”€â”€ server nÃ³i â”€â”€  â† Server CHá»¦ Äá»˜NG nÃ³i!    â”‚
  â”‚         â”€â”€â”€â”€ client nÃ³i â”€â”€â–º                              â”‚
  â”‚                                                          â”‚
  â”‚  â†’ Cáº¢ HAI chiá»u, Báº¤T Ká»² LÃšC NÃ€O                       â”‚
  â”‚  â†’ ÄÃ¢y gá»i lÃ  "full-duplex" = HAI CHIá»€U HOÃ€N TOÃ€N      â”‚
  â”‚  â†’ Káº¿t ná»‘i PERSISTENT (khÃ´ng Ä‘Ã³ng sau má»—i message)      â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7 Äáº·c Ä‘iá»ƒm cá»§a WebSocket

```
Äáº¶C ÄIá»‚M WEBSOCKET:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  â‘  HAI CHIá»€U (Full-Duplex):                              â”‚
  â”‚     â†’ Server cÃ³ thá»ƒ CHá»¦ Äá»˜NG push tin nháº¯n cho client   â”‚
  â”‚     â†’ Client cÅ©ng cÃ³ thá»ƒ gá»­i message báº¥t ká»³ lÃºc nÃ o    â”‚
  â”‚     â†’ KhÃ´ng cáº§n chá» request/response nhÆ° HTTP            â”‚
  â”‚                                                          â”‚
  â”‚  â‘¡ Há»– TRá»¢ TEXT + BINARY:                                â”‚
  â”‚     â†’ Gá»­i Ä‘Æ°á»£c JSON strings                              â”‚
  â”‚     â†’ Gá»­i Ä‘Æ°á»£c ArrayBuffer, Blob (hÃ¬nh áº£nh, audio)      â”‚
  â”‚                                                          â”‚
  â”‚  â‘¢ Dá»°A TRÃŠN TCP:                                         â”‚
  â”‚     â†’ Tin cáº­y, thá»© tá»± Ä‘áº£m báº£o                           â”‚
  â”‚     â†’ Server implementation tÆ°Æ¡ng Ä‘á»‘i dá»…                 â”‚
  â”‚                                                          â”‚
  â”‚  â‘£ Dá»® LIá»†U NHáº¸:                                          â”‚
  â”‚     â†’ Header overhead chá»‰ 2-14 bytes per frame          â”‚
  â”‚     â†’ So vá»›i HTTP: 200-800 bytes header Má»–I request     â”‚
  â”‚     â†’ Hiá»‡u suáº¥t communication Ráº¤T CAO                   â”‚
  â”‚                                                          â”‚
  â”‚  â‘¤ KHÃ”NG CÃ“ SAME-ORIGIN RESTRICTION:                     â”‚
  â”‚     â†’ Client káº¿t ná»‘i Ä‘áº¿n Báº¤T Ká»² server nÃ o             â”‚
  â”‚     â†’ KhÃ´ng bá»‹ CORS block nhÆ° HTTP requests              â”‚
  â”‚                                                          â”‚
  â”‚  â‘¥ PROTOCOL IDENTIFIER:                                   â”‚
  â”‚     â†’ ws://  (khÃ´ng mÃ£ hÃ³a, port 80)                    â”‚
  â”‚     â†’ wss:// (cÃ³ mÃ£ hÃ³a TLS, port 443)                  â”‚
  â”‚     â†’ Giá»‘ng http:// vs https://                          â”‚
  â”‚                                                          â”‚
  â”‚  â‘¦ TÆ¯Æ NG THÃCH HTTP:                                      â”‚
  â”‚     â†’ Handshake dÃ¹ng HTTP upgrade                        â”‚
  â”‚     â†’ Port máº·c Ä‘á»‹nh 80/443 (giá»‘ng HTTP)                  â”‚
  â”‚     â†’ Äi qua Ä‘Æ°á»£c HTTP proxy servers                     â”‚
  â”‚     â†’ Firewall Ã­t khi cháº·n vÃ¬ táº­n dá»¥ng HTTP port        â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### WebSocket Handshake â€” CÃ¡ch káº¿t ná»‘i

```
WEBSOCKET HANDSHAKE = "Báº®T TAY" GIá»®A CLIENT & SERVER:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  BÆ°á»›c 1: Client gá»­i HTTP upgrade request:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  GET /chat HTTP/1.1                                      â”‚
  â”‚  Host: server.example.com                                â”‚
  â”‚  Upgrade: websocket              â† "TÃ´i muá»‘n upgrade!" â”‚
  â”‚  Connection: Upgrade             â† "Chuyá»ƒn protocol"    â”‚
  â”‚  Sec-WebSocket-Key: dGhlIHNhbX...â† Random key (Base64) â”‚
  â”‚  Sec-WebSocket-Version: 13       â† Version 13 (chuáº©n)  â”‚
  â”‚  Origin: http://example.com      â† CORS check          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ Server Ä‘á»“ng Ã½
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  HTTP/1.1 101 Switching Protocols â† Status 101!         â”‚
  â”‚  Upgrade: websocket                                      â”‚
  â”‚  Connection: Upgrade                                     â”‚
  â”‚  Sec-WebSocket-Accept: s3pPLMB...â† Computed from Key   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ Tá»« Ä‘Ã¢y trá»Ÿ Ä‘i
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  KHÃ”NG CÃ’N HTTP Ná»®A!                                     â”‚
  â”‚  â†’ Chuyá»ƒn sang WebSocket protocol                        â”‚
  â”‚  â†’ Gá»­i/nháº­n data báº±ng WebSocket frames                  â”‚
  â”‚  â†’ Káº¿t ná»‘i PERSISTENT cho Ä‘áº¿n khi close                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  NGUYÃŠN LÃ HOáº T Äá»˜NG:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Client gá»­i event kÃ¨m danh sÃ¡ch recipient IDs
  â†’ Server nháº­n â†’ thÃ´ng bÃ¡o cho Táº¤T Cáº¢ active clients
  â†’ Chá»‰ client nÃ o cÃ³ ID trong danh sÃ¡ch má»›i xá»­ lÃ½ event
```

### WebSocket API â€” Sá»­ dá»¥ng trong Browser

```typescript
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WEBSOCKET CLIENT â€” API CÆ  Báº¢N
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// â‘  Táº¡o káº¿t ná»‘i WebSocket
const ws = new WebSocket("ws://localhost:9999");

// â‘¡ Khi káº¿t ná»‘i THÃ€NH CÃ”NG (handshake xong)
ws.onopen = function () {
  console.log("Connection open.");
  ws.send("hello"); // Gá»­i text message
  ws.send(
    JSON.stringify({
      // Gá»­i JSON
      type: "chat",
      message: "Xin chÃ o!",
    }),
  );
};

// â‘¢ Khi NHáº¬N message tá»« server
ws.onmessage = function (event) {
  console.log(event); // MessageEvent object
  console.log(event.data); // Ná»™i dung message

  // Parse náº¿u server gá»­i JSON:
  const data = JSON.parse(event.data);
};

// â‘£ Khi káº¿t ná»‘i bá»‹ ÄÃ“NG
ws.onclose = function (event) {
  console.log("Connection closed.");
  console.log(event.code); // Close code (1000 = normal)
  console.log(event.reason); // Close reason
};

// â‘¤ Khi cÃ³ Lá»–I
ws.onerror = function (error) {
  console.error("WebSocket error:", error);
};

// â‘¥ Chá»§ Ä‘á»™ng ÄÃ“NG káº¿t ná»‘i
ws.close(1000, "User logout");

// â‘¦ Kiá»ƒm tra tráº¡ng thÃ¡i káº¿t ná»‘i
console.log(ws.readyState);
// 0 = CONNECTING (Ä‘ang káº¿t ná»‘i)
// 1 = OPEN       (Ä‘Ã£ káº¿t ná»‘i, sáºµn sÃ ng)
// 2 = CLOSING    (Ä‘ang Ä‘Ã³ng)
// 3 = CLOSED     (Ä‘Ã£ Ä‘Ã³ng)
```

#### ğŸ“– Giáº£i thÃ­ch WebSocket API cho ngÆ°á»i má»›i:

```
WEBSOCKET LIFECYCLE â€” VÃ’NG Äá»œI Káº¾T Ná»I:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚CONNECTINGâ”‚ â†’  â”‚   OPEN   â”‚ â†’  â”‚ CLOSING  â”‚ â†’  â”‚  CLOSED  â”‚
  â”‚ (state 0)â”‚    â”‚(state 1) â”‚    â”‚(state 2) â”‚    â”‚(state 3) â”‚
  â”‚ new WS() â”‚    â”‚ onopen() â”‚    â”‚ close()  â”‚    â”‚ onclose()â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚          â”‚
                  â”‚ onmessageâ”‚ â† Nháº­n data
                  â”‚ ws.send()â”‚ â†’ Gá»­i data
                  â”‚          â”‚
                  â”‚ onerror  â”‚ â† Lá»—i xáº£y ra

  MESSAGE TYPES â€” LOáº I DATA Gá»¬I ÄÆ¯á»¢C:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ws.send("Hello")           â†’ String (text)              â”‚
  â”‚ ws.send(JSON.stringify({}))â†’ JSON (váº«n lÃ  string)       â”‚
  â”‚ ws.send(arrayBuffer)       â†’ Binary (ArrayBuffer)       â”‚
  â”‚ ws.send(blob)              â†’ Binary (Blob)              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  BEST PRACTICES:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ âœ… Kiá»ƒm tra readyState trÆ°á»›c khi send()                 â”‚
  â”‚ âœ… Implement heartbeat (ping/pong) Ä‘á»ƒ detect disconnect â”‚
  â”‚ âœ… Auto-reconnect khi bá»‹ máº¥t káº¿t ná»‘i                    â”‚
  â”‚ âœ… DÃ¹ng wss:// trong production (mÃ£ hÃ³a TLS)           â”‚
  â”‚ âœ… Handle onclose + onerror Ä‘á»ƒ cleanup resources        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. So SÃ¡nh 4 Ká»¹ Thuáº­t Real-Time

> **ğŸ¯ Há»c xong pháº§n nÃ y, báº¡n sáº½ biáº¿t:**
>
> - 4 cÃ¡ch thá»±c hiá»‡n real-time communication trÃªn web
> - Æ¯u nhÆ°á»£c Ä‘iá»ƒm cá»§a tá»«ng cÃ¡ch
> - Khi nÃ o dÃ¹ng ká»¹ thuáº­t nÃ o

### Short Polling vs Long Polling vs SSE vs WebSocket

```
4 Ká»¸ THUáº¬T REAL-TIME COMMUNICATION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â‘  SHORT POLLING = "Há»i liÃªn tá»¥c":
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Client:  "CÃ³ data má»›i khÃ´ng?"                           â”‚
  â”‚  Server:  "KhÃ´ng" â†’ Client ÄÃ“NG                         â”‚
  â”‚  (2 giÃ¢y sau...)                                         â”‚
  â”‚  Client:  "CÃ³ data má»›i khÃ´ng?"                           â”‚
  â”‚  Server:  "KhÃ´ng" â†’ Client ÄÃ“NG                         â”‚
  â”‚  (2 giÃ¢y sau...)                                         â”‚
  â”‚  Client:  "CÃ³ data má»›i khÃ´ng?"                           â”‚
  â”‚  Server:  "CÃ“! ÄÃ¢y nÃ¨" â†’ Client ÄÃ“NG                   â”‚
  â”‚                                                          â”‚
  â”‚  â†’ setInterval(() => fetch('/api/data'), 2000)          â”‚
  â”‚  â†’ ÄÆ¡n giáº£n nhÆ°ng LÃƒNG PHÃ (99% request = rá»—ng)       â”‚
  â”‚  â†’ Server load TÄ‚NG theo sá»‘ user                        â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â‘¡ LONG POLLING = "Há»i rá»“i Äá»¢I":
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Client:  "CÃ³ data má»›i khÃ´ng?"                           â”‚
  â”‚  Server:  (im láº·ng... chá»... chá»... 30 giÃ¢y...)        â”‚
  â”‚  Server:  "CÃ“! ÄÃ¢y nÃ¨" â†’ Client ÄÃ“NG                   â”‚
  â”‚  Client:  "CÃ³ data má»›i khÃ´ng?" (gá»­i láº¡i ngay)           â”‚
  â”‚  Server:  (im láº·ng... chá»...)                            â”‚
  â”‚                                                          â”‚
  â”‚  â†’ ÃT request hÆ¡n short polling (chá»‰ response khi cÃ³)  â”‚
  â”‚  â†’ NhÆ°ng káº¿t ná»‘i bá»‹ TREO = váº«n tá»‘n resource server     â”‚
  â”‚  â†’ Server pháº£i quáº£n lÃ½ pending connections              â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â‘¢ SSE (Server-Sent Events) = "ÄÄƒng kÃ½ nháº­n tin":
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Client:  "TÃ´i muá»‘n nghe tin tá»©c!"                       â”‚
  â”‚  Server:  "OK, má»Ÿ kÃªnh streaming..."                     â”‚
  â”‚  Server:  â”€â”€â”€â”€ data: tin 1 â”€â”€â”€â”€â”€â”€â–º                      â”‚
  â”‚  Server:  â”€â”€â”€â”€ data: tin 2 â”€â”€â”€â”€â”€â”€â–º                      â”‚
  â”‚  Server:  â”€â”€â”€â”€ data: tin 3 â”€â”€â”€â”€â”€â”€â–º                      â”‚
  â”‚  (Client chá»‰ NGHE, muá»‘n nÃ³i â†’ gá»­i HTTP request má»›i)    â”‚
  â”‚                                                          â”‚
  â”‚  â†’ Má»˜T CHIá»€U: Server â†’ Client                          â”‚
  â”‚  â†’ Dá»±a trÃªn HTTP (Content-Type: text/event-stream)     â”‚
  â”‚  â†’ Auto reconnect bá»Ÿi browser                           â”‚
  â”‚  â†’ TIáº¾T KIá»†M hÆ¡n polling nhiá»u                         â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â‘£ WEBSOCKET = "Gá»i Ä‘iá»‡n thoáº¡i":
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Client:  â”€â”€â”€â”€ HTTP Upgrade â”€â”€â”€â–º Server                 â”‚
  â”‚  Server:  â—„â”€â”€ 101 Switching â”€â”€â”€â”€                        â”‚
  â”‚  (Chuyá»ƒn sang WS protocol)                               â”‚
  â”‚                                                          â”‚
  â”‚  Client:  â”€â”€â”€â”€ frame â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                        â”‚
  â”‚  Server:  â—„â”€â”€â”€â”€ frame â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
  â”‚  Server:  â—„â”€â”€â”€â”€ frame â”€â”€â”€â”€â”€â”€â”€â”€â”€  (server push!)         â”‚
  â”‚  Client:  â”€â”€â”€â”€ frame â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º                        â”‚
  â”‚                                                          â”‚
  â”‚  â†’ HAI CHIá»€U (full-duplex)                              â”‚
  â”‚  â†’ Latency Cá»°C THáº¤P (2-14 bytes overhead)              â”‚
  â”‚  â†’ TEXT + BINARY                                        â”‚
  â”‚  â†’ Phá»©c táº¡p hÆ¡n SSE                                     â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Báº£ng so sÃ¡nh chi tiáº¿t

```
SO SÃNH 4 Ká»¸ THUáº¬T:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚              â”‚Short Polling â”‚Long Polling  â”‚SSE           â”‚WebSocket     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ HÆ°á»›ng        â”‚ Clientâ†’Svr  â”‚ Clientâ†’Svr   â”‚ Svrâ†’Client   â”‚ Hai chiá»u    â”‚
  â”‚              â”‚ (request)    â”‚ (held open)  â”‚ (one-way)    â”‚ (full-duplex)â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Protocol     â”‚ HTTP         â”‚ HTTP         â”‚ HTTP         â”‚ WS (upgrade) â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Latency      â”‚ Cao (intervalâ”‚ Trung bÃ¬nh   â”‚ Tháº¥p         â”‚ Ráº¥t tháº¥p     â”‚
  â”‚              â”‚ between poll)â”‚ (hold time)  â”‚ (streaming)  â”‚ (persistent) â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Resource     â”‚ Ráº¥t tá»‘n      â”‚ Tá»‘n vá»«a      â”‚ Tiáº¿t kiá»‡m    â”‚ Tiáº¿t kiá»‡m    â”‚
  â”‚ Usage        â”‚ (many reqs)  â”‚ (held conns) â”‚ (1 conn)     â”‚ (1 conn)     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Data Format  â”‚ Any          â”‚ Any          â”‚ Text only    â”‚ Text+Binary  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Reconnect    â”‚ Tá»± (interval)â”‚ Tá»± (re-poll) â”‚ âœ… Auto       â”‚ âŒ Manual    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Compatibilityâ”‚ âœ… 100%      â”‚ âœ… 100%      â”‚ âœ… Tá»‘t       â”‚ âœ… Tá»‘t       â”‚
  â”‚              â”‚              â”‚              â”‚ (trá»« IE)     â”‚ (trá»« IE 9-)  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Complexity   â”‚ â­ Ráº¥t dá»…    â”‚ â­â­ Dá»…      â”‚ â­â­ Dá»…      â”‚ â­â­â­ KhÃ³   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  THá»¨ Tá»° HIá»†U SUáº¤T (Performance):
  WebSocket > SSE > Long Polling > Short Polling
  ğŸ† Best â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Worst ğŸ“‰

  THá»¨ Tá»° TÆ¯Æ NG THÃCH (Compatibility):
  Short Polling > Long Polling > SSE > WebSocket
  âœ… Best â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Limited âš ï¸

  â†’ Chá»n phÆ°Æ¡ng phÃ¡p tÃ¹y theo yÃªu cáº§u cá»¥ thá»ƒ!
```

### Decision Tree â€” Chá»n ká»¹ thuáº­t nÃ o?

```
DECISION TREE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Cáº§n real-time?
  â”‚
  â”œâ”€ KHÃ”NG â†’ HTTP thÃ´ng thÆ°á»ng (REST API)
  â”‚
  â””â”€ CÃ“ â†’ Cáº§n hai chiá»u?
           â”‚
           â”œâ”€ KHÃ”NG â†’ SSE âœ…
           â”‚  (AI streaming, live feeds,
           â”‚   notifications, stock prices)
           â”‚
           â””â”€ CÃ“ â†’ Cáº§n latency cá»±c tháº¥p?
                    â”‚
                    â”œâ”€ CÃ“ â†’ WebSocket âœ…
                    â”‚  (Chat, gaming, collaborative
                    â”‚   editing, live trading)
                    â”‚
                    â””â”€ KHÃ”NG â†’ Long Polling âœ…
                       (Simple notifications,
                        legacy browser support)

  KHI NÃ€O DÃ™NG SHORT POLLING?
  â†’ Chá»‰ khi: cáº§n Ä‘Æ¡n giáº£n, check status má»—i vÃ i giÃ¢y
  â†’ VÃ­ dá»¥: kiá»ƒm tra job completion, build status
  â†’ Äá»«ng dÃ¹ng cho real-time data!
```

---

## 2. SSE LÃ  GÃ¬?

```
SSE â€” SERVER-SENT EVENTS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  SSE = ká»¹ thuáº­t PUSH dá»¯ liá»‡u tá»« server, dá»±a trÃªn HTTP:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Client (Browser)              Server                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   HTTP GET       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
  â”‚  â”‚          â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚   Connection:     â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚   keep-alive      â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚                   â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚ â—„â”€â”€â”€â”€ data: Hi    â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚ â—„â”€â”€â”€â”€ data: there â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚ â—„â”€â”€â”€â”€ data: !     â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚        ...        â”‚          â”‚            â”‚
  â”‚  â”‚          â”‚ â—„â”€â”€â”€â”€ data: [DONE]â”‚          â”‚            â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
  â”‚                                                          â”‚
  â”‚  â†’ Má»˜T CHIá»€U: Server â†’ Client                          â”‚
  â”‚  â†’ Dá»±a trÃªn HTTP long connection                        â”‚
  â”‚  â†’ Content-Type: text/event-stream                      â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  4 Äáº¶C ÄIá»‚M Cá»T LÃ•I:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  â‘  SINGLE DIRECTION (má»™t chiá»u):                         â”‚
  â”‚     â†’ Chá»‰ Server â†’ Client                               â”‚
  â”‚     â†’ Client muá»‘n gá»­i data = gá»­i HTTP request má»›i       â”‚
  â”‚                                                          â”‚
  â”‚  â‘¡ TEXT ONLY (chá»‰ text):                                 â”‚
  â”‚     â†’ Máº·c Ä‘á»‹nh UTF-8                                     â”‚
  â”‚     â†’ ThÆ°á»ng dÃ¹ng JSON strings                           â”‚
  â”‚     â†’ KhÃ´ng há»— trá»£ binary natively                       â”‚
  â”‚                                                          â”‚
  â”‚  â‘¢ AUTO RECONNECT (tá»± káº¿t ná»‘i láº¡i):                      â”‚
  â”‚     â†’ Browser tá»± reconnect khi máº¥t káº¿t ná»‘i              â”‚
  â”‚     â†’ Gá»­i Last-Event-ID header                          â”‚
  â”‚     â†’ Server biáº¿t client Ä‘á»c Ä‘áº¿n Ä‘Ã¢u                    â”‚
  â”‚                                                          â”‚
  â”‚  â‘£ HTTP-BASED (dá»±a trÃªn HTTP):                           â”‚
  â”‚     â†’ KhÃ´ng cáº§n protocol upgrade                         â”‚
  â”‚     â†’ Äi qua proxy/firewall/CDN bÃ¬nh thÆ°á»ng              â”‚
  â”‚     â†’ Táº­n dá»¥ng HTTP caching, compression                â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  DATA FORMAT Cá»¦A SSE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  HTTP/1.1 200 OK                                         â”‚
  â”‚  Content-Type: text/event-stream                         â”‚
  â”‚  Cache-Control: no-cache                                 â”‚
  â”‚  Connection: keep-alive                                  â”‚
  â”‚                                                          â”‚
  â”‚  id: 1                    â† Event ID (cho reconnect)    â”‚
  â”‚  event: message           â† Loáº¡i event (cÃ³ thá»ƒ custom) â”‚
  â”‚  data: {"text": "Xin"}   â† Dá»¯ liá»‡u                   â”‚
  â”‚                            â† DÃ²ng trá»‘ng = káº¿t thÃºc eventâ”‚
  â”‚  id: 2                                                   â”‚
  â”‚  data: {"text": " chÃ o"}                                â”‚
  â”‚                                                          â”‚
  â”‚  id: 3                                                   â”‚
  â”‚  data: [DONE]             â† Signal káº¿t thÃºc stream     â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 3. Sá»­ Dá»¥ng CÆ¡ Báº£n â€” EventSource

```
EVENTSOURCE â€” API NATIVE Cá»¦A BROWSER:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  // 1. Táº¡o instance, káº¿t ná»‘i Ä‘áº¿n server                 â”‚
  â”‚  const es = new EventSource('http://localhost:3000/sse');â”‚
  â”‚                                                          â”‚
  â”‚  // 2. Láº¯ng nghe message máº·c Ä‘á»‹nh                       â”‚
  â”‚  es.onmessage = (event) => {                            â”‚
  â”‚    console.log('Data:', event.data);                    â”‚
  â”‚  };                                                      â”‚
  â”‚                                                          â”‚
  â”‚  // 3. Láº¯ng nghe custom event (thá»a thuáº­n vá»›i backend)  â”‚
  â”‚  es.addEventListener('custom-event', (event) => {       â”‚
  â”‚    console.log('Custom:', event.data);                  â”‚
  â”‚  });                                                     â”‚
  â”‚                                                          â”‚
  â”‚  // 4. Láº¯ng nghe tráº¡ng thÃ¡i                              â”‚
  â”‚  es.onopen = () => console.log('Connected');            â”‚
  â”‚  es.onerror = (err) => console.error('Error:', err);    â”‚
  â”‚                                                          â”‚
  â”‚  // 5. ÄÃ³ng káº¿t ná»‘i                                      â”‚
  â”‚  es.close();                                             â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš ï¸ Háº N CHáº¾ Lá»šN Cá»¦A EVENTSOURCE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  âŒ CHá»ˆ Há»– TRá»¢ GET                                      â”‚
  â”‚                                                          â”‚
  â”‚  Trong AI chat:                                          â”‚
  â”‚  â†’ User gá»­i message dÃ i + context + conversation historyâ”‚
  â”‚  â†’ KHÃ”NG THá»‚ nhÃ©t háº¿t vÃ o URL query params              â”‚
  â”‚  â†’ Cáº¦N POST vá»›i JSON body                               â”‚
  â”‚                                                          â”‚
  â”‚  â†’ EventSource native = KHÃ”NG Äá»¦ cho AI scenarios      â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 4. Thá»±c Chiáº¿n â€” Fetch SSE Cho AI

```
GIáº¢I PHÃP: @microsoft/fetch-event-source
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Microsoft open-source library giáº£i quyáº¿t Má»ŒI háº¡n cháº¿:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  âœ… Há»— trá»£ POST vÃ  Táº¤T Cáº¢ HTTP methods                 â”‚
  â”‚  âœ… Custom headers (Authorization token)                 â”‚
  â”‚  âœ… JSON body (gá»­i message + context)                   â”‚
  â”‚  âœ… Error retry strategies                               â”‚
  â”‚  âœ… Timeout configuration                               â”‚
  â”‚  âœ… AbortController support                              â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 3.1 Code ÄÃ³ng GÃ³i Thá»±c Táº¿

```javascript
import { fetchEventSource } from "@microsoft/fetch-event-source";
import { ElMessage } from "element-plus";

let controller; // DÃ¹ng Ä‘á»ƒ abort request

/**
 * Gá»i streaming API
 * @param url     - Endpoint URL
 * @param headers - Custom headers (auth token, etc.)
 * @param data    - POST body (message, context, history)
 * @param handleMessage - Callback má»—i khi nháº­n 1 chunk
 */
export const requestStream = (url, headers, data, handleMessage) => {
  controller = new AbortController();

  fetchEventSource(url, {
    method: "POST",
    signal: controller.signal,
    headers: headers,
    body: JSON.stringify(data),

    // Cho phÃ©p tiáº¿p tá»¥c nháº­n data khi tab bá»‹ áº©n
    openWhenHidden: true,

    // Káº¿t ná»‘i Ä‘Æ°á»£c thiáº¿t láº­p
    async onopen(response) {
      console.log("SSE connection established");
    },

    // Nháº­n 1 chunk data â†’ callback Ä‘Æ°á»£c gá»i NHIá»€U Láº¦N
    onmessage(msg) {
      handleMessage(msg);
    },

    // Stream káº¿t thÃºc bÃ¬nh thÆ°á»ng
    onclose() {
      controller.abort();
    },

    // Lá»—i xáº£y ra
    onerror(err) {
      ElMessage({ message: err, type: "error" });
      // PHáº¢I throw error Ä‘á»ƒ dá»«ng retry
      throw err;
    },
  });
};

// Dá»«ng nháº­n data (user click "Stop generating")
export const stopRequest = () => {
  if (controller) {
    controller.abort();
    controller = new AbortController();
  }
};
```

### 3.2 Báº«y Quan Trá»ng â€” Stop Generating

```
âš ï¸ ABORT CONTROLLER â€” BáºªY NGHIÃŠM TRá»ŒNG:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  controller.abort() = FRONTEND dá»«ng nháº­n data            â”‚
  â”‚                                                          â”‚
  â”‚  NHÆ¯NG:                                                  â”‚
  â”‚  â†’ Backend KHÃ”NG BIáº¾T frontend Ä‘Ã£ abort!                 â”‚
  â”‚  â†’ Backend VáºªN TIáº¾P Tá»¤C generate text                   â”‚
  â”‚  â†’ Backend lÆ°u FULL response vÃ o database               â”‚
  â”‚                                                          â”‚
  â”‚  Háº¬U QUáº¢:                                                â”‚
  â”‚  â†’ User tháº¥y: "Xin chÃ o, tÃ´i lÃ  AI assistant..."       â”‚
  â”‚  â†’ Database lÆ°u: "Xin chÃ o, tÃ´i lÃ  AI assistant.        â”‚
  â”‚    TÃ´i cÃ³ thá»ƒ giÃºp gÃ¬ cho báº¡n hÃ´m nay? Báº¡n cÃ³          â”‚
  â”‚    thá»ƒ há»i tÃ´i báº¥t ká»³ cÃ¢u há»i nÃ o..."                  â”‚
  â”‚  â†’ Khi xem history â†’ DATA KHÃ”NG NHáº¤T QUÃN!              â”‚
  â”‚                                                          â”‚
  â”‚  GIáº¢I PHÃP ÄÃšNG:                                         â”‚
  â”‚  â†’ Backend cáº§n cÃ³ API "/stop-generation"                 â”‚
  â”‚  â†’ Frontend gá»i stop API â†’ Backend dá»«ng generate        â”‚
  â”‚  â†’ Backend lÆ°u Ä‘Ãºng pháº§n Ä‘Ã£ generate                    â”‚
  â”‚  â†’ History data NHáº¤T QUÃN                                â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 5. Nginx â€” Báº«y Cháº¿t NgÆ°á»i

```
PROXY BUFFERING â€” Táº I SAO TEXT "Dá»’N Cá»¤C"?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  TRIá»†U CHá»¨NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Code frontend ÄÃšNG 100%                                 â”‚
  â”‚  NhÆ°ng text hiá»‡n ra "tá»«ng cá»¥c lá»›n" thay vÃ¬ "tá»«ng chá»¯"  â”‚
  â”‚                                                          â”‚
  â”‚  Ká»³ vá»ng (typewriter):   Thá»±c táº¿ (chunked):             â”‚
  â”‚  X                        (im láº·ng 2 giÃ¢y...)            â”‚
  â”‚  Xi                       Xin chÃ o, tÃ´i               â”‚
  â”‚  Xin                      (im láº·ng 1 giÃ¢y...)            â”‚
  â”‚  Xin                      lÃ  AI assistant               â”‚
  â”‚  Xin c                    cÃ³ thá»ƒ giÃºp gÃ¬              â”‚
  â”‚  Xin ch                                                  â”‚
  â”‚  Xin chÃ                   â†’ KHÃ”NG CÃ“ hiá»‡u á»©ng          â”‚
  â”‚  Xin chÃ o                   typewriter!                  â”‚
  â”‚  ...                                                     â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  NGUYÃŠN NHÃ‚N â€” NGINX PROXY BUFFERING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Máº·c Ä‘á»‹nh Nginx Báº¬T proxy_buffering:                    â”‚
  â”‚                                                          â”‚
  â”‚  Backend  â”€â”€chunkâ”€â”€â–º  Nginx  â”€â”€(buffer)â”€â”€  Client       â”‚
  â”‚           â”€â”€chunkâ”€â”€â–º         â”€â”€(buffer)â”€â”€               â”‚
  â”‚           â”€â”€chunkâ”€â”€â–º         â”€â”€(buffer)â”€â”€               â”‚
  â”‚                              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º  (dá»“n cá»¥c!) â”‚
  â”‚                                                          â”‚
  â”‚  Nginx GOM nhiá»u chunks láº¡i â†’ gá»­i 1 láº§n                 â”‚
  â”‚  â†’ PHÃA BACKEND stream Ä‘Ãºng                              â”‚
  â”‚  â†’ PHÃA CLIENT nháº­n SAI (dá»“n cá»¥c)                       â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  GIáº¢I PHÃP â€” Táº®T PROXY BUFFERING:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  location ^~/api/v1/chat/ {                              â”‚
  â”‚      proxy_pass http://backend_server;                   â”‚
  â”‚      proxy_set_header X-Forwarded-For $remote_addr;     â”‚
  â”‚                                                          â”‚
  â”‚      # TrÃ¡nh long connection bá»‹ timeout                  â”‚
  â”‚      proxy_read_timeout 3600s;                           â”‚
  â”‚                                                          â”‚
  â”‚      # â­ Cá»T LÃ•I: táº¯t proxy buffering                 â”‚
  â”‚      proxy_buffering off;                                â”‚
  â”‚                                                          â”‚
  â”‚      # Báº­t chunked transfer encoding                     â”‚
  â”‚      chunked_transfer_encoding on;                       â”‚
  â”‚  }                                                       â”‚
  â”‚                                                          â”‚
  â”‚  SAU KHI FIX:                                             â”‚
  â”‚  Backend â”€â”€chunkâ”€â”€â–º Nginx â”€â”€chunkâ”€â”€â–º Client              â”‚
  â”‚          â”€â”€chunkâ”€â”€â–º       â”€â”€chunkâ”€â”€â–º                     â”‚
  â”‚          â”€â”€chunkâ”€â”€â–º       â”€â”€chunkâ”€â”€â–º                     â”‚
  â”‚                                                          â”‚
  â”‚  â†’ Má»—i chunk = NGAY Láº¬P Tá»¨C forward                    â”‚
  â”‚  â†’ Hiá»‡u á»©ng typewriter HOáº T Äá»˜NG                        â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  CHECKLIST CONFIG NGINX CHO SSE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  âœ… proxy_buffering off;         â†’ Táº¯t buffering        â”‚
  â”‚  âœ… chunked_transfer_encoding on;â†’ Báº­t chunked          â”‚
  â”‚  âœ… proxy_read_timeout 3600s;    â†’ Timeout Ä‘á»§ dÃ i       â”‚
  â”‚  âœ… proxy_cache off;             â†’ Táº¯t cache            â”‚
  â”‚  âœ… X-Accel-Buffering: no;       â†’ Header response      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 6. SSE vs WebSocket â€” So SÃ¡nh Chi Tiáº¿t

```
SO SÃNH TOÃ€N DIá»†N:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚    Äáº·c tÃ­nh       â”‚      SSE         â”‚   WebSocket      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ HÆ°á»›ng giao tiáº¿p  â”‚ Má»™t chiá»u         â”‚ Hai chiá»u        â”‚
  â”‚                  â”‚ Server â†’ Client  â”‚ (full-duplex)    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Protocol         â”‚ HTTP/1.1 chuáº©n   â”‚ WS protocol riÃªngâ”‚
  â”‚                  â”‚ (khÃ´ng upgrade)   â”‚ (cáº§n handshake)  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Data format      â”‚ Text/JSON only   â”‚ Text + Binary    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Auto reconnect   â”‚ âœ… Browser native â”‚ âŒ Pháº£i tá»± code  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Äá»™ phá»©c táº¡p      â”‚ Nháº¹, Ä‘Æ¡n giáº£n    â”‚ Náº·ng, phá»©c táº¡p   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Proxy/Firewall   â”‚ âœ… XuyÃªn qua dá»…  â”‚ âš ï¸ CÃ³ thá»ƒ bá»‹ cháº·nâ”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Multiplexing     â”‚ âœ… HTTP/2 native  â”‚ âŒ 1 connection   â”‚
  â”‚ (HTTP/2)         â”‚                  â”‚ per endpoint     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Overhead/message â”‚ Cao hÆ¡n          â”‚ Tháº¥p hÆ¡n         â”‚
  â”‚                  â”‚ (HTTP headers)   â”‚ (2-14 bytes)     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Event IDs        â”‚ âœ… Native support â”‚ âŒ Pháº£i tá»± lÃ m   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Browser support  â”‚ Gáº§n 100%         â”‚ Gáº§n 100%         â”‚
  â”‚                  â”‚ (trá»« IE)         â”‚ (trá»« IE 9-)      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  FLOW SO SÃNH TRá»°C QUAN:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  SSE:                                                    â”‚
  â”‚  Client â”€â”€â”€â”€ HTTP GET â”€â”€â”€â”€â–º Server                      â”‚
  â”‚         â—„â”€â”€â”€â”€ data â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
  â”‚         â—„â”€â”€â”€â”€ data â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
  â”‚         â—„â”€â”€â”€â”€ data â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
  â”‚  (Client muá»‘n gá»­i â†’ HTTP request Má»šI)                  â”‚
  â”‚                                                          â”‚
  â”‚  WebSocket:                                              â”‚
  â”‚  Client â”€â”€â”€â”€ HTTP Upgrade â”€â”€â–º Server                    â”‚
  â”‚         â—„â”€â”€â”€â”€ Upgrade OK â”€â”€â”€â”€                           â”‚
  â”‚         â”€â”€â”€â”€ WS frame â”€â”€â”€â”€â”€â”€â–º                           â”‚
  â”‚         â—„â”€â”€â”€â”€ WS frame â”€â”€â”€â”€â”€                            â”‚
  â”‚         â”€â”€â”€â”€ WS frame â”€â”€â”€â”€â”€â”€â–º                           â”‚
  â”‚         â—„â”€â”€â”€â”€ WS frame â”€â”€â”€â”€â”€                            â”‚
  â”‚  (Cáº£ hai chiá»u báº¥t ká»³ lÃºc nÃ o)                          â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  PROTOCOL HANDSHAKE SO SÃNH:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  SSE â€” Váº«n lÃ  HTTP bÃ¬nh thÆ°á»ng:                          â”‚
  â”‚  GET /stream HTTP/1.1                                    â”‚
  â”‚  Accept: text/event-stream                               â”‚
  â”‚  â†’ Response: 200 OK                                      â”‚
  â”‚  â†’ Content-Type: text/event-stream                       â”‚
  â”‚  â†’ Xong! Báº¯t Ä‘áº§u nháº­n data                              â”‚
  â”‚                                                          â”‚
  â”‚  WebSocket â€” Cáº§n protocol upgrade:                       â”‚
  â”‚  GET /ws HTTP/1.1                                        â”‚
  â”‚  Upgrade: websocket                                      â”‚
  â”‚  Connection: Upgrade                                     â”‚
  â”‚  Sec-WebSocket-Key: xxx                                  â”‚
  â”‚  â†’ Response: 101 Switching Protocols                     â”‚
  â”‚  â†’ Upgrade: websocket                                    â”‚
  â”‚  â†’ Sec-WebSocket-Accept: yyy                             â”‚
  â”‚  â†’ Xong! Chuyá»ƒn sang WS protocol                        â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 7. Táº¡i Sao AI Chá»n SSE Thay VÃ¬ WebSocket?

```
LÃ DO AI STREAMING Æ¯U TIÃŠN SSE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â‘  PATTERN PHÃ™ Há»¢P â€” REQUEST/STREAM RESPONSE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  AI chat pattern:                                        â”‚
  â”‚  â†’ User Gá»¬I 1 Láº¦N (cÃ¢u há»i)                            â”‚
  â”‚  â†’ Server TRáº¢ Lá»œI LIÃŠN Tá»¤C (tá»«ng token)                â”‚
  â”‚  â†’ ÄÃšNG MÃ” HÃŒNH Má»˜T CHIá»€U                               â”‚
  â”‚                                                          â”‚
  â”‚  WebSocket = "báº¯n ruá»“i báº±ng Ä‘áº¡i bÃ¡c"                    â”‚
  â”‚  â†’ Full-duplex â‰  cáº§n thiáº¿t                               â”‚
  â”‚  â†’ User khÃ´ng gá»­i data TRONG KHI server Ä‘ang stream     â”‚
  â”‚  â†’ Kháº£ nÄƒng hai chiá»u = LÃƒNG PHÃ                        â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â‘¡ TÆ¯Æ NG THÃCH Háº  Táº¦NG:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  SSE = váº«n lÃ  HTTP:                                      â”‚
  â”‚  â†’ Nginx proxy: hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng                   â”‚
  â”‚  â†’ Load balancer: khÃ´ng cáº§n config Ä‘áº·c biá»‡t             â”‚
  â”‚  â†’ CDN: xuyÃªn qua Ä‘Æ°á»£c                                  â”‚
  â”‚  â†’ Firewall: khÃ´ng cháº·n (vÃ¬ lÃ  HTTP)                    â”‚
  â”‚  â†’ API Gateway: há»— trá»£ native                           â”‚
  â”‚                                                          â”‚
  â”‚  WebSocket:                                              â”‚
  â”‚  â†’ Cáº§n config proxy riÃªng cho WS                        â”‚
  â”‚  â†’ Load balancer cáº§n sticky sessions                    â”‚
  â”‚  â†’ CDN thÆ°á»ng khÃ´ng há»— trá»£                              â”‚
  â”‚  â†’ Firewall CÃ“ THá»‚ cháº·n upgrade                        â”‚
  â”‚  â†’ Phá»©c táº¡p hÆ¡n Ä‘Ã¡ng ká»ƒ                                 â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â‘¢ ÄÆ N GIáº¢N HÃ“A BACKEND:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  SSE backend:                                            â”‚
  â”‚  â†’ Set Content-Type: text/event-stream                   â”‚
  â”‚  â†’ Write data lines                                      â”‚
  â”‚  â†’ Flush each chunk                                      â”‚
  â”‚  â†’ Done!                                                 â”‚
  â”‚                                                          â”‚
  â”‚  WebSocket backend:                                      â”‚
  â”‚  â†’ Quáº£n lÃ½ connection lifecycle                          â”‚
  â”‚  â†’ Handle ping/pong heartbeat                           â”‚
  â”‚  â†’ Manage connection pools                               â”‚
  â”‚  â†’ Handle reconnection logic                            â”‚
  â”‚  â†’ Binary frame parsing                                  â”‚
  â”‚  â†’ Phá»©c táº¡p hÆ¡n NHIá»€U                                    â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â‘£ HTTP SEMANTICS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  SSE giá»¯ nguyÃªn HTTP semantics:                          â”‚
  â”‚  â†’ Status codes (401, 403, 429 rate limit)              â”‚
  â”‚  â†’ Headers (Authorization, Content-Type)                 â”‚
  â”‚  â†’ Caching rules                                        â”‚
  â”‚  â†’ CORS                                                  â”‚
  â”‚  â†’ Cookies                                               â”‚
  â”‚                                                          â”‚
  â”‚  WebSocket Máº¤T háº¿t:                                      â”‚
  â”‚  â†’ Sau upgrade â†’ khÃ´ng cÃ²n HTTP status codes            â”‚
  â”‚  â†’ Auth pháº£i handle qua WS message                      â”‚
  â”‚  â†’ KhÃ´ng cÃ³ caching                                      â”‚
  â”‚  â†’ CORS chá»‰ á»Ÿ handshake                                 â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  KHI NÃ€O DÃ™NG WEBSOCKET THAY VÃŒ SSE:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  â†’ Real-time chat (cáº£ 2 phÃ­a gá»­i liÃªn tá»¥c)             â”‚
  â”‚  â†’ Multiplayer games (latency cá»±c tháº¥p)                 â”‚
  â”‚  â†’ Collaborative editing (Google Docs)                  â”‚
  â”‚  â†’ Live trading (order book updates + user actions)     â”‚
  â”‚  â†’ IoT dashboards + control (2-way)                     â”‚
  â”‚                                                          â”‚
  â”‚  â†’ NÃ³i chung: khi Cáº¢ HAI phÃ­a cáº§n gá»­i data             â”‚
  â”‚    THÆ¯á»œNG XUYÃŠN vÃ  Äá»’NG THá»œI                            â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 8. Kiáº¿n TrÃºc Tá»•ng Quan Streaming

```
AI STREAMING ARCHITECTURE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    FRONTEND                              â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  User Input                                       â”‚  â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚  â”‚
  â”‚  â”‚  â”‚ "Xin chÃ o!" â”‚â”€â”€ POST /api/chat â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚  â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   (fetchEventSource)             â”‚  â”‚
  â”‚  â”‚                                                    â”‚  â”‚
  â”‚  â”‚  Stream Display                                    â”‚  â”‚
  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
  â”‚  â”‚  â”‚ "Xin chÃ o! TÃ´i lÃ  AI assistant. TÃ´i cÃ³ thá»ƒ  â”‚ â”‚  â”‚
  â”‚  â”‚  â”‚  giÃºp gÃ¬ cho báº¡n?â–ˆ"  â† cursor nháº¥p nhÃ¡y     â”‚ â”‚  â”‚
  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
  â”‚  â”‚  â—„â”€â”€ data: {"text": "Xin"}                       â”‚  â”‚
  â”‚  â”‚  â—„â”€â”€ data: {"text": " chÃ o"}                      â”‚  â”‚
  â”‚  â”‚  â—„â”€â”€ data: {"text": "!"}                          â”‚  â”‚
  â”‚  â”‚  â—„â”€â”€ data: {"text": " TÃ´i"}                       â”‚  â”‚
  â”‚  â”‚  ...                                               â”‚  â”‚
  â”‚  â”‚  â—„â”€â”€ data: [DONE]                                  â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    NGINX                                 â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  proxy_buffering OFF                               â”‚  â”‚
  â”‚  â”‚  chunked_transfer_encoding ON                      â”‚  â”‚
  â”‚  â”‚  proxy_read_timeout 3600s                          â”‚  â”‚
  â”‚  â”‚  â†’ Má»—i chunk = FORWARD NGAY                       â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                    BACKEND                               â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
  â”‚  â”‚  1. Nháº­n message + context tá»« POST body           â”‚  â”‚
  â”‚  â”‚  2. Set Content-Type: text/event-stream           â”‚  â”‚
  â”‚  â”‚  3. Gá»i LLM API (OpenAI, Claude, etc.)          â”‚  â”‚
  â”‚  â”‚  4. LLM tráº£ vá» tá»«ng token                         â”‚  â”‚
  â”‚  â”‚  5. Má»—i token â†’ write("data: {token}\n\n")      â”‚  â”‚
  â”‚  â”‚  6. Flush immediately                              â”‚  â”‚
  â”‚  â”‚  7. Cuá»‘i cÃ¹ng: write("data: [DONE]\n\n")        â”‚  â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 9. CÃ¢u Há»i Phá»ng Váº¥n

### Q1: SSE lÃ  gÃ¬? KhÃ¡c gÃ¬ so vá»›i WebSocket?

```
TRáº¢ Lá»œI:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  SSE (Server-Sent Events):                                   â”‚
â”‚  â†’ Ká»¹ thuáº­t push data Tá»ª server, dá»±a trÃªn HTTP              â”‚
â”‚  â†’ Má»™t chiá»u: Server â†’ Client                               â”‚
â”‚  â†’ Content-Type: text/event-stream                           â”‚
â”‚  â†’ Auto reconnect bá»Ÿi browser                               â”‚
â”‚  â†’ Chá»‰ text/JSON                                            â”‚
â”‚                                                              â”‚
â”‚  KhÃ¡c WebSocket:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚          â”‚ SSE               â”‚ WebSocket               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ HÆ°á»›ng    â”‚ Má»™t chiá»u          â”‚ Hai chiá»u (full-duplex)  â”‚ â”‚
â”‚  â”‚ Protocol â”‚ HTTP chuáº©n        â”‚ WS protocol riÃªng       â”‚ â”‚
â”‚  â”‚ Data     â”‚ Text only         â”‚ Text + Binary           â”‚ â”‚
â”‚  â”‚ Reconnectâ”‚ Tá»± Ä‘á»™ng           â”‚ Pháº£i code thá»§ cÃ´ng      â”‚ â”‚
â”‚  â”‚ Proxy    â”‚ XuyÃªn qua dá»…     â”‚ CÃ³ thá»ƒ bá»‹ cháº·n          â”‚ â”‚
â”‚  â”‚ Phá»©c táº¡p â”‚ ÄÆ¡n giáº£n          â”‚ Phá»©c táº¡p hÆ¡n            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Q2: Táº¡i sao ChatGPT/AI chat dÃ¹ng SSE thay vÃ¬ WebSocket?

```
TRáº¢ Lá»œI:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  â‘  Pattern phÃ¹ há»£p:                                         â”‚
â”‚     â†’ User gá»­i 1 request â†’ Server stream response           â”‚
â”‚     â†’ ÄÃºng mÃ´ hÃ¬nh Má»˜T CHIá»€U cá»§a SSE                       â”‚
â”‚     â†’ WebSocket hai chiá»u = "thá»«a chá»©c nÄƒng"                â”‚
â”‚                                                              â”‚
â”‚  â‘¡ TÆ°Æ¡ng thÃ­ch háº¡ táº§ng:                                     â”‚
â”‚     â†’ SSE = HTTP â†’ proxy/LB/CDN/firewall Ä‘á»u OK            â”‚
â”‚     â†’ WebSocket cáº§n config Ä‘áº·c biá»‡t cho proxy              â”‚
â”‚                                                              â”‚
â”‚  â‘¢ HTTP semantics:                                           â”‚
â”‚     â†’ Giá»¯ nguyÃªn status codes (401, 429 rate limit...)      â”‚
â”‚     â†’ Auth qua headers bÃ¬nh thÆ°á»ng                          â”‚
â”‚     â†’ WebSocket máº¥t háº¿t HTTP semantics sau upgrade          â”‚
â”‚                                                              â”‚
â”‚  â‘£ Backend Ä‘Æ¡n giáº£n hÆ¡n:                                     â”‚
â”‚     â†’ KhÃ´ng cáº§n quáº£n lÃ½ connection pools                    â”‚
â”‚     â†’ KhÃ´ng cáº§n heartbeat/ping-pong                         â”‚
â”‚     â†’ Chá»‰ cáº§n write + flush                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Q3: EventSource native cÃ³ háº¡n cháº¿ gÃ¬? Giáº£i phÃ¡p?

```
TRáº¢ Lá»œI:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  Háº N CHáº¾ Cá»¦A EventSource NATIVE:                            â”‚
â”‚  â†’ CHá»ˆ há»— trá»£ GET method                                   â”‚
â”‚  â†’ KhÃ´ng thá»ƒ gá»­i POST body (message + context)             â”‚
â”‚  â†’ KhÃ´ng custom headers (auth token)                        â”‚
â”‚  â†’ Trong AI chat â†’ KHÃ”NG Äá»¦ DÃ™NG                           â”‚
â”‚                                                              â”‚
â”‚  GIáº¢I PHÃP:                                                  â”‚
â”‚  â†’ @microsoft/fetch-event-source                            â”‚
â”‚  â†’ DÃ¹ng fetch API bÃªn dÆ°á»›i (POST, headers, body)           â”‚
â”‚  â†’ Parse SSE format thá»§ cÃ´ng                                â”‚
â”‚  â†’ Há»— trá»£ AbortController Ä‘á»ƒ stop                          â”‚
â”‚  â†’ Custom retry strategies                                  â”‚
â”‚                                                              â”‚
â”‚  HOáº¶C: tá»± viáº¿t báº±ng fetch + ReadableStream:                 â”‚
â”‚  const res = await fetch(url, { method: 'POST', body })    â”‚
â”‚  const reader = res.body.getReader()                        â”‚
â”‚  const decoder = new TextDecoder()                          â”‚
â”‚  while (true) {                                              â”‚
â”‚    const { done, value } = await reader.read()              â”‚
â”‚    if (done) break                                           â”‚
â”‚    const text = decoder.decode(value)                       â”‚
â”‚    // parse SSE lines: "data: ..."                          â”‚
â”‚  }                                                           â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Q4: Táº¡i sao SSE bá»‹ "dá»“n cá»¥c" khi qua Nginx? CÃ¡ch fix?

```
TRáº¢ Lá»œI:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  NGUYÃŠN NHÃ‚N:                                                â”‚
â”‚  â†’ Nginx máº·c Ä‘á»‹nh Báº¬T proxy_buffering                      â”‚
â”‚  â†’ Gom nhiá»u chunks thÃ nh 1 buffer â†’ gá»­i 1 láº§n             â”‚
â”‚  â†’ Frontend nháº­n "tá»«ng cá»¥c lá»›n" thay vÃ¬ "tá»«ng chá»¯"        â”‚
â”‚                                                              â”‚
â”‚  FIX:                                                        â”‚
â”‚  location /api/chat/ {                                      â”‚
â”‚    proxy_pass http://backend;                               â”‚
â”‚    proxy_buffering off;          â† Táº®T buffering           â”‚
â”‚    chunked_transfer_encoding on; â† Báº¬T chunked            â”‚
â”‚    proxy_read_timeout 3600s;     â† Timeout Ä‘á»§ dÃ i         â”‚
â”‚    proxy_cache off;              â† Táº®T cache              â”‚
â”‚  }                                                           â”‚
â”‚                                                              â”‚
â”‚  HOáº¶C tá»« backend, thÃªm header:                              â”‚
â”‚  X-Accel-Buffering: no                                      â”‚
â”‚  â†’ Nginx tá»± Ä‘á»™ng táº¯t buffering cho response nÃ y            â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Q5: AbortController dÃ¹ng Ä‘á»ƒ stop stream â€” cÃ³ báº«y gÃ¬ khÃ´ng?

```
TRáº¢ Lá»œI:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  CÃ“ BáºªY NGHIÃŠM TRá»ŒNG:                                       â”‚
â”‚                                                              â”‚
â”‚  controller.abort() = frontend Dá»ªNG NHáº¬N DATA               â”‚
â”‚  NHÆ¯NG backend KHÃ”NG BIáº¾T â†’ váº«n tiáº¿p tá»¥c generate!         â”‚
â”‚                                                              â”‚
â”‚  Háº­u quáº£:                                                    â”‚
â”‚  â†’ User tháº¥y text cáº¯t ngang                                 â”‚
â”‚  â†’ Database lÆ°u FULL text                                   â”‚
â”‚  â†’ Xem history â†’ DATA KHÃ”NG NHáº¤T QUÃN                      â”‚
â”‚                                                              â”‚
â”‚  Giáº£i phÃ¡p Ä‘Ãºng:                                             â”‚
â”‚  â‘  Backend cáº§n endpoint "/api/stop-generation"              â”‚
â”‚  â‘¡ Frontend gá»i stop API KHI user click "Stop"             â”‚
â”‚  â‘¢ Backend nháº­n signal â†’ dá»«ng LLM generation               â”‚
â”‚  â‘£ Backend lÆ°u ÄÃšNG pháº§n Ä‘Ã£ generate                       â”‚
â”‚  â‘¤ History data NHáº¤T QUÃN                                   â”‚
â”‚                                                              â”‚
â”‚  KHÃ”NG NÃŠN chá»‰ dÃ¹ng AbortController trong production!       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Q6: So sÃ¡nh cÃ¡c ká»¹ thuáº­t real-time trÃªn web?

```
TRáº¢ Lá»œI:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Ká»¹ thuáº­t     â”‚ HÆ°á»›ng     â”‚ Protocol   â”‚ Use case       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Polling     â”‚ Client â†’  â”‚ HTTP       â”‚ Legacy,        â”‚  â”‚
â”‚  â”‚             â”‚ Server    â”‚ (repeated) â”‚ simple checks  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Long        â”‚ Server â†’  â”‚ HTTP       â”‚ Notifications, â”‚  â”‚
â”‚  â”‚ Polling     â”‚ Client    â”‚ (held open)â”‚ basic updates  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ SSE         â”‚ Server â†’  â”‚ HTTP       â”‚ AI streaming,  â”‚  â”‚
â”‚  â”‚             â”‚ Client    â”‚ (stream)   â”‚ live feeds,    â”‚  â”‚
â”‚  â”‚             â”‚           â”‚            â”‚ notifications  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ WebSocket   â”‚ Hai chiá»u â”‚ WS         â”‚ Chat, gaming,  â”‚  â”‚
â”‚  â”‚             â”‚           â”‚ (upgrade)  â”‚ collaboration  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ WebRTC      â”‚ Peer â†”    â”‚ Custom     â”‚ Video call,    â”‚  â”‚
â”‚  â”‚             â”‚ Peer      â”‚ (P2P)      â”‚ screen share   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  TÃ³m gá»n decision tree:                                     â”‚
â”‚  â†’ Chá»‰ server push, text? â†’ SSE                            â”‚
â”‚  â†’ Hai chiá»u, real-time? â†’ WebSocket                        â”‚
â”‚  â†’ P2P media? â†’ WebRTC                                      â”‚
â”‚  â†’ ÄÆ¡n giáº£n, legacy? â†’ Polling                              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
