# Browser Security â€” XSS, CSRF & Attack Prevention Deep Dive

> ğŸ“… 2026-02-11 Â· â± 25 phÃºt Ä‘á»c
>
> TÃ i liá»‡u chuyÃªn sÃ¢u vá» báº£o máº­t trÃ¬nh duyá»‡t: XSS (3 loáº¡i),
> CSRF (3 loáº¡i), Man-in-the-Middle, Network Hijacking, vÃ  phÃ²ng thá»§.
> Äá»™ khÃ³: â­ï¸â­ï¸â­ï¸â­ï¸ | Chá»§ Ä‘á»: Browser Security

---

## Má»¥c Lá»¥c

0. [XSS Attack â€” Táº¥n cÃ´ng XSS](#0-xss-attack--táº¥n-cÃ´ng-xss)
1. [PhÃ²ng chá»‘ng XSS](#1-phÃ²ng-chá»‘ng-xss)
2. [CSRF Attack â€” Táº¥n cÃ´ng CSRF](#2-csrf-attack--táº¥n-cÃ´ng-csrf)
3. [PhÃ²ng chá»‘ng CSRF](#3-phÃ²ng-chá»‘ng-csrf)
4. [Man-in-the-Middle Attack](#4-man-in-the-middle-attack)
5. [CÃ¡c váº¥n Ä‘á» báº£o máº­t Frontend](#5-cÃ¡c-váº¥n-Ä‘á»-báº£o-máº­t-frontend)
6. [Network Hijacking](#6-network-hijacking)
7. [TÃ³m Táº¯t & CÃ¢u Há»i Phá»ng Váº¥n](#7-tÃ³m-táº¯t--cÃ¢u-há»i-phá»ng-váº¥n)

---

## 0. XSS Attack â€” Táº¥n cÃ´ng XSS

> **ğŸ¯ Há»c xong pháº§n nÃ y, báº¡n sáº½ biáº¿t:**
>
> - XSS lÃ  gÃ¬, báº£n cháº¥t cá»§a nÃ³
> - 3 loáº¡i XSS: Stored, Reflected, DOM-based
> - CÃ¡c bÆ°á»›c táº¥n cÃ´ng chi tiáº¿t cá»§a tá»«ng loáº¡i

### KhÃ¡i niá»‡m

```
XSS â€” CROSS-SITE SCRIPTING:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Äá»ŠNH NGHÄ¨A:                                             â”‚
  â”‚  â†’ Táº¥n cÃ´ng CHÃˆN MÃƒ Äá»˜C (Code Injection Attack)       â”‚
  â”‚  â†’ Attacker inject malicious script vÃ o website         â”‚
  â”‚  â†’ Script cháº¡y trÃªn BROWSER cá»§a user                    â”‚
  â”‚  â†’ ÄÃ¡nh cáº¯p thÃ´ng tin: cookies, data cÃ¡ nhÃ¢n...        â”‚
  â”‚                                                          â”‚
  â”‚  Báº¢N CHáº¤T:                                                â”‚
  â”‚  â†’ Website KHÃ”NG Lá»ŒC mÃ£ Ä‘á»™c háº¡i                        â”‚
  â”‚  â†’ Code Ä‘á»™c HÃ’A LáºªN vÃ o code bÃ¬nh thÆ°á»ng               â”‚
  â”‚  â†’ Browser KHÃ”NG PHÃ‚N BIá»†T Ä‘Æ°á»£c script nÃ o tin cáº­y     â”‚
  â”‚  â†’ â†’ Thá»±c thi mÃ£ Ä‘á»™c!                                   â”‚
  â”‚                                                          â”‚
  â”‚  ATTACKER CÃ“ THá»‚:                                        â”‚
  â”‚  â‘  Láº¥y data tá»« page (DOM, cookies, localStorage)       â”‚
  â”‚  â‘¡ DoS Attack (gá»­i request há»£p lá»‡ â†’ quÃ¡ táº£i server)  â”‚
  â”‚  â‘¢ PhÃ¡ vá»¡ cáº¥u trÃºc page                                â”‚
  â”‚  â‘£ Traffic hijacking (redirect link sang website khÃ¡c) â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3 loáº¡i XSS

```
3 LOáº I Táº¤N CÃ”NG XSS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Loáº¡i         â”‚  MÃ´ táº£                                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â‘  Stored     â”‚ Code Ä‘á»™c LÆ¯U TRONG DATABASE server      â”‚
  â”‚ (LÆ°u trá»¯)   â”‚ â†’ Má»—i user truy cáº­p Ä‘á»u bá»‹ áº£nh hÆ°á»Ÿng  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â‘¡ Reflected  â”‚ Code Ä‘á»™c Náº°M TRONG URL                  â”‚
  â”‚ (Pháº£n xáº¡)   â”‚ â†’ User pháº£i CLICK vÃ o URL Ä‘á»™c           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â‘¢ DOM-based  â”‚ Code Ä‘á»™c Sá»¬A DOM trÃªn client            â”‚
  â”‚ (DOM)        â”‚ â†’ Lá»— há»•ng FRONTEND JavaScript           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### â‘  Stored XSS â€” Chi tiáº¿t

```
STORED XSS â€” CODE Äá»˜C LÆ¯U TRONG DATABASE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Attacker             Server                User (náº¡n nhÃ¢n)
  â”Œâ”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”
  â”‚      â”‚â”€â”€ â‘  â”€â”€â”€â”€â”€â”€â–ºâ”‚      â”‚              â”‚      â”‚
  â”‚      â”‚ Submit codeâ”‚  DB  â”‚              â”‚      â”‚
  â”‚      â”‚ Ä‘á»™c (post, â”‚ â”Œâ”€â”€â” â”‚              â”‚      â”‚
  â”‚      â”‚ comment...)â”‚ â”‚ğŸ’€â”‚ â”‚              â”‚      â”‚
  â”‚      â”‚            â”‚ â””â”€â”€â”˜ â”‚              â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚â—„â”€â”€ â‘¡ â”€â”€â”€â”€â”€â”€â”€â”€â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚  User request â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚â”€â”€ â‘¢ â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚      â”‚
  â”‚      â”‚            â”‚      â”‚ HTML + code  â”‚ ğŸ’€   â”‚
  â”‚      â”‚            â”‚      â”‚ Ä‘á»™c tá»« DB    â”‚ Cháº¡y â”‚
  â”‚      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â‘£ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚code  â”‚
  â”‚      â”‚  Nháº­n data â”‚      â”‚              â”‚ Ä‘á»™c! â”‚
  â”‚      â”‚  bá»‹ Ä‘Ã¡nh   â”‚      â”‚              â”‚      â”‚
  â”‚      â”‚  cáº¯p!      â”‚      â”‚              â”‚      â”‚
  â””â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”˜

  4 BÆ¯á»šC:
  â‘  Attacker submit CODE Äá»˜C lÃªn server (post, review, DM)
  â‘¡ User bÃ¬nh thÆ°á»ng má»Ÿ website
  â‘¢ Server láº¥y code Ä‘á»™c tá»« DB â†’ ghÃ©p vÃ o HTML â†’ tráº£ browser
  â‘£ Browser parse + THá»°C THI code Ä‘á»™c â†’ Ä‘Ã¡nh cáº¯p data

  âš ï¸ THÆ¯á»œNG Xáº¢Y RA á»:
  â†’ Diá»…n Ä‘Ã n (forum posts)
  â†’ Reviews sáº£n pháº©m
  â†’ Tin nháº¯n riÃªng (private messages)
  â†’ Comment sections
```

### â‘¡ Reflected XSS â€” Chi tiáº¿t

```
REFLECTED XSS â€” CODE Äá»˜C TRONG URL:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Attacker             Server                User (náº¡n nhÃ¢n)
  â”Œâ”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”
  â”‚      â”‚â”€â”€ â‘  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
  â”‚      â”‚  Gá»­i URL chá»©a code Ä‘á»™c          â”‚      â”‚
  â”‚      â”‚  VD: site.com/search?q=<script> â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚              â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚â—„â”€â”€ â‘¡ â”€â”€â”€â”€â”€â”€â”€â”€â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚ User click   â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚ URL Ä‘á»™c      â”‚      â”‚
  â”‚      â”‚            â”‚      â”‚â”€â”€ â‘¢ â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚      â”‚
  â”‚      â”‚            â”‚      â”‚ Láº¥y code tá»«  â”‚ ğŸ’€   â”‚
  â”‚      â”‚            â”‚      â”‚ URL â†’ ghÃ©p   â”‚ Cháº¡y â”‚
  â”‚      â”‚            â”‚      â”‚ vÃ o HTML     â”‚ code â”‚
  â”‚      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â‘£ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ Ä‘á»™c! â”‚
  â”‚      â”‚  Nháº­n data â”‚      â”‚              â”‚      â”‚
  â””â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”˜

  4 BÆ¯á»šC:
  â‘  Attacker táº¡o URL Äáº¶C BIá»†T chá»©a code Ä‘á»™c
  â‘¡ User CLICK vÃ o URL Ä‘á»™c (bá»‹ lá»«a)
  â‘¢ Server láº¥y code tá»« URL â†’ ghÃ©p HTML â†’ tráº£ browser
  â‘£ Browser parse + THá»°C THI code Ä‘á»™c â†’ Ä‘Ã¡nh cáº¯p data

  KHÃC Vá»šI STORED XSS:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Stored:    code Ä‘á»™c náº±m trong DATABASE                  â”‚
  â”‚ Reflected: code Ä‘á»™c náº±m trong URL                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš ï¸ THÆ¯á»œNG Xáº¢Y RA á»:
  â†’ Search functions (site.com/search?q=<script>...)
  â†’ URL redirects
  â†’ Cáº§n user CLICK vÃ o link â†’ attacker káº¿t há»£p lá»«a Ä‘áº£o
```

### â‘¢ DOM-based XSS â€” Chi tiáº¿t

```
DOM-BASED XSS â€” Sá»¬A DOM TRá»°C TIáº¾P TRÃŠN CLIENT:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Attacker                                   User (náº¡n nhÃ¢n)
  â”Œâ”€â”€â”€â”€â”€â”€â”                                  â”Œâ”€â”€â”€â”€â”€â”€â”
  â”‚      â”‚â”€â”€ â‘  Gá»­i URL chá»©a code â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚      â”‚
  â”‚      â”‚                                  â”‚      â”‚
  â”‚      â”‚                                  â”‚  â‘¡   â”‚
  â”‚      â”‚          (khÃ´ng qua server!)     â”‚ Open â”‚
  â”‚      â”‚                                  â”‚ URL  â”‚
  â”‚      â”‚                                  â”‚      â”‚
  â”‚      â”‚                                  â”‚  â‘¢   â”‚
  â”‚      â”‚                                  â”‚ JS   â”‚
  â”‚      â”‚                                  â”‚ Ä‘á»c  â”‚
  â”‚      â”‚                                  â”‚ URL  â”‚
  â”‚      â”‚                                  â”‚ â†’ ğŸ’€ â”‚
  â”‚      â”‚â—„â”€â”€ â‘£ Nháº­n data Ä‘Ã¡nh cáº¯p â”€â”€â”€â”€â”€â”€â”€â”€â”‚ DOM  â”‚
  â””â”€â”€â”€â”€â”€â”€â”˜                                  â””â”€â”€â”€â”€â”€â”€â”˜

  4 BÆ¯á»šC:
  â‘  Attacker táº¡o URL chá»©a code Ä‘á»™c
  â‘¡ User má»Ÿ URL
  â‘¢ Frontend JavaScript TRÃCH XUáº¤T code tá»« URL â†’ thá»±c thi
  â‘£ Code Ä‘á»™c Ä‘Ã¡nh cáº¯p data â†’ gá»­i vá» attacker

  KHÃC Vá»šI STORED & REFLECTED:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ DOM-based: code Ä‘á»™c trÃ­ch xuáº¥t + thá»±c thi á»Ÿ BROWSER    â”‚
  â”‚            â†’ Lá»— há»•ng FRONTEND JavaScript               â”‚
  â”‚            â†’ KHÃ”NG qua server                           â”‚
  â”‚                                                         â”‚
  â”‚ Stored/Reflected: code Ä‘á»™c xá»­ lÃ½ á»Ÿ SERVER              â”‚
  â”‚            â†’ Lá»— há»•ng SERVER-SIDE                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. PhÃ²ng chá»‘ng XSS

> **ğŸ¯ 3 biá»‡n phÃ¡p phÃ²ng chá»‘ng XSS**

```
PHÃ’NG CHá»NG XSS â€” 3 BIá»†N PHÃP:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘  INPUT ESCAPING & PURE FRONTEND                       â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
  â”‚  â†’ DÃ¹ng pure frontend rendering (trÃ¡nh server-side     â”‚
  â”‚    rendering concat HTML)                                â”‚
  â”‚  â†’ ESCAPE má»i code chÃ¨n vÃ o HTML                       â”‚
  â”‚    < â†’ &lt;  > â†’ &gt;  & â†’ &amp;  " â†’ &quot;         â”‚
  â”‚  â†’ DOM-based: VALIDATE data khi láº¥y, render, concat    â”‚
  â”‚  â†’ Flag malicious code trong quÃ¡ trÃ¬nh xá»­ lÃ½          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘¡ CSP â€” CONTENT SECURITY POLICY                         â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
  â”‚  â†’ Táº¡o WHITELIST cho browser                             â”‚
  â”‚  â†’ Chá»‰ cho phÃ©p load/execute resources tá»« nguá»“n tin cáº­yâ”‚
  â”‚  â†’ Browser Tá»° Xá»¬ LÃ viá»‡c block                         â”‚
  â”‚                                                          â”‚
  â”‚  2 CÃCH Báº¬T CSP:                                          â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚ A) HTTP Header:                                     â”‚ â”‚
  â”‚  â”‚ Content-Security-Policy: script-src 'self'          â”‚ â”‚
  â”‚  â”‚                                                     â”‚ â”‚
  â”‚  â”‚ B) Meta tag:                                        â”‚ â”‚
  â”‚  â”‚ <meta http-equiv="Content-Security-Policy"          â”‚ â”‚
  â”‚  â”‚   content="script-src 'self'">                      â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘¢ Báº¢O Vá»† THÃ”NG TIN NHáº Y Cáº¢M                            â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
  â”‚  â†’ Cookie: set HTTP-Only flag                            â”‚
  â”‚    â†’ Script KHÃ”NG THá»‚ truy cáº­p document.cookie          â”‚
  â”‚  â†’ DÃ¹ng CAPTCHA                                          â”‚
  â”‚    â†’ Chá»‘ng script giáº£ máº¡o user thá»±c hiá»‡n actions        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. CSRF Attack â€” Táº¥n cÃ´ng CSRF

> **ğŸ¯ Há»c xong pháº§n nÃ y, báº¡n sáº½ biáº¿t:**
>
> - CSRF lÃ  gÃ¬, báº£n cháº¥t
> - 3 loáº¡i táº¥n cÃ´ng CSRF

### KhÃ¡i niá»‡m

```
CSRF â€” CROSS-SITE REQUEST FORGERY:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Äá»ŠNH NGHÄ¨A:                                             â”‚
  â”‚  â†’ Attacker Dá»¤ user vÃ o website thá»© 3                  â”‚
  â”‚  â†’ Website Ä‘Ã³ gá»­i CROSS-SITE REQUEST Ä‘áº¿n website bá»‹    â”‚
  â”‚    táº¥n cÃ´ng                                              â”‚
  â”‚  â†’ Náº¿u user ÄÃƒ ÄÄ‚NG NHáº¬P (cookie cÃ²n valid)           â”‚
  â”‚  â†’ Attacker BYPASS xÃ¡c thá»±c, GIáº¢ Máº O user              â”‚
  â”‚  â†’ Thá»±c hiá»‡n operations trÃªn server                     â”‚
  â”‚                                                          â”‚
  â”‚  Báº¢N CHáº¤T:                                                â”‚
  â”‚  â†’ Lá»£i dá»¥ng Cookie Ä‘Æ°á»£c Gá»¬I Tá»° Äá»˜NG                    â”‚
  â”‚    trong same-origin requests                            â”‚
  â”‚  â†’ â†’ Giáº£ máº¡o danh tÃ­nh user!                            â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  VÃ Dá»¤:

  User Ä‘Ã£ login bank.com (cookie valid)
        â”‚
        â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  click link    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  User    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ evil.com   â”‚
  â”‚ (logged  â”‚                â”‚            â”‚
  â”‚  in to   â”‚                â”‚ <img src=  â”‚
  â”‚ bank.com)â”‚                â”‚ "bank.com/ â”‚
  â”‚          â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ transfer?  â”‚
  â”‚          â”‚  browser tá»±    â”‚ to=hacker  â”‚
  â”‚          â”‚  gá»­i cookie!   â”‚ &amt=1000">â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼ Browser tá»± gá»­i request + cookie tá»›i bank.com!
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ bank.com â”‚ â†’ Nháº­n cookie há»£p lá»‡ â†’ Thá»±c hiá»‡n transfer!
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3 loáº¡i CSRF

```
3 LOáº I Táº¤N CÃ”NG CSRF:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘  GET-type CSRF                                         â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
  â”‚  â†’ DÃ¹ng <img> tag táº¡o GET request                       â”‚
  â”‚  â†’ User má»Ÿ page â†’ request Tá»° Äá»˜NG gá»­i                  â”‚
  â”‚                                                          â”‚
  â”‚  VD: <img src="https://bank.com/transfer?to=hacker      â”‚
  â”‚        &amount=10000">                                   â”‚
  â”‚  â†’ Browser tá»± load img â†’ gá»­i GET + cookie!             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘¡ POST-type CSRF                                        â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                      â”‚
  â”‚  â†’ Táº¡o HIDDEN FORM â†’ auto submit                        â”‚
  â”‚  â†’ User vÃ o page â†’ form Tá»° Äá»˜NG submit                 â”‚
  â”‚                                                          â”‚
  â”‚  VD: <form action="bank.com/transfer" method="POST">    â”‚
  â”‚        <input type="hidden" name="to" value="hacker">   â”‚
  â”‚        <input type="hidden" name="amount" value="10000">â”‚
  â”‚      </form>                                             â”‚
  â”‚      <script>document.forms[0].submit();</script>        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘¢ Link-type CSRF                                        â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
  â”‚  â†’ DÃ¹ng <a> tag vá»›i href chá»©a request                   â”‚
  â”‚  â†’ Cáº§n user CLICK vÃ o link                              â”‚
  â”‚                                                          â”‚
  â”‚  VD: <a href="bank.com/transfer?to=hacker&amount=10000">â”‚
  â”‚        Click Ä‘á»ƒ nháº­n thÆ°á»Ÿng!                             â”‚
  â”‚      </a>                                                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. PhÃ²ng chá»‘ng CSRF

> **ğŸ¯ 4 biá»‡n phÃ¡p phÃ²ng chá»‘ng CSRF**

```
PHÃ’NG CHá»NG CSRF â€” 4 BIá»†N PHÃP:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘  SAME-ORIGIN CHECK (Origin / Referer)                  â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
  â”‚  â†’ Server kiá»ƒm tra Origin hoáº·c Referer header           â”‚
  â”‚  â†’ XÃ¡c Ä‘á»‹nh request cÃ³ tá»« site Ä‘Æ°á»£c phÃ©p khÃ´ng          â”‚
  â”‚  â†’ KhÃ´ng cÃ³ Origin/Referer â†’ CHáº¶N request               â”‚
  â”‚                                                          â”‚
  â”‚  âŒ Háº¡n cháº¿:                                              â”‚
  â”‚  â†’ Referer CÃ“ THá»‚ bá»‹ giáº£ máº¡o                           â”‚
  â”‚  â†’ Cháº·n luÃ´n links tá»« search engine                     â”‚
  â”‚  â†’ ThÆ°á»ng allow search engine â†’ attacker khai thÃ¡c     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘¡ CSRF TOKEN                                            â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                          â”‚
  â”‚  â†’ Server gá»­i RANDOM TOKEN cho user                     â”‚
  â”‚  â†’ Má»i request tiáº¿p theo PHáº¢I kÃ¨m token                â”‚
  â”‚  â†’ Server VERIFY token â†’ há»£p lá»‡ má»›i thá»±c hiá»‡n         â”‚
  â”‚                                                          â”‚
  â”‚  Server â”€â”€ token â”€â”€â–º Client                              â”‚
  â”‚  Client â”€â”€ request + token â”€â”€â–º Server â”€â”€ verify âœ…      â”‚
  â”‚                                                          â”‚
  â”‚  âœ… Giáº£i quyáº¿t giáº£ máº¡o cookie single-factor auth        â”‚
  â”‚  âŒ Pháº£i thÃªm token vÃ o Táº¤T Cáº¢ requests â†’ phiá»n       â”‚
  â”‚  âŒ Multi-server: session khÃ´ng share token             â”‚
  â”‚    â†’ Giáº£i phÃ¡p: thay Ä‘á»•i cÃ¡ch táº¡o token                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘¢ DOUBLE COOKIE VERIFICATION                            â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
  â”‚  â†’ Server inject RANDOM STRING vÃ o cookie               â”‚
  â”‚  â†’ Client láº¥y string tá»« cookie â†’ thÃªm vÃ o URL params  â”‚
  â”‚  â†’ Server so sÃ¡nh: cookie data vs URL param data        â”‚
  â”‚                                                          â”‚
  â”‚  âœ… Attacker chá»‰ CÃ“ THá»‚ dÃ¹ng cookie, KHÃ”NG THá»‚ Äá»ŒC    â”‚
  â”‚  âœ… Tiá»‡n hÆ¡n CSRF token, khÃ´ng váº¥n Ä‘á» distributed      â”‚
  â”‚  âŒ Tháº¥t báº¡i náº¿u website cÃ³ lá»— há»•ng XSS                â”‚
  â”‚  âŒ KhÃ´ng thá»ƒ cÃ´ láº­p subdomain                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘£ SAMESITE COOKIE ATTRIBUTE                              â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
  â”‚  â†’ Háº¡n cháº¿ cookie KHÃ”NG ÄÆ¯á»¢C dÃ¹ng bá»Ÿi third-party      â”‚
  â”‚  â†’ Attacker KHÃ”NG THá»‚ khai thÃ¡c cookie!                 â”‚
  â”‚                                                          â”‚
  â”‚  2 MODE:                                                   â”‚
  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
  â”‚  â”‚ Strict   â”‚ Cookie KHÃ”NG BAO GIá»œ gá»­i third-party    â”‚ â”‚
  â”‚  â”‚          â”‚ â†’ An toÃ n nháº¥t nhÆ°ng strict quÃ¡          â”‚ â”‚
  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
  â”‚  â”‚ Lax      â”‚ Cookie chá»‰ gá»­i khi GET request          â”‚ â”‚
  â”‚  â”‚          â”‚ â†’ dáº«n Ä‘áº¿n page redirect                  â”‚ â”‚
  â”‚  â”‚          â”‚ â†’ CÃ¢n báº±ng báº£o máº­t + usability           â”‚ â”‚
  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Man-in-the-Middle Attack

> **ğŸ¯ MITM Attack â€” Táº¥n cÃ´ng trung gian**

```
MAN-IN-THE-MIDDLE (MITM) ATTACK:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  Äá»ŠNH NGHÄ¨A:                                             â”‚
  â”‚  â†’ Attacker táº¡o Káº¾T Ná»I Äá»˜C Láº¬P vá»›i Cáº¢ HAI Äáº¦U      â”‚
  â”‚  â†’ Trao Ä‘á»•i data nháº­n Ä‘Æ°á»£c giá»¯a 2 bÃªn                  â”‚
  â”‚  â†’ Cáº£ 2 bÃªn TÆ¯á»NG Ä‘ang nÃ³i chuyá»‡n TRá»°C TIáº¾P           â”‚
  â”‚  â†’ Thá»±c táº¿: toÃ n bá»™ session Bá»Š KIá»‚M SOÃT              â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  QUÃ TRÃŒNH Táº¤N CÃ”NG:

  Client                   Hacker                  Server
  â”Œâ”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”
  â”‚      â”‚â”€â”€ â‘  request â”€â”€â–ºâ”‚      â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚      â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚      â”‚â—„â”€â”€ â‘¡ PK_S â”€â”€â”€â”€â”‚      â”‚
  â”‚      â”‚                â”‚ LÆ°u  â”‚  (Public Key   â”‚      â”‚
  â”‚      â”‚                â”‚PK_S  â”‚   tháº­t)        â”‚      â”‚
  â”‚      â”‚                â”‚      â”‚                â”‚      â”‚
  â”‚      â”‚â—„â”€â”€ â‘¢ PK_H â”€â”€â”€â”€â”‚      â”‚                â”‚      â”‚
  â”‚      â”‚  (Public Key   â”‚ Gá»­i  â”‚                â”‚      â”‚
  â”‚      â”‚   GIáº¢!)        â”‚ key  â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚ giáº£  â”‚                â”‚      â”‚
  â”‚      â”‚â”€â”€ â‘£ encrypt â”€â”€â–ºâ”‚      â”‚                â”‚      â”‚
  â”‚      â”‚  báº±ng PK_H    â”‚ Giáº£i â”‚                â”‚      â”‚
  â”‚      â”‚  (tÆ°á»Ÿng PK_S) â”‚ mÃ£   â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚ báº±ng â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚ SK_H â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚ â†’ Äá»ŒCâ”‚                â”‚      â”‚
  â”‚      â”‚                â”‚ DATA!â”‚                â”‚      â”‚
  â”‚      â”‚                â”‚      â”‚â”€â”€ â‘¤ encrypt â”€â”€â–ºâ”‚      â”‚
  â”‚      â”‚                â”‚      â”‚  báº±ng PK_S     â”‚      â”‚
  â”‚      â”‚                â”‚      â”‚  (data tháº­t)   â”‚      â”‚
  â”‚      â”‚                â”‚      â”‚                â”‚      â”‚
  â”‚      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â‘¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
  â”‚      â”‚  Server gá»­i encrypted data             â”‚      â”‚
  â”‚      â”‚  Hacker giáº£i mÃ£ + Ä‘á»c + forward         â”‚      â”‚
  â””â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”˜

  â†’ Client vÃ  Server KHÃ”NG BIáº¾T bá»‹ táº¥n cÃ´ng!
  â†’ Hacker Ä‘á»c TOÃ€N Bá»˜ dá»¯ liá»‡u truyá»n táº£i!

  PHÃ’NG CHá»NG:
  â†’ DÃ¹ng HTTPS vá»›i DIGITAL CERTIFICATE (CA)
  â†’ Certificate Ä‘áº£m báº£o public key ÄÃšNG cá»§a server
  â†’ Hacker KHÃ”NG THá»‚ giáº£ máº¡o certificate (khÃ´ng cÃ³ CA key)
```

---

## 5. CÃ¡c váº¥n Ä‘á» báº£o máº­t Frontend

```
6 Váº¤N Äá»€ Báº¢O Máº¬T FRONTEND:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘  XSS (Cross-Site Scripting)                            â”‚
  â”‚  â†’ Inject code Ä‘á»™c: JS, CSS, Flash                      â”‚
  â”‚  â†’ Phá»• biáº¿n á»Ÿ forums, input khÃ´ng validate              â”‚
  â”‚  â†’ ÄÃ¡nh cáº¯p cookies, data, redirect                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘¡ IFRAME ABUSE                                          â”‚
  â”‚  â†’ Content iframe do THIRD-PARTY cung cáº¥p              â”‚
  â”‚  â†’ Máº·c Ä‘á»‹nh KHÃ”NG kiá»ƒm soÃ¡t Ä‘Æ°á»£c                      â”‚
  â”‚  â†’ CÃ³ thá»ƒ cháº¡y JS, Flash, pop-up dialogs              â”‚
  â”‚  â†’ PhÃ¡ há»ng tráº£i nghiá»‡m user                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘¢ CSRF (Cross-Site Request Forgery)                     â”‚
  â”‚  â†’ Táº¥n cÃ´ng THá»¤ Äá»˜NG (passive attack)                  â”‚
  â”‚  â†’ Ã‰p user ÄÃƒ XÃC THá»°C thá»±c hiá»‡n actions              â”‚
  â”‚  â†’ Sá»­a thÃ´ng tin cÃ¡ nhÃ¢n, settings...                  â”‚
  â”‚  â†’ User KHÃ”NG BIáº¾T                                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘£ MALICIOUS THIRD-PARTY LIBRARIES                       â”‚
  â”‚  â†’ Frontend/backend Ä‘á»u dÃ¹ng framework + libraries     â”‚
  â”‚  â†’ Code Ä‘á»™c Cáº¤Y VÃ€O library â†’ NGUY HIá»‚M               â”‚
  â”‚  â†’ KhÃ³ phÃ¡t hiá»‡n, áº£nh hÆ°á»Ÿng diá»‡n rá»™ng                  â”‚
  â”‚  â†’ VD: event-stream incident (npm)                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘¤ CLICKJACKING                                          â”‚
  â”‚  â†’ Render page tháº­t trong TRANSPARENT iframe            â”‚
  â”‚  â†’ User tÆ°á»Ÿng click button â†’ thá»±c ra click iframe      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚  â‘¥ SENSITIVE DATA EXPOSURE                               â”‚
  â”‚  â†’ LÆ°u trá»¯ data nháº¡y cáº£m á»Ÿ client-side                â”‚
  â”‚  â†’ localStorage, sessionStorage khÃ´ng mÃ£ hÃ³a           â”‚
  â”‚  â†’ API keys, tokens hiá»‡n trong frontend code            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Network Hijacking

> **ğŸ¯ DNS Hijacking vs HTTP Hijacking**

```
NETWORK HIJACKING â€” 2 LOáº I:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘  DNS HIJACKING (Chiáº¿m quyá»n DNS)                      â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
  â”‚  â†’ Nháº­p JD.com â†’ Bá»Š CHUYá»‚N HÆ¯á»šNG sang Taobao!         â”‚
  â”‚                                                          â”‚
  â”‚  2 phÆ°Æ¡ng thá»©c:                                           â”‚
  â”‚                                                          â”‚
  â”‚  A) Forced DNS Resolution:                               â”‚
  â”‚  â†’ Sá»­a báº£n ghi DNS local cá»§a ISP                       â”‚
  â”‚  â†’ Traffic user â†’ redirect tá»›i caching server           â”‚
  â”‚                                                          â”‚
  â”‚  B) 302 Redirect:                                        â”‚
  â”‚  â†’ Monitor outbound traffic                              â”‚
  â”‚  â†’ PhÃ¢n tÃ­ch content cÃ³ thá»ƒ hijack                      â”‚
  â”‚  â†’ Gá»­i 302 redirect response â†’ hijack memory           â”‚
  â”‚  â†’ User láº¥y content tá»« nguá»“n sai!                      â”‚
  â”‚                                                          â”‚
  â”‚  âš ï¸ DNS hijacking lÃ  Báº¤T Há»¢P PHÃP â†’ Ã­t gáº·p hiá»‡n nay   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  â‘¡ HTTP HIJACKING (Chiáº¿m quyá»n HTTP)                     â”‚
  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚
  â”‚  â†’ Truy cáº­p Google â†’ nhÆ°ng tháº¥y quáº£ng cÃ¡o Google Play!â”‚
  â”‚                                                          â”‚
  â”‚  NGUYÃŠN NHÃ‚N:                                             â”‚
  â”‚  â†’ HTTP truyá»n PLAINTEXT                                 â”‚
  â”‚  â†’ ISP (nhÃ  máº¡ng) CÃ“ THá»‚ Äá»ŒC response                â”‚
  â”‚  â†’ ISP Sá»¬A Ná»˜I DUNG response (chÃ¨n quáº£ng cÃ¡o)        â”‚
  â”‚                                                          â”‚
  â”‚  âš ï¸ HTTP hijacking VáºªN CÃ’N Ráº¤T PHá»” BIáº¾N                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  GIáº¢I PHÃP:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                          â”‚
  â”‚  HTTPS TOÃ€N TRANG!                                        â”‚
  â”‚                                                          â”‚
  â”‚  â†’ MÃ£ hÃ³a TOÃ€N Bá»˜ HTTP requests                        â”‚
  â”‚  â†’ ISP KHÃ”NG THá»‚ Ä‘á»c plaintext                          â”‚
  â”‚  â†’ ISP KHÃ”NG THá»‚ sá»­a response content                  â”‚
  â”‚  â†’ â†’ Endpoint-to-endpoint encryption! ğŸ”’               â”‚
  â”‚                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. TÃ³m Táº¯t & CÃ¢u Há»i Phá»ng Váº¥n

### Quick Reference

```
BROWSER SECURITY â€” QUICK REFERENCE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  XSS (Cross-Site Scripting):
  â†’ Inject code Ä‘á»™c vÃ o website â†’ cháº¡y trÃªn browser user
  â†’ 3 loáº¡i: Stored (DB), Reflected (URL), DOM-based (client)
  â†’ PhÃ²ng: Escape input, CSP whitelist, HTTP-Only cookie

  CSRF (Cross-Site Request Forgery):
  â†’ Giáº£ máº¡o user báº±ng cookie cÃ²n valid â†’ gá»­i request
  â†’ 3 loáº¡i: GET (<img>), POST (hidden form), Link (<a>)
  â†’ PhÃ²ng: Origin/Referer check, CSRF token, SameSite cookie

  MITM (Man-in-the-Middle):
  â†’ Attacker cháº·n giá»¯a client-server â†’ Ä‘á»c/sá»­a data
  â†’ PhÃ²ng: HTTPS + Digital Certificate (CA)

  NETWORK HIJACKING:
  â†’ DNS Hijacking: sá»­a DNS â†’ redirect (báº¥t há»£p phÃ¡p)
  â†’ HTTP Hijacking: ISP chÃ¨n quáº£ng cÃ¡o (plaintext)
  â†’ PhÃ²ng: HTTPS toÃ n trang
```

### CÃ¢u Há»i Phá»ng Váº¥n ThÆ°á»ng Gáº·p

**1. XSS lÃ  gÃ¬? CÃ³ máº¥y loáº¡i?**

> XSS (Cross-Site Scripting) lÃ  táº¥n cÃ´ng chÃ¨n mÃ£ Ä‘á»™c (code injection). Website khÃ´ng lá»c code Ä‘á»™c â†’ browser thá»±c thi. 3 loáº¡i: **Stored** (code lÆ°u DB, áº£nh hÆ°á»Ÿng táº¥t cáº£ users), **Reflected** (code trong URL, cáº§n user click), **DOM-based** (JS frontend trÃ­ch xuáº¥t + thá»±c thi, khÃ´ng qua server).

**2. PhÃ²ng chá»‘ng XSS tháº¿ nÃ o?**

> 3 biá»‡n phÃ¡p: â‘  Escape input (HTML entities: `<` â†’ `&lt;`), dÃ¹ng pure frontend rendering. â‘¡ CSP (Content Security Policy) â€” whitelist trusted resources, báº­t báº±ng HTTP header hoáº·c meta tag. â‘¢ Cookie `HTTP-Only` (JS khÃ´ng Ä‘á»c Ä‘Æ°á»£c cookie), thÃªm CAPTCHA chá»‘ng script giáº£ máº¡o.

**3. CSRF lÃ  gÃ¬? KhÃ¡c XSS tháº¿ nÃ o?**

> CSRF (Cross-Site Request Forgery) lá»£i dá»¥ng cookie auto-send Ä‘á»ƒ giáº£ máº¡o user gá»­i request. KhÃ¡c XSS: XSS inject code vÃ o website (cháº¡y trÃªn browser), CSRF giáº£ máº¡o user gá»­i request (exploit cookie). 3 loáº¡i CSRF: GET (`<img>`), POST (hidden form auto-submit), Link (`<a>` cáº§n click).

**4. PhÃ²ng chá»‘ng CSRF tháº¿ nÃ o?**

> 4 cÃ¡ch: â‘  Same-origin check (Origin/Referer header). â‘¡ CSRF Token (server gá»­i random token, má»i request pháº£i kÃ¨m token). â‘¢ Double Cookie (inject random string vÃ o cookie + URL param, server so sÃ¡nh). â‘£ SameSite cookie attribute (Strict: khÃ´ng bao giá» third-party, Lax: chá»‰ GET redirects).

**5. Man-in-the-Middle attack lÃ  gÃ¬?**

> Attacker cháº·n giá»¯a client-server, táº¡o káº¿t ná»‘i Ä‘á»™c láº­p vá»›i cáº£ 2, thay public key tháº­t báº±ng key giáº£. Cáº£ 2 bÃªn tÆ°á»Ÿng giao tiáº¿p trá»±c tiáº¿p nhÆ°ng attacker Ä‘á»c/sá»­a toÃ n bá»™ data. PhÃ²ng chá»‘ng: HTTPS + Digital Certificate (CA xÃ¡c thá»±c public key tháº­t).

**6. DNS Hijacking vs HTTP Hijacking?**

> DNS Hijacking: sá»­a DNS records â†’ redirect traffic sang server khÃ¡c (báº¥t há»£p phÃ¡p, Ã­t gáº·p). HTTP Hijacking: ISP Ä‘á»c HTTP plaintext â†’ chÃ¨n quáº£ng cÃ¡o/sá»­a content (váº«n phá»• biáº¿n). Giáº£i phÃ¡p chung: HTTPS toÃ n trang â†’ ISP khÃ´ng Ä‘á»c/sá»­a Ä‘Æ°á»£c encrypted data.

**7. SameSite cookie cÃ³ máº¥y mode?**

> 2 mode: **Strict** â€” cookie KHÃ”NG BAO GIá»œ gá»­i third-party (an toÃ n nháº¥t). **Lax** â€” cookie chá»‰ gá»­i khi GET request dáº«n Ä‘áº¿n page redirect (cÃ¢n báº±ng báº£o máº­t + usability). SameSite ngÄƒn third-party website sá»­ dá»¥ng cookie â†’ phÃ²ng CSRF.

---

## Checklist Há»c Táº­p

- [ ] Giáº£i thÃ­ch XSS lÃ  gÃ¬, phÃ¢n biá»‡t 3 loáº¡i (Stored/Reflected/DOM)
- [ ] Biáº¿t 3 biá»‡n phÃ¡p phÃ²ng chá»‘ng XSS (Escape, CSP, HTTP-Only)
- [ ] Giáº£i thÃ­ch CSRF lÃ  gÃ¬, phÃ¢n biá»‡t 3 loáº¡i (GET/POST/Link)
- [ ] Biáº¿t 4 biá»‡n phÃ¡p phÃ²ng chá»‘ng CSRF
- [ ] Hiá»ƒu Man-in-the-Middle attack + cÃ¡ch phÃ²ng
- [ ] Biáº¿t 6 váº¥n Ä‘á» báº£o máº­t frontend
- [ ] PhÃ¢n biá»‡t DNS Hijacking vs HTTP Hijacking
- [ ] Hiá»ƒu táº¡i sao HTTPS giáº£i quyáº¿t Ä‘Æ°á»£c network hijacking

---

_Cáº­p nháº­t láº§n cuá»‘i: ThÃ¡ng 2, 2026_
